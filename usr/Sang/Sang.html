<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.242">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Introduction to Statistical Learning</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Sang_files/libs/clipboard/clipboard.min.js"></script>
<script src="Sang_files/libs/quarto-html/quarto.js"></script>
<script src="Sang_files/libs/quarto-html/popper.min.js"></script>
<script src="Sang_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Sang_files/libs/quarto-html/anchor.min.js"></script>
<link href="Sang_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Sang_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="Sang_files/libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="Sang_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Sang_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Sang_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="Sang_files/libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<style>html{ scroll-behavior: smooth; }</style>

<link href="Sang_files/libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="Sang_files/libs/pagedtable-1.1/js/pagedtable.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of Contents</h2>
   
  <ul>
  <li><a href="#preamble" id="toc-preamble" class="nav-link active" data-scroll-target="#preamble">Preamble</a>
  <ul>
  <li><a href="#problem-statements" id="toc-problem-statements" class="nav-link" data-scroll-target="#problem-statements">Problem Statements</a></li>
  <li><a href="#methodologies" id="toc-methodologies" class="nav-link" data-scroll-target="#methodologies">Methodologies</a></li>
  <li><a href="#data-description" id="toc-data-description" class="nav-link" data-scroll-target="#data-description">Data Description</a></li>
  </ul></li>
  <li><a href="#exploratory-analysis" id="toc-exploratory-analysis" class="nav-link" data-scroll-target="#exploratory-analysis">Exploratory Analysis</a>
  <ul>
  <li><a href="#data-import" id="toc-data-import" class="nav-link" data-scroll-target="#data-import">Data Import</a></li>
  <li><a href="#data-analysis" id="toc-data-analysis" class="nav-link" data-scroll-target="#data-analysis">Data Analysis</a></li>
  <li><a href="#data-histograms" id="toc-data-histograms" class="nav-link" data-scroll-target="#data-histograms">Data Histograms</a></li>
  <li><a href="#data-relationships" id="toc-data-relationships" class="nav-link" data-scroll-target="#data-relationships">Data Relationships</a></li>
  <li><a href="#data-split" id="toc-data-split" class="nav-link" data-scroll-target="#data-split">Data Split</a></li>
  </ul></li>
  <li><a href="#data-modeling" id="toc-data-modeling" class="nav-link" data-scroll-target="#data-modeling">Data Modeling</a>
  <ul>
  <li><a href="#k-nearest-neightbor" id="toc-k-nearest-neightbor" class="nav-link" data-scroll-target="#k-nearest-neightbor">K-Nearest Neightbor</a>
  <ul class="collapse">
  <li><a href="#model-construction" id="toc-model-construction" class="nav-link" data-scroll-target="#model-construction">Model Construction</a></li>
  <li><a href="#k-fold-cv" id="toc-k-fold-cv" class="nav-link" data-scroll-target="#k-fold-cv">K-fold CV</a></li>
  <li><a href="#hold-out-cv" id="toc-hold-out-cv" class="nav-link" data-scroll-target="#hold-out-cv">Hold-out CV</a></li>
  <li><a href="#loocv" id="toc-loocv" class="nav-link" data-scroll-target="#loocv">LOOCV</a></li>
  <li><a href="#repeated-cv" id="toc-repeated-cv" class="nav-link" data-scroll-target="#repeated-cv">Repeated CV</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul></li>
  <li><a href="#logistic-regression" id="toc-logistic-regression" class="nav-link" data-scroll-target="#logistic-regression">Logistic Regression</a>
  <ul class="collapse">
  <li><a href="#k-fold-cv-caret" id="toc-k-fold-cv-caret" class="nav-link" data-scroll-target="#k-fold-cv-caret">K-fold CV (<code>caret</code>)</a></li>
  <li><a href="#k-fold-cv-tuned-caret" id="toc-k-fold-cv-tuned-caret" class="nav-link" data-scroll-target="#k-fold-cv-tuned-caret">K-fold CV Tuned (<code>caret</code>)</a></li>
  <li><a href="#k-fold-cv-mass" id="toc-k-fold-cv-mass" class="nav-link" data-scroll-target="#k-fold-cv-mass">K-fold CV (<code>MASS</code>)</a></li>
  <li><a href="#hold-out-cv-mass" id="toc-hold-out-cv-mass" class="nav-link" data-scroll-target="#hold-out-cv-mass">Hold-out CV (<code>MASS</code>)</a></li>
  </ul></li>
  <li><a href="#linear-discriminant-analysis" id="toc-linear-discriminant-analysis" class="nav-link" data-scroll-target="#linear-discriminant-analysis">Linear Discriminant Analysis</a>
  <ul class="collapse">
  <li><a href="#k-fold-cvcaret" id="toc-k-fold-cvcaret" class="nav-link" data-scroll-target="#k-fold-cvcaret">K-fold CV(<code>caret</code>)</a></li>
  <li><a href="#k-fold-cv-mass-1" id="toc-k-fold-cv-mass-1" class="nav-link" data-scroll-target="#k-fold-cv-mass-1">K-fold CV (<code>MASS</code>)</a></li>
  </ul></li>
  <li><a href="#quadratic-discriminant-analysis" id="toc-quadratic-discriminant-analysis" class="nav-link" data-scroll-target="#quadratic-discriminant-analysis">Quadratic discriminant analysis</a>
  <ul class="collapse">
  <li><a href="#k-fold-cv-caret-1" id="toc-k-fold-cv-caret-1" class="nav-link" data-scroll-target="#k-fold-cv-caret-1">K-fold CV (<code>caret</code>)</a></li>
  <li><a href="#k-fold-cv-mass-2" id="toc-k-fold-cv-mass-2" class="nav-link" data-scroll-target="#k-fold-cv-mass-2">K-fold CV (<code>MASS</code>)</a></li>
  </ul></li>
  <li><a href="#summary-1" id="toc-summary-1" class="nav-link" data-scroll-target="#summary-1">Summary</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Introduction to Statistical Learning</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i></button></div></div>
<p class="subtitle lead">STAT 387</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="cell" data-layout-align="TRUE">

<style type="text/css">
body {
font-family: "Times New Roman";
font-size: 0.8em;
}

h2, .h2, h2.anchored, 
h3, .h3, h3.anchored,
.quarto-title, 
.quarto-title-meta {
text-align: center;
}

h2, .h2 {
font-size: 1.5em;
}

h3, .h3 {
font-size: 1.25em;
}

h4, .h4 {
font-size: 1em;
}

h5, .h5 {
font-size: 0.75em;
}

h6, .h6 {
font-size: 0.7em;
}

.quarto-title-meta {
display: block!important;
}

.quarto-title-meta-heading {
display: none;
}

.dropdown-menu {
font-size: 0.8rem;
}

code {
color: #61AFEF;
}

.btn {
border-color: #f8f9fa9e!important;
}

body.quarto-dark {
background-color: #282c34;

color: #d8dee9;

.pagedtable .even {
background-color: #3b4252!important;
}

p code:not(.sourceCode), li code:not(.sourceCode) {
background-color: #4c566a!important;
}
}

#quarto-code-tools-menu{
position: absolute;
}

.top-right {
position: fixed;
}

#TOC::before {
content: "";
display: block;
height: 141px;
margin: 20px 20px 20px 20px;
background-image: url("https://raw.githubusercontent.com/theRealLeif/STAT387/main/README.asset/Logo.svg");
background-size: contain;
background-position: center center;
background-repeat: no-repeat;
}

</style>
</div>
<section id="preamble" class="level2">
<h2 class="anchored" data-anchor-id="preamble">Preamble</h2>
<p>Consider the wine quality dataset from <a href="https://archive.ics.uci.edu/ml/datasets/Wine+Quality">UCI Machine Learning Respository</a>. We will focus only on the data concerning white wines (and not red wines). Dichotomize the <code>quality</code> variable as <code>good</code>, which takes the value 1 if quality â‰¥ 7 and the value 0, otherwise. We will take <code>good</code> as response and all the 11 physiochemical characteristics of the wines in the data as predictors.</p>
<section id="problem-statements" class="level3">
<h3 class="anchored" data-anchor-id="problem-statements">Problem Statements</h3>
<p>Use 10-fold cross-validation for estimating the test error rates below and compute the estimates using <code>caret</code> package with seed set to 1234 before each computation.</p>
<ol type="a">
<li>Fit a KNN with K chosen optimally using test error rate. Report error rate, sensitivity, specificity, and AUC for the optimal KNN based on the training data. Also, report its estimated test error rate.</li>
<li>Repeat (a) using logistic regression.</li>
<li>Repeat (a) using LDA.</li>
<li>Repeat (a) using QDA.</li>
<li>Compare the results in (a)-(d). Which classifier would you recommend? Justify your answer.</li>
</ol>
</section>
<section id="methodologies" class="level3">
<h3 class="anchored" data-anchor-id="methodologies">Methodologies</h3>
<ul>
<li>KNN</li>
<li>GLM/logit/glmnet</li>
<li>LDA</li>
<li>QDA</li>
<li>Naive Bayes</li>
<li>Decision Tree</li>
<li>Classification and Regression Trees (CART)</li>
<li>Random Forest (Classification)</li>
<li>Bagging (Bootstrap Aggregation)</li>
<li>Boosting (Gradient Boosting Machine (GBM))</li>
<li>eXtreme Gradient Boosting (XGBoost)</li>
<li>Extremely Randomized Trees (ExtraTrees)</li>
<li>SVM</li>
<li>Neural Networks (NNET)</li>
</ul>
</section>
<section id="data-description" class="level3">
<h3 class="anchored" data-anchor-id="data-description">Data Description</h3>
<p>This is a dataset of wine quality containing 4898 observations of 12 variables. The variables are:</p>
<ul>
<li><code>fixed.acidity</code>: The amount of fixed acid in the wine (<span class="math inline">\(g/dm^3\)</span>)</li>
<li><code>volatile.acidity</code>: The amount of volatile acid in the wine (<span class="math inline">\(g/dm^4\)</span>)</li>
<li><code>citric.acid</code>: The amount of citric acid in the wine (<span class="math inline">\(g/dm^3\)</span>)</li>
<li><code>residual.sugar</code>: The amount of residual sugar in the wine (<span class="math inline">\(g/dm^3\)</span>)</li>
<li><code>chlorides</code>: The amount of salt in the wine (<span class="math inline">\(g/dm^3\)</span>)</li>
<li><code>free.sulfur.dioxide</code>: The amount of free sulfur dioxide in the wine (<span class="math inline">\(mg/dm^3\)</span>)</li>
<li><code>total.sulfur.dioxide</code>: The amount of total sulfur dioxide in the wine (<span class="math inline">\(mg/dm^3\)</span>)</li>
<li><code>density</code>: The density of the wine (<span class="math inline">\(g/dm^3\)</span>)</li>
<li><code>pH</code>: The <span class="math inline">\(pH\)</span> value of the wine</li>
<li><code>sulphates</code>: The amount of sulphates in the wine (<span class="math inline">\(g/dm^3\)</span>)</li>
<li><code>alcohol</code>: The alcohol content of the wine (<span class="math inline">\(\% vol\)</span>)</li>
<li><code>quality</code>: The quality score of the wine (0-10)</li>
</ul>
<p>After removing the duplicate rows from our data set, we are left with 3961 observations of the above 11 variables minus <code>quality</code> column variable, and introduced a new variable <code>good</code> as our response:</p>
<ul>
<li><code>good</code>: A binary variable indicating whether the wine is good (<code>quality</code> <span class="math inline">\(\geq\)</span> 7) or not (<code>quality</code> <span class="math inline">\(&lt;\)</span> 7).</li>
</ul>
</section>
</section>
<section id="exploratory-analysis" class="level2">
<h2 class="anchored" data-anchor-id="exploratory-analysis">Exploratory Analysis</h2>
<section id="data-import" class="level3">
<h3 class="anchored" data-anchor-id="data-import">Data Import</h3>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>wine.data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">winequality-white.csv"</span>, <span class="at">sep=</span><span class="st">";"</span>, <span class="at">header =</span> T)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>wine.data_subset <span class="ot">&lt;-</span>  wine.data <span class="sc">%&gt;%</span> </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">good =</span> <span class="fu">ifelse</span>(quality<span class="sc">&gt;=</span><span class="dv">7</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>, <span class="dv">13</span>))</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(wine.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["fixed.acidity"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["volatile.acidity"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["citric.acid"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["residual.sugar"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["chlorides"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["free.sulfur.dioxide"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["total.sulfur.dioxide"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["density"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["pH"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["sulphates"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["alcohol"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["quality"],"name":[12],"type":["int"],"align":["right"]}],"data":[{"1":"7.0","2":"0.27","3":"0.36","4":"20.7","5":"0.045","6":"45","7":"170","8":"1.0010","9":"3.00","10":"0.45","11":"8.8","12":"6","_rn_":"1"},{"1":"6.3","2":"0.30","3":"0.34","4":"1.6","5":"0.049","6":"14","7":"132","8":"0.9940","9":"3.30","10":"0.49","11":"9.5","12":"6","_rn_":"2"},{"1":"8.1","2":"0.28","3":"0.40","4":"6.9","5":"0.050","6":"30","7":"97","8":"0.9951","9":"3.26","10":"0.44","11":"10.1","12":"6","_rn_":"3"},{"1":"7.2","2":"0.23","3":"0.32","4":"8.5","5":"0.058","6":"47","7":"186","8":"0.9956","9":"3.19","10":"0.40","11":"9.9","12":"6","_rn_":"4"},{"1":"7.2","2":"0.23","3":"0.32","4":"8.5","5":"0.058","6":"47","7":"186","8":"0.9956","9":"3.19","10":"0.40","11":"9.9","12":"6","_rn_":"5"},{"1":"8.1","2":"0.28","3":"0.40","4":"6.9","5":"0.050","6":"30","7":"97","8":"0.9951","9":"3.26","10":"0.44","11":"10.1","12":"6","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(wine.data_subset)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["fixed.acidity"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["volatile.acidity"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["citric.acid"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["residual.sugar"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["chlorides"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["free.sulfur.dioxide"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["total.sulfur.dioxide"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["density"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["pH"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["sulphates"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["alcohol"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["good"],"name":[12],"type":["dbl"],"align":["right"]}],"data":[{"1":"7.0","2":"0.27","3":"0.36","4":"20.7","5":"0.045","6":"45","7":"170","8":"1.0010","9":"3.00","10":"0.45","11":"8.8","12":"0","_rn_":"1"},{"1":"6.3","2":"0.30","3":"0.34","4":"1.6","5":"0.049","6":"14","7":"132","8":"0.9940","9":"3.30","10":"0.49","11":"9.5","12":"0","_rn_":"2"},{"1":"8.1","2":"0.28","3":"0.40","4":"6.9","5":"0.050","6":"30","7":"97","8":"0.9951","9":"3.26","10":"0.44","11":"10.1","12":"0","_rn_":"3"},{"1":"7.2","2":"0.23","3":"0.32","4":"8.5","5":"0.058","6":"47","7":"186","8":"0.9956","9":"3.19","10":"0.40","11":"9.9","12":"0","_rn_":"4"},{"1":"6.2","2":"0.32","3":"0.16","4":"7.0","5":"0.045","6":"30","7":"136","8":"0.9949","9":"3.18","10":"0.47","11":"9.6","12":"0","_rn_":"5"},{"1":"8.1","2":"0.22","3":"0.43","4":"1.5","5":"0.044","6":"28","7":"129","8":"0.9938","9":"3.22","10":"0.45","11":"11.0","12":"0","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="data-analysis" class="level3">
<h3 class="anchored" data-anchor-id="data-analysis">Data Analysis</h3>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(wine.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4898   12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(wine.data_subset)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3961   12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(wine.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   4898 obs. of  12 variables:
 $ fixed.acidity       : num  7 6.3 8.1 7.2 7.2 8.1 6.2 7 6.3 8.1 ...
 $ volatile.acidity    : num  0.27 0.3 0.28 0.23 0.23 0.28 0.32 0.27 0.3 0.22 ...
 $ citric.acid         : num  0.36 0.34 0.4 0.32 0.32 0.4 0.16 0.36 0.34 0.43 ...
 $ residual.sugar      : num  20.7 1.6 6.9 8.5 8.5 6.9 7 20.7 1.6 1.5 ...
 $ chlorides           : num  0.045 0.049 0.05 0.058 0.058 0.05 0.045 0.045 0.049 0.044 ...
 $ free.sulfur.dioxide : num  45 14 30 47 47 30 30 45 14 28 ...
 $ total.sulfur.dioxide: num  170 132 97 186 186 97 136 170 132 129 ...
 $ density             : num  1.001 0.994 0.995 0.996 0.996 ...
 $ pH                  : num  3 3.3 3.26 3.19 3.19 3.26 3.18 3 3.3 3.22 ...
 $ sulphates           : num  0.45 0.49 0.44 0.4 0.4 0.44 0.47 0.45 0.49 0.45 ...
 $ alcohol             : num  8.8 9.5 10.1 9.9 9.9 10.1 9.6 8.8 9.5 11 ...
 $ quality             : int  6 6 6 6 6 6 6 6 6 6 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(wine.data_subset)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   3961 obs. of  12 variables:
 $ fixed.acidity       : num  7 6.3 8.1 7.2 6.2 8.1 8.1 8.6 7.9 6.6 ...
 $ volatile.acidity    : num  0.27 0.3 0.28 0.23 0.32 0.22 0.27 0.23 0.18 0.16 ...
 $ citric.acid         : num  0.36 0.34 0.4 0.32 0.16 0.43 0.41 0.4 0.37 0.4 ...
 $ residual.sugar      : num  20.7 1.6 6.9 8.5 7 1.5 1.45 4.2 1.2 1.5 ...
 $ chlorides           : num  0.045 0.049 0.05 0.058 0.045 0.044 0.033 0.035 0.04 0.044 ...
 $ free.sulfur.dioxide : num  45 14 30 47 30 28 11 17 16 48 ...
 $ total.sulfur.dioxide: num  170 132 97 186 136 129 63 109 75 143 ...
 $ density             : num  1.001 0.994 0.995 0.996 0.995 ...
 $ pH                  : num  3 3.3 3.26 3.19 3.18 3.22 2.99 3.14 3.18 3.54 ...
 $ sulphates           : num  0.45 0.49 0.44 0.4 0.47 0.45 0.56 0.53 0.63 0.52 ...
 $ alcohol             : num  8.8 9.5 10.1 9.9 9.6 11 12 9.7 10.8 12.4 ...
 $ good                : num  0 0 0 0 0 0 0 0 0 1 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wine.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> fixed.acidity    volatile.acidity  citric.acid     residual.sugar  
 Min.   : 3.800   Min.   :0.0800   Min.   :0.0000   Min.   : 0.600  
 1st Qu.: 6.300   1st Qu.:0.2100   1st Qu.:0.2700   1st Qu.: 1.700  
 Median : 6.800   Median :0.2600   Median :0.3200   Median : 5.200  
 Mean   : 6.855   Mean   :0.2782   Mean   :0.3342   Mean   : 6.391  
 3rd Qu.: 7.300   3rd Qu.:0.3200   3rd Qu.:0.3900   3rd Qu.: 9.900  
 Max.   :14.200   Max.   :1.1000   Max.   :1.6600   Max.   :65.800  
   chlorides       free.sulfur.dioxide total.sulfur.dioxide    density      
 Min.   :0.00900   Min.   :  2.00      Min.   :  9.0        Min.   :0.9871  
 1st Qu.:0.03600   1st Qu.: 23.00      1st Qu.:108.0        1st Qu.:0.9917  
 Median :0.04300   Median : 34.00      Median :134.0        Median :0.9937  
 Mean   :0.04577   Mean   : 35.31      Mean   :138.4        Mean   :0.9940  
 3rd Qu.:0.05000   3rd Qu.: 46.00      3rd Qu.:167.0        3rd Qu.:0.9961  
 Max.   :0.34600   Max.   :289.00      Max.   :440.0        Max.   :1.0390  
       pH          sulphates         alcohol         quality     
 Min.   :2.720   Min.   :0.2200   Min.   : 8.00   Min.   :3.000  
 1st Qu.:3.090   1st Qu.:0.4100   1st Qu.: 9.50   1st Qu.:5.000  
 Median :3.180   Median :0.4700   Median :10.40   Median :6.000  
 Mean   :3.188   Mean   :0.4898   Mean   :10.51   Mean   :5.878  
 3rd Qu.:3.280   3rd Qu.:0.5500   3rd Qu.:11.40   3rd Qu.:6.000  
 Max.   :3.820   Max.   :1.0800   Max.   :14.20   Max.   :9.000  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wine.data_subset)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> fixed.acidity    volatile.acidity  citric.acid     residual.sugar  
 Min.   : 3.800   Min.   :0.0800   Min.   :0.0000   Min.   : 0.600  
 1st Qu.: 6.300   1st Qu.:0.2100   1st Qu.:0.2700   1st Qu.: 1.600  
 Median : 6.800   Median :0.2600   Median :0.3200   Median : 4.700  
 Mean   : 6.839   Mean   :0.2805   Mean   :0.3343   Mean   : 5.915  
 3rd Qu.: 7.300   3rd Qu.:0.3300   3rd Qu.:0.3900   3rd Qu.: 8.900  
 Max.   :14.200   Max.   :1.1000   Max.   :1.6600   Max.   :65.800  
   chlorides       free.sulfur.dioxide total.sulfur.dioxide    density      
 Min.   :0.00900   Min.   :  2.00      Min.   :  9.0        Min.   :0.9871  
 1st Qu.:0.03500   1st Qu.: 23.00      1st Qu.:106.0        1st Qu.:0.9916  
 Median :0.04200   Median : 33.00      Median :133.0        Median :0.9935  
 Mean   :0.04591   Mean   : 34.89      Mean   :137.2        Mean   :0.9938  
 3rd Qu.:0.05000   3rd Qu.: 45.00      3rd Qu.:166.0        3rd Qu.:0.9957  
 Max.   :0.34600   Max.   :289.00      Max.   :440.0        Max.   :1.0390  
       pH          sulphates         alcohol           good       
 Min.   :2.720   Min.   :0.2200   Min.   : 8.00   Min.   :0.0000  
 1st Qu.:3.090   1st Qu.:0.4100   1st Qu.: 9.50   1st Qu.:0.0000  
 Median :3.180   Median :0.4800   Median :10.40   Median :0.0000  
 Mean   :3.195   Mean   :0.4904   Mean   :10.59   Mean   :0.2083  
 3rd Qu.:3.290   3rd Qu.:0.5500   3rd Qu.:11.40   3rd Qu.:0.0000  
 Max.   :3.820   Max.   :1.0800   Max.   :14.20   Max.   :1.0000  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for NAs in dataset</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(wine.data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Counts at each combination of response's factor levels</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(wine.data<span class="sc">$</span>quality)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   3    4    5    6    7    8    9 
  20  163 1457 2198  880  175    5 </code></pre>
</div>
</div>
</section>
<section id="data-histograms" class="level3">
<h3 class="anchored" data-anchor-id="data-histograms">Data Histograms</h3>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>wine.colnames <span class="ot">&lt;-</span> <span class="fu">colnames</span>(wine.data_subset[, <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>])</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>num_plots     <span class="ot">&lt;-</span> <span class="fu">length</span>(wine.colnames)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>num_rows      <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(num_plots<span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an empty list to store plots</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>grid_arr      <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop over each column name in the wine.colnames vector</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_plots) {</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a ggplot object for the current column using aes</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  plt <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> wine.data_subset, <span class="fu">aes_string</span>(<span class="at">x =</span> wine.colnames[i])) <span class="sc">+</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fu">diff</span>(<span class="fu">range</span>(wine.data_subset[[wine.colnames[i]]]))<span class="sc">/</span><span class="dv">30</span>, </span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"slategray3"</span>) <span class="sc">+</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> wine.colnames[i], <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add the current plot to the grid_arr list</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>  grid_arr[[i]] <span class="ot">&lt;-</span> plt</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>grid_arr <span class="ot">&lt;-</span> <span class="fu">do.call</span>(gridExtra<span class="sc">::</span>grid.arrange, <span class="fu">c</span>(grid_arr, <span class="at">ncol =</span> <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Sang_files/figure-html/hist_plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="data-relationships" class="level3">
<h3 class="anchored" data-anchor-id="data-relationships">Data Relationships</h3>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>reshape2<span class="sc">::</span><span class="fu">melt</span>(wine.data[, <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>], <span class="st">"quality"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(value, quality, <span class="at">color =</span> variable)) <span class="sc">+</span>  </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(value,quality, <span class="at">colour=</span>variable), <span class="at">method=</span>lm, <span class="at">se=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(.<span class="sc">~</span>variable, <span class="at">scales =</span> <span class="st">"free"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Sang_files/figure-html/relation_plot-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Collinearity between Attributes</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(wine.data_subset) <span class="sc">%&gt;%</span> </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  corrplot<span class="sc">::</span><span class="fu">corrplot</span>(<span class="at">method =</span> <span class="st">'number'</span>,  <span class="at">type =</span> <span class="st">"lower"</span>, <span class="at">tl.col =</span> <span class="st">"steelblue"</span>, <span class="at">number.cex =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Sang_files/figure-html/relation_plot-2.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove quality from dataset, use good as response </span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>wine.data_subset<span class="sc">$</span>quality <span class="ot">&lt;-</span> <span class="cn">NULL</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-split" class="level3">
<h3 class="anchored" data-anchor-id="data-split">Data Split</h3>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Splitting the dataset into train and test (7/10th for train remaining for test)</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>inTrain <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">createDataPartition</span>(wine.data_subset<span class="sc">$</span>good, <span class="at">p =</span> <span class="dv">7</span><span class="sc">/</span><span class="dv">10</span>, <span class="at">list =</span> F)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> wine.data_subset[inTrain,]</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> wine.data_subset[<span class="sc">-</span>inTrain,]</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the outcome variable to a factor with two levels</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>train<span class="sc">$</span>good <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(train<span class="sc">$</span>good)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>test<span class="sc">$</span>good <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(test<span class="sc">$</span>good)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="data-modeling" class="level2">
<h2 class="anchored" data-anchor-id="data-modeling">Data Modeling</h2>
<section id="k-nearest-neightbor" class="level3">
<h3 class="anchored" data-anchor-id="k-nearest-neightbor">K-Nearest Neightbor</h3>
<section id="model-construction" class="level4">
<h4 class="anchored" data-anchor-id="model-construction">Model Construction</h4>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------#</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co">#-----K-fold CV------#</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------#</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the training control object for 10-fold cross-validation</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">10</span>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the KNN model using 10-fold cross-validation</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="co"># tuneLength argument to specify the range of values of K to be considered for tuning</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train, </span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"knn"</span>, </span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">trControl =</span> train_control,</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tuneGrid =</span> <span class="fu">data.frame</span>(<span class="at">k =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>))</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the model into .Rdata for future import </span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(knn_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_kfoldCV.Rdata"</span>)</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------#</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a><span class="co">#-----K-fold CV (Mod)------#</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------#</span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">10</span>)</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train, </span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"knn"</span>, </span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>                   <span class="at">trControl =</span> train_control, </span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tuneGrid =</span> <span class="fu">data.frame</span>(<span class="at">k =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>))</span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the model into .Rdata for future import </span></span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(knn_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_kfoldCV_mod.Rdata"</span>)</span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------#</span></span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a><span class="co">#----Hold-out CV-----#</span></span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------#</span></span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"none"</span>,)</span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train, </span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"knn"</span>,</span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tuneGrid =</span> <span class="fu">data.frame</span>(<span class="at">k =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>))</span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(knn_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_holdoutCV.Rdata"</span>)</span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-56"><a href="#cb24-56" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------#</span></span>
<span id="cb24-57"><a href="#cb24-57" aria-hidden="true" tabindex="-1"></a><span class="co">#----Hold-out CV (Mod)-----#</span></span>
<span id="cb24-58"><a href="#cb24-58" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------#</span></span>
<span id="cb24-59"><a href="#cb24-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-60"><a href="#cb24-60" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb24-61"><a href="#cb24-61" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"none"</span>,)</span>
<span id="cb24-62"><a href="#cb24-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-63"><a href="#cb24-63" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb24-64"><a href="#cb24-64" aria-hidden="true" tabindex="-1"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb24-65"><a href="#cb24-65" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train, </span>
<span id="cb24-66"><a href="#cb24-66" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"knn"</span>,</span>
<span id="cb24-67"><a href="#cb24-67" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tuneGrid =</span> <span class="fu">expand.grid</span>(<span class="at">k=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>))</span>
<span id="cb24-68"><a href="#cb24-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-69"><a href="#cb24-69" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(knn_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_holdoutCV_mod.Rdata"</span>)</span>
<span id="cb24-70"><a href="#cb24-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-71"><a href="#cb24-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-72"><a href="#cb24-72" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------#</span></span>
<span id="cb24-73"><a href="#cb24-73" aria-hidden="true" tabindex="-1"></a><span class="co">#-------LOOCV--------#</span></span>
<span id="cb24-74"><a href="#cb24-74" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------#</span></span>
<span id="cb24-75"><a href="#cb24-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-76"><a href="#cb24-76" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb24-77"><a href="#cb24-77" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"LOOCV"</span>)</span>
<span id="cb24-78"><a href="#cb24-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-79"><a href="#cb24-79" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb24-80"><a href="#cb24-80" aria-hidden="true" tabindex="-1"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb24-81"><a href="#cb24-81" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train, </span>
<span id="cb24-82"><a href="#cb24-82" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"knn"</span>, </span>
<span id="cb24-83"><a href="#cb24-83" aria-hidden="true" tabindex="-1"></a>                   <span class="at">trControl =</span> train_control,</span>
<span id="cb24-84"><a href="#cb24-84" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tuneGrid =</span> <span class="fu">data.frame</span>(<span class="at">k =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>))</span>
<span id="cb24-85"><a href="#cb24-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-86"><a href="#cb24-86" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(knn_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_looCV.Rdata"</span>)</span>
<span id="cb24-87"><a href="#cb24-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-88"><a href="#cb24-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-89"><a href="#cb24-89" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------#</span></span>
<span id="cb24-90"><a href="#cb24-90" aria-hidden="true" tabindex="-1"></a><span class="co">#-------LOOCV (Mod)--------#</span></span>
<span id="cb24-91"><a href="#cb24-91" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------#</span></span>
<span id="cb24-92"><a href="#cb24-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-93"><a href="#cb24-93" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb24-94"><a href="#cb24-94" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"LOOCV"</span>)</span>
<span id="cb24-95"><a href="#cb24-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-96"><a href="#cb24-96" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb24-97"><a href="#cb24-97" aria-hidden="true" tabindex="-1"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb24-98"><a href="#cb24-98" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train, </span>
<span id="cb24-99"><a href="#cb24-99" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"knn"</span>, </span>
<span id="cb24-100"><a href="#cb24-100" aria-hidden="true" tabindex="-1"></a>                   <span class="at">trControl =</span> train_control,</span>
<span id="cb24-101"><a href="#cb24-101" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tuneLength =</span> <span class="dv">10</span>,</span>
<span id="cb24-102"><a href="#cb24-102" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tuneGrid =</span> <span class="fu">expand.grid</span>(<span class="at">k =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>))</span>
<span id="cb24-103"><a href="#cb24-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-104"><a href="#cb24-104" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(knn_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_looCV_mod.Rdata"</span>)</span>
<span id="cb24-105"><a href="#cb24-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-106"><a href="#cb24-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-107"><a href="#cb24-107" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------#</span></span>
<span id="cb24-108"><a href="#cb24-108" aria-hidden="true" tabindex="-1"></a><span class="co">#----Repeated CV-----#</span></span>
<span id="cb24-109"><a href="#cb24-109" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------#</span></span>
<span id="cb24-110"><a href="#cb24-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-111"><a href="#cb24-111" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb24-112"><a href="#cb24-112" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"repeatedcv"</span>, <span class="at">number =</span> <span class="dv">10</span>, <span class="at">repeats =</span> <span class="dv">5</span>)</span>
<span id="cb24-113"><a href="#cb24-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-114"><a href="#cb24-114" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb24-115"><a href="#cb24-115" aria-hidden="true" tabindex="-1"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb24-116"><a href="#cb24-116" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train, </span>
<span id="cb24-117"><a href="#cb24-117" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"knn"</span>, </span>
<span id="cb24-118"><a href="#cb24-118" aria-hidden="true" tabindex="-1"></a>                   <span class="at">trControl =</span> train_control)</span>
<span id="cb24-119"><a href="#cb24-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-120"><a href="#cb24-120" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(knn_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_repeatedCV.Rdata"</span>)</span>
<span id="cb24-121"><a href="#cb24-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-122"><a href="#cb24-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-123"><a href="#cb24-123" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------#</span></span>
<span id="cb24-124"><a href="#cb24-124" aria-hidden="true" tabindex="-1"></a><span class="co">#----Repeated CV (Mod)-----#</span></span>
<span id="cb24-125"><a href="#cb24-125" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------#</span></span>
<span id="cb24-126"><a href="#cb24-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-127"><a href="#cb24-127" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb24-128"><a href="#cb24-128" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"repeatedcv"</span>, <span class="at">number =</span> <span class="dv">10</span>, <span class="at">repeats =</span> <span class="dv">5</span>)</span>
<span id="cb24-129"><a href="#cb24-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-130"><a href="#cb24-130" aria-hidden="true" tabindex="-1"></a>kknn.grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">kmax =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span> ,<span class="dv">9</span>, <span class="dv">11</span>), <span class="at">distance =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb24-131"><a href="#cb24-131" aria-hidden="true" tabindex="-1"></a>                         <span class="at">kernel =</span> <span class="fu">c</span>(<span class="st">"rectangular"</span>, <span class="st">"gaussian"</span>, <span class="st">"cos"</span>))</span>
<span id="cb24-132"><a href="#cb24-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-133"><a href="#cb24-133" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb24-134"><a href="#cb24-134" aria-hidden="true" tabindex="-1"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb24-135"><a href="#cb24-135" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train, </span>
<span id="cb24-136"><a href="#cb24-136" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"kknn"</span>,</span>
<span id="cb24-137"><a href="#cb24-137" aria-hidden="true" tabindex="-1"></a>                   <span class="at">trControl =</span> train_control, </span>
<span id="cb24-138"><a href="#cb24-138" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tuneGrid =</span> kknn.grid,</span>
<span id="cb24-139"><a href="#cb24-139" aria-hidden="true" tabindex="-1"></a>                   <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>))</span>
<span id="cb24-140"><a href="#cb24-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-141"><a href="#cb24-141" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(knn_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_repeatedCV_mod.Rdata"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="k-fold-cv" class="level4">
<h4 class="anchored" data-anchor-id="k-fold-cv">K-fold CV</h4>
<p>In the 10-fold cross-validation procedure, the original dataset is split into 10 subsets of approximately equal size. The model is then trained on 9 of the subsets (the training data) and evaluated on the remaining subset (the validation data). This process is repeated 10 times, each time using a different subset as the validation set, until every subset has been used exactly once as the validation set.</p>
<p>The purpose of cross-validation is to estimate the performance of the model on new, unseen data by simulating the process of training and testing on multiple, independent datasets. It is typically used to assess the performance of different models or model configurations, to select hyperparameters, or to compare the performance of different algorithms.</p>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import model</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_kfoldCV.Rdata"</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the test data using the trained model and calculate the test error rate</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_model, <span class="at">newdata =</span> test)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(knn.predictions, test<span class="sc">$</span>good)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 924 164
         1  37  63
                                          
               Accuracy : 0.8308          
                 95% CI : (0.8083, 0.8517)
    No Information Rate : 0.8089          
    P-Value [Acc &gt; NIR] : 0.02856         
                                          
                  Kappa : 0.304           
                                          
 Mcnemar's Test P-Value : &lt; 2e-16         
                                          
            Sensitivity : 0.9615          
            Specificity : 0.2775          
         Pos Pred Value : 0.8493          
         Neg Pred Value : 0.6300          
             Prevalence : 0.8089          
         Detection Rate : 0.7778          
   Detection Prevalence : 0.9158          
      Balanced Accuracy : 0.6195          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert predictions to a numeric vector</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(knn.predictions)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the AUC using the performance() and auc() functions:</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>auc_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6195157</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Performance plot for TP and FP</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"KNN ROC Curves with 10-fold CV"</span>)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(roc_obj<span class="sc">@</span>x.values))</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>y_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(roc_obj<span class="sc">@</span>y.values))</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> x_values, <span class="at">y =</span> y_values, </span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">rgb</span>(<span class="fl">0.3803922</span>, <span class="fl">0.6862745</span>, <span class="fl">0.9372549</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fu">paste</span>(<span class="st">"AUC ="</span>, <span class="fu">round</span>(auc_val, <span class="dv">4</span>)), <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>knn.kfoldCV.ROC.plot<span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>knn_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">k =</span> knn_model<span class="sc">$</span>results<span class="sc">$</span>k, </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Accuracy =</span> knn_model<span class="sc">$</span>results<span class="sc">$</span>Accuracy,</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Kappa =</span> knn_model<span class="sc">$</span>results<span class="sc">$</span>Kappa)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Accuracy and Kappa value plot</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>accu.kappa.plot <span class="ot">&lt;-</span> <span class="cf">function</span>(model_df) {</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> model_df) <span class="sc">+</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">color =</span> <span class="st">"Accuracy"</span>)) <span class="sc">+</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">color =</span> <span class="st">"Kappa"</span>)) <span class="sc">+</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">linetype =</span> <span class="st">"Accuracy"</span>, <span class="at">color =</span> <span class="st">"Accuracy"</span>)) <span class="sc">+</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">linetype =</span> <span class="st">"Kappa"</span>, <span class="at">color =</span> <span class="st">"Kappa"</span>)) <span class="sc">+</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#98c379"</span>, <span class="st">"#e06c75"</span>),</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>                       <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>)) )) <span class="sc">+</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_linetype_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"solid"</span>, <span class="st">"dotted"</span>),</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>                          <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="fu">c</span>(<span class="st">"#98c379"</span>, <span class="st">"#e06c75"</span>)))) <span class="sc">+</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"K value"</span>, </span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Accuracy / Kappa"</span>) <span class="sc">+</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Metric"</span>),</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>           <span class="at">linetype =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Metric"</span>))</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>knn.kfoldCV.plot <span class="ot">&lt;-</span> <span class="fu">accu.kappa.plot</span>(knn_df) <span class="sc">+</span> </span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">label =</span> <span class="fu">round</span>(Kappa, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"KNN Model Performance (10-Fold CV)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="tuned" class="level5">
<h5 class="anchored" data-anchor-id="tuned">Tuned</h5>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_kfoldCV_mod.Rdata"</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_model, <span class="at">newdata =</span> test)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(knn.predictions, test<span class="sc">$</span>good)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 937 208
         1  24  19
                                         
               Accuracy : 0.8047         
                 95% CI : (0.781, 0.8269)
    No Information Rate : 0.8089         
    P-Value [Acc &gt; NIR] : 0.6599         
                                         
                  Kappa : 0.0851         
                                         
 Mcnemar's Test P-Value : &lt;2e-16         
                                         
            Sensitivity : 0.9750         
            Specificity : 0.0837         
         Pos Pred Value : 0.8183         
         Neg Pred Value : 0.4419         
             Prevalence : 0.8089         
         Detection Rate : 0.7887         
   Detection Prevalence : 0.9638         
      Balanced Accuracy : 0.5294         
                                         
       'Positive' Class : 0              
                                         </code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(knn.predictions)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>auc_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5293632</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"KNN ROC Curves with Tuned 10-fold CV"</span>)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(roc_obj<span class="sc">@</span>x.values))</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>y_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(roc_obj<span class="sc">@</span>y.values))</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> x_values, <span class="at">y =</span> y_values, </span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">rgb</span>(<span class="fl">0.3803922</span>, <span class="fl">0.6862745</span>, <span class="fl">0.9372549</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fu">paste</span>(<span class="st">"AUC ="</span>, <span class="fu">round</span>(auc_val, <span class="dv">4</span>)), <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>knn.kfoldCV_mod.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>knn_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">k =</span> knn_model<span class="sc">$</span>results<span class="sc">$</span>k, </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Accuracy =</span> knn_model<span class="sc">$</span>results<span class="sc">$</span>Accuracy,</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Kappa =</span> knn_model<span class="sc">$</span>results<span class="sc">$</span>Kappa)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>knn.kfoldCV_mod.plot <span class="ot">&lt;-</span> <span class="fu">accu.kappa.plot</span>(knn_df) <span class="sc">+</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">3</span>)),  <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">angle=</span><span class="dv">90</span>)  <span class="sc">+</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">label =</span> <span class="fu">round</span>(Kappa, <span class="dv">3</span>)),  <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">angle=</span><span class="dv">90</span>) <span class="sc">+</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"KNN Model Performance (Tuned 10-Fold CV)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="hold-out-cv" class="level4">
<h4 class="anchored" data-anchor-id="hold-out-cv">Hold-out CV</h4>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_holdoutCV.Rdata"</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_model, <span class="at">newdata =</span> test)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(knn.predictions, test<span class="sc">$</span>good)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 919 168
         1  42  59
                                          
               Accuracy : 0.8232          
                 95% CI : (0.8003, 0.8445)
    No Information Rate : 0.8089          
    P-Value [Acc &gt; NIR] : 0.1109          
                                          
                  Kappa : 0.2744          
                                          
 Mcnemar's Test P-Value : &lt;2e-16          
                                          
            Sensitivity : 0.9563          
            Specificity : 0.2599          
         Pos Pred Value : 0.8454          
         Neg Pred Value : 0.5842          
             Prevalence : 0.8089          
         Detection Rate : 0.7736          
   Detection Prevalence : 0.9150          
      Balanced Accuracy : 0.6081          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(knn.predictions)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>auc_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6081037</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"KNN ROC Curves with Hold-out CV"</span>)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(roc_obj<span class="sc">@</span>x.values))</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>y_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(roc_obj<span class="sc">@</span>y.values))</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> x_values, <span class="at">y =</span> y_values, </span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">rgb</span>(<span class="fl">0.3803922</span>, <span class="fl">0.6862745</span>, <span class="fl">0.9372549</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fu">paste</span>(<span class="st">"AUC ="</span>, <span class="fu">round</span>(auc_val, <span class="dv">4</span>)), <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>knn.holdoutCV.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>knn_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">k =</span> knn_model<span class="sc">$</span>results<span class="sc">$</span>k, </span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Accuracy =</span> knn_model<span class="sc">$</span>results<span class="sc">$</span>Accuracy,</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Kappa =</span> knn_model<span class="sc">$</span>results<span class="sc">$</span>Kappa)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>knn.holdoutCV.plot <span class="ot">&lt;-</span> <span class="fu">accu.kappa.plot</span>(knn_df) <span class="sc">+</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">label =</span> <span class="fu">round</span>(Kappa, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"KNN Model Performance (Hold-out CV)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="tuned-1" class="level5">
<h5 class="anchored" data-anchor-id="tuned-1">Tuned</h5>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_holdoutCV_mod.Rdata"</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_model, <span class="at">newdata =</span> test)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(knn.predictions, test<span class="sc">$</span>good)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 950 220
         1  11   7
                                          
               Accuracy : 0.8056          
                 95% CI : (0.7819, 0.8277)
    No Information Rate : 0.8089          
    P-Value [Acc &gt; NIR] : 0.6326          
                                          
                  Kappa : 0.0299          
                                          
 Mcnemar's Test P-Value : &lt;2e-16          
                                          
            Sensitivity : 0.98855         
            Specificity : 0.03084         
         Pos Pred Value : 0.81197         
         Neg Pred Value : 0.38889         
             Prevalence : 0.80892         
         Detection Rate : 0.79966         
   Detection Prevalence : 0.98485         
      Balanced Accuracy : 0.50970         
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(knn.predictions)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>auc_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5096953</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"KNN ROC Curves with Tuned Hold-out CV"</span>)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(roc_obj<span class="sc">@</span>x.values))</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>y_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(roc_obj<span class="sc">@</span>y.values))</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> x_values, <span class="at">y =</span> y_values, </span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">rgb</span>(<span class="fl">0.3803922</span>, <span class="fl">0.6862745</span>, <span class="fl">0.9372549</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fu">paste</span>(<span class="st">"AUC ="</span>, <span class="fu">round</span>(auc_val, <span class="dv">4</span>)), <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>knn.holdoutCV_mod.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>knn_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">k =</span> knn_model<span class="sc">$</span>results<span class="sc">$</span>k, </span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Accuracy =</span> knn_model<span class="sc">$</span>results<span class="sc">$</span>Accuracy,</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Kappa =</span> knn_model<span class="sc">$</span>results<span class="sc">$</span>Kappa)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>knn.holdoutCV_mod.plot <span class="ot">&lt;-</span> <span class="fu">accu.kappa.plot</span>(knn_df) <span class="sc">+</span> </span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">3</span>)), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">angle=</span><span class="dv">90</span>) <span class="sc">+</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">label =</span> <span class="fu">round</span>(Kappa, <span class="dv">3</span>)), <span class="at">hjust=</span><span class="sc">-</span><span class="fl">0.3</span>, <span class="at">angle=</span><span class="dv">90</span>) <span class="sc">+</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"KNN Model Performance (Tuned Hold-out CV)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="loocv" class="level4">
<h4 class="anchored" data-anchor-id="loocv">LOOCV</h4>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_looCV.Rdata"</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_model, <span class="at">newdata =</span> test)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(knn.predictions, test<span class="sc">$</span>good)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 923 163
         1  38  64
                                          
               Accuracy : 0.8308          
                 95% CI : (0.8083, 0.8517)
    No Information Rate : 0.8089          
    P-Value [Acc &gt; NIR] : 0.02856         
                                          
                  Kappa : 0.3069          
                                          
 Mcnemar's Test P-Value : &lt; 2e-16         
                                          
            Sensitivity : 0.9605          
            Specificity : 0.2819          
         Pos Pred Value : 0.8499          
         Neg Pred Value : 0.6275          
             Prevalence : 0.8089          
         Detection Rate : 0.7769          
   Detection Prevalence : 0.9141          
      Balanced Accuracy : 0.6212          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(knn.predictions)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>auc_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6211981</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"KNN ROC Curves with LOOCV"</span>)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(roc_obj<span class="sc">@</span>x.values))</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>y_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(roc_obj<span class="sc">@</span>y.values))</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> x_values, <span class="at">y =</span> y_values, </span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">rgb</span>(<span class="fl">0.3803922</span>, <span class="fl">0.6862745</span>, <span class="fl">0.9372549</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fu">paste</span>(<span class="st">"AUC ="</span>, <span class="fu">round</span>(auc_val, <span class="dv">4</span>)), <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>knn.looCV.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>knn_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">k =</span> knn_model<span class="sc">$</span>results<span class="sc">$</span>k, </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Accuracy =</span> knn_model<span class="sc">$</span>results<span class="sc">$</span>Accuracy,</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Kappa =</span> knn_model<span class="sc">$</span>results<span class="sc">$</span>Kappa)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>knn.looCV.plot <span class="ot">&lt;-</span> <span class="fu">accu.kappa.plot</span>(knn_df) <span class="sc">+</span> </span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">label =</span> <span class="fu">round</span>(Kappa, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"KNN Model Performance (LOOCV)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="tuned-2" class="level5">
<h5 class="anchored" data-anchor-id="tuned-2">Tuned</h5>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_looCV_mod.Rdata"</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_model, <span class="at">newdata =</span> test)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(knn.predictions, test<span class="sc">$</span>good)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 936 208
         1  25  19
                                          
               Accuracy : 0.8039          
                 95% CI : (0.7801, 0.8261)
    No Information Rate : 0.8089          
    P-Value [Acc &gt; NIR] : 0.6863          
                                          
                  Kappa : 0.0833          
                                          
 Mcnemar's Test P-Value : &lt;2e-16          
                                          
            Sensitivity : 0.9740          
            Specificity : 0.0837          
         Pos Pred Value : 0.8182          
         Neg Pred Value : 0.4318          
             Prevalence : 0.8089          
         Detection Rate : 0.7879          
   Detection Prevalence : 0.9630          
      Balanced Accuracy : 0.5288          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(knn.predictions)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>auc_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5288429</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Knn ROC Curves Tuned LOOCV"</span>)</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(roc_obj<span class="sc">@</span>x.values))</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>y_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(roc_obj<span class="sc">@</span>y.values))</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> x_values, <span class="at">y =</span> y_values, </span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">rgb</span>(<span class="fl">0.3803922</span>, <span class="fl">0.6862745</span>, <span class="fl">0.9372549</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fu">paste</span>(<span class="st">"AUC ="</span>, <span class="fu">round</span>(auc_val, <span class="dv">4</span>)), <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>knn.looCV_mod.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>knn_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">k =</span> knn_model<span class="sc">$</span>results<span class="sc">$</span>k, </span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Accuracy =</span> knn_model<span class="sc">$</span>results<span class="sc">$</span>Accuracy,</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Kappa =</span> knn_model<span class="sc">$</span>results<span class="sc">$</span>Kappa)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>knn.looCV_mod.plot <span class="ot">&lt;-</span> <span class="fu">accu.kappa.plot</span>(knn_df) <span class="sc">+</span> </span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">3</span>)), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">angle=</span><span class="dv">90</span>) <span class="sc">+</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">label =</span> <span class="fu">round</span>(Kappa, <span class="dv">3</span>)), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">angle=</span><span class="dv">90</span>) <span class="sc">+</span></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"KNN Model Performance (Tuned LOOCV)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="repeated-cv" class="level4">
<h4 class="anchored" data-anchor-id="repeated-cv">Repeated CV</h4>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_repeatedCV.Rdata"</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_model, <span class="at">newdata =</span> test)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(knn.predictions, test<span class="sc">$</span>good)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 917  83
         1  44 144
                                          
               Accuracy : 0.8931          
                 95% CI : (0.8741, 0.9101)
    No Information Rate : 0.8089          
    P-Value [Acc &gt; NIR] : 1.966e-15       
                                          
                  Kappa : 0.6299          
                                          
 Mcnemar's Test P-Value : 0.0007464       
                                          
            Sensitivity : 0.9542          
            Specificity : 0.6344          
         Pos Pred Value : 0.9170          
         Neg Pred Value : 0.7660          
             Prevalence : 0.8089          
         Detection Rate : 0.7719          
   Detection Prevalence : 0.8418          
      Balanced Accuracy : 0.7943          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(knn.predictions)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>auc_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7942878</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"KNN ROC Curves with Repeated CV"</span>)</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(roc_obj<span class="sc">@</span>x.values))</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>y_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(roc_obj<span class="sc">@</span>y.values))</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> x_values, <span class="at">y =</span> y_values, </span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">rgb</span>(<span class="fl">0.3803922</span>, <span class="fl">0.6862745</span>, <span class="fl">0.9372549</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fu">paste</span>(<span class="st">"AUC ="</span>, <span class="fu">round</span>(auc_val, <span class="dv">4</span>)), <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>knn.repeatedCV.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> knn_model<span class="sc">$</span>results</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>knn.repeatedCV.plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>df, <span class="fu">aes</span>(<span class="at">x =</span> kmax, <span class="at">y =</span> Accuracy)) <span class="sc">+</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Accuracy"</span>)) <span class="sc">+</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Kappa"</span>)) <span class="sc">+</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> <span class="st">"Accuracy"</span>, <span class="at">color =</span> <span class="st">"Accuracy"</span>)) <span class="sc">+</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Kappa, <span class="at">linetype =</span> <span class="st">"Kappa"</span>, <span class="at">color =</span> <span class="st">"Kappa"</span>)) <span class="sc">+</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> Kappa, <span class="at">label =</span> <span class="fu">round</span>(Kappa, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#98c379"</span>, <span class="st">"#e06c75"</span>),</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>)) )) <span class="sc">+</span></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"solid"</span>, <span class="st">"dotted"</span>),</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>                        <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="fu">c</span>(<span class="st">"#98c379"</span>, <span class="st">"#e06c75"</span>)))) <span class="sc">+</span></span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"K value"</span>, </span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Accuracy / Kappa"</span>,</span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"KNN Model Performance (Repeated CV)"</span>) <span class="sc">+</span></span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Metric"</span>),</span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">linetype =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Metric"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="tuned-3" class="level5">
<h5 class="anchored" data-anchor-id="tuned-3">Tuned</h5>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_repeatedCV_mod.Rdata"</span>)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_model, <span class="at">newdata =</span> test)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(knn.predictions, test<span class="sc">$</span>good)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 921 103
         1  40 124
                                          
               Accuracy : 0.8796          
                 95% CI : (0.8598, 0.8976)
    No Information Rate : 0.8089          
    P-Value [Acc &gt; NIR] : 3.875e-11       
                                          
                  Kappa : 0.5645          
                                          
 Mcnemar's Test P-Value : 2.164e-07       
                                          
            Sensitivity : 0.9584          
            Specificity : 0.5463          
         Pos Pred Value : 0.8994          
         Neg Pred Value : 0.7561          
             Prevalence : 0.8089          
         Detection Rate : 0.7753          
   Detection Prevalence : 0.8620          
      Balanced Accuracy : 0.7523          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(knn.predictions)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>auc_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7523161</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"KNN ROC Curves with Tuned Repeated CV"</span>)</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(roc_obj<span class="sc">@</span>x.values))</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>y_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(roc_obj<span class="sc">@</span>y.values))</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> x_values, <span class="at">y =</span> y_values, </span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">rgb</span>(<span class="fl">0.3803922</span>, <span class="fl">0.6862745</span>, <span class="fl">0.9372549</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fu">paste</span>(<span class="st">"AUC ="</span>, <span class="fu">round</span>(auc_val, <span class="dv">4</span>)), <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>knn.repeatedCV_mod.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>knn.repeatedCV_mod.plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(knn_model) <span class="sc">+</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"K value"</span>, </span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Accuracy"</span>, </span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"KNN Model Performance (Tuned Repeated CV)"</span>) <span class="sc">+</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="summary" class="level4">
<h4 class="anchored" data-anchor-id="summary">Summary</h4>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(knn.kfoldCV.plot,</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>          knn.kfoldCV_mod.plot,</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>          knn.holdoutCV.plot,</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>          knn.holdoutCV_mod.plot,</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>          knn.looCV.plot,</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>          knn.looCV_mod.plot,</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>          knn.repeatedCV.plot,</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>          knn.repeatedCV_mod.plot,</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Sang_files/figure-html/knn.Accuracy.Kappa.Plot-1.png" class="img-fluid figure-img" width="1440"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(knn.kfoldCV.ROC.plot, knn.kfoldCV_mod.ROC.plot,</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">align =</span> <span class="st">"hv"</span>, <span class="at">scale =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Sang_files/figure-html/knn.ROC_curve-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(knn.holdoutCV.ROC.plot, knn.holdoutCV_mod.ROC.plot,</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">align =</span> <span class="st">"hv"</span>, <span class="at">scale =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Sang_files/figure-html/knn.ROC_curve-2.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(knn.looCV.ROC.plot, knn.looCV_mod.ROC.plot,</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">align =</span> <span class="st">"hv"</span>, <span class="at">scale =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Sang_files/figure-html/knn.ROC_curve-3.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(knn.repeatedCV.ROC.plot, knn.repeatedCV_mod.ROC.plot,</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">align =</span> <span class="st">"hv"</span>, <span class="at">scale =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Sang_files/figure-html/knn.ROC_curve-4.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<table class="table">
<colgroup>
<col style="width: 32%">
<col style="width: 16%">
<col style="width: 18%">
<col style="width: 18%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th>Resampling Method</th>
<th>Error Rate</th>
<th>Sensitivity</th>
<th>Specificity</th>
<th>AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>K-Fold CV</td>
<td>0.1692</td>
<td>0.9615</td>
<td>0.2775</td>
<td>0.6195157</td>
</tr>
<tr class="even">
<td>K-Fold CV (Tuned)</td>
<td>0.1953</td>
<td>0.9750</td>
<td>0.0837</td>
<td>0.5293632</td>
</tr>
<tr class="odd">
<td>Hold-out CV</td>
<td>0.1768</td>
<td>0.9563</td>
<td>0.2599</td>
<td>0.6081037</td>
</tr>
<tr class="even">
<td>Hold-out CV (Tuned)</td>
<td>0.1944</td>
<td>0.9886</td>
<td>0.0308</td>
<td>0.5096953</td>
</tr>
<tr class="odd">
<td>LOOCV</td>
<td>0.1692</td>
<td>0.9605</td>
<td>0.2819</td>
<td>0.6211981</td>
</tr>
<tr class="even">
<td>LOOCV (Tuned)</td>
<td>0.1961</td>
<td>0.9740</td>
<td>0.0837</td>
<td>0.5288429</td>
</tr>
<tr class="odd">
<td>Repeated CV</td>
<td>0.1069</td>
<td>0.9542</td>
<td>0.6344</td>
<td>0.7942878</td>
</tr>
<tr class="even">
<td>Repeated CV (Tuned)</td>
<td>0.1204</td>
<td>0.9584</td>
<td>0.5463</td>
<td>0.7523161</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="logistic-regression" class="level3">
<h3 class="anchored" data-anchor-id="logistic-regression">Logistic Regression</h3>
<section id="k-fold-cv-caret" class="level4">
<h4 class="anchored" data-anchor-id="k-fold-cv-caret">K-fold CV (<code>caret</code>)</h4>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co">#---------------------------#</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="co">#----Model Construction-----#</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="co">#---------------------------#</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the training control object for 10-fold cross-validation</span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">10</span>)</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the logistic regression model using 10-fold cross-validation</span></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>logit_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> train, </span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">method =</span> <span class="st">"glm"</span>, </span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">family =</span> <span class="st">"binomial"</span>,</span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">trControl =</span> train_control)</span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(logit_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">logit.model_kfoldCV.Rdata"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">logit.model_kfoldCV.Rdata"</span>)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>logit.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(logit_model, <span class="at">newdata =</span> test)</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(logit.predictions, test<span class="sc">$</span>good)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 896 148
         1  65  79
                                          
               Accuracy : 0.8207          
                 95% CI : (0.7977, 0.8421)
    No Information Rate : 0.8089          
    P-Value [Acc &gt; NIR] : 0.1596          
                                          
                  Kappa : 0.3259          
                                          
 Mcnemar's Test P-Value : 1.926e-08       
                                          
            Sensitivity : 0.9324          
            Specificity : 0.3480          
         Pos Pred Value : 0.8582          
         Neg Pred Value : 0.5486          
             Prevalence : 0.8089          
         Detection Rate : 0.7542          
   Detection Prevalence : 0.8788          
      Balanced Accuracy : 0.6402          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>logit.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(logit.predictions)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(logit.predictions, test<span class="sc">$</span>good)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the RMSE and MAE</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>RMSE <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">RMSE</span>(<span class="fu">as.numeric</span>(<span class="fu">unlist</span>(pred_obj<span class="sc">@</span>predictions)), <span class="fu">as.numeric</span>(test<span class="sc">$</span>good))</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>MAE <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">MAE</span>(<span class="fu">as.numeric</span>(<span class="fu">unlist</span>(pred_obj<span class="sc">@</span>predictions)), <span class="fu">as.numeric</span>(test<span class="sc">$</span>good))</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute AUC value</span></span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>auc_val  <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>auc_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6401899</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>log.perf <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(log.perf, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"caret::glm ROC Curves"</span>)</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(log.perf<span class="sc">@</span>x.values))</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>y_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(log.perf<span class="sc">@</span>y.values))</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> x_values, <span class="at">y =</span> y_values, </span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">rgb</span>(<span class="fl">0.3803922</span>, <span class="fl">0.6862745</span>, <span class="fl">0.9372549</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fu">paste</span>(<span class="st">"AUC ="</span>, <span class="fu">round</span>(auc_val, <span class="dv">4</span>)), <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>logit.kfoldCV.ROC_caret.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(<span class="fu">data.frame</span>(<span class="st">"Error Rate"</span> <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> logit_model<span class="sc">$</span>results<span class="sc">$</span>Accuracy, </span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"RMSE"</span> <span class="ot">=</span> RMSE, </span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"MAE"</span> <span class="ot">=</span> MAE,</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Kappa"</span> <span class="ot">=</span> logit_model<span class="sc">$</span>results<span class="sc">$</span>Kappa), </span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">caption =</span> <span class="st">"caret::glm Performance (10-fold CV)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>caret::glm Performance (10-fold CV)</caption>
<colgroup>
<col style="width: 18%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Error.Rate</th>
<th style="text-align: center;">RMSE</th>
<th style="text-align: center;">MAE</th>
<th style="text-align: center;">Kappa</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0.1893</td>
<td style="text-align: center;">0.4234</td>
<td style="text-align: center;">0.1793</td>
<td style="text-align: center;">0.3351</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="k-fold-cv-tuned-caret" class="level4">
<h4 class="anchored" data-anchor-id="k-fold-cv-tuned-caret">K-fold CV Tuned (<code>caret</code>)</h4>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>glm.model <span class="ot">&lt;-</span> <span class="fu">glm</span>(good <span class="sc">~</span> ., <span class="at">data=</span> train,<span class="at">family=</span><span class="st">"binomial"</span>)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>glm.fit<span class="ot">=</span> <span class="fu">stepAIC</span>(glm.model, <span class="at">direction =</span> <span class="st">'backward'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=2263
good ~ fixed.acidity + volatile.acidity + citric.acid + residual.sugar + 
    chlorides + free.sulfur.dioxide + total.sulfur.dioxide + 
    density + pH + sulphates + alcohol

                       Df Deviance    AIC
- citric.acid           1   2240.1 2262.1
&lt;none&gt;                      2239.0 2263.0
- alcohol               1   2241.3 2263.3
- total.sulfur.dioxide  1   2243.0 2265.0
- chlorides             1   2252.2 2274.2
- volatile.acidity      1   2254.3 2276.3
- sulphates             1   2256.6 2278.6
- free.sulfur.dioxide   1   2258.1 2280.1
- fixed.acidity         1   2258.6 2280.6
- density               1   2263.2 2285.2
- residual.sugar        1   2266.6 2288.6
- pH                    1   2295.8 2317.8

Step:  AIC=2262.05
good ~ fixed.acidity + volatile.acidity + residual.sugar + chlorides + 
    free.sulfur.dioxide + total.sulfur.dioxide + density + pH + 
    sulphates + alcohol

                       Df Deviance    AIC
&lt;none&gt;                      2240.1 2262.1
- alcohol               1   2242.7 2262.7
- total.sulfur.dioxide  1   2243.7 2263.7
- chlorides             1   2252.8 2272.8
- sulphates             1   2257.9 2277.9
- volatile.acidity      1   2258.4 2278.4
- free.sulfur.dioxide   1   2258.8 2278.8
- fixed.acidity         1   2261.2 2281.2
- density               1   2263.7 2283.7
- residual.sugar        1   2267.2 2287.2
- pH                    1   2296.2 2316.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on test data and construct a confusion matrix</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>logit.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(glm.fit, <span class="at">newdata =</span> test,<span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>logit.predictions <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(logit.predictions <span class="sc">&gt;</span> <span class="fl">0.7</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(logit.predictions, test<span class="sc">$</span>good)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 954 207
         1   7  20
                                          
               Accuracy : 0.8199          
                 95% CI : (0.7968, 0.8413)
    No Information Rate : 0.8089          
    P-Value [Acc &gt; NIR] : 0.1784          
                                          
                  Kappa : 0.1218          
                                          
 Mcnemar's Test P-Value : &lt;2e-16          
                                          
            Sensitivity : 0.99272         
            Specificity : 0.08811         
         Pos Pred Value : 0.82171         
         Neg Pred Value : 0.74074         
             Prevalence : 0.80892         
         Detection Rate : 0.80303         
   Detection Prevalence : 0.97727         
      Balanced Accuracy : 0.54041         
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>Accuracy <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(logit.predictions, test<span class="sc">$</span>good)<span class="sc">$</span>overall[[<span class="dv">1</span>]]</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>Kappa <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(logit.predictions, test<span class="sc">$</span>good)<span class="sc">$</span>overall[[<span class="dv">2</span>]] </span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>logit.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(logit.predictions)</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(logit.predictions, test<span class="sc">$</span>good)</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the RMSE and MAE</span></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>RMSE <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">RMSE</span>(<span class="fu">as.numeric</span>(<span class="fu">unlist</span>(pred_obj<span class="sc">@</span>predictions)), <span class="fu">as.numeric</span>(test<span class="sc">$</span>good))</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>MAE <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">MAE</span>(<span class="fu">as.numeric</span>(<span class="fu">unlist</span>(pred_obj<span class="sc">@</span>predictions)), <span class="fu">as.numeric</span>(test<span class="sc">$</span>good))</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute AUC value</span></span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>auc_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5404108</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>log.perf <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(log.perf, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"caret::glm ROC Curves with stepAIC"</span>)</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(log.perf<span class="sc">@</span>x.values))</span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>y_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(log.perf<span class="sc">@</span>y.values))</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> x_values, <span class="at">y =</span> y_values, </span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">rgb</span>(<span class="fl">0.3803922</span>, <span class="fl">0.6862745</span>, <span class="fl">0.9372549</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fu">paste</span>(<span class="st">"AUC ="</span>, <span class="fu">round</span>(auc_val, <span class="dv">4</span>)), <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>logit.kfoldCV_caret_tuned.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(<span class="fu">data.frame</span>(<span class="st">"Error Rate"</span> <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> Accuracy,</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"RMSE"</span> <span class="ot">=</span> RMSE, </span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"MAE"</span> <span class="ot">=</span> MAE,</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Kappa"</span> <span class="ot">=</span> Kappa),</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">caption =</span> <span class="st">"caret::glm Performance (10-fold CV with stepAIC)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>caret::glm Performance (10-fold CV with stepAIC)</caption>
<colgroup>
<col style="width: 18%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Error.Rate</th>
<th style="text-align: center;">RMSE</th>
<th style="text-align: center;">MAE</th>
<th style="text-align: center;">Kappa</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0.1801</td>
<td style="text-align: center;">0.4244</td>
<td style="text-align: center;">0.1801</td>
<td style="text-align: center;">0.1218</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="k-fold-cv-mass" class="level4">
<h4 class="anchored" data-anchor-id="k-fold-cv-mass">K-fold CV (<code>MASS</code>)</h4>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the number of folds</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Randomly assign each row in the data to a fold</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>) <span class="co"># for reproducibility</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>fold_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>k, <span class="at">length.out =</span> <span class="fu">nrow</span>(wine.data_subset)))</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize an empty list to store the folds</span></span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"list"</span>, k)</span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign each row to a fold</span></span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a>  folds[[i]] <span class="ot">&lt;-</span> <span class="fu">which</span>(fold_indices <span class="sc">==</span> i)</span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a><span class="co">#To store the error rate of each fold</span></span>
<span id="cb93-17"><a href="#cb93-17" aria-hidden="true" tabindex="-1"></a>error_rate <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb93-18"><a href="#cb93-18" aria-hidden="true" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb93-19"><a href="#cb93-19" aria-hidden="true" tabindex="-1"></a>mae <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb93-20"><a href="#cb93-20" aria-hidden="true" tabindex="-1"></a>kappa <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb93-21"><a href="#cb93-21" aria-hidden="true" tabindex="-1"></a>confusion_matrices <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"list"</span>, k)</span>
<span id="cb93-22"><a href="#cb93-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-23"><a href="#cb93-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each fold</span></span>
<span id="cb93-24"><a href="#cb93-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb93-25"><a href="#cb93-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the i-th fold as the testing set</span></span>
<span id="cb93-26"><a href="#cb93-26" aria-hidden="true" tabindex="-1"></a>  test_indices <span class="ot">&lt;-</span> <span class="fu">unlist</span>(folds[[i]])</span>
<span id="cb93-27"><a href="#cb93-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb93-28"><a href="#cb93-28" aria-hidden="true" tabindex="-1"></a>  test <span class="ot">&lt;-</span> wine.data_subset[test_indices, ]</span>
<span id="cb93-29"><a href="#cb93-29" aria-hidden="true" tabindex="-1"></a>  train <span class="ot">&lt;-</span> wine.data_subset[<span class="sc">-</span>test_indices, ]</span>
<span id="cb93-30"><a href="#cb93-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb93-31"><a href="#cb93-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fit the model on the training set</span></span>
<span id="cb93-32"><a href="#cb93-32" aria-hidden="true" tabindex="-1"></a>  logit_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(good <span class="sc">~</span> ., <span class="at">data =</span> train, <span class="at">family =</span> binomial)</span>
<span id="cb93-33"><a href="#cb93-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb93-34"><a href="#cb93-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make predictions on the testing set and calculate the error rate</span></span>
<span id="cb93-35"><a href="#cb93-35" aria-hidden="true" tabindex="-1"></a>  log.pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(logit_model, <span class="at">newdata =</span> test, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb93-36"><a href="#cb93-36" aria-hidden="true" tabindex="-1"></a>  predicted_classes <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">ifelse</span>(log.pred <span class="sc">&gt;</span> <span class="fl">0.7</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb93-37"><a href="#cb93-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb93-38"><a href="#cb93-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute RMSE</span></span>
<span id="cb93-39"><a href="#cb93-39" aria-hidden="true" tabindex="-1"></a>  rmse[i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((predicted_classes <span class="sc">-</span> test<span class="sc">$</span>good) <span class="sc">^</span> <span class="dv">2</span>))</span>
<span id="cb93-40"><a href="#cb93-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb93-41"><a href="#cb93-41" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute MAE</span></span>
<span id="cb93-42"><a href="#cb93-42" aria-hidden="true" tabindex="-1"></a>  mae[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(predicted_classes <span class="sc">-</span> test<span class="sc">$</span>good))</span>
<span id="cb93-43"><a href="#cb93-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb93-44"><a href="#cb93-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute MAE</span></span>
<span id="cb93-45"><a href="#cb93-45" aria-hidden="true" tabindex="-1"></a>  error_rate[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>((predicted_classes<span class="sc">&gt;</span> <span class="fl">0.7</span>) <span class="sc">!=</span> test<span class="sc">$</span>good)</span>
<span id="cb93-46"><a href="#cb93-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb93-47"><a href="#cb93-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute confusion matrix</span></span>
<span id="cb93-48"><a href="#cb93-48" aria-hidden="true" tabindex="-1"></a>  test<span class="sc">$</span>good <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(test<span class="sc">$</span>good)</span>
<span id="cb93-49"><a href="#cb93-49" aria-hidden="true" tabindex="-1"></a>  predicted_classes <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(log.pred <span class="sc">&gt;</span> <span class="fl">0.7</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb93-50"><a href="#cb93-50" aria-hidden="true" tabindex="-1"></a>  confusion_matrices[[i]] <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">confusionMatrix</span>(predicted_classes, test<span class="sc">$</span>good)</span>
<span id="cb93-51"><a href="#cb93-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb93-52"><a href="#cb93-52" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute Kappa value</span></span>
<span id="cb93-53"><a href="#cb93-53" aria-hidden="true" tabindex="-1"></a>  kappa[i] <span class="ot">&lt;-</span> confusion_matrices[[i]]<span class="sc">$</span>overall[[<span class="dv">2</span>]]</span>
<span id="cb93-54"><a href="#cb93-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb93-55"><a href="#cb93-55" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Print the error rates for each fold</span></span>
<span id="cb93-56"><a href="#cb93-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"Fold "</span>, i, <span class="st">": "</span>, <span class="st">"OER:"</span>, error_rate[i], <span class="st">" RMSE:"</span>, rmse[i], <span class="st">" MAE:"</span>, mae[i], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb93-57"><a href="#cb93-57" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Fold 1: OER:0.198992443324937 RMSE:0.446085690562853 MAE:0.198992443324937
Fold 2: OER:0.181818181818182 RMSE:0.426401432711221 MAE:0.181818181818182
Fold 3: OER:0.20959595959596 RMSE:0.457816513022367 MAE:0.20959595959596
Fold 4: OER:0.247474747474747 RMSE:0.497468338163091 MAE:0.247474747474747
Fold 5: OER:0.174242424242424 RMSE:0.417423554968361 MAE:0.174242424242424
Fold 6: OER:0.22979797979798 RMSE:0.479372485441102 MAE:0.22979797979798
Fold 7: OER:0.184343434343434 RMSE:0.429352342888023 MAE:0.184343434343434
Fold 8: OER:0.196969696969697 RMSE:0.443812682299297 MAE:0.196969696969697
Fold 9: OER:0.161616161616162 RMSE:0.402015126103685 MAE:0.161616161616162
Fold 10: OER:0.179292929292929 RMSE:0.423429957954004 MAE:0.179292929292929</code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>best_confmat_index <span class="ot">&lt;-</span> <span class="fu">which.min</span>(error_rate)</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>best_confmat_index</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>best_confmat_indexi <span class="ot">&lt;-</span> <span class="fu">which.min</span>(rmse)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>best_confmat_index</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>best_confmat_index <span class="ot">&lt;-</span> <span class="fu">which.min</span>(mae)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>best_confmat_index</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>confusion_matrices[best_confmat_index]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 326  64
         1   0   6
                                          
               Accuracy : 0.8384          
                 95% CI : (0.7984, 0.8733)
    No Information Rate : 0.8232          
    P-Value [Acc &gt; NIR] : 0.2365          
                                          
                  Kappa : 0.1337          
                                          
 Mcnemar's Test P-Value : 3.407e-15       
                                          
            Sensitivity : 1.00000         
            Specificity : 0.08571         
         Pos Pred Value : 0.83590         
         Neg Pred Value : 1.00000         
             Prevalence : 0.82323         
         Detection Rate : 0.82323         
   Detection Prevalence : 0.98485         
      Balanced Accuracy : 0.54286         
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co">#AUC and Performance Plot</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>predicted_classes <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(predicted_classes)</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(predicted_classes, test<span class="sc">$</span>good)</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>auc_val  <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>log.perf <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj,<span class="st">"tpr"</span>,<span class="st">"fpr"</span>)</span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>auc_val  <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>auc_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5438871</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(log.perf, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"MASS::glm ROC Curves"</span>)</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(log.perf<span class="sc">@</span>x.values))</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>y_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(log.perf<span class="sc">@</span>y.values))</span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> x_values, <span class="at">y =</span> y_values, </span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">rgb</span>(<span class="fl">0.3803922</span>, <span class="fl">0.6862745</span>, <span class="fl">0.9372549</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fu">paste</span>(<span class="st">"AUC ="</span>, <span class="fu">round</span>(auc_val, <span class="dv">4</span>)), <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>logit.kfoldCV_MASS.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>logit_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">k =</span> <span class="dv">1</span><span class="sc">:</span>k,</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Accuracy =</span> <span class="dv">1</span><span class="sc">-</span>error_rate, </span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Kappa =</span> kappa)</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>logit.kfoldCV_MASS.plot <span class="ot">&lt;-</span> <span class="fu">accu.kappa.plot</span>(logit_df) <span class="sc">+</span> </span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">label =</span> <span class="fu">round</span>(Kappa, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"MASS::glm Model Performance (10-Fold CV)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="hold-out-cv-mass" class="level4">
<h4 class="anchored" data-anchor-id="hold-out-cv-mass">Hold-out CV (<code>MASS</code>)</h4>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the seed for reproducibility</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportion of data to use for training</span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>train_prop <span class="ot">&lt;-</span> <span class="fl">0.7</span></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the data into training and testing sets</span></span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>train_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">seq_len</span>(<span class="fu">nrow</span>(wine.data_subset)), <span class="at">size =</span> <span class="fu">round</span>(train_prop <span class="sc">*</span> <span class="fu">nrow</span>(wine.data_subset)), <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> wine.data_subset[train_indices, ]</span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> wine.data_subset[<span class="sc">-</span>train_indices, ]</span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model on the training set</span></span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a>logit_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(good <span class="sc">~</span> ., <span class="at">data =</span> train, <span class="at">family =</span> binomial)</span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the testing set and calculate the error rate</span></span>
<span id="cb107-16"><a href="#cb107-16" aria-hidden="true" tabindex="-1"></a>log.pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(logit_model, <span class="at">newdata =</span> test, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb107-17"><a href="#cb107-17" aria-hidden="true" tabindex="-1"></a>predicted_classes <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">ifelse</span>(log.pred <span class="sc">&gt;</span> <span class="fl">0.7</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb107-18"><a href="#cb107-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-19"><a href="#cb107-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute RMSE</span></span>
<span id="cb107-20"><a href="#cb107-20" aria-hidden="true" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((predicted_classes <span class="sc">-</span> test<span class="sc">$</span>good) <span class="sc">^</span> <span class="dv">2</span>))</span>
<span id="cb107-21"><a href="#cb107-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-22"><a href="#cb107-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute MAE</span></span>
<span id="cb107-23"><a href="#cb107-23" aria-hidden="true" tabindex="-1"></a>mae <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(predicted_classes <span class="sc">-</span> test<span class="sc">$</span>good))</span>
<span id="cb107-24"><a href="#cb107-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-25"><a href="#cb107-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute error rate</span></span>
<span id="cb107-26"><a href="#cb107-26" aria-hidden="true" tabindex="-1"></a>error_rate <span class="ot">&lt;-</span> <span class="fu">mean</span>((predicted_classes <span class="sc">&gt;</span> <span class="fl">0.7</span>) <span class="sc">!=</span> test<span class="sc">$</span>good)</span>
<span id="cb107-27"><a href="#cb107-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-28"><a href="#cb107-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the accuracy of the predictions on the testing set</span></span>
<span id="cb107-29"><a href="#cb107-29" aria-hidden="true" tabindex="-1"></a>train<span class="sc">$</span>good <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(train<span class="sc">$</span>good)</span>
<span id="cb107-30"><a href="#cb107-30" aria-hidden="true" tabindex="-1"></a>test<span class="sc">$</span>good <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(test<span class="sc">$</span>good)</span>
<span id="cb107-31"><a href="#cb107-31" aria-hidden="true" tabindex="-1"></a>predicted_classes <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(log.pred <span class="sc">&gt;</span> <span class="fl">0.7</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb107-32"><a href="#cb107-32" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(predicted_classes, test<span class="sc">$</span>good)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 938 214
         1  11  25
                                          
               Accuracy : 0.8106          
                 95% CI : (0.7871, 0.8325)
    No Information Rate : 0.7988          
    P-Value [Acc &gt; NIR] : 0.1643          
                                          
                  Kappa : 0.1363          
                                          
 Mcnemar's Test P-Value : &lt;2e-16          
                                          
            Sensitivity : 0.9884          
            Specificity : 0.1046          
         Pos Pred Value : 0.8142          
         Neg Pred Value : 0.6944          
             Prevalence : 0.7988          
         Detection Rate : 0.7896          
   Detection Prevalence : 0.9697          
      Balanced Accuracy : 0.5465          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>kappa <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(predicted_classes, test<span class="sc">$</span>good)<span class="sc">$</span>overall[[<span class="dv">2</span>]]</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="co">#AUC and Performance Plot</span></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>predicted_classes <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(predicted_classes)</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(predicted_classes, test<span class="sc">$</span>good)</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>log.perf <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj,<span class="st">"tpr"</span>,<span class="st">"fpr"</span>)</span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>auc_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5465057</code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(log.perf, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"MASS::glm ROC Curves with Hold-out CV"</span>)</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(log.perf<span class="sc">@</span>x.values))</span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>y_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(log.perf<span class="sc">@</span>y.values))</span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> x_values, <span class="at">y =</span> y_values, </span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">rgb</span>(<span class="fl">0.3803922</span>, <span class="fl">0.6862745</span>, <span class="fl">0.9372549</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fu">paste</span>(<span class="st">"AUC ="</span>, <span class="fu">round</span>(auc_val, <span class="dv">4</span>)), <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Sang_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>logit.holdoutCV_MASS.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(<span class="fu">data.frame</span>(<span class="st">"Error Rate"</span> <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> error_rate, </span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"RMSE"</span> <span class="ot">=</span> rmse, </span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"MAE"</span> <span class="ot">=</span> mae,</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Kappa"</span> <span class="ot">=</span> kappa))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 18%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Error.Rate</th>
<th style="text-align: center;">RMSE</th>
<th style="text-align: center;">MAE</th>
<th style="text-align: center;">Kappa</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0.8106</td>
<td style="text-align: center;">0.4352</td>
<td style="text-align: center;">0.1894</td>
<td style="text-align: center;">0.1363</td>
</tr>
</tbody>
</table>
</div>
</div>
<table class="table">
<colgroup>
<col style="width: 53%">
<col style="width: 11%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th>Resampling Method</th>
<th>Error Rate</th>
<th>Sensitivity</th>
<th>Specificity</th>
<th>AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Logistic Regression (<code>caret</code>)</td>
<td>0.1793</td>
<td>0.9324</td>
<td>0.3480</td>
<td>0.6401899</td>
</tr>
<tr class="even">
<td>Logistic Regression (<code>caret</code> tuned with stepAIC)</td>
<td>0.1801</td>
<td>0.99272</td>
<td>0.0881</td>
<td>0.5404108</td>
</tr>
<tr class="odd">
<td>Logistic Regression (<code>MASS</code> K-fold CV)</td>
<td>0.1616</td>
<td>1.00000</td>
<td>0.0857</td>
<td>0.5438871</td>
</tr>
<tr class="even">
<td>Logistic Regression (<code>MASS</code> Hold-out CV)</td>
<td>0.1894</td>
<td>0.9884</td>
<td>0.1046</td>
<td>0.5465057</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="linear-discriminant-analysis" class="level3">
<h3 class="anchored" data-anchor-id="linear-discriminant-analysis">Linear Discriminant Analysis</h3>
<section id="k-fold-cvcaret" class="level4">
<h4 class="anchored" data-anchor-id="k-fold-cvcaret">K-fold CV(<code>caret</code>)</h4>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co">#---------------------------#</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="co">#----Model Construction-----#</span></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a><span class="co">#---------------------------#</span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">10</span>)</span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a>lda_model <span class="ot">&lt;-</span> <span class="fu">train</span>(<span class="fu">as.factor</span>(good) <span class="sc">~</span> ., </span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train, </span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"lda"</span>, </span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">trControl =</span> train_control)</span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(lda_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">lda.model_kfoldCV.Rdata"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">lda.model_kfoldCV.Rdata"</span>)</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>lda.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(lda_model, <span class="at">newdata =</span> test)</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(lda.predictions, test<span class="sc">$</span>good)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 881 160
         1  68  79
                                          
               Accuracy : 0.8081          
                 95% CI : (0.7845, 0.8301)
    No Information Rate : 0.7988          
    P-Value [Acc &gt; NIR] : 0.2246          
                                          
                  Kappa : 0.3024          
                                          
 Mcnemar's Test P-Value : 1.674e-09       
                                          
            Sensitivity : 0.9283          
            Specificity : 0.3305          
         Pos Pred Value : 0.8463          
         Neg Pred Value : 0.5374          
             Prevalence : 0.7988          
         Detection Rate : 0.7416          
   Detection Prevalence : 0.8763          
      Balanced Accuracy : 0.6294          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>lda.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(lda.predictions)</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(lda.predictions, test<span class="sc">$</span>good)</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the RMSE and MAE</span></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>RMSE <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">RMSE</span>(<span class="fu">as.numeric</span>(<span class="fu">unlist</span>(pred_obj<span class="sc">@</span>predictions)), <span class="fu">as.numeric</span>(test<span class="sc">$</span>good))</span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>MAE <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">MAE</span>(<span class="fu">as.numeric</span>(<span class="fu">unlist</span>(pred_obj<span class="sc">@</span>predictions)), <span class="fu">as.numeric</span>(test<span class="sc">$</span>good))</span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute AUC value</span></span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a>auc_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6294448</code></pre>
</div>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>lda.perf <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lda.perf, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"caret::qda ROC Curves"</span>)</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(lda.perf<span class="sc">@</span>x.values))</span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a>y_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(lda.perf<span class="sc">@</span>y.values))</span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> x_values, <span class="at">y =</span> y_values, </span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">rgb</span>(<span class="fl">0.3803922</span>, <span class="fl">0.6862745</span>, <span class="fl">0.9372549</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fu">paste</span>(<span class="st">"AUC ="</span>, <span class="fu">round</span>(auc_val, <span class="dv">4</span>)), <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>lda.kfoldCV_caret.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(<span class="fu">data.frame</span>(<span class="st">"Error Rate"</span> <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> lda_model<span class="sc">$</span>results<span class="sc">$</span>Accuracy, </span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"RMSE"</span> <span class="ot">=</span> RMSE, </span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"MAE"</span> <span class="ot">=</span> MAE,</span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Kappa"</span> <span class="ot">=</span> lda_model<span class="sc">$</span>results<span class="sc">$</span>Kappa), </span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">caption =</span> <span class="st">"caret::lda Performance (10-fold CV)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>caret::lda Performance (10-fold CV)</caption>
<colgroup>
<col style="width: 18%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Error.Rate</th>
<th style="text-align: center;">RMSE</th>
<th style="text-align: center;">MAE</th>
<th style="text-align: center;">Kappa</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0.1915</td>
<td style="text-align: center;">0.4381</td>
<td style="text-align: center;">0.1919</td>
<td style="text-align: center;">0.3345</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="k-fold-cv-mass-1" class="level4">
<h4 class="anchored" data-anchor-id="k-fold-cv-mass-1">K-fold CV (<code>MASS</code>)</h4>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the number of folds</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Randomly assign each row in the data to a fold</span></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>) <span class="co"># for reproducibility</span></span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>fold_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>k, <span class="at">length.out =</span> <span class="fu">nrow</span>(wine.data_subset)))</span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize an empty list to store the folds</span></span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"list"</span>, k)</span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-11"><a href="#cb120-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign each row to a fold</span></span>
<span id="cb120-12"><a href="#cb120-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb120-13"><a href="#cb120-13" aria-hidden="true" tabindex="-1"></a>  folds[[i]] <span class="ot">&lt;-</span> <span class="fu">which</span>(fold_indices <span class="sc">==</span> i)</span>
<span id="cb120-14"><a href="#cb120-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb120-15"><a href="#cb120-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-16"><a href="#cb120-16" aria-hidden="true" tabindex="-1"></a><span class="co">#To store the error rate of each fold</span></span>
<span id="cb120-17"><a href="#cb120-17" aria-hidden="true" tabindex="-1"></a>error_rate <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb120-18"><a href="#cb120-18" aria-hidden="true" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb120-19"><a href="#cb120-19" aria-hidden="true" tabindex="-1"></a>mae <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb120-20"><a href="#cb120-20" aria-hidden="true" tabindex="-1"></a>kappa <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb120-21"><a href="#cb120-21" aria-hidden="true" tabindex="-1"></a>confusion_matrices <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"list"</span>, k)</span>
<span id="cb120-22"><a href="#cb120-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-23"><a href="#cb120-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each fold</span></span>
<span id="cb120-24"><a href="#cb120-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb120-25"><a href="#cb120-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the i-th fold as the testing set</span></span>
<span id="cb120-26"><a href="#cb120-26" aria-hidden="true" tabindex="-1"></a>  test_indices <span class="ot">&lt;-</span> <span class="fu">unlist</span>(folds[[i]])</span>
<span id="cb120-27"><a href="#cb120-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb120-28"><a href="#cb120-28" aria-hidden="true" tabindex="-1"></a>  test <span class="ot">&lt;-</span> wine.data_subset[test_indices, ]</span>
<span id="cb120-29"><a href="#cb120-29" aria-hidden="true" tabindex="-1"></a>  train <span class="ot">&lt;-</span> wine.data_subset[<span class="sc">-</span>test_indices, ]</span>
<span id="cb120-30"><a href="#cb120-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb120-31"><a href="#cb120-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fit the model on the training set</span></span>
<span id="cb120-32"><a href="#cb120-32" aria-hidden="true" tabindex="-1"></a>  lda_model <span class="ot">&lt;-</span> <span class="fu">lda</span>(good <span class="sc">~</span> ., <span class="at">data =</span> train, <span class="at">family =</span> binomial)</span>
<span id="cb120-33"><a href="#cb120-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb120-34"><a href="#cb120-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make predictions on the testing set and calculate the error rate</span></span>
<span id="cb120-35"><a href="#cb120-35" aria-hidden="true" tabindex="-1"></a>  lda.pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(lda_model, <span class="at">newdata =</span> test, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb120-36"><a href="#cb120-36" aria-hidden="true" tabindex="-1"></a>  predicted_classes <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(lda.pred<span class="sc">$</span>posterior[, <span class="dv">2</span>] <span class="sc">&gt;</span> <span class="fl">0.7</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb120-37"><a href="#cb120-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb120-38"><a href="#cb120-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute RMSE</span></span>
<span id="cb120-39"><a href="#cb120-39" aria-hidden="true" tabindex="-1"></a>  rmse[i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((predicted_classes <span class="sc">-</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>good)) <span class="sc">^</span> <span class="dv">2</span>))</span>
<span id="cb120-40"><a href="#cb120-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb120-41"><a href="#cb120-41" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute MAE</span></span>
<span id="cb120-42"><a href="#cb120-42" aria-hidden="true" tabindex="-1"></a>  mae[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(predicted_classes <span class="sc">-</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>good)))</span>
<span id="cb120-43"><a href="#cb120-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb120-44"><a href="#cb120-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute OER</span></span>
<span id="cb120-45"><a href="#cb120-45" aria-hidden="true" tabindex="-1"></a>  error_rate[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>((predicted_classes <span class="sc">&gt;</span> <span class="fl">0.7</span>) <span class="sc">!=</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>good))</span>
<span id="cb120-46"><a href="#cb120-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb120-47"><a href="#cb120-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute confusion matrix</span></span>
<span id="cb120-48"><a href="#cb120-48" aria-hidden="true" tabindex="-1"></a>  test<span class="sc">$</span>good <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(test<span class="sc">$</span>good)</span>
<span id="cb120-49"><a href="#cb120-49" aria-hidden="true" tabindex="-1"></a>  predicted_classes <span class="ot">&lt;-</span> <span class="fu">factor</span>(predicted_classes, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb120-50"><a href="#cb120-50" aria-hidden="true" tabindex="-1"></a>  confusion_matrices[[i]] <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">confusionMatrix</span>(predicted_classes, test<span class="sc">$</span>good)</span>
<span id="cb120-51"><a href="#cb120-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb120-52"><a href="#cb120-52" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute Kappa value</span></span>
<span id="cb120-53"><a href="#cb120-53" aria-hidden="true" tabindex="-1"></a>  kappa[i] <span class="ot">&lt;-</span> confusion_matrices[[i]]<span class="sc">$</span>overall[[<span class="dv">2</span>]]</span>
<span id="cb120-54"><a href="#cb120-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb120-55"><a href="#cb120-55" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Print the error rates for each fold</span></span>
<span id="cb120-56"><a href="#cb120-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"Fold "</span>, i, <span class="st">": "</span>, <span class="st">"OER:"</span>, error_rate[i], <span class="st">" RMSE:"</span>, rmse[i], <span class="st">" MAE:"</span>, mae[i], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb120-57"><a href="#cb120-57" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Fold 1: OER:0.193954659949622 RMSE:0.440402838262451 MAE:0.193954659949622
Fold 2: OER:0.174242424242424 RMSE:0.417423554968361 MAE:0.174242424242424
Fold 3: OER:0.202020202020202 RMSE:0.449466574975495 MAE:0.202020202020202
Fold 4: OER:0.23989898989899 RMSE:0.489794844704382 MAE:0.23989898989899
Fold 5: OER:0.176767676767677 RMSE:0.420437482591261 MAE:0.176767676767677
Fold 6: OER:0.222222222222222 RMSE:0.471404520791032 MAE:0.222222222222222
Fold 7: OER:0.184343434343434 RMSE:0.429352342888023 MAE:0.184343434343434
Fold 8: OER:0.194444444444444 RMSE:0.440958551844098 MAE:0.194444444444444
Fold 9: OER:0.159090909090909 RMSE:0.398862017608733 MAE:0.159090909090909
Fold 10: OER:0.179292929292929 RMSE:0.423429957954004 MAE:0.179292929292929</code></pre>
</div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>best_confmat_index <span class="ot">&lt;-</span> <span class="fu">which.min</span>(error_rate)</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>best_confmat_index</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>best_confmat_indexi <span class="ot">&lt;-</span> <span class="fu">which.min</span>(rmse)</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>best_confmat_index</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>best_confmat_index <span class="ot">&lt;-</span> <span class="fu">which.min</span>(mae)</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>best_confmat_index</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>confusion_matrices[best_confmat_index]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 325  62
         1   1   8
                                          
               Accuracy : 0.8409          
                 95% CI : (0.8011, 0.8755)
    No Information Rate : 0.8232          
    P-Value [Acc &gt; NIR] : 0.197           
                                          
                  Kappa : 0.1691          
                                          
 Mcnemar's Test P-Value : 4.053e-14       
                                          
            Sensitivity : 0.9969          
            Specificity : 0.1143          
         Pos Pred Value : 0.8398          
         Neg Pred Value : 0.8889          
             Prevalence : 0.8232          
         Detection Rate : 0.8207          
   Detection Prevalence : 0.9773          
      Balanced Accuracy : 0.5556          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co">#AUC and Performance Plot</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>predicted_classes <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(predicted_classes)</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(predicted_classes, test<span class="sc">$</span>good)</span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>lda.perf <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj,<span class="st">"tpr"</span>,<span class="st">"fpr"</span>)</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a>auc_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5488133</code></pre>
</div>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lda.perf, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"MASS::lda ROC Curves"</span>)</span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(lda.perf<span class="sc">@</span>x.values))</span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a>y_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(lda.perf<span class="sc">@</span>y.values))</span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> x_values, <span class="at">y =</span> y_values, </span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">rgb</span>(<span class="fl">0.3803922</span>, <span class="fl">0.6862745</span>, <span class="fl">0.9372549</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb132-11"><a href="#cb132-11" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fu">paste</span>(<span class="st">"AUC ="</span>, <span class="fu">round</span>(auc_val, <span class="dv">4</span>)), <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>lda.kfoldCV_MASS.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>lda_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">k =</span> <span class="dv">1</span><span class="sc">:</span>k,</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Accuracy =</span> <span class="dv">1</span><span class="sc">-</span>error_rate, </span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Kappa =</span> kappa)</span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>lda.kfoldCV_MASS.plot <span class="ot">&lt;-</span> <span class="fu">accu.kappa.plot</span>(lda_df) <span class="sc">+</span> </span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">label =</span> <span class="fu">round</span>(Kappa, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"MASS::lda Model Performance (10-Fold CV)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<table class="table">
<colgroup>
<col style="width: 29%">
<col style="width: 17%">
<col style="width: 18%">
<col style="width: 18%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th>Resampling Method</th>
<th>Error Rate</th>
<th>Sensitivity</th>
<th>Specificity</th>
<th>AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>LDA (<code>caret</code>)</td>
<td>0.1919</td>
<td>0.9283</td>
<td>0.3305</td>
<td>0.6294448</td>
</tr>
<tr class="even">
<td>LDA (<code>MASS</code>)</td>
<td>0.1591</td>
<td>0.9969</td>
<td>0.1143</td>
<td>0.5488133</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="quadratic-discriminant-analysis" class="level3">
<h3 class="anchored" data-anchor-id="quadratic-discriminant-analysis">Quadratic discriminant analysis</h3>
<section id="k-fold-cv-caret-1" class="level4">
<h4 class="anchored" data-anchor-id="k-fold-cv-caret-1">K-fold CV (<code>caret</code>)</h4>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co">#---------------------------#</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="co">#----Model Construction-----#</span></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a><span class="co">#---------------------------#</span></span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">10</span>)</span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a>qda_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb134-9"><a href="#cb134-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train, </span>
<span id="cb134-10"><a href="#cb134-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"qda"</span>, </span>
<span id="cb134-11"><a href="#cb134-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">trControl =</span> train_control)</span>
<span id="cb134-12"><a href="#cb134-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-13"><a href="#cb134-13" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(qda_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">qda.model_kfoldCV.Rdata"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">qda.model_kfoldCV.Rdata"</span>)</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>qda.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(qda_model, <span class="at">newdata =</span> test)</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(qda.predictions, test<span class="sc">$</span>good)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 247  23
         1  72  54
                                          
               Accuracy : 0.7601          
                 95% CI : (0.7149, 0.8013)
    No Information Rate : 0.8056          
    P-Value [Acc &gt; NIR] : 0.9892          
                                          
                  Kappa : 0.3831          
                                          
 Mcnemar's Test P-Value : 8.449e-07       
                                          
            Sensitivity : 0.7743          
            Specificity : 0.7013          
         Pos Pred Value : 0.9148          
         Neg Pred Value : 0.4286          
             Prevalence : 0.8056          
         Detection Rate : 0.6237          
   Detection Prevalence : 0.6818          
      Balanced Accuracy : 0.7378          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>qda.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(qda.predictions)</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(qda.predictions, test<span class="sc">$</span>good)</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the RMSE and MAE</span></span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>RMSE <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">RMSE</span>(<span class="fu">as.numeric</span>(<span class="fu">unlist</span>(pred_obj<span class="sc">@</span>predictions)), <span class="fu">as.numeric</span>(test<span class="sc">$</span>good))</span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>MAE <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">MAE</span>(<span class="fu">as.numeric</span>(<span class="fu">unlist</span>(pred_obj<span class="sc">@</span>predictions)), <span class="fu">as.numeric</span>(test<span class="sc">$</span>good))</span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute AUC value</span></span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a>auc_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7377967</code></pre>
</div>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>qda.perf <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(qda.perf, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"caret::glm ROC Curves"</span>)</span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(qda.perf<span class="sc">@</span>x.values))</span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a>y_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(qda.perf<span class="sc">@</span>y.values))</span>
<span id="cb139-9"><a href="#cb139-9" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> x_values, <span class="at">y =</span> y_values, </span>
<span id="cb139-10"><a href="#cb139-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">rgb</span>(<span class="fl">0.3803922</span>, <span class="fl">0.6862745</span>, <span class="fl">0.9372549</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb139-11"><a href="#cb139-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb139-12"><a href="#cb139-12" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fu">paste</span>(<span class="st">"AUC ="</span>, <span class="fu">round</span>(auc_val, <span class="dv">4</span>)), <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>qda.kfoldCV_caret.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>qda_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">k =</span> <span class="dv">1</span><span class="sc">:</span>k,</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Accuracy =</span> qda_model<span class="sc">$</span>results<span class="sc">$</span>Accuracy,</span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Kappa =</span> qda_model<span class="sc">$</span>results<span class="sc">$</span>Kappa)</span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(<span class="fu">data.frame</span>(<span class="st">"Error Rate"</span> <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> qda_model<span class="sc">$</span>results<span class="sc">$</span>Accuracy, </span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"RMSE"</span> <span class="ot">=</span> RMSE, </span>
<span id="cb140-9"><a href="#cb140-9" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"MAE"</span> <span class="ot">=</span> MAE,</span>
<span id="cb140-10"><a href="#cb140-10" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Kappa"</span> <span class="ot">=</span> qda_model<span class="sc">$</span>results<span class="sc">$</span>Kappa), </span>
<span id="cb140-11"><a href="#cb140-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">caption =</span> <span class="st">"caret::qda Performance (10-fold CV)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>caret::qda Performance (10-fold CV)</caption>
<colgroup>
<col style="width: 18%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Error.Rate</th>
<th style="text-align: center;">RMSE</th>
<th style="text-align: center;">MAE</th>
<th style="text-align: center;">Kappa</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0.2579</td>
<td style="text-align: center;">0.4898</td>
<td style="text-align: center;">0.2399</td>
<td style="text-align: center;">0.3793</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="k-fold-cv-mass-2" class="level4">
<h4 class="anchored" data-anchor-id="k-fold-cv-mass-2">K-fold CV (<code>MASS</code>)</h4>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the number of folds</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Randomly assign each row in the data to a fold</span></span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>) <span class="co"># for reproducibility</span></span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a>fold_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>k, <span class="at">length.out =</span> <span class="fu">nrow</span>(wine.data_subset)))</span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize an empty list to store the folds</span></span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"list"</span>, k)</span>
<span id="cb141-10"><a href="#cb141-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-11"><a href="#cb141-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign each row to a fold</span></span>
<span id="cb141-12"><a href="#cb141-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb141-13"><a href="#cb141-13" aria-hidden="true" tabindex="-1"></a>  folds[[i]] <span class="ot">&lt;-</span> <span class="fu">which</span>(fold_indices <span class="sc">==</span> i)</span>
<span id="cb141-14"><a href="#cb141-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb141-15"><a href="#cb141-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-16"><a href="#cb141-16" aria-hidden="true" tabindex="-1"></a><span class="co">#To store the error rate of each fold</span></span>
<span id="cb141-17"><a href="#cb141-17" aria-hidden="true" tabindex="-1"></a>error_rate <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb141-18"><a href="#cb141-18" aria-hidden="true" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb141-19"><a href="#cb141-19" aria-hidden="true" tabindex="-1"></a>mae <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb141-20"><a href="#cb141-20" aria-hidden="true" tabindex="-1"></a>confusion_matrices <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"list"</span>, k)</span>
<span id="cb141-21"><a href="#cb141-21" aria-hidden="true" tabindex="-1"></a>kappa <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb141-22"><a href="#cb141-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-23"><a href="#cb141-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-24"><a href="#cb141-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each fold</span></span>
<span id="cb141-25"><a href="#cb141-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb141-26"><a href="#cb141-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the i-th fold as the testing set</span></span>
<span id="cb141-27"><a href="#cb141-27" aria-hidden="true" tabindex="-1"></a>  test_indices <span class="ot">&lt;-</span> <span class="fu">unlist</span>(folds[[i]])</span>
<span id="cb141-28"><a href="#cb141-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb141-29"><a href="#cb141-29" aria-hidden="true" tabindex="-1"></a>  test <span class="ot">&lt;-</span> wine.data_subset[test_indices, ]</span>
<span id="cb141-30"><a href="#cb141-30" aria-hidden="true" tabindex="-1"></a>  train <span class="ot">&lt;-</span> wine.data_subset[<span class="sc">-</span>test_indices, ]</span>
<span id="cb141-31"><a href="#cb141-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb141-32"><a href="#cb141-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fit the model on the training set</span></span>
<span id="cb141-33"><a href="#cb141-33" aria-hidden="true" tabindex="-1"></a>  qda_model <span class="ot">&lt;-</span> <span class="fu">qda</span>(good <span class="sc">~</span> ., <span class="at">data =</span> train, <span class="at">family =</span> binomial)</span>
<span id="cb141-34"><a href="#cb141-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb141-35"><a href="#cb141-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make predictions on the testing set and calculate the error rate</span></span>
<span id="cb141-36"><a href="#cb141-36" aria-hidden="true" tabindex="-1"></a>  qda.pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(qda_model, <span class="at">newdata =</span> test, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb141-37"><a href="#cb141-37" aria-hidden="true" tabindex="-1"></a>  predicted_classes <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(qda.pred<span class="sc">$</span>posterior[,<span class="dv">2</span>] <span class="sc">&gt;</span> <span class="fl">0.7</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb141-38"><a href="#cb141-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb141-39"><a href="#cb141-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute RMSE</span></span>
<span id="cb141-40"><a href="#cb141-40" aria-hidden="true" tabindex="-1"></a>  rmse[i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((predicted_classes <span class="sc">-</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>good)) <span class="sc">^</span> <span class="dv">2</span>))</span>
<span id="cb141-41"><a href="#cb141-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb141-42"><a href="#cb141-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute MAE</span></span>
<span id="cb141-43"><a href="#cb141-43" aria-hidden="true" tabindex="-1"></a>  mae[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(predicted_classes <span class="sc">-</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>good)))</span>
<span id="cb141-44"><a href="#cb141-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb141-45"><a href="#cb141-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute OER</span></span>
<span id="cb141-46"><a href="#cb141-46" aria-hidden="true" tabindex="-1"></a>  error_rate[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>((predicted_classes <span class="sc">&gt;</span> <span class="fl">0.7</span>) <span class="sc">!=</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>good))</span>
<span id="cb141-47"><a href="#cb141-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb141-48"><a href="#cb141-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute confusion matrix</span></span>
<span id="cb141-49"><a href="#cb141-49" aria-hidden="true" tabindex="-1"></a>  test<span class="sc">$</span>good <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(test<span class="sc">$</span>good)</span>
<span id="cb141-50"><a href="#cb141-50" aria-hidden="true" tabindex="-1"></a>  predicted_classes <span class="ot">&lt;-</span> <span class="fu">factor</span>(predicted_classes, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb141-51"><a href="#cb141-51" aria-hidden="true" tabindex="-1"></a>  confusion_matrices[[i]] <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">confusionMatrix</span>(predicted_classes, test<span class="sc">$</span>good)</span>
<span id="cb141-52"><a href="#cb141-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb141-53"><a href="#cb141-53" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute Kappa value</span></span>
<span id="cb141-54"><a href="#cb141-54" aria-hidden="true" tabindex="-1"></a>  kappa[i] <span class="ot">&lt;-</span> confusion_matrices[[i]]<span class="sc">$</span>overall[[<span class="dv">2</span>]]</span>
<span id="cb141-55"><a href="#cb141-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb141-56"><a href="#cb141-56" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Print the error rates for each fold</span></span>
<span id="cb141-57"><a href="#cb141-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"Fold "</span>, i, <span class="st">": "</span>, <span class="st">"OER:"</span>, error_rate[i], <span class="st">" RMSE:"</span>, rmse[i], <span class="st">" MAE:"</span>, mae[i], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb141-58"><a href="#cb141-58" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Fold 1: OER:0.19647355163728 RMSE:0.443253371828438 MAE:0.19647355163728
Fold 2: OER:0.171717171717172 RMSE:0.414387707005374 MAE:0.171717171717172
Fold 3: OER:0.232323232323232 RMSE:0.481999203654147 MAE:0.232323232323232
Fold 4: OER:0.212121212121212 RMSE:0.460566186471838 MAE:0.212121212121212
Fold 5: OER:0.20959595959596 RMSE:0.457816513022367 MAE:0.20959595959596
Fold 6: OER:0.222222222222222 RMSE:0.471404520791032 MAE:0.222222222222222
Fold 7: OER:0.194444444444444 RMSE:0.440958551844098 MAE:0.194444444444444
Fold 8: OER:0.207070707070707 RMSE:0.455050224778218 MAE:0.207070707070707
Fold 9: OER:0.174242424242424 RMSE:0.417423554968361 MAE:0.174242424242424
Fold 10: OER:0.169191919191919 RMSE:0.411329453348431 MAE:0.169191919191919</code></pre>
</div>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>best_confmat_index <span class="ot">&lt;-</span> <span class="fu">which.min</span>(error_rate)</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>best_confmat_index</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>best_confmat_indexi <span class="ot">&lt;-</span> <span class="fu">which.min</span>(rmse)</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>best_confmat_index</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>best_confmat_index <span class="ot">&lt;-</span> <span class="fu">which.min</span>(mae)</span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>best_confmat_index</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>confusion_matrices[best_confmat_index]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 285  33
         1  34  44
                                          
               Accuracy : 0.8308          
                 95% CI : (0.7902, 0.8664)
    No Information Rate : 0.8056          
    P-Value [Acc &gt; NIR] : 0.1126          
                                          
                  Kappa : 0.4626          
                                          
 Mcnemar's Test P-Value : 1.0000          
                                          
            Sensitivity : 0.8934          
            Specificity : 0.5714          
         Pos Pred Value : 0.8962          
         Neg Pred Value : 0.5641          
             Prevalence : 0.8056          
         Detection Rate : 0.7197          
   Detection Prevalence : 0.8030          
      Balanced Accuracy : 0.7324          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co">#AUC and Performance Plot</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>predicted_classes <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(predicted_classes)</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(predicted_classes, test<span class="sc">$</span>good)</span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>qda.perf <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj,<span class="st">"tpr"</span>,<span class="st">"fpr"</span>)</span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a>auc_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7324227</code></pre>
</div>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(qda.perf, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"MASS::qda ROC Curves"</span>)</span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(qda.perf<span class="sc">@</span>x.values))</span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a>y_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(qda.perf<span class="sc">@</span>y.values))</span>
<span id="cb153-8"><a href="#cb153-8" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> x_values, <span class="at">y =</span> y_values, </span>
<span id="cb153-9"><a href="#cb153-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">rgb</span>(<span class="fl">0.3803922</span>, <span class="fl">0.6862745</span>, <span class="fl">0.9372549</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb153-10"><a href="#cb153-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb153-11"><a href="#cb153-11" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fu">paste</span>(<span class="st">"AUC ="</span>, <span class="fu">round</span>(auc_val, <span class="dv">4</span>)), <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>qda.kfoldCV_MASS.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>qda_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">k =</span> <span class="dv">1</span><span class="sc">:</span>k,</span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Accuracy =</span> <span class="dv">1</span><span class="sc">-</span>error_rate, </span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Kappa =</span> kappa)</span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a>qda.kfoldCV_MASS.plot <span class="ot">&lt;-</span> <span class="fu">accu.kappa.plot</span>(qda_df) <span class="sc">+</span> </span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb154-9"><a href="#cb154-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">label =</span> <span class="fu">round</span>(Kappa, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb154-10"><a href="#cb154-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"MASS::qda Model Performance (10-Fold CV)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<table class="table">
<colgroup>
<col style="width: 29%">
<col style="width: 17%">
<col style="width: 18%">
<col style="width: 18%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th>Resampling Method</th>
<th>Error Rate</th>
<th>Sensitivity</th>
<th>Specificity</th>
<th>AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>QDA (<code>caret</code>)</td>
<td>0.2399</td>
<td>0.7743</td>
<td>0.7013</td>
<td>0.7377967</td>
</tr>
<tr class="even">
<td>QDA (<code>MASS</code>)</td>
<td>0.1692</td>
<td>0.8934</td>
<td>0.5714</td>
<td>0.7324227</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="summary-1" class="level3">
<h3 class="anchored" data-anchor-id="summary-1">Summary</h3>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(knn.kfoldCV.plot, </span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>          logit.kfoldCV_MASS.plot,</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>          lda.kfoldCV_MASS.plot,</span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>          qda.kfoldCV_MASS.plot,</span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Sang_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="1920"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(knn.kfoldCV.ROC.plot,</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>                   logit.kfoldCV_MASS.ROC.plot,</span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>                   lda.kfoldCV_MASS.ROC.plot,</span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a>                   qda.kfoldCV_MASS.ROC.plot, </span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">align =</span> <span class="st">"hv"</span>, <span class="at">scale =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Sang_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<table class="table">
<colgroup>
<col style="width: 53%">
<col style="width: 11%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th>Resampling Method</th>
<th>Error Rate</th>
<th>Sensitivity</th>
<th>Specificity</th>
<th>AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>K-Fold CV</td>
<td>0.1692</td>
<td>0.9615</td>
<td>0.2775</td>
<td>0.6195157</td>
</tr>
<tr class="even">
<td>K-Fold CV (Tuned)</td>
<td>0.1953</td>
<td>0.9750</td>
<td>0.0837</td>
<td>0.5293632</td>
</tr>
<tr class="odd">
<td>Hold-out CV</td>
<td>0.1768</td>
<td>0.9563</td>
<td>0.2599</td>
<td>0.6081037</td>
</tr>
<tr class="even">
<td>Hold-out CV (Tuned)</td>
<td>0.1944</td>
<td>0.9886</td>
<td>0.03084</td>
<td>0.5096953</td>
</tr>
<tr class="odd">
<td>LOOCV</td>
<td>0.1692</td>
<td>0.9605</td>
<td>0.2819</td>
<td>0.6211981</td>
</tr>
<tr class="even">
<td>LOOCV (Tuned)</td>
<td>0.1961</td>
<td>0.9740</td>
<td>0.0837</td>
<td>0.5288429</td>
</tr>
<tr class="odd">
<td>Repeated CV</td>
<td>0.1069</td>
<td>0.9542</td>
<td>0.6344</td>
<td>0.7942878</td>
</tr>
<tr class="even">
<td>Repeated CV (Tuned)</td>
<td>0.1204</td>
<td>0.9584</td>
<td>0.5463</td>
<td>0.7523161</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Logistic Regression (<code>caret</code>)</td>
<td>0.1793</td>
<td>0.9324</td>
<td>0.3480</td>
<td>0.6401899</td>
</tr>
<tr class="odd">
<td>Logistic Regression (<code>caret</code> tuned with stepAIC)</td>
<td>0.1801</td>
<td>0.99272</td>
<td>0.0881</td>
<td>0.5404108</td>
</tr>
<tr class="even">
<td>Logistic Regression (<code>MASS</code> K-fold CV)</td>
<td>0.1616</td>
<td>1.00000</td>
<td>0.0857</td>
<td>0.5438871</td>
</tr>
<tr class="odd">
<td>Logistic Regression (<code>MASS</code> Hold-out CV)</td>
<td>0.1894</td>
<td>0.9884</td>
<td>0.1046</td>
<td>0.5465057</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>LDA (<code>caret</code>)</td>
<td>0.1919</td>
<td>0.9283</td>
<td>0.3305</td>
<td>0.6294448</td>
</tr>
<tr class="even">
<td>LDA (<code>MASS</code>)</td>
<td>0.1591</td>
<td>0.9969</td>
<td>0.1143</td>
<td>0.5488133</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>QDA (<code>caret</code>)</td>
<td>0.2399</td>
<td>0.7743</td>
<td>0.7013</td>
<td>0.7377967</td>
</tr>
<tr class="odd">
<td>QDA (<code>MASS</code>)</td>
<td>0.1692</td>
<td>0.8934</td>
<td>0.5714</td>
<td>0.7324227</td>
</tr>
</tbody>
</table>
<!-- -->

</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb157" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Introduction to Statistical Learning"</span></span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "STAT 387" </span></span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a><span class="co">    df-print: paged</span></span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a><span class="co">    theme:</span></span>
<span id="cb157-8"><a href="#cb157-8" aria-hidden="true" tabindex="-1"></a><span class="co">      light: materia</span></span>
<span id="cb157-9"><a href="#cb157-9" aria-hidden="true" tabindex="-1"></a><span class="co">      dark: slate</span></span>
<span id="cb157-10"><a href="#cb157-10" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb157-11"><a href="#cb157-11" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-title: Table of Contents</span></span>
<span id="cb157-12"><a href="#cb157-12" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 4</span></span>
<span id="cb157-13"><a href="#cb157-13" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: right</span></span>
<span id="cb157-14"><a href="#cb157-14" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: false</span></span>
<span id="cb157-15"><a href="#cb157-15" aria-hidden="true" tabindex="-1"></a><span class="co">    number-depth: 3</span></span>
<span id="cb157-16"><a href="#cb157-16" aria-hidden="true" tabindex="-1"></a><span class="co">    anchor-sections: true</span></span>
<span id="cb157-17"><a href="#cb157-17" aria-hidden="true" tabindex="-1"></a><span class="co">    smooth-scroll: true</span></span>
<span id="cb157-18"><a href="#cb157-18" aria-hidden="true" tabindex="-1"></a><span class="co">    link-external-icon: false</span></span>
<span id="cb157-19"><a href="#cb157-19" aria-hidden="true" tabindex="-1"></a><span class="co">    link-external-newwindow: false</span></span>
<span id="cb157-20"><a href="#cb157-20" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: false</span></span>
<span id="cb157-21"><a href="#cb157-21" aria-hidden="true" tabindex="-1"></a><span class="co">    code-line-numbers: false</span></span>
<span id="cb157-22"><a href="#cb157-22" aria-hidden="true" tabindex="-1"></a><span class="co">    code-overflow: scroll</span></span>
<span id="cb157-23"><a href="#cb157-23" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: </span></span>
<span id="cb157-24"><a href="#cb157-24" aria-hidden="true" tabindex="-1"></a><span class="co">      source: true</span></span>
<span id="cb157-25"><a href="#cb157-25" aria-hidden="true" tabindex="-1"></a><span class="co">      toggle: true</span></span>
<span id="cb157-26"><a href="#cb157-26" aria-hidden="true" tabindex="-1"></a><span class="co">      caption: none</span></span>
<span id="cb157-27"><a href="#cb157-27" aria-hidden="true" tabindex="-1"></a><span class="co">    code-summary: "Show/Hide Code"</span></span>
<span id="cb157-28"><a href="#cb157-28" aria-hidden="true" tabindex="-1"></a><span class="co">    highlight-style: atom-one</span></span>
<span id="cb157-29"><a href="#cb157-29" aria-hidden="true" tabindex="-1"></a><span class="co">    link-external-filter: '^(?:http:|https:)\/\/www\.quarto\.org\/custom'</span></span>
<span id="cb157-30"><a href="#cb157-30" aria-hidden="true" tabindex="-1"></a><span class="co">    self-contained-math: true</span></span>
<span id="cb157-31"><a href="#cb157-31" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-align: center</span></span>
<span id="cb157-32"><a href="#cb157-32" aria-hidden="true" tabindex="-1"></a><span class="co">    html-math-method:</span></span>
<span id="cb157-33"><a href="#cb157-33" aria-hidden="true" tabindex="-1"></a><span class="co">      method: mathjax</span></span>
<span id="cb157-34"><a href="#cb157-34" aria-hidden="true" tabindex="-1"></a><span class="co">      url: "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"</span></span>
<span id="cb157-35"><a href="#cb157-35" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb157-36"><a href="#cb157-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-37"><a href="#cb157-37" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup, include=FALSE}</span></span>
<span id="cb157-38"><a href="#cb157-38" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">fig.align =</span> <span class="cn">TRUE</span>)</span>
<span id="cb157-39"><a href="#cb157-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-40"><a href="#cb157-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)  <span class="co"># Load core packages: </span></span>
<span id="cb157-41"><a href="#cb157-41" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot2,   for data visualization.</span></span>
<span id="cb157-42"><a href="#cb157-42" aria-hidden="true" tabindex="-1"></a><span class="co"># dplyr,     for data manipulation.</span></span>
<span id="cb157-43"><a href="#cb157-43" aria-hidden="true" tabindex="-1"></a><span class="co"># tidyr,     for data tidying.</span></span>
<span id="cb157-44"><a href="#cb157-44" aria-hidden="true" tabindex="-1"></a><span class="co"># purrr,     for functional programming.</span></span>
<span id="cb157-45"><a href="#cb157-45" aria-hidden="true" tabindex="-1"></a><span class="co"># tibble,    for tibbles, a modern re-imagining of data frames.</span></span>
<span id="cb157-46"><a href="#cb157-46" aria-hidden="true" tabindex="-1"></a><span class="co"># stringr,   for strings.</span></span>
<span id="cb157-47"><a href="#cb157-47" aria-hidden="true" tabindex="-1"></a><span class="co"># forcats,   for factors.</span></span>
<span id="cb157-48"><a href="#cb157-48" aria-hidden="true" tabindex="-1"></a><span class="co"># lubridate, for date/times.</span></span>
<span id="cb157-49"><a href="#cb157-49" aria-hidden="true" tabindex="-1"></a><span class="co"># readr,     for reading .csv, .tsv, and .fwf files.</span></span>
<span id="cb157-50"><a href="#cb157-50" aria-hidden="true" tabindex="-1"></a><span class="co"># readxl,    for reading .xls, and .xlxs files.</span></span>
<span id="cb157-51"><a href="#cb157-51" aria-hidden="true" tabindex="-1"></a><span class="co"># feather,   for sharing with Python and other languages.</span></span>
<span id="cb157-52"><a href="#cb157-52" aria-hidden="true" tabindex="-1"></a><span class="co"># haven,     for SPSS, SAS and Stata files.</span></span>
<span id="cb157-53"><a href="#cb157-53" aria-hidden="true" tabindex="-1"></a><span class="co"># httr,      for web apis.</span></span>
<span id="cb157-54"><a href="#cb157-54" aria-hidden="true" tabindex="-1"></a><span class="co"># jsonlite   for JSON.</span></span>
<span id="cb157-55"><a href="#cb157-55" aria-hidden="true" tabindex="-1"></a><span class="co"># rvest,     for web scraping.</span></span>
<span id="cb157-56"><a href="#cb157-56" aria-hidden="true" tabindex="-1"></a><span class="co"># xml2,      for XML.</span></span>
<span id="cb157-57"><a href="#cb157-57" aria-hidden="true" tabindex="-1"></a><span class="co"># modelr,    for modelling within a pipeline</span></span>
<span id="cb157-58"><a href="#cb157-58" aria-hidden="true" tabindex="-1"></a><span class="co"># broom,     for turning models into tidy data</span></span>
<span id="cb157-59"><a href="#cb157-59" aria-hidden="true" tabindex="-1"></a><span class="co"># hms,       for times.</span></span>
<span id="cb157-60"><a href="#cb157-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-61"><a href="#cb157-61" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)   <span class="co"># Pipeline operator</span></span>
<span id="cb157-62"><a href="#cb157-62" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lobstr)     <span class="co"># Visualizing abstract syntax trees, stack trees, and object sizes</span></span>
<span id="cb157-63"><a href="#cb157-63" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pander)     <span class="co"># Exporting/converting complex pandoc documents, EX: df to Pandoc table</span></span>
<span id="cb157-64"><a href="#cb157-64" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggforce)    <span class="co"># More plot functions on top of ggplot2</span></span>
<span id="cb157-65"><a href="#cb157-65" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)     <span class="co"># Automatically add p-values and significance levels  plots. </span></span>
<span id="cb157-66"><a href="#cb157-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrange and annotate multiple plots on the same page. </span></span>
<span id="cb157-67"><a href="#cb157-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Change graphical parameters such as colors and labels.</span></span>
<span id="cb157-68"><a href="#cb157-68" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)         <span class="co"># Geo-spatial vector manipulation: points, lines, polygons</span></span>
<span id="cb157-69"><a href="#cb157-69" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra) <span class="co"># Generate 90 % of complex/advanced/self-customized/beautiful tables</span></span>
<span id="cb157-70"><a href="#cb157-70" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)    <span class="co"># Multiple plots arrangement</span></span>
<span id="cb157-71"><a href="#cb157-71" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)  <span class="co"># Multiple plots arrangement</span></span>
<span id="cb157-72"><a href="#cb157-72" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(animation)  <span class="co"># Animated figure container</span></span>
<span id="cb157-73"><a href="#cb157-73" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(latex2exp)  <span class="co"># Latex axis titles in ggplot2</span></span>
<span id="cb157-74"><a href="#cb157-74" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ellipse)    <span class="co"># Simultaneous confidence interval region to check C.I. of 2 slope parameters</span></span>
<span id="cb157-75"><a href="#cb157-75" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)     <span class="co"># User interactive plots</span></span>
<span id="cb157-76"><a href="#cb157-76" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ellipse)    <span class="co"># Simultaneous confidence interval region to check C.I. of 2 regressors</span></span>
<span id="cb157-77"><a href="#cb157-77" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(olsrr)      <span class="co"># Model selections </span></span>
<span id="cb157-78"><a href="#cb157-78" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaps)      <span class="co"># Regression subsetting </span></span>
<span id="cb157-79"><a href="#cb157-79" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pls)        <span class="co"># Partial Least squares</span></span>
<span id="cb157-80"><a href="#cb157-80" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)       <span class="co"># LDA, QDA, OLS, Ridge Regression, Box-Cox, stepAIC, etc,.</span></span>
<span id="cb157-81"><a href="#cb157-81" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(e1071)      <span class="co"># Naive Bayesian Classfier,SVM, GKNN, ICA, LCA</span></span>
<span id="cb157-82"><a href="#cb157-82" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(class)      <span class="co"># KNN, SOM, LVQ</span></span>
<span id="cb157-83"><a href="#cb157-83" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ROCR)       <span class="co"># Precision/Recall/Sensitivity/Specificity performance plot </span></span>
<span id="cb157-84"><a href="#cb157-84" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)       <span class="co"># LOOCV, Bootstrap,</span></span>
<span id="cb157-85"><a href="#cb157-85" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)      <span class="co"># Classification/Regression Training, run ?caret::trainControl</span></span>
<span id="cb157-86"><a href="#cb157-86" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrgram)   <span class="co"># for correlation matrix</span></span>
<span id="cb157-87"><a href="#cb157-87" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)   <span class="co"># for graphical display of correlation matrix</span></span>
<span id="cb157-88"><a href="#cb157-88" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(class)      <span class="co"># LDA, QDA, KNN</span></span>
<span id="cb157-89"><a href="#cb157-89" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)        <span class="co"># make random results reproducible</span></span>
<span id="cb157-90"><a href="#cb157-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-91"><a href="#cb157-91" aria-hidden="true" tabindex="-1"></a>current_dir <span class="ot">&lt;-</span> <span class="fu">getwd</span>()</span>
<span id="cb157-92"><a href="#cb157-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-93"><a href="#cb157-93" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(current_dir)) {</span>
<span id="cb157-94"><a href="#cb157-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setwd</span>(current_dir)</span>
<span id="cb157-95"><a href="#cb157-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove</span>(current_dir)</span>
<span id="cb157-96"><a href="#cb157-96" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb157-97"><a href="#cb157-97" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-98"><a href="#cb157-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-99"><a href="#cb157-99" aria-hidden="true" tabindex="-1"></a><span class="in">```{css, echo=FALSE}</span></span>
<span id="cb157-100"><a href="#cb157-100" aria-hidden="true" tabindex="-1"></a>body <span class="op">{</span></span>
<span id="cb157-101"><a href="#cb157-101" aria-hidden="true" tabindex="-1"></a>font<span class="op">-</span>family<span class="op">:</span> <span class="st">"Times New Roman"</span><span class="op">;</span></span>
<span id="cb157-102"><a href="#cb157-102" aria-hidden="true" tabindex="-1"></a>font<span class="op">-</span>size<span class="op">:</span> <span class="fl">0.8</span>em<span class="op">;</span></span>
<span id="cb157-103"><a href="#cb157-103" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb157-104"><a href="#cb157-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-105"><a href="#cb157-105" aria-hidden="true" tabindex="-1"></a>h2<span class="op">,</span> <span class="op">.</span><span class="fu">h2</span><span class="op">,</span> h2<span class="op">.</span><span class="fu">anchored</span><span class="op">,</span> </span>
<span id="cb157-106"><a href="#cb157-106" aria-hidden="true" tabindex="-1"></a>h3<span class="op">,</span> <span class="op">.</span><span class="fu">h3</span><span class="op">,</span> h3<span class="op">.</span><span class="fu">anchored</span><span class="op">,</span></span>
<span id="cb157-107"><a href="#cb157-107" aria-hidden="true" tabindex="-1"></a><span class="op">.</span><span class="fu">quarto</span><span class="op">-</span>title<span class="op">,</span> </span>
<span id="cb157-108"><a href="#cb157-108" aria-hidden="true" tabindex="-1"></a><span class="op">.</span><span class="fu">quarto</span><span class="op">-</span>title<span class="op">-</span>meta <span class="op">{</span></span>
<span id="cb157-109"><a href="#cb157-109" aria-hidden="true" tabindex="-1"></a>text<span class="op">-</span>align<span class="op">:</span> center<span class="op">;</span></span>
<span id="cb157-110"><a href="#cb157-110" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb157-111"><a href="#cb157-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-112"><a href="#cb157-112" aria-hidden="true" tabindex="-1"></a>h2<span class="op">,</span> <span class="op">.</span><span class="fu">h2</span> <span class="op">{</span></span>
<span id="cb157-113"><a href="#cb157-113" aria-hidden="true" tabindex="-1"></a>font<span class="op">-</span>size<span class="op">:</span> <span class="fl">1.5</span>em<span class="op">;</span></span>
<span id="cb157-114"><a href="#cb157-114" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb157-115"><a href="#cb157-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-116"><a href="#cb157-116" aria-hidden="true" tabindex="-1"></a>h3<span class="op">,</span> <span class="op">.</span><span class="fu">h3</span> <span class="op">{</span></span>
<span id="cb157-117"><a href="#cb157-117" aria-hidden="true" tabindex="-1"></a>font<span class="op">-</span>size<span class="op">:</span> <span class="fl">1.25</span>em<span class="op">;</span></span>
<span id="cb157-118"><a href="#cb157-118" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb157-119"><a href="#cb157-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-120"><a href="#cb157-120" aria-hidden="true" tabindex="-1"></a>h4<span class="op">,</span> <span class="op">.</span><span class="fu">h4</span> <span class="op">{</span></span>
<span id="cb157-121"><a href="#cb157-121" aria-hidden="true" tabindex="-1"></a>font<span class="op">-</span>size<span class="op">:</span> 1em<span class="op">;</span></span>
<span id="cb157-122"><a href="#cb157-122" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb157-123"><a href="#cb157-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-124"><a href="#cb157-124" aria-hidden="true" tabindex="-1"></a>h5<span class="op">,</span> <span class="op">.</span><span class="fu">h5</span> <span class="op">{</span></span>
<span id="cb157-125"><a href="#cb157-125" aria-hidden="true" tabindex="-1"></a>font<span class="op">-</span>size<span class="op">:</span> <span class="fl">0.75</span>em<span class="op">;</span></span>
<span id="cb157-126"><a href="#cb157-126" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb157-127"><a href="#cb157-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-128"><a href="#cb157-128" aria-hidden="true" tabindex="-1"></a>h6<span class="op">,</span> <span class="op">.</span><span class="fu">h6</span> <span class="op">{</span></span>
<span id="cb157-129"><a href="#cb157-129" aria-hidden="true" tabindex="-1"></a>font<span class="op">-</span>size<span class="op">:</span> <span class="fl">0.7</span>em<span class="op">;</span></span>
<span id="cb157-130"><a href="#cb157-130" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb157-131"><a href="#cb157-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-132"><a href="#cb157-132" aria-hidden="true" tabindex="-1"></a><span class="op">.</span><span class="fu">quarto</span><span class="op">-</span>title<span class="op">-</span>meta <span class="op">{</span></span>
<span id="cb157-133"><a href="#cb157-133" aria-hidden="true" tabindex="-1"></a>display<span class="op">:</span> block<span class="op">!</span>important<span class="op">;</span></span>
<span id="cb157-134"><a href="#cb157-134" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb157-135"><a href="#cb157-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-136"><a href="#cb157-136" aria-hidden="true" tabindex="-1"></a><span class="op">.</span><span class="fu">quarto</span><span class="op">-</span>title<span class="op">-</span>meta<span class="op">-</span>heading <span class="op">{</span></span>
<span id="cb157-137"><a href="#cb157-137" aria-hidden="true" tabindex="-1"></a>display<span class="op">:</span> none<span class="op">;</span></span>
<span id="cb157-138"><a href="#cb157-138" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb157-139"><a href="#cb157-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-140"><a href="#cb157-140" aria-hidden="true" tabindex="-1"></a><span class="op">.</span><span class="fu">dropdown</span><span class="op">-</span>menu <span class="op">{</span></span>
<span id="cb157-141"><a href="#cb157-141" aria-hidden="true" tabindex="-1"></a>font<span class="op">-</span>size<span class="op">:</span> <span class="fl">0.8</span>rem<span class="op">;</span></span>
<span id="cb157-142"><a href="#cb157-142" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb157-143"><a href="#cb157-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-144"><a href="#cb157-144" aria-hidden="true" tabindex="-1"></a>code <span class="op">{</span></span>
<span id="cb157-145"><a href="#cb157-145" aria-hidden="true" tabindex="-1"></a>color<span class="op">:</span> #61AFEF<span class="op">;</span></span>
<span id="cb157-146"><a href="#cb157-146" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb157-147"><a href="#cb157-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-148"><a href="#cb157-148" aria-hidden="true" tabindex="-1"></a><span class="op">.</span><span class="fu">btn</span> <span class="op">{</span></span>
<span id="cb157-149"><a href="#cb157-149" aria-hidden="true" tabindex="-1"></a>border<span class="op">-</span>color<span class="op">:</span> #f8f9fa9e<span class="op">!</span>important<span class="op">;</span></span>
<span id="cb157-150"><a href="#cb157-150" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb157-151"><a href="#cb157-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-152"><a href="#cb157-152" aria-hidden="true" tabindex="-1"></a>body<span class="op">.</span><span class="fu">quarto</span><span class="op">-</span>dark <span class="op">{</span></span>
<span id="cb157-153"><a href="#cb157-153" aria-hidden="true" tabindex="-1"></a>background<span class="op">-</span>color<span class="op">:</span> #282c34<span class="op">;</span></span>
<span id="cb157-154"><a href="#cb157-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-155"><a href="#cb157-155" aria-hidden="true" tabindex="-1"></a>color<span class="op">:</span> #d8dee9<span class="op">;</span></span>
<span id="cb157-156"><a href="#cb157-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-157"><a href="#cb157-157" aria-hidden="true" tabindex="-1"></a><span class="op">.</span><span class="fu">pagedtable</span> <span class="op">.</span><span class="fu">even</span> <span class="op">{</span></span>
<span id="cb157-158"><a href="#cb157-158" aria-hidden="true" tabindex="-1"></a>background<span class="op">-</span>color<span class="op">:</span> #3b4252<span class="op">!</span>important<span class="op">;</span></span>
<span id="cb157-159"><a href="#cb157-159" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb157-160"><a href="#cb157-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-161"><a href="#cb157-161" aria-hidden="true" tabindex="-1"></a>p code<span class="op">:</span><span class="fu">not</span><span class="op">(.</span><span class="fu">sourceCode</span><span class="op">),</span> li code<span class="op">:</span><span class="fu">not</span><span class="op">(.</span><span class="fu">sourceCode</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb157-162"><a href="#cb157-162" aria-hidden="true" tabindex="-1"></a>background<span class="op">-</span>color<span class="op">:</span> #4c566a<span class="op">!</span>important<span class="op">;</span></span>
<span id="cb157-163"><a href="#cb157-163" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb157-164"><a href="#cb157-164" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb157-165"><a href="#cb157-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-166"><a href="#cb157-166" aria-hidden="true" tabindex="-1"></a>#quarto<span class="op">-</span>code<span class="op">-</span>tools<span class="op">-</span>menu<span class="op">{</span></span>
<span id="cb157-167"><a href="#cb157-167" aria-hidden="true" tabindex="-1"></a>position<span class="op">:</span> absolute<span class="op">;</span></span>
<span id="cb157-168"><a href="#cb157-168" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb157-169"><a href="#cb157-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-170"><a href="#cb157-170" aria-hidden="true" tabindex="-1"></a><span class="op">.</span><span class="fu">top</span><span class="op">-</span>right <span class="op">{</span></span>
<span id="cb157-171"><a href="#cb157-171" aria-hidden="true" tabindex="-1"></a>position<span class="op">:</span> <span class="kw">fixed</span><span class="op">;</span></span>
<span id="cb157-172"><a href="#cb157-172" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb157-173"><a href="#cb157-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-174"><a href="#cb157-174" aria-hidden="true" tabindex="-1"></a>#TOC<span class="op">::</span>before <span class="op">{</span></span>
<span id="cb157-175"><a href="#cb157-175" aria-hidden="true" tabindex="-1"></a>content<span class="op">:</span> <span class="st">""</span><span class="op">;</span></span>
<span id="cb157-176"><a href="#cb157-176" aria-hidden="true" tabindex="-1"></a>display<span class="op">:</span> block<span class="op">;</span></span>
<span id="cb157-177"><a href="#cb157-177" aria-hidden="true" tabindex="-1"></a>height<span class="op">:</span> 141px<span class="op">;</span></span>
<span id="cb157-178"><a href="#cb157-178" aria-hidden="true" tabindex="-1"></a>margin<span class="op">:</span> 20px 20px 20px 20px<span class="op">;</span></span>
<span id="cb157-179"><a href="#cb157-179" aria-hidden="true" tabindex="-1"></a>background<span class="op">-</span>image<span class="op">:</span> <span class="fu">url</span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/theRealLeif/STAT387/main/README.asset/Logo.svg"</span><span class="op">);</span></span>
<span id="cb157-180"><a href="#cb157-180" aria-hidden="true" tabindex="-1"></a>background<span class="op">-</span>size<span class="op">:</span> contain<span class="op">;</span></span>
<span id="cb157-181"><a href="#cb157-181" aria-hidden="true" tabindex="-1"></a>background<span class="op">-</span>position<span class="op">:</span> center center<span class="op">;</span></span>
<span id="cb157-182"><a href="#cb157-182" aria-hidden="true" tabindex="-1"></a>background<span class="op">-</span>repeat<span class="op">:</span> no<span class="op">-</span>repeat<span class="op">;</span></span>
<span id="cb157-183"><a href="#cb157-183" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb157-184"><a href="#cb157-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-185"><a href="#cb157-185" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-186"><a href="#cb157-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-187"><a href="#cb157-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-188"><a href="#cb157-188" aria-hidden="true" tabindex="-1"></a><span class="fu">## Preamble</span></span>
<span id="cb157-189"><a href="#cb157-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-190"><a href="#cb157-190" aria-hidden="true" tabindex="-1"></a>Consider the wine quality dataset from <span class="co">[</span><span class="ot">UCI Machine Learning Respository</span><span class="co">](https://archive.ics.uci.edu/ml/datasets/Wine+Quality)</span>. We will focus only on the data concerning white wines (and not red wines). Dichotomize the <span class="in">`quality`</span> variable as <span class="in">`good`</span>, which takes the value 1 if quality â‰¥ 7 and the value 0, otherwise. We will take <span class="in">`good`</span> as response and all the 11 physiochemical characteristics of the wines in the data as predictors.</span>
<span id="cb157-191"><a href="#cb157-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-192"><a href="#cb157-192" aria-hidden="true" tabindex="-1"></a><span class="fu">### Problem Statements</span></span>
<span id="cb157-193"><a href="#cb157-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-194"><a href="#cb157-194" aria-hidden="true" tabindex="-1"></a>Use 10-fold cross-validation for estimating the test error rates below and compute the estimates using <span class="in">`caret`</span> package with seed set to 1234 before each computation.</span>
<span id="cb157-195"><a href="#cb157-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-196"><a href="#cb157-196" aria-hidden="true" tabindex="-1"></a>(a) Fit a KNN with K chosen optimally using test error rate. Report error rate, sensitivity, specificity, and AUC for the optimal KNN based on the training data. Also, report its estimated test error rate.</span>
<span id="cb157-197"><a href="#cb157-197" aria-hidden="true" tabindex="-1"></a>(b) Repeat (a) using logistic regression.</span>
<span id="cb157-198"><a href="#cb157-198" aria-hidden="true" tabindex="-1"></a>(c) Repeat (a) using LDA.</span>
<span id="cb157-199"><a href="#cb157-199" aria-hidden="true" tabindex="-1"></a>(d) Repeat (a) using QDA.</span>
<span id="cb157-200"><a href="#cb157-200" aria-hidden="true" tabindex="-1"></a>(e) Compare the results in (a)-(d). Which classifier would you recommend? Justify your answer.</span>
<span id="cb157-201"><a href="#cb157-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-202"><a href="#cb157-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-203"><a href="#cb157-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-204"><a href="#cb157-204" aria-hidden="true" tabindex="-1"></a><span class="fu">### Methodologies</span></span>
<span id="cb157-205"><a href="#cb157-205" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>KNN</span>
<span id="cb157-206"><a href="#cb157-206" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>GLM/logit/glmnet</span>
<span id="cb157-207"><a href="#cb157-207" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>LDA</span>
<span id="cb157-208"><a href="#cb157-208" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>QDA</span>
<span id="cb157-209"><a href="#cb157-209" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Naive Bayes</span>
<span id="cb157-210"><a href="#cb157-210" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Decision Tree</span>
<span id="cb157-211"><a href="#cb157-211" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Classification and Regression Trees (CART)</span>
<span id="cb157-212"><a href="#cb157-212" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Random Forest (Classification)</span>
<span id="cb157-213"><a href="#cb157-213" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Bagging (Bootstrap Aggregation)</span>
<span id="cb157-214"><a href="#cb157-214" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Boosting (Gradient Boosting Machine (GBM))</span>
<span id="cb157-215"><a href="#cb157-215" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>eXtreme Gradient Boosting (XGBoost)</span>
<span id="cb157-216"><a href="#cb157-216" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Extremely Randomized Trees (ExtraTrees)</span>
<span id="cb157-217"><a href="#cb157-217" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>SVM</span>
<span id="cb157-218"><a href="#cb157-218" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Neural Networks (NNET)</span>
<span id="cb157-219"><a href="#cb157-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-220"><a href="#cb157-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-221"><a href="#cb157-221" aria-hidden="true" tabindex="-1"></a><span class="fu">### Data Description</span></span>
<span id="cb157-222"><a href="#cb157-222" aria-hidden="true" tabindex="-1"></a>This is a dataset of wine quality containing 4898 observations of 12 variables. The variables are:</span>
<span id="cb157-223"><a href="#cb157-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-224"><a href="#cb157-224" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`fixed.acidity`</span>: The amount of fixed acid in the wine ($g/dm^3$)</span>
<span id="cb157-225"><a href="#cb157-225" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`volatile.acidity`</span>: The amount of volatile acid in the wine ($g/dm^4$)</span>
<span id="cb157-226"><a href="#cb157-226" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`citric.acid`</span>: The amount of citric acid in the wine ($g/dm^3$)</span>
<span id="cb157-227"><a href="#cb157-227" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`residual.sugar`</span>: The amount of residual sugar in the wine ($g/dm^3$)</span>
<span id="cb157-228"><a href="#cb157-228" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`chlorides`</span>: The amount of salt in the wine ($g/dm^3$)</span>
<span id="cb157-229"><a href="#cb157-229" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`free.sulfur.dioxide`</span>: The amount of free sulfur dioxide in the wine ($mg/dm^3$)</span>
<span id="cb157-230"><a href="#cb157-230" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`total.sulfur.dioxide`</span>: The amount of total sulfur dioxide in the wine ($mg/dm^3$)</span>
<span id="cb157-231"><a href="#cb157-231" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`density`</span>: The density of the wine ($g/dm^3$)</span>
<span id="cb157-232"><a href="#cb157-232" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`pH`</span>: The $pH$ value of the wine</span>
<span id="cb157-233"><a href="#cb157-233" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`sulphates`</span>: The amount of sulphates in the wine ($g/dm^3$)</span>
<span id="cb157-234"><a href="#cb157-234" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`alcohol`</span>: The alcohol content of the wine ($\% vol$)</span>
<span id="cb157-235"><a href="#cb157-235" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`quality`</span>: The quality score of the wine (0-10)</span>
<span id="cb157-236"><a href="#cb157-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-237"><a href="#cb157-237" aria-hidden="true" tabindex="-1"></a>After removing the duplicate rows from our data set, we are left with 3961 observations of the above 11 variables minus <span class="in">`quality`</span> column variable, and introduced a new variable <span class="in">`good`</span> as our response:</span>
<span id="cb157-238"><a href="#cb157-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-239"><a href="#cb157-239" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`good`</span>: A binary variable indicating whether the wine is good (<span class="in">`quality`</span> $\geq$ 7) or not (<span class="in">`quality`</span> $&lt;$ 7).</span>
<span id="cb157-240"><a href="#cb157-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-241"><a href="#cb157-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-242"><a href="#cb157-242" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exploratory Analysis</span></span>
<span id="cb157-243"><a href="#cb157-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-244"><a href="#cb157-244" aria-hidden="true" tabindex="-1"></a><span class="fu">### Data Import</span></span>
<span id="cb157-245"><a href="#cb157-245" aria-hidden="true" tabindex="-1"></a><span class="in">```{r data_import}</span></span>
<span id="cb157-246"><a href="#cb157-246" aria-hidden="true" tabindex="-1"></a>wine.data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">winequality-white.csv"</span>, <span class="at">sep=</span><span class="st">";"</span>, <span class="at">header =</span> T)</span>
<span id="cb157-247"><a href="#cb157-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-248"><a href="#cb157-248" aria-hidden="true" tabindex="-1"></a>wine.data_subset <span class="ot">&lt;-</span>  wine.data <span class="sc">%&gt;%</span> </span>
<span id="cb157-249"><a href="#cb157-249" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">good =</span> <span class="fu">ifelse</span>(quality<span class="sc">&gt;=</span><span class="dv">7</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb157-250"><a href="#cb157-250" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb157-251"><a href="#cb157-251" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>, <span class="dv">13</span>))</span>
<span id="cb157-252"><a href="#cb157-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-253"><a href="#cb157-253" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(wine.data)</span>
<span id="cb157-254"><a href="#cb157-254" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(wine.data_subset)</span>
<span id="cb157-255"><a href="#cb157-255" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-256"><a href="#cb157-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-257"><a href="#cb157-257" aria-hidden="true" tabindex="-1"></a><span class="fu">### Data Analysis</span></span>
<span id="cb157-258"><a href="#cb157-258" aria-hidden="true" tabindex="-1"></a><span class="in">```{r basic_analysis}</span></span>
<span id="cb157-259"><a href="#cb157-259" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(wine.data)</span>
<span id="cb157-260"><a href="#cb157-260" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(wine.data_subset)</span>
<span id="cb157-261"><a href="#cb157-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-262"><a href="#cb157-262" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(wine.data)</span>
<span id="cb157-263"><a href="#cb157-263" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(wine.data_subset)</span>
<span id="cb157-264"><a href="#cb157-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-265"><a href="#cb157-265" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wine.data)</span>
<span id="cb157-266"><a href="#cb157-266" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wine.data_subset)</span>
<span id="cb157-267"><a href="#cb157-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-268"><a href="#cb157-268" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for NAs in dataset</span></span>
<span id="cb157-269"><a href="#cb157-269" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(wine.data))</span>
<span id="cb157-270"><a href="#cb157-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-271"><a href="#cb157-271" aria-hidden="true" tabindex="-1"></a><span class="co"># Counts at each combination of response's factor levels</span></span>
<span id="cb157-272"><a href="#cb157-272" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(wine.data<span class="sc">$</span>quality)</span>
<span id="cb157-273"><a href="#cb157-273" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-274"><a href="#cb157-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-275"><a href="#cb157-275" aria-hidden="true" tabindex="-1"></a><span class="fu">### Data Histograms</span></span>
<span id="cb157-276"><a href="#cb157-276" aria-hidden="true" tabindex="-1"></a><span class="in">```{r hist_plot, warning=FALSE}</span></span>
<span id="cb157-277"><a href="#cb157-277" aria-hidden="true" tabindex="-1"></a>wine.colnames <span class="ot">&lt;-</span> <span class="fu">colnames</span>(wine.data_subset[, <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>])</span>
<span id="cb157-278"><a href="#cb157-278" aria-hidden="true" tabindex="-1"></a>num_plots     <span class="ot">&lt;-</span> <span class="fu">length</span>(wine.colnames)</span>
<span id="cb157-279"><a href="#cb157-279" aria-hidden="true" tabindex="-1"></a>num_rows      <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(num_plots<span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb157-280"><a href="#cb157-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-281"><a href="#cb157-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-282"><a href="#cb157-282" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an empty list to store plots</span></span>
<span id="cb157-283"><a href="#cb157-283" aria-hidden="true" tabindex="-1"></a>grid_arr      <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb157-284"><a href="#cb157-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-285"><a href="#cb157-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-286"><a href="#cb157-286" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop over each column name in the wine.colnames vector</span></span>
<span id="cb157-287"><a href="#cb157-287" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_plots) {</span>
<span id="cb157-288"><a href="#cb157-288" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a ggplot object for the current column using aes</span></span>
<span id="cb157-289"><a href="#cb157-289" aria-hidden="true" tabindex="-1"></a>  plt <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> wine.data_subset, <span class="fu">aes_string</span>(<span class="at">x =</span> wine.colnames[i])) <span class="sc">+</span></span>
<span id="cb157-290"><a href="#cb157-290" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fu">diff</span>(<span class="fu">range</span>(wine.data_subset[[wine.colnames[i]]]))<span class="sc">/</span><span class="dv">30</span>, </span>
<span id="cb157-291"><a href="#cb157-291" aria-hidden="true" tabindex="-1"></a>                   <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"slategray3"</span>) <span class="sc">+</span></span>
<span id="cb157-292"><a href="#cb157-292" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> wine.colnames[i], <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb157-293"><a href="#cb157-293" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span>
<span id="cb157-294"><a href="#cb157-294" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-295"><a href="#cb157-295" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add the current plot to the grid_arr list</span></span>
<span id="cb157-296"><a href="#cb157-296" aria-hidden="true" tabindex="-1"></a>  grid_arr[[i]] <span class="ot">&lt;-</span> plt</span>
<span id="cb157-297"><a href="#cb157-297" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb157-298"><a href="#cb157-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-299"><a href="#cb157-299" aria-hidden="true" tabindex="-1"></a>grid_arr <span class="ot">&lt;-</span> <span class="fu">do.call</span>(gridExtra<span class="sc">::</span>grid.arrange, <span class="fu">c</span>(grid_arr, <span class="at">ncol =</span> <span class="dv">3</span>))</span>
<span id="cb157-300"><a href="#cb157-300" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-301"><a href="#cb157-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-302"><a href="#cb157-302" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb157-303"><a href="#cb157-303" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove unnecessary variables</span></span>
<span id="cb157-304"><a href="#cb157-304" aria-hidden="true" tabindex="-1"></a><span class="fu">remove</span>(grid_arr)</span>
<span id="cb157-305"><a href="#cb157-305" aria-hidden="true" tabindex="-1"></a><span class="fu">remove</span>(plt)</span>
<span id="cb157-306"><a href="#cb157-306" aria-hidden="true" tabindex="-1"></a><span class="fu">remove</span>(i)</span>
<span id="cb157-307"><a href="#cb157-307" aria-hidden="true" tabindex="-1"></a><span class="fu">remove</span>(num_plots)</span>
<span id="cb157-308"><a href="#cb157-308" aria-hidden="true" tabindex="-1"></a><span class="fu">remove</span>(num_rows)</span>
<span id="cb157-309"><a href="#cb157-309" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-310"><a href="#cb157-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-311"><a href="#cb157-311" aria-hidden="true" tabindex="-1"></a><span class="fu">### Data Relationships</span></span>
<span id="cb157-312"><a href="#cb157-312" aria-hidden="true" tabindex="-1"></a><span class="in">```{r relation_plot, fig.width=10, fig.height=5, message=FALSE}</span></span>
<span id="cb157-313"><a href="#cb157-313" aria-hidden="true" tabindex="-1"></a>reshape2<span class="sc">::</span><span class="fu">melt</span>(wine.data[, <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>], <span class="st">"quality"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb157-314"><a href="#cb157-314" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(value, quality, <span class="at">color =</span> variable)) <span class="sc">+</span>  </span>
<span id="cb157-315"><a href="#cb157-315" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb157-316"><a href="#cb157-316" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(value,quality, <span class="at">colour=</span>variable), <span class="at">method=</span>lm, <span class="at">se=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb157-317"><a href="#cb157-317" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(.<span class="sc">~</span>variable, <span class="at">scales =</span> <span class="st">"free"</span>)</span>
<span id="cb157-318"><a href="#cb157-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-319"><a href="#cb157-319" aria-hidden="true" tabindex="-1"></a><span class="co"># Collinearity between Attributes</span></span>
<span id="cb157-320"><a href="#cb157-320" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(wine.data_subset) <span class="sc">%&gt;%</span> </span>
<span id="cb157-321"><a href="#cb157-321" aria-hidden="true" tabindex="-1"></a>  corrplot<span class="sc">::</span><span class="fu">corrplot</span>(<span class="at">method =</span> <span class="st">'number'</span>,  <span class="at">type =</span> <span class="st">"lower"</span>, <span class="at">tl.col =</span> <span class="st">"steelblue"</span>, <span class="at">number.cex =</span> <span class="fl">0.5</span>)</span>
<span id="cb157-322"><a href="#cb157-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-323"><a href="#cb157-323" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove quality from dataset, use good as response </span></span>
<span id="cb157-324"><a href="#cb157-324" aria-hidden="true" tabindex="-1"></a>wine.data_subset<span class="sc">$</span>quality <span class="ot">&lt;-</span> <span class="cn">NULL</span> </span>
<span id="cb157-325"><a href="#cb157-325" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-326"><a href="#cb157-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-327"><a href="#cb157-327" aria-hidden="true" tabindex="-1"></a><span class="fu">### Data Split</span></span>
<span id="cb157-328"><a href="#cb157-328" aria-hidden="true" tabindex="-1"></a><span class="in">```{r data_split}</span></span>
<span id="cb157-329"><a href="#cb157-329" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb157-330"><a href="#cb157-330" aria-hidden="true" tabindex="-1"></a><span class="co"># Splitting the dataset into train and test (7/10th for train remaining for test)</span></span>
<span id="cb157-331"><a href="#cb157-331" aria-hidden="true" tabindex="-1"></a>inTrain <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">createDataPartition</span>(wine.data_subset<span class="sc">$</span>good, <span class="at">p =</span> <span class="dv">7</span><span class="sc">/</span><span class="dv">10</span>, <span class="at">list =</span> F)</span>
<span id="cb157-332"><a href="#cb157-332" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> wine.data_subset[inTrain,]</span>
<span id="cb157-333"><a href="#cb157-333" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> wine.data_subset[<span class="sc">-</span>inTrain,]</span>
<span id="cb157-334"><a href="#cb157-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-335"><a href="#cb157-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-336"><a href="#cb157-336" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the outcome variable to a factor with two levels</span></span>
<span id="cb157-337"><a href="#cb157-337" aria-hidden="true" tabindex="-1"></a>train<span class="sc">$</span>good <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(train<span class="sc">$</span>good)</span>
<span id="cb157-338"><a href="#cb157-338" aria-hidden="true" tabindex="-1"></a>test<span class="sc">$</span>good <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(test<span class="sc">$</span>good)</span>
<span id="cb157-339"><a href="#cb157-339" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-340"><a href="#cb157-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-341"><a href="#cb157-341" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data Modeling</span></span>
<span id="cb157-342"><a href="#cb157-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-343"><a href="#cb157-343" aria-hidden="true" tabindex="-1"></a><span class="fu">### K-Nearest Neightbor</span></span>
<span id="cb157-344"><a href="#cb157-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-345"><a href="#cb157-345" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Model Construction</span></span>
<span id="cb157-346"><a href="#cb157-346" aria-hidden="true" tabindex="-1"></a><span class="in">```{r knn.model_savings, eval=FALSE}</span></span>
<span id="cb157-347"><a href="#cb157-347" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------#</span></span>
<span id="cb157-348"><a href="#cb157-348" aria-hidden="true" tabindex="-1"></a><span class="co">#-----K-fold CV------#</span></span>
<span id="cb157-349"><a href="#cb157-349" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------#</span></span>
<span id="cb157-350"><a href="#cb157-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-351"><a href="#cb157-351" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb157-352"><a href="#cb157-352" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the training control object for 10-fold cross-validation</span></span>
<span id="cb157-353"><a href="#cb157-353" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">10</span>)</span>
<span id="cb157-354"><a href="#cb157-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-355"><a href="#cb157-355" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the KNN model using 10-fold cross-validation</span></span>
<span id="cb157-356"><a href="#cb157-356" aria-hidden="true" tabindex="-1"></a><span class="co"># tuneLength argument to specify the range of values of K to be considered for tuning</span></span>
<span id="cb157-357"><a href="#cb157-357" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb157-358"><a href="#cb157-358" aria-hidden="true" tabindex="-1"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb157-359"><a href="#cb157-359" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train, </span>
<span id="cb157-360"><a href="#cb157-360" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"knn"</span>, </span>
<span id="cb157-361"><a href="#cb157-361" aria-hidden="true" tabindex="-1"></a>                   <span class="at">trControl =</span> train_control,</span>
<span id="cb157-362"><a href="#cb157-362" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tuneGrid =</span> <span class="fu">data.frame</span>(<span class="at">k =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>))</span>
<span id="cb157-363"><a href="#cb157-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-364"><a href="#cb157-364" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the model into .Rdata for future import </span></span>
<span id="cb157-365"><a href="#cb157-365" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(knn_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_kfoldCV.Rdata"</span>)</span>
<span id="cb157-366"><a href="#cb157-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-367"><a href="#cb157-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-368"><a href="#cb157-368" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------#</span></span>
<span id="cb157-369"><a href="#cb157-369" aria-hidden="true" tabindex="-1"></a><span class="co">#-----K-fold CV (Mod)------#</span></span>
<span id="cb157-370"><a href="#cb157-370" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------#</span></span>
<span id="cb157-371"><a href="#cb157-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-372"><a href="#cb157-372" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb157-373"><a href="#cb157-373" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">10</span>)</span>
<span id="cb157-374"><a href="#cb157-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-375"><a href="#cb157-375" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb157-376"><a href="#cb157-376" aria-hidden="true" tabindex="-1"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb157-377"><a href="#cb157-377" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train, </span>
<span id="cb157-378"><a href="#cb157-378" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"knn"</span>, </span>
<span id="cb157-379"><a href="#cb157-379" aria-hidden="true" tabindex="-1"></a>                   <span class="at">trControl =</span> train_control, </span>
<span id="cb157-380"><a href="#cb157-380" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tuneGrid =</span> <span class="fu">data.frame</span>(<span class="at">k =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>))</span>
<span id="cb157-381"><a href="#cb157-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-382"><a href="#cb157-382" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the model into .Rdata for future import </span></span>
<span id="cb157-383"><a href="#cb157-383" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(knn_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_kfoldCV_mod.Rdata"</span>)</span>
<span id="cb157-384"><a href="#cb157-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-385"><a href="#cb157-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-386"><a href="#cb157-386" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------#</span></span>
<span id="cb157-387"><a href="#cb157-387" aria-hidden="true" tabindex="-1"></a><span class="co">#----Hold-out CV-----#</span></span>
<span id="cb157-388"><a href="#cb157-388" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------#</span></span>
<span id="cb157-389"><a href="#cb157-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-390"><a href="#cb157-390" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb157-391"><a href="#cb157-391" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"none"</span>,)</span>
<span id="cb157-392"><a href="#cb157-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-393"><a href="#cb157-393" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb157-394"><a href="#cb157-394" aria-hidden="true" tabindex="-1"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb157-395"><a href="#cb157-395" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train, </span>
<span id="cb157-396"><a href="#cb157-396" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"knn"</span>,</span>
<span id="cb157-397"><a href="#cb157-397" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tuneGrid =</span> <span class="fu">data.frame</span>(<span class="at">k =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>))</span>
<span id="cb157-398"><a href="#cb157-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-399"><a href="#cb157-399" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(knn_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_holdoutCV.Rdata"</span>)</span>
<span id="cb157-400"><a href="#cb157-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-401"><a href="#cb157-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-402"><a href="#cb157-402" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------#</span></span>
<span id="cb157-403"><a href="#cb157-403" aria-hidden="true" tabindex="-1"></a><span class="co">#----Hold-out CV (Mod)-----#</span></span>
<span id="cb157-404"><a href="#cb157-404" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------#</span></span>
<span id="cb157-405"><a href="#cb157-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-406"><a href="#cb157-406" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb157-407"><a href="#cb157-407" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"none"</span>,)</span>
<span id="cb157-408"><a href="#cb157-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-409"><a href="#cb157-409" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb157-410"><a href="#cb157-410" aria-hidden="true" tabindex="-1"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb157-411"><a href="#cb157-411" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train, </span>
<span id="cb157-412"><a href="#cb157-412" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"knn"</span>,</span>
<span id="cb157-413"><a href="#cb157-413" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tuneGrid =</span> <span class="fu">expand.grid</span>(<span class="at">k=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>))</span>
<span id="cb157-414"><a href="#cb157-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-415"><a href="#cb157-415" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(knn_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_holdoutCV_mod.Rdata"</span>)</span>
<span id="cb157-416"><a href="#cb157-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-417"><a href="#cb157-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-418"><a href="#cb157-418" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------#</span></span>
<span id="cb157-419"><a href="#cb157-419" aria-hidden="true" tabindex="-1"></a><span class="co">#-------LOOCV--------#</span></span>
<span id="cb157-420"><a href="#cb157-420" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------#</span></span>
<span id="cb157-421"><a href="#cb157-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-422"><a href="#cb157-422" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb157-423"><a href="#cb157-423" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"LOOCV"</span>)</span>
<span id="cb157-424"><a href="#cb157-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-425"><a href="#cb157-425" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb157-426"><a href="#cb157-426" aria-hidden="true" tabindex="-1"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb157-427"><a href="#cb157-427" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train, </span>
<span id="cb157-428"><a href="#cb157-428" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"knn"</span>, </span>
<span id="cb157-429"><a href="#cb157-429" aria-hidden="true" tabindex="-1"></a>                   <span class="at">trControl =</span> train_control,</span>
<span id="cb157-430"><a href="#cb157-430" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tuneGrid =</span> <span class="fu">data.frame</span>(<span class="at">k =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>))</span>
<span id="cb157-431"><a href="#cb157-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-432"><a href="#cb157-432" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(knn_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_looCV.Rdata"</span>)</span>
<span id="cb157-433"><a href="#cb157-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-434"><a href="#cb157-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-435"><a href="#cb157-435" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------#</span></span>
<span id="cb157-436"><a href="#cb157-436" aria-hidden="true" tabindex="-1"></a><span class="co">#-------LOOCV (Mod)--------#</span></span>
<span id="cb157-437"><a href="#cb157-437" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------#</span></span>
<span id="cb157-438"><a href="#cb157-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-439"><a href="#cb157-439" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb157-440"><a href="#cb157-440" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"LOOCV"</span>)</span>
<span id="cb157-441"><a href="#cb157-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-442"><a href="#cb157-442" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb157-443"><a href="#cb157-443" aria-hidden="true" tabindex="-1"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb157-444"><a href="#cb157-444" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train, </span>
<span id="cb157-445"><a href="#cb157-445" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"knn"</span>, </span>
<span id="cb157-446"><a href="#cb157-446" aria-hidden="true" tabindex="-1"></a>                   <span class="at">trControl =</span> train_control,</span>
<span id="cb157-447"><a href="#cb157-447" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tuneLength =</span> <span class="dv">10</span>,</span>
<span id="cb157-448"><a href="#cb157-448" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tuneGrid =</span> <span class="fu">expand.grid</span>(<span class="at">k =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>))</span>
<span id="cb157-449"><a href="#cb157-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-450"><a href="#cb157-450" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(knn_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_looCV_mod.Rdata"</span>)</span>
<span id="cb157-451"><a href="#cb157-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-452"><a href="#cb157-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-453"><a href="#cb157-453" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------#</span></span>
<span id="cb157-454"><a href="#cb157-454" aria-hidden="true" tabindex="-1"></a><span class="co">#----Repeated CV-----#</span></span>
<span id="cb157-455"><a href="#cb157-455" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------#</span></span>
<span id="cb157-456"><a href="#cb157-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-457"><a href="#cb157-457" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb157-458"><a href="#cb157-458" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"repeatedcv"</span>, <span class="at">number =</span> <span class="dv">10</span>, <span class="at">repeats =</span> <span class="dv">5</span>)</span>
<span id="cb157-459"><a href="#cb157-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-460"><a href="#cb157-460" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb157-461"><a href="#cb157-461" aria-hidden="true" tabindex="-1"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb157-462"><a href="#cb157-462" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train, </span>
<span id="cb157-463"><a href="#cb157-463" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"knn"</span>, </span>
<span id="cb157-464"><a href="#cb157-464" aria-hidden="true" tabindex="-1"></a>                   <span class="at">trControl =</span> train_control)</span>
<span id="cb157-465"><a href="#cb157-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-466"><a href="#cb157-466" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(knn_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_repeatedCV.Rdata"</span>)</span>
<span id="cb157-467"><a href="#cb157-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-468"><a href="#cb157-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-469"><a href="#cb157-469" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------#</span></span>
<span id="cb157-470"><a href="#cb157-470" aria-hidden="true" tabindex="-1"></a><span class="co">#----Repeated CV (Mod)-----#</span></span>
<span id="cb157-471"><a href="#cb157-471" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------#</span></span>
<span id="cb157-472"><a href="#cb157-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-473"><a href="#cb157-473" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb157-474"><a href="#cb157-474" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"repeatedcv"</span>, <span class="at">number =</span> <span class="dv">10</span>, <span class="at">repeats =</span> <span class="dv">5</span>)</span>
<span id="cb157-475"><a href="#cb157-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-476"><a href="#cb157-476" aria-hidden="true" tabindex="-1"></a>kknn.grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">kmax =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span> ,<span class="dv">9</span>, <span class="dv">11</span>), <span class="at">distance =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb157-477"><a href="#cb157-477" aria-hidden="true" tabindex="-1"></a>                         <span class="at">kernel =</span> <span class="fu">c</span>(<span class="st">"rectangular"</span>, <span class="st">"gaussian"</span>, <span class="st">"cos"</span>))</span>
<span id="cb157-478"><a href="#cb157-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-479"><a href="#cb157-479" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb157-480"><a href="#cb157-480" aria-hidden="true" tabindex="-1"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb157-481"><a href="#cb157-481" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train, </span>
<span id="cb157-482"><a href="#cb157-482" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"kknn"</span>,</span>
<span id="cb157-483"><a href="#cb157-483" aria-hidden="true" tabindex="-1"></a>                   <span class="at">trControl =</span> train_control, </span>
<span id="cb157-484"><a href="#cb157-484" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tuneGrid =</span> kknn.grid,</span>
<span id="cb157-485"><a href="#cb157-485" aria-hidden="true" tabindex="-1"></a>                   <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>))</span>
<span id="cb157-486"><a href="#cb157-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-487"><a href="#cb157-487" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(knn_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_repeatedCV_mod.Rdata"</span>)</span>
<span id="cb157-488"><a href="#cb157-488" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-489"><a href="#cb157-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-490"><a href="#cb157-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-491"><a href="#cb157-491" aria-hidden="true" tabindex="-1"></a><span class="fu">#### K-fold CV </span></span>
<span id="cb157-492"><a href="#cb157-492" aria-hidden="true" tabindex="-1"></a>In the 10-fold cross-validation procedure, the original dataset is split into 10 subsets of approximately equal size. The model is then trained on 9 of the subsets (the training data) and evaluated on the remaining subset (the validation data). This process is repeated 10 times, each time using a different subset as the validation set, until every subset has been used exactly once as the validation set.</span>
<span id="cb157-493"><a href="#cb157-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-494"><a href="#cb157-494" aria-hidden="true" tabindex="-1"></a>The purpose of cross-validation is to estimate the performance of the model on new, unseen data by simulating the process of training and testing on multiple, independent datasets. It is typically used to assess the performance of different models or model configurations, to select hyperparameters, or to compare the performance of different algorithms.</span>
<span id="cb157-495"><a href="#cb157-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-496"><a href="#cb157-496" aria-hidden="true" tabindex="-1"></a><span class="in">```{r knn.kfoldCV, fig.show='hide'}</span></span>
<span id="cb157-497"><a href="#cb157-497" aria-hidden="true" tabindex="-1"></a><span class="co"># Import model</span></span>
<span id="cb157-498"><a href="#cb157-498" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_kfoldCV.Rdata"</span>)</span>
<span id="cb157-499"><a href="#cb157-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-500"><a href="#cb157-500" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the test data using the trained model and calculate the test error rate</span></span>
<span id="cb157-501"><a href="#cb157-501" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_model, <span class="at">newdata =</span> test)</span>
<span id="cb157-502"><a href="#cb157-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-503"><a href="#cb157-503" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb157-504"><a href="#cb157-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-505"><a href="#cb157-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-506"><a href="#cb157-506" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert predictions to a numeric vector</span></span>
<span id="cb157-507"><a href="#cb157-507" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(knn.predictions)</span>
<span id="cb157-508"><a href="#cb157-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-509"><a href="#cb157-509" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the AUC using the performance() and auc() functions:</span></span>
<span id="cb157-510"><a href="#cb157-510" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb157-511"><a href="#cb157-511" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb157-512"><a href="#cb157-512" aria-hidden="true" tabindex="-1"></a>auc_val</span>
<span id="cb157-513"><a href="#cb157-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-514"><a href="#cb157-514" aria-hidden="true" tabindex="-1"></a><span class="co"># Performance plot for TP and FP</span></span>
<span id="cb157-515"><a href="#cb157-515" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb157-516"><a href="#cb157-516" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb157-517"><a href="#cb157-517" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb157-518"><a href="#cb157-518" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb157-519"><a href="#cb157-519" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"KNN ROC Curves with 10-fold CV"</span>)</span>
<span id="cb157-520"><a href="#cb157-520" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb157-521"><a href="#cb157-521" aria-hidden="true" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(roc_obj<span class="sc">@</span>x.values))</span>
<span id="cb157-522"><a href="#cb157-522" aria-hidden="true" tabindex="-1"></a>y_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(roc_obj<span class="sc">@</span>y.values))</span>
<span id="cb157-523"><a href="#cb157-523" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> x_values, <span class="at">y =</span> y_values, </span>
<span id="cb157-524"><a href="#cb157-524" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">rgb</span>(<span class="fl">0.3803922</span>, <span class="fl">0.6862745</span>, <span class="fl">0.9372549</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb157-525"><a href="#cb157-525" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb157-526"><a href="#cb157-526" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fu">paste</span>(<span class="st">"AUC ="</span>, <span class="fu">round</span>(auc_val, <span class="dv">4</span>)), <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span>
<span id="cb157-527"><a href="#cb157-527" aria-hidden="true" tabindex="-1"></a>knn.kfoldCV.ROC.plot<span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb157-528"><a href="#cb157-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-529"><a href="#cb157-529" aria-hidden="true" tabindex="-1"></a>knn_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">k =</span> knn_model<span class="sc">$</span>results<span class="sc">$</span>k, </span>
<span id="cb157-530"><a href="#cb157-530" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Accuracy =</span> knn_model<span class="sc">$</span>results<span class="sc">$</span>Accuracy,</span>
<span id="cb157-531"><a href="#cb157-531" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Kappa =</span> knn_model<span class="sc">$</span>results<span class="sc">$</span>Kappa)</span>
<span id="cb157-532"><a href="#cb157-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-533"><a href="#cb157-533" aria-hidden="true" tabindex="-1"></a><span class="co"># Accuracy and Kappa value plot</span></span>
<span id="cb157-534"><a href="#cb157-534" aria-hidden="true" tabindex="-1"></a>accu.kappa.plot <span class="ot">&lt;-</span> <span class="cf">function</span>(model_df) {</span>
<span id="cb157-535"><a href="#cb157-535" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> model_df) <span class="sc">+</span></span>
<span id="cb157-536"><a href="#cb157-536" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">color =</span> <span class="st">"Accuracy"</span>)) <span class="sc">+</span></span>
<span id="cb157-537"><a href="#cb157-537" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">color =</span> <span class="st">"Kappa"</span>)) <span class="sc">+</span></span>
<span id="cb157-538"><a href="#cb157-538" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">linetype =</span> <span class="st">"Accuracy"</span>, <span class="at">color =</span> <span class="st">"Accuracy"</span>)) <span class="sc">+</span></span>
<span id="cb157-539"><a href="#cb157-539" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">linetype =</span> <span class="st">"Kappa"</span>, <span class="at">color =</span> <span class="st">"Kappa"</span>)) <span class="sc">+</span></span>
<span id="cb157-540"><a href="#cb157-540" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#98c379"</span>, <span class="st">"#e06c75"</span>),</span>
<span id="cb157-541"><a href="#cb157-541" aria-hidden="true" tabindex="-1"></a>                       <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>)) )) <span class="sc">+</span></span>
<span id="cb157-542"><a href="#cb157-542" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_linetype_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"solid"</span>, <span class="st">"dotted"</span>),</span>
<span id="cb157-543"><a href="#cb157-543" aria-hidden="true" tabindex="-1"></a>                          <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="fu">c</span>(<span class="st">"#98c379"</span>, <span class="st">"#e06c75"</span>)))) <span class="sc">+</span></span>
<span id="cb157-544"><a href="#cb157-544" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"K value"</span>, </span>
<span id="cb157-545"><a href="#cb157-545" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Accuracy / Kappa"</span>) <span class="sc">+</span></span>
<span id="cb157-546"><a href="#cb157-546" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb157-547"><a href="#cb157-547" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb157-548"><a href="#cb157-548" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb157-549"><a href="#cb157-549" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Metric"</span>),</span>
<span id="cb157-550"><a href="#cb157-550" aria-hidden="true" tabindex="-1"></a>           <span class="at">linetype =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Metric"</span>))</span>
<span id="cb157-551"><a href="#cb157-551" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb157-552"><a href="#cb157-552" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb157-553"><a href="#cb157-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-554"><a href="#cb157-554" aria-hidden="true" tabindex="-1"></a>knn.kfoldCV.plot <span class="ot">&lt;-</span> <span class="fu">accu.kappa.plot</span>(knn_df) <span class="sc">+</span> </span>
<span id="cb157-555"><a href="#cb157-555" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb157-556"><a href="#cb157-556" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">label =</span> <span class="fu">round</span>(Kappa, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb157-557"><a href="#cb157-557" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"KNN Model Performance (10-Fold CV)"</span>)</span>
<span id="cb157-558"><a href="#cb157-558" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-559"><a href="#cb157-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-560"><a href="#cb157-560" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Tuned</span></span>
<span id="cb157-561"><a href="#cb157-561" aria-hidden="true" tabindex="-1"></a><span class="in">```{r knn.kfoldCV_mod, fig.show='hide'}</span></span>
<span id="cb157-562"><a href="#cb157-562" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_kfoldCV_mod.Rdata"</span>)</span>
<span id="cb157-563"><a href="#cb157-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-564"><a href="#cb157-564" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_model, <span class="at">newdata =</span> test)</span>
<span id="cb157-565"><a href="#cb157-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-566"><a href="#cb157-566" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb157-567"><a href="#cb157-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-568"><a href="#cb157-568" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(knn.predictions)</span>
<span id="cb157-569"><a href="#cb157-569" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb157-570"><a href="#cb157-570" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb157-571"><a href="#cb157-571" aria-hidden="true" tabindex="-1"></a>auc_val</span>
<span id="cb157-572"><a href="#cb157-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-573"><a href="#cb157-573" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb157-574"><a href="#cb157-574" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb157-575"><a href="#cb157-575" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb157-576"><a href="#cb157-576" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb157-577"><a href="#cb157-577" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"KNN ROC Curves with Tuned 10-fold CV"</span>)</span>
<span id="cb157-578"><a href="#cb157-578" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb157-579"><a href="#cb157-579" aria-hidden="true" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(roc_obj<span class="sc">@</span>x.values))</span>
<span id="cb157-580"><a href="#cb157-580" aria-hidden="true" tabindex="-1"></a>y_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(roc_obj<span class="sc">@</span>y.values))</span>
<span id="cb157-581"><a href="#cb157-581" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> x_values, <span class="at">y =</span> y_values, </span>
<span id="cb157-582"><a href="#cb157-582" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">rgb</span>(<span class="fl">0.3803922</span>, <span class="fl">0.6862745</span>, <span class="fl">0.9372549</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb157-583"><a href="#cb157-583" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb157-584"><a href="#cb157-584" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fu">paste</span>(<span class="st">"AUC ="</span>, <span class="fu">round</span>(auc_val, <span class="dv">4</span>)), <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span>
<span id="cb157-585"><a href="#cb157-585" aria-hidden="true" tabindex="-1"></a>knn.kfoldCV_mod.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb157-586"><a href="#cb157-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-587"><a href="#cb157-587" aria-hidden="true" tabindex="-1"></a>knn_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">k =</span> knn_model<span class="sc">$</span>results<span class="sc">$</span>k, </span>
<span id="cb157-588"><a href="#cb157-588" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Accuracy =</span> knn_model<span class="sc">$</span>results<span class="sc">$</span>Accuracy,</span>
<span id="cb157-589"><a href="#cb157-589" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Kappa =</span> knn_model<span class="sc">$</span>results<span class="sc">$</span>Kappa)</span>
<span id="cb157-590"><a href="#cb157-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-591"><a href="#cb157-591" aria-hidden="true" tabindex="-1"></a>knn.kfoldCV_mod.plot <span class="ot">&lt;-</span> <span class="fu">accu.kappa.plot</span>(knn_df) <span class="sc">+</span></span>
<span id="cb157-592"><a href="#cb157-592" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">3</span>)),  <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">angle=</span><span class="dv">90</span>)  <span class="sc">+</span></span>
<span id="cb157-593"><a href="#cb157-593" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">label =</span> <span class="fu">round</span>(Kappa, <span class="dv">3</span>)),  <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">angle=</span><span class="dv">90</span>) <span class="sc">+</span></span>
<span id="cb157-594"><a href="#cb157-594" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"KNN Model Performance (Tuned 10-Fold CV)"</span>)</span>
<span id="cb157-595"><a href="#cb157-595" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-596"><a href="#cb157-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-597"><a href="#cb157-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-598"><a href="#cb157-598" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Hold-out CV</span></span>
<span id="cb157-599"><a href="#cb157-599" aria-hidden="true" tabindex="-1"></a><span class="in">```{r knn.holdoutCV, fig.show='hide'}</span></span>
<span id="cb157-600"><a href="#cb157-600" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_holdoutCV.Rdata"</span>)</span>
<span id="cb157-601"><a href="#cb157-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-602"><a href="#cb157-602" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_model, <span class="at">newdata =</span> test)</span>
<span id="cb157-603"><a href="#cb157-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-604"><a href="#cb157-604" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb157-605"><a href="#cb157-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-606"><a href="#cb157-606" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(knn.predictions)</span>
<span id="cb157-607"><a href="#cb157-607" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb157-608"><a href="#cb157-608" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb157-609"><a href="#cb157-609" aria-hidden="true" tabindex="-1"></a>auc_val</span>
<span id="cb157-610"><a href="#cb157-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-611"><a href="#cb157-611" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb157-612"><a href="#cb157-612" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb157-613"><a href="#cb157-613" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb157-614"><a href="#cb157-614" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb157-615"><a href="#cb157-615" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"KNN ROC Curves with Hold-out CV"</span>)</span>
<span id="cb157-616"><a href="#cb157-616" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb157-617"><a href="#cb157-617" aria-hidden="true" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(roc_obj<span class="sc">@</span>x.values))</span>
<span id="cb157-618"><a href="#cb157-618" aria-hidden="true" tabindex="-1"></a>y_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(roc_obj<span class="sc">@</span>y.values))</span>
<span id="cb157-619"><a href="#cb157-619" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> x_values, <span class="at">y =</span> y_values, </span>
<span id="cb157-620"><a href="#cb157-620" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">rgb</span>(<span class="fl">0.3803922</span>, <span class="fl">0.6862745</span>, <span class="fl">0.9372549</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb157-621"><a href="#cb157-621" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb157-622"><a href="#cb157-622" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fu">paste</span>(<span class="st">"AUC ="</span>, <span class="fu">round</span>(auc_val, <span class="dv">4</span>)), <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span>
<span id="cb157-623"><a href="#cb157-623" aria-hidden="true" tabindex="-1"></a>knn.holdoutCV.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb157-624"><a href="#cb157-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-625"><a href="#cb157-625" aria-hidden="true" tabindex="-1"></a>knn_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">k =</span> knn_model<span class="sc">$</span>results<span class="sc">$</span>k, </span>
<span id="cb157-626"><a href="#cb157-626" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Accuracy =</span> knn_model<span class="sc">$</span>results<span class="sc">$</span>Accuracy,</span>
<span id="cb157-627"><a href="#cb157-627" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Kappa =</span> knn_model<span class="sc">$</span>results<span class="sc">$</span>Kappa)</span>
<span id="cb157-628"><a href="#cb157-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-629"><a href="#cb157-629" aria-hidden="true" tabindex="-1"></a>knn.holdoutCV.plot <span class="ot">&lt;-</span> <span class="fu">accu.kappa.plot</span>(knn_df) <span class="sc">+</span></span>
<span id="cb157-630"><a href="#cb157-630" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb157-631"><a href="#cb157-631" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">label =</span> <span class="fu">round</span>(Kappa, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb157-632"><a href="#cb157-632" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"KNN Model Performance (Hold-out CV)"</span>)</span>
<span id="cb157-633"><a href="#cb157-633" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-634"><a href="#cb157-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-635"><a href="#cb157-635" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Tuned</span></span>
<span id="cb157-636"><a href="#cb157-636" aria-hidden="true" tabindex="-1"></a><span class="in">```{r knn.holdoutCV_mod, fig.show='hide'}</span></span>
<span id="cb157-637"><a href="#cb157-637" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_holdoutCV_mod.Rdata"</span>)</span>
<span id="cb157-638"><a href="#cb157-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-639"><a href="#cb157-639" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_model, <span class="at">newdata =</span> test)</span>
<span id="cb157-640"><a href="#cb157-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-641"><a href="#cb157-641" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb157-642"><a href="#cb157-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-643"><a href="#cb157-643" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(knn.predictions)</span>
<span id="cb157-644"><a href="#cb157-644" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb157-645"><a href="#cb157-645" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb157-646"><a href="#cb157-646" aria-hidden="true" tabindex="-1"></a>auc_val</span>
<span id="cb157-647"><a href="#cb157-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-648"><a href="#cb157-648" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb157-649"><a href="#cb157-649" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb157-650"><a href="#cb157-650" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb157-651"><a href="#cb157-651" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb157-652"><a href="#cb157-652" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"KNN ROC Curves with Tuned Hold-out CV"</span>)</span>
<span id="cb157-653"><a href="#cb157-653" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb157-654"><a href="#cb157-654" aria-hidden="true" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(roc_obj<span class="sc">@</span>x.values))</span>
<span id="cb157-655"><a href="#cb157-655" aria-hidden="true" tabindex="-1"></a>y_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(roc_obj<span class="sc">@</span>y.values))</span>
<span id="cb157-656"><a href="#cb157-656" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> x_values, <span class="at">y =</span> y_values, </span>
<span id="cb157-657"><a href="#cb157-657" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">rgb</span>(<span class="fl">0.3803922</span>, <span class="fl">0.6862745</span>, <span class="fl">0.9372549</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb157-658"><a href="#cb157-658" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb157-659"><a href="#cb157-659" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fu">paste</span>(<span class="st">"AUC ="</span>, <span class="fu">round</span>(auc_val, <span class="dv">4</span>)), <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span>
<span id="cb157-660"><a href="#cb157-660" aria-hidden="true" tabindex="-1"></a>knn.holdoutCV_mod.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb157-661"><a href="#cb157-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-662"><a href="#cb157-662" aria-hidden="true" tabindex="-1"></a>knn_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">k =</span> knn_model<span class="sc">$</span>results<span class="sc">$</span>k, </span>
<span id="cb157-663"><a href="#cb157-663" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Accuracy =</span> knn_model<span class="sc">$</span>results<span class="sc">$</span>Accuracy,</span>
<span id="cb157-664"><a href="#cb157-664" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Kappa =</span> knn_model<span class="sc">$</span>results<span class="sc">$</span>Kappa)</span>
<span id="cb157-665"><a href="#cb157-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-666"><a href="#cb157-666" aria-hidden="true" tabindex="-1"></a>knn.holdoutCV_mod.plot <span class="ot">&lt;-</span> <span class="fu">accu.kappa.plot</span>(knn_df) <span class="sc">+</span> </span>
<span id="cb157-667"><a href="#cb157-667" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">3</span>)), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">angle=</span><span class="dv">90</span>) <span class="sc">+</span></span>
<span id="cb157-668"><a href="#cb157-668" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">label =</span> <span class="fu">round</span>(Kappa, <span class="dv">3</span>)), <span class="at">hjust=</span><span class="sc">-</span><span class="fl">0.3</span>, <span class="at">angle=</span><span class="dv">90</span>) <span class="sc">+</span></span>
<span id="cb157-669"><a href="#cb157-669" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"KNN Model Performance (Tuned Hold-out CV)"</span>)</span>
<span id="cb157-670"><a href="#cb157-670" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-671"><a href="#cb157-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-672"><a href="#cb157-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-673"><a href="#cb157-673" aria-hidden="true" tabindex="-1"></a><span class="fu">#### LOOCV</span></span>
<span id="cb157-674"><a href="#cb157-674" aria-hidden="true" tabindex="-1"></a><span class="in">```{r knn.LOOCV, fig.show='hide'}</span></span>
<span id="cb157-675"><a href="#cb157-675" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_looCV.Rdata"</span>)</span>
<span id="cb157-676"><a href="#cb157-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-677"><a href="#cb157-677" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_model, <span class="at">newdata =</span> test)</span>
<span id="cb157-678"><a href="#cb157-678" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb157-679"><a href="#cb157-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-680"><a href="#cb157-680" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(knn.predictions)</span>
<span id="cb157-681"><a href="#cb157-681" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb157-682"><a href="#cb157-682" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb157-683"><a href="#cb157-683" aria-hidden="true" tabindex="-1"></a>auc_val</span>
<span id="cb157-684"><a href="#cb157-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-685"><a href="#cb157-685" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb157-686"><a href="#cb157-686" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb157-687"><a href="#cb157-687" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb157-688"><a href="#cb157-688" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb157-689"><a href="#cb157-689" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"KNN ROC Curves with LOOCV"</span>)</span>
<span id="cb157-690"><a href="#cb157-690" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb157-691"><a href="#cb157-691" aria-hidden="true" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(roc_obj<span class="sc">@</span>x.values))</span>
<span id="cb157-692"><a href="#cb157-692" aria-hidden="true" tabindex="-1"></a>y_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(roc_obj<span class="sc">@</span>y.values))</span>
<span id="cb157-693"><a href="#cb157-693" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> x_values, <span class="at">y =</span> y_values, </span>
<span id="cb157-694"><a href="#cb157-694" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">rgb</span>(<span class="fl">0.3803922</span>, <span class="fl">0.6862745</span>, <span class="fl">0.9372549</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb157-695"><a href="#cb157-695" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb157-696"><a href="#cb157-696" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fu">paste</span>(<span class="st">"AUC ="</span>, <span class="fu">round</span>(auc_val, <span class="dv">4</span>)), <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span>
<span id="cb157-697"><a href="#cb157-697" aria-hidden="true" tabindex="-1"></a>knn.looCV.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb157-698"><a href="#cb157-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-699"><a href="#cb157-699" aria-hidden="true" tabindex="-1"></a>knn_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">k =</span> knn_model<span class="sc">$</span>results<span class="sc">$</span>k, </span>
<span id="cb157-700"><a href="#cb157-700" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Accuracy =</span> knn_model<span class="sc">$</span>results<span class="sc">$</span>Accuracy,</span>
<span id="cb157-701"><a href="#cb157-701" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Kappa =</span> knn_model<span class="sc">$</span>results<span class="sc">$</span>Kappa)</span>
<span id="cb157-702"><a href="#cb157-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-703"><a href="#cb157-703" aria-hidden="true" tabindex="-1"></a>knn.looCV.plot <span class="ot">&lt;-</span> <span class="fu">accu.kappa.plot</span>(knn_df) <span class="sc">+</span> </span>
<span id="cb157-704"><a href="#cb157-704" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb157-705"><a href="#cb157-705" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">label =</span> <span class="fu">round</span>(Kappa, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb157-706"><a href="#cb157-706" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"KNN Model Performance (LOOCV)"</span>)</span>
<span id="cb157-707"><a href="#cb157-707" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-708"><a href="#cb157-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-709"><a href="#cb157-709" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Tuned</span></span>
<span id="cb157-710"><a href="#cb157-710" aria-hidden="true" tabindex="-1"></a><span class="in">```{r knn.LOOCV_mod, fig.show='hide'}</span></span>
<span id="cb157-711"><a href="#cb157-711" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_looCV_mod.Rdata"</span>)</span>
<span id="cb157-712"><a href="#cb157-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-713"><a href="#cb157-713" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_model, <span class="at">newdata =</span> test)</span>
<span id="cb157-714"><a href="#cb157-714" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb157-715"><a href="#cb157-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-716"><a href="#cb157-716" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(knn.predictions)</span>
<span id="cb157-717"><a href="#cb157-717" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb157-718"><a href="#cb157-718" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb157-719"><a href="#cb157-719" aria-hidden="true" tabindex="-1"></a>auc_val</span>
<span id="cb157-720"><a href="#cb157-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-721"><a href="#cb157-721" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb157-722"><a href="#cb157-722" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb157-723"><a href="#cb157-723" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb157-724"><a href="#cb157-724" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb157-725"><a href="#cb157-725" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Knn ROC Curves Tuned LOOCV"</span>)</span>
<span id="cb157-726"><a href="#cb157-726" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb157-727"><a href="#cb157-727" aria-hidden="true" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(roc_obj<span class="sc">@</span>x.values))</span>
<span id="cb157-728"><a href="#cb157-728" aria-hidden="true" tabindex="-1"></a>y_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(roc_obj<span class="sc">@</span>y.values))</span>
<span id="cb157-729"><a href="#cb157-729" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> x_values, <span class="at">y =</span> y_values, </span>
<span id="cb157-730"><a href="#cb157-730" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">rgb</span>(<span class="fl">0.3803922</span>, <span class="fl">0.6862745</span>, <span class="fl">0.9372549</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb157-731"><a href="#cb157-731" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb157-732"><a href="#cb157-732" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fu">paste</span>(<span class="st">"AUC ="</span>, <span class="fu">round</span>(auc_val, <span class="dv">4</span>)), <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span>
<span id="cb157-733"><a href="#cb157-733" aria-hidden="true" tabindex="-1"></a>knn.looCV_mod.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb157-734"><a href="#cb157-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-735"><a href="#cb157-735" aria-hidden="true" tabindex="-1"></a>knn_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">k =</span> knn_model<span class="sc">$</span>results<span class="sc">$</span>k, </span>
<span id="cb157-736"><a href="#cb157-736" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Accuracy =</span> knn_model<span class="sc">$</span>results<span class="sc">$</span>Accuracy,</span>
<span id="cb157-737"><a href="#cb157-737" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Kappa =</span> knn_model<span class="sc">$</span>results<span class="sc">$</span>Kappa)</span>
<span id="cb157-738"><a href="#cb157-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-739"><a href="#cb157-739" aria-hidden="true" tabindex="-1"></a>knn.looCV_mod.plot <span class="ot">&lt;-</span> <span class="fu">accu.kappa.plot</span>(knn_df) <span class="sc">+</span> </span>
<span id="cb157-740"><a href="#cb157-740" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">3</span>)), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">angle=</span><span class="dv">90</span>) <span class="sc">+</span></span>
<span id="cb157-741"><a href="#cb157-741" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">label =</span> <span class="fu">round</span>(Kappa, <span class="dv">3</span>)), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">angle=</span><span class="dv">90</span>) <span class="sc">+</span></span>
<span id="cb157-742"><a href="#cb157-742" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"KNN Model Performance (Tuned LOOCV)"</span>)</span>
<span id="cb157-743"><a href="#cb157-743" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-744"><a href="#cb157-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-745"><a href="#cb157-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-746"><a href="#cb157-746" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Repeated CV</span></span>
<span id="cb157-747"><a href="#cb157-747" aria-hidden="true" tabindex="-1"></a><span class="in">```{r knn.repeatedCV, fig.show='hide'}</span></span>
<span id="cb157-748"><a href="#cb157-748" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_repeatedCV.Rdata"</span>)</span>
<span id="cb157-749"><a href="#cb157-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-750"><a href="#cb157-750" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_model, <span class="at">newdata =</span> test)</span>
<span id="cb157-751"><a href="#cb157-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-752"><a href="#cb157-752" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb157-753"><a href="#cb157-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-754"><a href="#cb157-754" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(knn.predictions)</span>
<span id="cb157-755"><a href="#cb157-755" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb157-756"><a href="#cb157-756" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb157-757"><a href="#cb157-757" aria-hidden="true" tabindex="-1"></a>auc_val</span>
<span id="cb157-758"><a href="#cb157-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-759"><a href="#cb157-759" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb157-760"><a href="#cb157-760" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb157-761"><a href="#cb157-761" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb157-762"><a href="#cb157-762" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb157-763"><a href="#cb157-763" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"KNN ROC Curves with Repeated CV"</span>)</span>
<span id="cb157-764"><a href="#cb157-764" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb157-765"><a href="#cb157-765" aria-hidden="true" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(roc_obj<span class="sc">@</span>x.values))</span>
<span id="cb157-766"><a href="#cb157-766" aria-hidden="true" tabindex="-1"></a>y_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(roc_obj<span class="sc">@</span>y.values))</span>
<span id="cb157-767"><a href="#cb157-767" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> x_values, <span class="at">y =</span> y_values, </span>
<span id="cb157-768"><a href="#cb157-768" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">rgb</span>(<span class="fl">0.3803922</span>, <span class="fl">0.6862745</span>, <span class="fl">0.9372549</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb157-769"><a href="#cb157-769" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb157-770"><a href="#cb157-770" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fu">paste</span>(<span class="st">"AUC ="</span>, <span class="fu">round</span>(auc_val, <span class="dv">4</span>)), <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span>
<span id="cb157-771"><a href="#cb157-771" aria-hidden="true" tabindex="-1"></a>knn.repeatedCV.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb157-772"><a href="#cb157-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-773"><a href="#cb157-773" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> knn_model<span class="sc">$</span>results</span>
<span id="cb157-774"><a href="#cb157-774" aria-hidden="true" tabindex="-1"></a>knn.repeatedCV.plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>df, <span class="fu">aes</span>(<span class="at">x =</span> kmax, <span class="at">y =</span> Accuracy)) <span class="sc">+</span></span>
<span id="cb157-775"><a href="#cb157-775" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Accuracy"</span>)) <span class="sc">+</span></span>
<span id="cb157-776"><a href="#cb157-776" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Kappa"</span>)) <span class="sc">+</span></span>
<span id="cb157-777"><a href="#cb157-777" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> <span class="st">"Accuracy"</span>, <span class="at">color =</span> <span class="st">"Accuracy"</span>)) <span class="sc">+</span></span>
<span id="cb157-778"><a href="#cb157-778" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Kappa, <span class="at">linetype =</span> <span class="st">"Kappa"</span>, <span class="at">color =</span> <span class="st">"Kappa"</span>)) <span class="sc">+</span></span>
<span id="cb157-779"><a href="#cb157-779" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb157-780"><a href="#cb157-780" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> Kappa, <span class="at">label =</span> <span class="fu">round</span>(Kappa, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb157-781"><a href="#cb157-781" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#98c379"</span>, <span class="st">"#e06c75"</span>),</span>
<span id="cb157-782"><a href="#cb157-782" aria-hidden="true" tabindex="-1"></a>                     <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>)) )) <span class="sc">+</span></span>
<span id="cb157-783"><a href="#cb157-783" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"solid"</span>, <span class="st">"dotted"</span>),</span>
<span id="cb157-784"><a href="#cb157-784" aria-hidden="true" tabindex="-1"></a>                        <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="fu">c</span>(<span class="st">"#98c379"</span>, <span class="st">"#e06c75"</span>)))) <span class="sc">+</span></span>
<span id="cb157-785"><a href="#cb157-785" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"K value"</span>, </span>
<span id="cb157-786"><a href="#cb157-786" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Accuracy / Kappa"</span>,</span>
<span id="cb157-787"><a href="#cb157-787" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"KNN Model Performance (Repeated CV)"</span>) <span class="sc">+</span></span>
<span id="cb157-788"><a href="#cb157-788" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb157-789"><a href="#cb157-789" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb157-790"><a href="#cb157-790" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb157-791"><a href="#cb157-791" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Metric"</span>),</span>
<span id="cb157-792"><a href="#cb157-792" aria-hidden="true" tabindex="-1"></a>         <span class="at">linetype =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Metric"</span>))</span>
<span id="cb157-793"><a href="#cb157-793" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-794"><a href="#cb157-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-795"><a href="#cb157-795" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Tuned</span></span>
<span id="cb157-796"><a href="#cb157-796" aria-hidden="true" tabindex="-1"></a><span class="in">```{r knn.repeatedCV_mod, fig.show='hide'}</span></span>
<span id="cb157-797"><a href="#cb157-797" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_repeatedCV_mod.Rdata"</span>)</span>
<span id="cb157-798"><a href="#cb157-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-799"><a href="#cb157-799" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_model, <span class="at">newdata =</span> test)</span>
<span id="cb157-800"><a href="#cb157-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-801"><a href="#cb157-801" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb157-802"><a href="#cb157-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-803"><a href="#cb157-803" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(knn.predictions)</span>
<span id="cb157-804"><a href="#cb157-804" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb157-805"><a href="#cb157-805" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb157-806"><a href="#cb157-806" aria-hidden="true" tabindex="-1"></a>auc_val</span>
<span id="cb157-807"><a href="#cb157-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-808"><a href="#cb157-808" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb157-809"><a href="#cb157-809" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb157-810"><a href="#cb157-810" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb157-811"><a href="#cb157-811" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb157-812"><a href="#cb157-812" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"KNN ROC Curves with Tuned Repeated CV"</span>)</span>
<span id="cb157-813"><a href="#cb157-813" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb157-814"><a href="#cb157-814" aria-hidden="true" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(roc_obj<span class="sc">@</span>x.values))</span>
<span id="cb157-815"><a href="#cb157-815" aria-hidden="true" tabindex="-1"></a>y_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(roc_obj<span class="sc">@</span>y.values))</span>
<span id="cb157-816"><a href="#cb157-816" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> x_values, <span class="at">y =</span> y_values, </span>
<span id="cb157-817"><a href="#cb157-817" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">rgb</span>(<span class="fl">0.3803922</span>, <span class="fl">0.6862745</span>, <span class="fl">0.9372549</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb157-818"><a href="#cb157-818" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb157-819"><a href="#cb157-819" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fu">paste</span>(<span class="st">"AUC ="</span>, <span class="fu">round</span>(auc_val, <span class="dv">4</span>)), <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span>
<span id="cb157-820"><a href="#cb157-820" aria-hidden="true" tabindex="-1"></a>knn.repeatedCV_mod.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb157-821"><a href="#cb157-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-822"><a href="#cb157-822" aria-hidden="true" tabindex="-1"></a>knn.repeatedCV_mod.plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(knn_model) <span class="sc">+</span></span>
<span id="cb157-823"><a href="#cb157-823" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"K value"</span>, </span>
<span id="cb157-824"><a href="#cb157-824" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Accuracy"</span>, </span>
<span id="cb157-825"><a href="#cb157-825" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"KNN Model Performance (Tuned Repeated CV)"</span>) <span class="sc">+</span></span>
<span id="cb157-826"><a href="#cb157-826" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb157-827"><a href="#cb157-827" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) </span>
<span id="cb157-828"><a href="#cb157-828" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-829"><a href="#cb157-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-830"><a href="#cb157-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-831"><a href="#cb157-831" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Summary</span></span>
<span id="cb157-832"><a href="#cb157-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-833"><a href="#cb157-833" aria-hidden="true" tabindex="-1"></a><span class="in">```{r knn.Accuracy.Kappa.Plot, fig.width=15, fig.height=20}</span></span>
<span id="cb157-834"><a href="#cb157-834" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(knn.kfoldCV.plot,</span>
<span id="cb157-835"><a href="#cb157-835" aria-hidden="true" tabindex="-1"></a>          knn.kfoldCV_mod.plot,</span>
<span id="cb157-836"><a href="#cb157-836" aria-hidden="true" tabindex="-1"></a>          knn.holdoutCV.plot,</span>
<span id="cb157-837"><a href="#cb157-837" aria-hidden="true" tabindex="-1"></a>          knn.holdoutCV_mod.plot,</span>
<span id="cb157-838"><a href="#cb157-838" aria-hidden="true" tabindex="-1"></a>          knn.looCV.plot,</span>
<span id="cb157-839"><a href="#cb157-839" aria-hidden="true" tabindex="-1"></a>          knn.looCV_mod.plot,</span>
<span id="cb157-840"><a href="#cb157-840" aria-hidden="true" tabindex="-1"></a>          knn.repeatedCV.plot,</span>
<span id="cb157-841"><a href="#cb157-841" aria-hidden="true" tabindex="-1"></a>          knn.repeatedCV_mod.plot,</span>
<span id="cb157-842"><a href="#cb157-842" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">4</span>)</span>
<span id="cb157-843"><a href="#cb157-843" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-844"><a href="#cb157-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-845"><a href="#cb157-845" aria-hidden="true" tabindex="-1"></a><span class="in">```{r knn.ROC_curve, fig.width=10}</span></span>
<span id="cb157-846"><a href="#cb157-846" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(knn.kfoldCV.ROC.plot, knn.kfoldCV_mod.ROC.plot,</span>
<span id="cb157-847"><a href="#cb157-847" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">align =</span> <span class="st">"hv"</span>, <span class="at">scale =</span> <span class="fl">0.8</span>)</span>
<span id="cb157-848"><a href="#cb157-848" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(knn.holdoutCV.ROC.plot, knn.holdoutCV_mod.ROC.plot,</span>
<span id="cb157-849"><a href="#cb157-849" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">align =</span> <span class="st">"hv"</span>, <span class="at">scale =</span> <span class="fl">0.8</span>)</span>
<span id="cb157-850"><a href="#cb157-850" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(knn.looCV.ROC.plot, knn.looCV_mod.ROC.plot,</span>
<span id="cb157-851"><a href="#cb157-851" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">align =</span> <span class="st">"hv"</span>, <span class="at">scale =</span> <span class="fl">0.8</span>)</span>
<span id="cb157-852"><a href="#cb157-852" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(knn.repeatedCV.ROC.plot, knn.repeatedCV_mod.ROC.plot,</span>
<span id="cb157-853"><a href="#cb157-853" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">align =</span> <span class="st">"hv"</span>, <span class="at">scale =</span> <span class="fl">0.8</span>)</span>
<span id="cb157-854"><a href="#cb157-854" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-855"><a href="#cb157-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-856"><a href="#cb157-856" aria-hidden="true" tabindex="-1"></a>| Resampling Method    | Error Rate | Sensitivity | Specificity | AUC       |</span>
<span id="cb157-857"><a href="#cb157-857" aria-hidden="true" tabindex="-1"></a>| -------------------- | ---------- | ----------- | ----------- | --------- |</span>
<span id="cb157-858"><a href="#cb157-858" aria-hidden="true" tabindex="-1"></a>| K-Fold CV            | 0.1692     | 0.9615      | 0.2775      | 0.6195157 |</span>
<span id="cb157-859"><a href="#cb157-859" aria-hidden="true" tabindex="-1"></a>| K-Fold CV (Tuned)    | 0.1953     | 0.9750      | 0.0837      | 0.5293632 |</span>
<span id="cb157-860"><a href="#cb157-860" aria-hidden="true" tabindex="-1"></a>| Hold-out CV          | 0.1768     | 0.9563      | 0.2599      | 0.6081037 |</span>
<span id="cb157-861"><a href="#cb157-861" aria-hidden="true" tabindex="-1"></a>| Hold-out CV  (Tuned) | 0.1944     | 0.9886      | 0.0308      | 0.5096953 |</span>
<span id="cb157-862"><a href="#cb157-862" aria-hidden="true" tabindex="-1"></a>| LOOCV                | 0.1692     | 0.9605      | 0.2819      | 0.6211981 |</span>
<span id="cb157-863"><a href="#cb157-863" aria-hidden="true" tabindex="-1"></a>| LOOCV (Tuned)        | 0.1961     | 0.9740      | 0.0837      | 0.5288429 |</span>
<span id="cb157-864"><a href="#cb157-864" aria-hidden="true" tabindex="-1"></a>| Repeated CV          | 0.1069     | 0.9542      | 0.6344      | 0.7942878 |</span>
<span id="cb157-865"><a href="#cb157-865" aria-hidden="true" tabindex="-1"></a>| Repeated CV (Tuned)  | 0.1204     | 0.9584      | 0.5463      | 0.7523161 |</span>
<span id="cb157-866"><a href="#cb157-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-867"><a href="#cb157-867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-868"><a href="#cb157-868" aria-hidden="true" tabindex="-1"></a><span class="fu">### Logistic Regression</span></span>
<span id="cb157-869"><a href="#cb157-869" aria-hidden="true" tabindex="-1"></a><span class="fu">#### K-fold CV (`caret`)</span></span>
<span id="cb157-870"><a href="#cb157-870" aria-hidden="true" tabindex="-1"></a><span class="in">```{r logit.model_savings, eval=FALSE}</span></span>
<span id="cb157-871"><a href="#cb157-871" aria-hidden="true" tabindex="-1"></a><span class="co">#---------------------------#</span></span>
<span id="cb157-872"><a href="#cb157-872" aria-hidden="true" tabindex="-1"></a><span class="co">#----Model Construction-----#</span></span>
<span id="cb157-873"><a href="#cb157-873" aria-hidden="true" tabindex="-1"></a><span class="co">#---------------------------#</span></span>
<span id="cb157-874"><a href="#cb157-874" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb157-875"><a href="#cb157-875" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the training control object for 10-fold cross-validation</span></span>
<span id="cb157-876"><a href="#cb157-876" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">10</span>)</span>
<span id="cb157-877"><a href="#cb157-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-878"><a href="#cb157-878" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the logistic regression model using 10-fold cross-validation</span></span>
<span id="cb157-879"><a href="#cb157-879" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb157-880"><a href="#cb157-880" aria-hidden="true" tabindex="-1"></a>logit_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb157-881"><a href="#cb157-881" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> train, </span>
<span id="cb157-882"><a href="#cb157-882" aria-hidden="true" tabindex="-1"></a>                     <span class="at">method =</span> <span class="st">"glm"</span>, </span>
<span id="cb157-883"><a href="#cb157-883" aria-hidden="true" tabindex="-1"></a>                     <span class="at">family =</span> <span class="st">"binomial"</span>,</span>
<span id="cb157-884"><a href="#cb157-884" aria-hidden="true" tabindex="-1"></a>                     <span class="at">trControl =</span> train_control)</span>
<span id="cb157-885"><a href="#cb157-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-886"><a href="#cb157-886" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(logit_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">logit.model_kfoldCV.Rdata"</span>)</span>
<span id="cb157-887"><a href="#cb157-887" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-888"><a href="#cb157-888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-889"><a href="#cb157-889" aria-hidden="true" tabindex="-1"></a><span class="in">```{r logit.kfoldCV_caret, fig.show='hide', message=FALSE}</span></span>
<span id="cb157-890"><a href="#cb157-890" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">logit.model_kfoldCV.Rdata"</span>)</span>
<span id="cb157-891"><a href="#cb157-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-892"><a href="#cb157-892" aria-hidden="true" tabindex="-1"></a>logit.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(logit_model, <span class="at">newdata =</span> test)</span>
<span id="cb157-893"><a href="#cb157-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-894"><a href="#cb157-894" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(logit.predictions, test<span class="sc">$</span>good)</span>
<span id="cb157-895"><a href="#cb157-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-896"><a href="#cb157-896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-897"><a href="#cb157-897" aria-hidden="true" tabindex="-1"></a>logit.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(logit.predictions)</span>
<span id="cb157-898"><a href="#cb157-898" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(logit.predictions, test<span class="sc">$</span>good)</span>
<span id="cb157-899"><a href="#cb157-899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-900"><a href="#cb157-900" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the RMSE and MAE</span></span>
<span id="cb157-901"><a href="#cb157-901" aria-hidden="true" tabindex="-1"></a>RMSE <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">RMSE</span>(<span class="fu">as.numeric</span>(<span class="fu">unlist</span>(pred_obj<span class="sc">@</span>predictions)), <span class="fu">as.numeric</span>(test<span class="sc">$</span>good))</span>
<span id="cb157-902"><a href="#cb157-902" aria-hidden="true" tabindex="-1"></a>MAE <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">MAE</span>(<span class="fu">as.numeric</span>(<span class="fu">unlist</span>(pred_obj<span class="sc">@</span>predictions)), <span class="fu">as.numeric</span>(test<span class="sc">$</span>good))</span>
<span id="cb157-903"><a href="#cb157-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-904"><a href="#cb157-904" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute AUC value</span></span>
<span id="cb157-905"><a href="#cb157-905" aria-hidden="true" tabindex="-1"></a>auc_val  <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb157-906"><a href="#cb157-906" aria-hidden="true" tabindex="-1"></a>auc_val</span>
<span id="cb157-907"><a href="#cb157-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-908"><a href="#cb157-908" aria-hidden="true" tabindex="-1"></a>log.perf <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb157-909"><a href="#cb157-909" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(log.perf, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb157-910"><a href="#cb157-910" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb157-911"><a href="#cb157-911" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb157-912"><a href="#cb157-912" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"caret::glm ROC Curves"</span>)</span>
<span id="cb157-913"><a href="#cb157-913" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb157-914"><a href="#cb157-914" aria-hidden="true" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(log.perf<span class="sc">@</span>x.values))</span>
<span id="cb157-915"><a href="#cb157-915" aria-hidden="true" tabindex="-1"></a>y_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(log.perf<span class="sc">@</span>y.values))</span>
<span id="cb157-916"><a href="#cb157-916" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> x_values, <span class="at">y =</span> y_values, </span>
<span id="cb157-917"><a href="#cb157-917" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">rgb</span>(<span class="fl">0.3803922</span>, <span class="fl">0.6862745</span>, <span class="fl">0.9372549</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb157-918"><a href="#cb157-918" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb157-919"><a href="#cb157-919" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fu">paste</span>(<span class="st">"AUC ="</span>, <span class="fu">round</span>(auc_val, <span class="dv">4</span>)), <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span>
<span id="cb157-920"><a href="#cb157-920" aria-hidden="true" tabindex="-1"></a>logit.kfoldCV.ROC_caret.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb157-921"><a href="#cb157-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-922"><a href="#cb157-922" aria-hidden="true" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(<span class="fu">data.frame</span>(<span class="st">"Error Rate"</span> <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> logit_model<span class="sc">$</span>results<span class="sc">$</span>Accuracy, </span>
<span id="cb157-923"><a href="#cb157-923" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"RMSE"</span> <span class="ot">=</span> RMSE, </span>
<span id="cb157-924"><a href="#cb157-924" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"MAE"</span> <span class="ot">=</span> MAE,</span>
<span id="cb157-925"><a href="#cb157-925" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Kappa"</span> <span class="ot">=</span> logit_model<span class="sc">$</span>results<span class="sc">$</span>Kappa), </span>
<span id="cb157-926"><a href="#cb157-926" aria-hidden="true" tabindex="-1"></a>               <span class="at">caption =</span> <span class="st">"caret::glm Performance (10-fold CV)"</span>)</span>
<span id="cb157-927"><a href="#cb157-927" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-928"><a href="#cb157-928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-929"><a href="#cb157-929" aria-hidden="true" tabindex="-1"></a><span class="fu">#### K-fold CV Tuned (`caret`)</span></span>
<span id="cb157-930"><a href="#cb157-930" aria-hidden="true" tabindex="-1"></a><span class="in">```{r logit.kfoldCV_tuned, fig.show='hide'}</span></span>
<span id="cb157-931"><a href="#cb157-931" aria-hidden="true" tabindex="-1"></a>glm.model <span class="ot">&lt;-</span> <span class="fu">glm</span>(good <span class="sc">~</span> ., <span class="at">data=</span> train,<span class="at">family=</span><span class="st">"binomial"</span>)</span>
<span id="cb157-932"><a href="#cb157-932" aria-hidden="true" tabindex="-1"></a>glm.fit<span class="ot">=</span> <span class="fu">stepAIC</span>(glm.model, <span class="at">direction =</span> <span class="st">'backward'</span>)</span>
<span id="cb157-933"><a href="#cb157-933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-934"><a href="#cb157-934" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on test data and construct a confusion matrix</span></span>
<span id="cb157-935"><a href="#cb157-935" aria-hidden="true" tabindex="-1"></a>logit.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(glm.fit, <span class="at">newdata =</span> test,<span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb157-936"><a href="#cb157-936" aria-hidden="true" tabindex="-1"></a>logit.predictions <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(logit.predictions <span class="sc">&gt;</span> <span class="fl">0.7</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb157-937"><a href="#cb157-937" aria-hidden="true" tabindex="-1"></a>                            <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb157-938"><a href="#cb157-938" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(logit.predictions, test<span class="sc">$</span>good)</span>
<span id="cb157-939"><a href="#cb157-939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-940"><a href="#cb157-940" aria-hidden="true" tabindex="-1"></a>Accuracy <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(logit.predictions, test<span class="sc">$</span>good)<span class="sc">$</span>overall[[<span class="dv">1</span>]]</span>
<span id="cb157-941"><a href="#cb157-941" aria-hidden="true" tabindex="-1"></a>Kappa <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(logit.predictions, test<span class="sc">$</span>good)<span class="sc">$</span>overall[[<span class="dv">2</span>]] </span>
<span id="cb157-942"><a href="#cb157-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-943"><a href="#cb157-943" aria-hidden="true" tabindex="-1"></a>logit.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(logit.predictions)</span>
<span id="cb157-944"><a href="#cb157-944" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(logit.predictions, test<span class="sc">$</span>good)</span>
<span id="cb157-945"><a href="#cb157-945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-946"><a href="#cb157-946" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the RMSE and MAE</span></span>
<span id="cb157-947"><a href="#cb157-947" aria-hidden="true" tabindex="-1"></a>RMSE <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">RMSE</span>(<span class="fu">as.numeric</span>(<span class="fu">unlist</span>(pred_obj<span class="sc">@</span>predictions)), <span class="fu">as.numeric</span>(test<span class="sc">$</span>good))</span>
<span id="cb157-948"><a href="#cb157-948" aria-hidden="true" tabindex="-1"></a>MAE <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">MAE</span>(<span class="fu">as.numeric</span>(<span class="fu">unlist</span>(pred_obj<span class="sc">@</span>predictions)), <span class="fu">as.numeric</span>(test<span class="sc">$</span>good))</span>
<span id="cb157-949"><a href="#cb157-949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-950"><a href="#cb157-950" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute AUC value</span></span>
<span id="cb157-951"><a href="#cb157-951" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb157-952"><a href="#cb157-952" aria-hidden="true" tabindex="-1"></a>auc_val</span>
<span id="cb157-953"><a href="#cb157-953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-954"><a href="#cb157-954" aria-hidden="true" tabindex="-1"></a>log.perf <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb157-955"><a href="#cb157-955" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(log.perf, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb157-956"><a href="#cb157-956" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb157-957"><a href="#cb157-957" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb157-958"><a href="#cb157-958" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"caret::glm ROC Curves with stepAIC"</span>)</span>
<span id="cb157-959"><a href="#cb157-959" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb157-960"><a href="#cb157-960" aria-hidden="true" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(log.perf<span class="sc">@</span>x.values))</span>
<span id="cb157-961"><a href="#cb157-961" aria-hidden="true" tabindex="-1"></a>y_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(log.perf<span class="sc">@</span>y.values))</span>
<span id="cb157-962"><a href="#cb157-962" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> x_values, <span class="at">y =</span> y_values, </span>
<span id="cb157-963"><a href="#cb157-963" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">rgb</span>(<span class="fl">0.3803922</span>, <span class="fl">0.6862745</span>, <span class="fl">0.9372549</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb157-964"><a href="#cb157-964" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb157-965"><a href="#cb157-965" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fu">paste</span>(<span class="st">"AUC ="</span>, <span class="fu">round</span>(auc_val, <span class="dv">4</span>)), <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span>
<span id="cb157-966"><a href="#cb157-966" aria-hidden="true" tabindex="-1"></a>logit.kfoldCV_caret_tuned.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb157-967"><a href="#cb157-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-968"><a href="#cb157-968" aria-hidden="true" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(<span class="fu">data.frame</span>(<span class="st">"Error Rate"</span> <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> Accuracy,</span>
<span id="cb157-969"><a href="#cb157-969" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"RMSE"</span> <span class="ot">=</span> RMSE, </span>
<span id="cb157-970"><a href="#cb157-970" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"MAE"</span> <span class="ot">=</span> MAE,</span>
<span id="cb157-971"><a href="#cb157-971" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Kappa"</span> <span class="ot">=</span> Kappa),</span>
<span id="cb157-972"><a href="#cb157-972" aria-hidden="true" tabindex="-1"></a>               <span class="at">caption =</span> <span class="st">"caret::glm Performance (10-fold CV with stepAIC)"</span>)</span>
<span id="cb157-973"><a href="#cb157-973" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-974"><a href="#cb157-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-975"><a href="#cb157-975" aria-hidden="true" tabindex="-1"></a><span class="fu">#### K-fold CV (`MASS`)</span></span>
<span id="cb157-976"><a href="#cb157-976" aria-hidden="true" tabindex="-1"></a><span class="in">```{r logit.kfoldCV_MASS, fig.show='hide'}</span></span>
<span id="cb157-977"><a href="#cb157-977" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the number of folds</span></span>
<span id="cb157-978"><a href="#cb157-978" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb157-979"><a href="#cb157-979" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-980"><a href="#cb157-980" aria-hidden="true" tabindex="-1"></a><span class="co"># Randomly assign each row in the data to a fold</span></span>
<span id="cb157-981"><a href="#cb157-981" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>) <span class="co"># for reproducibility</span></span>
<span id="cb157-982"><a href="#cb157-982" aria-hidden="true" tabindex="-1"></a>fold_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>k, <span class="at">length.out =</span> <span class="fu">nrow</span>(wine.data_subset)))</span>
<span id="cb157-983"><a href="#cb157-983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-984"><a href="#cb157-984" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize an empty list to store the folds</span></span>
<span id="cb157-985"><a href="#cb157-985" aria-hidden="true" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"list"</span>, k)</span>
<span id="cb157-986"><a href="#cb157-986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-987"><a href="#cb157-987" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign each row to a fold</span></span>
<span id="cb157-988"><a href="#cb157-988" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb157-989"><a href="#cb157-989" aria-hidden="true" tabindex="-1"></a>  folds[[i]] <span class="ot">&lt;-</span> <span class="fu">which</span>(fold_indices <span class="sc">==</span> i)</span>
<span id="cb157-990"><a href="#cb157-990" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb157-991"><a href="#cb157-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-992"><a href="#cb157-992" aria-hidden="true" tabindex="-1"></a><span class="co">#To store the error rate of each fold</span></span>
<span id="cb157-993"><a href="#cb157-993" aria-hidden="true" tabindex="-1"></a>error_rate <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb157-994"><a href="#cb157-994" aria-hidden="true" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb157-995"><a href="#cb157-995" aria-hidden="true" tabindex="-1"></a>mae <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb157-996"><a href="#cb157-996" aria-hidden="true" tabindex="-1"></a>kappa <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb157-997"><a href="#cb157-997" aria-hidden="true" tabindex="-1"></a>confusion_matrices <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"list"</span>, k)</span>
<span id="cb157-998"><a href="#cb157-998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-999"><a href="#cb157-999" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each fold</span></span>
<span id="cb157-1000"><a href="#cb157-1000" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb157-1001"><a href="#cb157-1001" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the i-th fold as the testing set</span></span>
<span id="cb157-1002"><a href="#cb157-1002" aria-hidden="true" tabindex="-1"></a>  test_indices <span class="ot">&lt;-</span> <span class="fu">unlist</span>(folds[[i]])</span>
<span id="cb157-1003"><a href="#cb157-1003" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-1004"><a href="#cb157-1004" aria-hidden="true" tabindex="-1"></a>  test <span class="ot">&lt;-</span> wine.data_subset[test_indices, ]</span>
<span id="cb157-1005"><a href="#cb157-1005" aria-hidden="true" tabindex="-1"></a>  train <span class="ot">&lt;-</span> wine.data_subset[<span class="sc">-</span>test_indices, ]</span>
<span id="cb157-1006"><a href="#cb157-1006" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-1007"><a href="#cb157-1007" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fit the model on the training set</span></span>
<span id="cb157-1008"><a href="#cb157-1008" aria-hidden="true" tabindex="-1"></a>  logit_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(good <span class="sc">~</span> ., <span class="at">data =</span> train, <span class="at">family =</span> binomial)</span>
<span id="cb157-1009"><a href="#cb157-1009" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-1010"><a href="#cb157-1010" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make predictions on the testing set and calculate the error rate</span></span>
<span id="cb157-1011"><a href="#cb157-1011" aria-hidden="true" tabindex="-1"></a>  log.pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(logit_model, <span class="at">newdata =</span> test, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb157-1012"><a href="#cb157-1012" aria-hidden="true" tabindex="-1"></a>  predicted_classes <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">ifelse</span>(log.pred <span class="sc">&gt;</span> <span class="fl">0.7</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb157-1013"><a href="#cb157-1013" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-1014"><a href="#cb157-1014" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute RMSE</span></span>
<span id="cb157-1015"><a href="#cb157-1015" aria-hidden="true" tabindex="-1"></a>  rmse[i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((predicted_classes <span class="sc">-</span> test<span class="sc">$</span>good) <span class="sc">^</span> <span class="dv">2</span>))</span>
<span id="cb157-1016"><a href="#cb157-1016" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-1017"><a href="#cb157-1017" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute MAE</span></span>
<span id="cb157-1018"><a href="#cb157-1018" aria-hidden="true" tabindex="-1"></a>  mae[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(predicted_classes <span class="sc">-</span> test<span class="sc">$</span>good))</span>
<span id="cb157-1019"><a href="#cb157-1019" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-1020"><a href="#cb157-1020" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute MAE</span></span>
<span id="cb157-1021"><a href="#cb157-1021" aria-hidden="true" tabindex="-1"></a>  error_rate[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>((predicted_classes<span class="sc">&gt;</span> <span class="fl">0.7</span>) <span class="sc">!=</span> test<span class="sc">$</span>good)</span>
<span id="cb157-1022"><a href="#cb157-1022" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-1023"><a href="#cb157-1023" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute confusion matrix</span></span>
<span id="cb157-1024"><a href="#cb157-1024" aria-hidden="true" tabindex="-1"></a>  test<span class="sc">$</span>good <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(test<span class="sc">$</span>good)</span>
<span id="cb157-1025"><a href="#cb157-1025" aria-hidden="true" tabindex="-1"></a>  predicted_classes <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(log.pred <span class="sc">&gt;</span> <span class="fl">0.7</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb157-1026"><a href="#cb157-1026" aria-hidden="true" tabindex="-1"></a>  confusion_matrices[[i]] <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">confusionMatrix</span>(predicted_classes, test<span class="sc">$</span>good)</span>
<span id="cb157-1027"><a href="#cb157-1027" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-1028"><a href="#cb157-1028" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute Kappa value</span></span>
<span id="cb157-1029"><a href="#cb157-1029" aria-hidden="true" tabindex="-1"></a>  kappa[i] <span class="ot">&lt;-</span> confusion_matrices[[i]]<span class="sc">$</span>overall[[<span class="dv">2</span>]]</span>
<span id="cb157-1030"><a href="#cb157-1030" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-1031"><a href="#cb157-1031" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Print the error rates for each fold</span></span>
<span id="cb157-1032"><a href="#cb157-1032" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"Fold "</span>, i, <span class="st">": "</span>, <span class="st">"OER:"</span>, error_rate[i], <span class="st">" RMSE:"</span>, rmse[i], <span class="st">" MAE:"</span>, mae[i], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb157-1033"><a href="#cb157-1033" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb157-1034"><a href="#cb157-1034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1035"><a href="#cb157-1035" aria-hidden="true" tabindex="-1"></a>best_confmat_index <span class="ot">&lt;-</span> <span class="fu">which.min</span>(error_rate)</span>
<span id="cb157-1036"><a href="#cb157-1036" aria-hidden="true" tabindex="-1"></a>best_confmat_index</span>
<span id="cb157-1037"><a href="#cb157-1037" aria-hidden="true" tabindex="-1"></a>best_confmat_indexi <span class="ot">&lt;-</span> <span class="fu">which.min</span>(rmse)</span>
<span id="cb157-1038"><a href="#cb157-1038" aria-hidden="true" tabindex="-1"></a>best_confmat_index</span>
<span id="cb157-1039"><a href="#cb157-1039" aria-hidden="true" tabindex="-1"></a>best_confmat_index <span class="ot">&lt;-</span> <span class="fu">which.min</span>(mae)</span>
<span id="cb157-1040"><a href="#cb157-1040" aria-hidden="true" tabindex="-1"></a>best_confmat_index</span>
<span id="cb157-1041"><a href="#cb157-1041" aria-hidden="true" tabindex="-1"></a>confusion_matrices[best_confmat_index]</span>
<span id="cb157-1042"><a href="#cb157-1042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1043"><a href="#cb157-1043" aria-hidden="true" tabindex="-1"></a><span class="co">#AUC and Performance Plot</span></span>
<span id="cb157-1044"><a href="#cb157-1044" aria-hidden="true" tabindex="-1"></a>predicted_classes <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(predicted_classes)</span>
<span id="cb157-1045"><a href="#cb157-1045" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(predicted_classes, test<span class="sc">$</span>good)</span>
<span id="cb157-1046"><a href="#cb157-1046" aria-hidden="true" tabindex="-1"></a>auc_val  <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb157-1047"><a href="#cb157-1047" aria-hidden="true" tabindex="-1"></a>log.perf <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj,<span class="st">"tpr"</span>,<span class="st">"fpr"</span>)</span>
<span id="cb157-1048"><a href="#cb157-1048" aria-hidden="true" tabindex="-1"></a>auc_val  <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb157-1049"><a href="#cb157-1049" aria-hidden="true" tabindex="-1"></a>auc_val</span>
<span id="cb157-1050"><a href="#cb157-1050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1051"><a href="#cb157-1051" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(log.perf, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb157-1052"><a href="#cb157-1052" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb157-1053"><a href="#cb157-1053" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb157-1054"><a href="#cb157-1054" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"MASS::glm ROC Curves"</span>)</span>
<span id="cb157-1055"><a href="#cb157-1055" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb157-1056"><a href="#cb157-1056" aria-hidden="true" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(log.perf<span class="sc">@</span>x.values))</span>
<span id="cb157-1057"><a href="#cb157-1057" aria-hidden="true" tabindex="-1"></a>y_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(log.perf<span class="sc">@</span>y.values))</span>
<span id="cb157-1058"><a href="#cb157-1058" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> x_values, <span class="at">y =</span> y_values, </span>
<span id="cb157-1059"><a href="#cb157-1059" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">rgb</span>(<span class="fl">0.3803922</span>, <span class="fl">0.6862745</span>, <span class="fl">0.9372549</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb157-1060"><a href="#cb157-1060" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb157-1061"><a href="#cb157-1061" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fu">paste</span>(<span class="st">"AUC ="</span>, <span class="fu">round</span>(auc_val, <span class="dv">4</span>)), <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span>
<span id="cb157-1062"><a href="#cb157-1062" aria-hidden="true" tabindex="-1"></a>logit.kfoldCV_MASS.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb157-1063"><a href="#cb157-1063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1064"><a href="#cb157-1064" aria-hidden="true" tabindex="-1"></a>logit_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">k =</span> <span class="dv">1</span><span class="sc">:</span>k,</span>
<span id="cb157-1065"><a href="#cb157-1065" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Accuracy =</span> <span class="dv">1</span><span class="sc">-</span>error_rate, </span>
<span id="cb157-1066"><a href="#cb157-1066" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Kappa =</span> kappa)</span>
<span id="cb157-1067"><a href="#cb157-1067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1068"><a href="#cb157-1068" aria-hidden="true" tabindex="-1"></a>logit.kfoldCV_MASS.plot <span class="ot">&lt;-</span> <span class="fu">accu.kappa.plot</span>(logit_df) <span class="sc">+</span> </span>
<span id="cb157-1069"><a href="#cb157-1069" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb157-1070"><a href="#cb157-1070" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">label =</span> <span class="fu">round</span>(Kappa, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb157-1071"><a href="#cb157-1071" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"MASS::glm Model Performance (10-Fold CV)"</span>)</span>
<span id="cb157-1072"><a href="#cb157-1072" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-1073"><a href="#cb157-1073" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1074"><a href="#cb157-1074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1075"><a href="#cb157-1075" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Hold-out CV (`MASS`)</span></span>
<span id="cb157-1078"><a href="#cb157-1078" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb157-1079"><a href="#cb157-1079" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the seed for reproducibility</span></span>
<span id="cb157-1080"><a href="#cb157-1080" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb157-1081"><a href="#cb157-1081" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1082"><a href="#cb157-1082" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportion of data to use for training</span></span>
<span id="cb157-1083"><a href="#cb157-1083" aria-hidden="true" tabindex="-1"></a>train_prop <span class="ot">&lt;-</span> <span class="fl">0.7</span></span>
<span id="cb157-1084"><a href="#cb157-1084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1085"><a href="#cb157-1085" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the data into training and testing sets</span></span>
<span id="cb157-1086"><a href="#cb157-1086" aria-hidden="true" tabindex="-1"></a>train_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">seq_len</span>(<span class="fu">nrow</span>(wine.data_subset)), <span class="at">size =</span> <span class="fu">round</span>(train_prop <span class="sc">*</span> <span class="fu">nrow</span>(wine.data_subset)), <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb157-1087"><a href="#cb157-1087" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> wine.data_subset[train_indices, ]</span>
<span id="cb157-1088"><a href="#cb157-1088" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> wine.data_subset[<span class="sc">-</span>train_indices, ]</span>
<span id="cb157-1089"><a href="#cb157-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1090"><a href="#cb157-1090" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model on the training set</span></span>
<span id="cb157-1091"><a href="#cb157-1091" aria-hidden="true" tabindex="-1"></a>logit_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(good <span class="sc">~</span> ., <span class="at">data =</span> train, <span class="at">family =</span> binomial)</span>
<span id="cb157-1092"><a href="#cb157-1092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1093"><a href="#cb157-1093" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the testing set and calculate the error rate</span></span>
<span id="cb157-1094"><a href="#cb157-1094" aria-hidden="true" tabindex="-1"></a>log.pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(logit_model, <span class="at">newdata =</span> test, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb157-1095"><a href="#cb157-1095" aria-hidden="true" tabindex="-1"></a>predicted_classes <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">ifelse</span>(log.pred <span class="sc">&gt;</span> <span class="fl">0.7</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb157-1096"><a href="#cb157-1096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1097"><a href="#cb157-1097" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute RMSE</span></span>
<span id="cb157-1098"><a href="#cb157-1098" aria-hidden="true" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((predicted_classes <span class="sc">-</span> test<span class="sc">$</span>good) <span class="sc">^</span> <span class="dv">2</span>))</span>
<span id="cb157-1099"><a href="#cb157-1099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1100"><a href="#cb157-1100" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute MAE</span></span>
<span id="cb157-1101"><a href="#cb157-1101" aria-hidden="true" tabindex="-1"></a>mae <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(predicted_classes <span class="sc">-</span> test<span class="sc">$</span>good))</span>
<span id="cb157-1102"><a href="#cb157-1102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1103"><a href="#cb157-1103" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute error rate</span></span>
<span id="cb157-1104"><a href="#cb157-1104" aria-hidden="true" tabindex="-1"></a>error_rate <span class="ot">&lt;-</span> <span class="fu">mean</span>((predicted_classes <span class="sc">&gt;</span> <span class="fl">0.7</span>) <span class="sc">!=</span> test<span class="sc">$</span>good)</span>
<span id="cb157-1105"><a href="#cb157-1105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1106"><a href="#cb157-1106" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the accuracy of the predictions on the testing set</span></span>
<span id="cb157-1107"><a href="#cb157-1107" aria-hidden="true" tabindex="-1"></a>train<span class="sc">$</span>good <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(train<span class="sc">$</span>good)</span>
<span id="cb157-1108"><a href="#cb157-1108" aria-hidden="true" tabindex="-1"></a>test<span class="sc">$</span>good <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(test<span class="sc">$</span>good)</span>
<span id="cb157-1109"><a href="#cb157-1109" aria-hidden="true" tabindex="-1"></a>predicted_classes <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(log.pred <span class="sc">&gt;</span> <span class="fl">0.7</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb157-1110"><a href="#cb157-1110" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(predicted_classes, test<span class="sc">$</span>good)</span>
<span id="cb157-1111"><a href="#cb157-1111" aria-hidden="true" tabindex="-1"></a>kappa <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(predicted_classes, test<span class="sc">$</span>good)<span class="sc">$</span>overall[[<span class="dv">2</span>]]</span>
<span id="cb157-1112"><a href="#cb157-1112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1113"><a href="#cb157-1113" aria-hidden="true" tabindex="-1"></a><span class="co">#AUC and Performance Plot</span></span>
<span id="cb157-1114"><a href="#cb157-1114" aria-hidden="true" tabindex="-1"></a>predicted_classes <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(predicted_classes)</span>
<span id="cb157-1115"><a href="#cb157-1115" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(predicted_classes, test<span class="sc">$</span>good)</span>
<span id="cb157-1116"><a href="#cb157-1116" aria-hidden="true" tabindex="-1"></a>log.perf <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj,<span class="st">"tpr"</span>,<span class="st">"fpr"</span>)</span>
<span id="cb157-1117"><a href="#cb157-1117" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb157-1118"><a href="#cb157-1118" aria-hidden="true" tabindex="-1"></a>auc_val</span>
<span id="cb157-1119"><a href="#cb157-1119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1120"><a href="#cb157-1120" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(log.perf, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb157-1121"><a href="#cb157-1121" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb157-1122"><a href="#cb157-1122" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb157-1123"><a href="#cb157-1123" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"MASS::glm ROC Curves with Hold-out CV"</span>)</span>
<span id="cb157-1124"><a href="#cb157-1124" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb157-1125"><a href="#cb157-1125" aria-hidden="true" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(log.perf<span class="sc">@</span>x.values))</span>
<span id="cb157-1126"><a href="#cb157-1126" aria-hidden="true" tabindex="-1"></a>y_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(log.perf<span class="sc">@</span>y.values))</span>
<span id="cb157-1127"><a href="#cb157-1127" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> x_values, <span class="at">y =</span> y_values, </span>
<span id="cb157-1128"><a href="#cb157-1128" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">rgb</span>(<span class="fl">0.3803922</span>, <span class="fl">0.6862745</span>, <span class="fl">0.9372549</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb157-1129"><a href="#cb157-1129" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb157-1130"><a href="#cb157-1130" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fu">paste</span>(<span class="st">"AUC ="</span>, <span class="fu">round</span>(auc_val, <span class="dv">4</span>)), <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span>
<span id="cb157-1131"><a href="#cb157-1131" aria-hidden="true" tabindex="-1"></a>logit.holdoutCV_MASS.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb157-1132"><a href="#cb157-1132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1133"><a href="#cb157-1133" aria-hidden="true" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(<span class="fu">data.frame</span>(<span class="st">"Error Rate"</span> <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> error_rate, </span>
<span id="cb157-1134"><a href="#cb157-1134" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"RMSE"</span> <span class="ot">=</span> rmse, </span>
<span id="cb157-1135"><a href="#cb157-1135" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"MAE"</span> <span class="ot">=</span> mae,</span>
<span id="cb157-1136"><a href="#cb157-1136" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Kappa"</span> <span class="ot">=</span> kappa))</span>
<span id="cb157-1137"><a href="#cb157-1137" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-1138"><a href="#cb157-1138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1139"><a href="#cb157-1139" aria-hidden="true" tabindex="-1"></a>| Resampling Method                                | Error Rate | Sensitivity | Specificity | AUC       |</span>
<span id="cb157-1140"><a href="#cb157-1140" aria-hidden="true" tabindex="-1"></a>| ------------------------------------------------ | ---------- | ----------- | ----------- | --------- |</span>
<span id="cb157-1141"><a href="#cb157-1141" aria-hidden="true" tabindex="-1"></a>| Logistic Regression (<span class="in">`caret`</span>)                    | 0.1793     | 0.9324      | 0.3480      | 0.6401899 |</span>
<span id="cb157-1142"><a href="#cb157-1142" aria-hidden="true" tabindex="-1"></a>| Logistic Regression (<span class="in">`caret`</span> tuned with stepAIC) | 0.1801     | 0.99272     | 0.0881      | 0.5404108 |</span>
<span id="cb157-1143"><a href="#cb157-1143" aria-hidden="true" tabindex="-1"></a>| Logistic Regression (<span class="in">`MASS`</span> K-fold CV)           | 0.1616     | 1.00000     | 0.0857      | 0.5438871 |</span>
<span id="cb157-1144"><a href="#cb157-1144" aria-hidden="true" tabindex="-1"></a>| Logistic Regression (<span class="in">`MASS`</span> Hold-out CV)         | 0.1894     | 0.9884      | 0.1046      | 0.5465057 |</span>
<span id="cb157-1145"><a href="#cb157-1145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1146"><a href="#cb157-1146" aria-hidden="true" tabindex="-1"></a><span class="fu">### Linear Discriminant Analysis</span></span>
<span id="cb157-1147"><a href="#cb157-1147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1148"><a href="#cb157-1148" aria-hidden="true" tabindex="-1"></a><span class="fu">#### K-fold CV(`caret`)</span></span>
<span id="cb157-1149"><a href="#cb157-1149" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lda.model_savings, eval=FALSE}</span></span>
<span id="cb157-1150"><a href="#cb157-1150" aria-hidden="true" tabindex="-1"></a><span class="co">#---------------------------#</span></span>
<span id="cb157-1151"><a href="#cb157-1151" aria-hidden="true" tabindex="-1"></a><span class="co">#----Model Construction-----#</span></span>
<span id="cb157-1152"><a href="#cb157-1152" aria-hidden="true" tabindex="-1"></a><span class="co">#---------------------------#</span></span>
<span id="cb157-1153"><a href="#cb157-1153" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb157-1154"><a href="#cb157-1154" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">10</span>)</span>
<span id="cb157-1155"><a href="#cb157-1155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1156"><a href="#cb157-1156" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb157-1157"><a href="#cb157-1157" aria-hidden="true" tabindex="-1"></a>lda_model <span class="ot">&lt;-</span> <span class="fu">train</span>(<span class="fu">as.factor</span>(good) <span class="sc">~</span> ., </span>
<span id="cb157-1158"><a href="#cb157-1158" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train, </span>
<span id="cb157-1159"><a href="#cb157-1159" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"lda"</span>, </span>
<span id="cb157-1160"><a href="#cb157-1160" aria-hidden="true" tabindex="-1"></a>                   <span class="at">trControl =</span> train_control)</span>
<span id="cb157-1161"><a href="#cb157-1161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1162"><a href="#cb157-1162" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(lda_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">lda.model_kfoldCV.Rdata"</span>)</span>
<span id="cb157-1163"><a href="#cb157-1163" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-1164"><a href="#cb157-1164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1165"><a href="#cb157-1165" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lda.kfoldCV_caret, fig.show='hide'}</span></span>
<span id="cb157-1166"><a href="#cb157-1166" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">lda.model_kfoldCV.Rdata"</span>)</span>
<span id="cb157-1167"><a href="#cb157-1167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1168"><a href="#cb157-1168" aria-hidden="true" tabindex="-1"></a>lda.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(lda_model, <span class="at">newdata =</span> test)</span>
<span id="cb157-1169"><a href="#cb157-1169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1170"><a href="#cb157-1170" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(lda.predictions, test<span class="sc">$</span>good)</span>
<span id="cb157-1171"><a href="#cb157-1171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1172"><a href="#cb157-1172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1173"><a href="#cb157-1173" aria-hidden="true" tabindex="-1"></a>lda.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(lda.predictions)</span>
<span id="cb157-1174"><a href="#cb157-1174" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(lda.predictions, test<span class="sc">$</span>good)</span>
<span id="cb157-1175"><a href="#cb157-1175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1176"><a href="#cb157-1176" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the RMSE and MAE</span></span>
<span id="cb157-1177"><a href="#cb157-1177" aria-hidden="true" tabindex="-1"></a>RMSE <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">RMSE</span>(<span class="fu">as.numeric</span>(<span class="fu">unlist</span>(pred_obj<span class="sc">@</span>predictions)), <span class="fu">as.numeric</span>(test<span class="sc">$</span>good))</span>
<span id="cb157-1178"><a href="#cb157-1178" aria-hidden="true" tabindex="-1"></a>MAE <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">MAE</span>(<span class="fu">as.numeric</span>(<span class="fu">unlist</span>(pred_obj<span class="sc">@</span>predictions)), <span class="fu">as.numeric</span>(test<span class="sc">$</span>good))</span>
<span id="cb157-1179"><a href="#cb157-1179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1180"><a href="#cb157-1180" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute AUC value</span></span>
<span id="cb157-1181"><a href="#cb157-1181" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb157-1182"><a href="#cb157-1182" aria-hidden="true" tabindex="-1"></a>auc_val</span>
<span id="cb157-1183"><a href="#cb157-1183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1184"><a href="#cb157-1184" aria-hidden="true" tabindex="-1"></a>lda.perf <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb157-1185"><a href="#cb157-1185" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lda.perf, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb157-1186"><a href="#cb157-1186" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb157-1187"><a href="#cb157-1187" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb157-1188"><a href="#cb157-1188" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"caret::qda ROC Curves"</span>)</span>
<span id="cb157-1189"><a href="#cb157-1189" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb157-1190"><a href="#cb157-1190" aria-hidden="true" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(lda.perf<span class="sc">@</span>x.values))</span>
<span id="cb157-1191"><a href="#cb157-1191" aria-hidden="true" tabindex="-1"></a>y_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(lda.perf<span class="sc">@</span>y.values))</span>
<span id="cb157-1192"><a href="#cb157-1192" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> x_values, <span class="at">y =</span> y_values, </span>
<span id="cb157-1193"><a href="#cb157-1193" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">rgb</span>(<span class="fl">0.3803922</span>, <span class="fl">0.6862745</span>, <span class="fl">0.9372549</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb157-1194"><a href="#cb157-1194" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb157-1195"><a href="#cb157-1195" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fu">paste</span>(<span class="st">"AUC ="</span>, <span class="fu">round</span>(auc_val, <span class="dv">4</span>)), <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span>
<span id="cb157-1196"><a href="#cb157-1196" aria-hidden="true" tabindex="-1"></a>lda.kfoldCV_caret.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb157-1197"><a href="#cb157-1197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1198"><a href="#cb157-1198" aria-hidden="true" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(<span class="fu">data.frame</span>(<span class="st">"Error Rate"</span> <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> lda_model<span class="sc">$</span>results<span class="sc">$</span>Accuracy, </span>
<span id="cb157-1199"><a href="#cb157-1199" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"RMSE"</span> <span class="ot">=</span> RMSE, </span>
<span id="cb157-1200"><a href="#cb157-1200" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"MAE"</span> <span class="ot">=</span> MAE,</span>
<span id="cb157-1201"><a href="#cb157-1201" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Kappa"</span> <span class="ot">=</span> lda_model<span class="sc">$</span>results<span class="sc">$</span>Kappa), </span>
<span id="cb157-1202"><a href="#cb157-1202" aria-hidden="true" tabindex="-1"></a>               <span class="at">caption =</span> <span class="st">"caret::lda Performance (10-fold CV)"</span>)</span>
<span id="cb157-1203"><a href="#cb157-1203" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-1204"><a href="#cb157-1204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1205"><a href="#cb157-1205" aria-hidden="true" tabindex="-1"></a><span class="fu">#### K-fold CV (`MASS`)</span></span>
<span id="cb157-1206"><a href="#cb157-1206" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, lda.kfoldCV_MASS, fig.show='hide'}</span></span>
<span id="cb157-1207"><a href="#cb157-1207" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the number of folds</span></span>
<span id="cb157-1208"><a href="#cb157-1208" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb157-1209"><a href="#cb157-1209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1210"><a href="#cb157-1210" aria-hidden="true" tabindex="-1"></a><span class="co"># Randomly assign each row in the data to a fold</span></span>
<span id="cb157-1211"><a href="#cb157-1211" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>) <span class="co"># for reproducibility</span></span>
<span id="cb157-1212"><a href="#cb157-1212" aria-hidden="true" tabindex="-1"></a>fold_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>k, <span class="at">length.out =</span> <span class="fu">nrow</span>(wine.data_subset)))</span>
<span id="cb157-1213"><a href="#cb157-1213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1214"><a href="#cb157-1214" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize an empty list to store the folds</span></span>
<span id="cb157-1215"><a href="#cb157-1215" aria-hidden="true" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"list"</span>, k)</span>
<span id="cb157-1216"><a href="#cb157-1216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1217"><a href="#cb157-1217" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign each row to a fold</span></span>
<span id="cb157-1218"><a href="#cb157-1218" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb157-1219"><a href="#cb157-1219" aria-hidden="true" tabindex="-1"></a>  folds[[i]] <span class="ot">&lt;-</span> <span class="fu">which</span>(fold_indices <span class="sc">==</span> i)</span>
<span id="cb157-1220"><a href="#cb157-1220" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb157-1221"><a href="#cb157-1221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1222"><a href="#cb157-1222" aria-hidden="true" tabindex="-1"></a><span class="co">#To store the error rate of each fold</span></span>
<span id="cb157-1223"><a href="#cb157-1223" aria-hidden="true" tabindex="-1"></a>error_rate <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb157-1224"><a href="#cb157-1224" aria-hidden="true" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb157-1225"><a href="#cb157-1225" aria-hidden="true" tabindex="-1"></a>mae <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb157-1226"><a href="#cb157-1226" aria-hidden="true" tabindex="-1"></a>kappa <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb157-1227"><a href="#cb157-1227" aria-hidden="true" tabindex="-1"></a>confusion_matrices <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"list"</span>, k)</span>
<span id="cb157-1228"><a href="#cb157-1228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1229"><a href="#cb157-1229" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each fold</span></span>
<span id="cb157-1230"><a href="#cb157-1230" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb157-1231"><a href="#cb157-1231" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the i-th fold as the testing set</span></span>
<span id="cb157-1232"><a href="#cb157-1232" aria-hidden="true" tabindex="-1"></a>  test_indices <span class="ot">&lt;-</span> <span class="fu">unlist</span>(folds[[i]])</span>
<span id="cb157-1233"><a href="#cb157-1233" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-1234"><a href="#cb157-1234" aria-hidden="true" tabindex="-1"></a>  test <span class="ot">&lt;-</span> wine.data_subset[test_indices, ]</span>
<span id="cb157-1235"><a href="#cb157-1235" aria-hidden="true" tabindex="-1"></a>  train <span class="ot">&lt;-</span> wine.data_subset[<span class="sc">-</span>test_indices, ]</span>
<span id="cb157-1236"><a href="#cb157-1236" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-1237"><a href="#cb157-1237" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fit the model on the training set</span></span>
<span id="cb157-1238"><a href="#cb157-1238" aria-hidden="true" tabindex="-1"></a>  lda_model <span class="ot">&lt;-</span> <span class="fu">lda</span>(good <span class="sc">~</span> ., <span class="at">data =</span> train, <span class="at">family =</span> binomial)</span>
<span id="cb157-1239"><a href="#cb157-1239" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-1240"><a href="#cb157-1240" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make predictions on the testing set and calculate the error rate</span></span>
<span id="cb157-1241"><a href="#cb157-1241" aria-hidden="true" tabindex="-1"></a>  lda.pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(lda_model, <span class="at">newdata =</span> test, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb157-1242"><a href="#cb157-1242" aria-hidden="true" tabindex="-1"></a>  predicted_classes <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(lda.pred<span class="sc">$</span>posterior[, <span class="dv">2</span>] <span class="sc">&gt;</span> <span class="fl">0.7</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb157-1243"><a href="#cb157-1243" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-1244"><a href="#cb157-1244" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute RMSE</span></span>
<span id="cb157-1245"><a href="#cb157-1245" aria-hidden="true" tabindex="-1"></a>  rmse[i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((predicted_classes <span class="sc">-</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>good)) <span class="sc">^</span> <span class="dv">2</span>))</span>
<span id="cb157-1246"><a href="#cb157-1246" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-1247"><a href="#cb157-1247" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute MAE</span></span>
<span id="cb157-1248"><a href="#cb157-1248" aria-hidden="true" tabindex="-1"></a>  mae[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(predicted_classes <span class="sc">-</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>good)))</span>
<span id="cb157-1249"><a href="#cb157-1249" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-1250"><a href="#cb157-1250" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute OER</span></span>
<span id="cb157-1251"><a href="#cb157-1251" aria-hidden="true" tabindex="-1"></a>  error_rate[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>((predicted_classes <span class="sc">&gt;</span> <span class="fl">0.7</span>) <span class="sc">!=</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>good))</span>
<span id="cb157-1252"><a href="#cb157-1252" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-1253"><a href="#cb157-1253" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute confusion matrix</span></span>
<span id="cb157-1254"><a href="#cb157-1254" aria-hidden="true" tabindex="-1"></a>  test<span class="sc">$</span>good <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(test<span class="sc">$</span>good)</span>
<span id="cb157-1255"><a href="#cb157-1255" aria-hidden="true" tabindex="-1"></a>  predicted_classes <span class="ot">&lt;-</span> <span class="fu">factor</span>(predicted_classes, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb157-1256"><a href="#cb157-1256" aria-hidden="true" tabindex="-1"></a>  confusion_matrices[[i]] <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">confusionMatrix</span>(predicted_classes, test<span class="sc">$</span>good)</span>
<span id="cb157-1257"><a href="#cb157-1257" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-1258"><a href="#cb157-1258" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute Kappa value</span></span>
<span id="cb157-1259"><a href="#cb157-1259" aria-hidden="true" tabindex="-1"></a>  kappa[i] <span class="ot">&lt;-</span> confusion_matrices[[i]]<span class="sc">$</span>overall[[<span class="dv">2</span>]]</span>
<span id="cb157-1260"><a href="#cb157-1260" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-1261"><a href="#cb157-1261" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Print the error rates for each fold</span></span>
<span id="cb157-1262"><a href="#cb157-1262" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"Fold "</span>, i, <span class="st">": "</span>, <span class="st">"OER:"</span>, error_rate[i], <span class="st">" RMSE:"</span>, rmse[i], <span class="st">" MAE:"</span>, mae[i], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb157-1263"><a href="#cb157-1263" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb157-1264"><a href="#cb157-1264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1265"><a href="#cb157-1265" aria-hidden="true" tabindex="-1"></a>best_confmat_index <span class="ot">&lt;-</span> <span class="fu">which.min</span>(error_rate)</span>
<span id="cb157-1266"><a href="#cb157-1266" aria-hidden="true" tabindex="-1"></a>best_confmat_index</span>
<span id="cb157-1267"><a href="#cb157-1267" aria-hidden="true" tabindex="-1"></a>best_confmat_indexi <span class="ot">&lt;-</span> <span class="fu">which.min</span>(rmse)</span>
<span id="cb157-1268"><a href="#cb157-1268" aria-hidden="true" tabindex="-1"></a>best_confmat_index</span>
<span id="cb157-1269"><a href="#cb157-1269" aria-hidden="true" tabindex="-1"></a>best_confmat_index <span class="ot">&lt;-</span> <span class="fu">which.min</span>(mae)</span>
<span id="cb157-1270"><a href="#cb157-1270" aria-hidden="true" tabindex="-1"></a>best_confmat_index</span>
<span id="cb157-1271"><a href="#cb157-1271" aria-hidden="true" tabindex="-1"></a>confusion_matrices[best_confmat_index]</span>
<span id="cb157-1272"><a href="#cb157-1272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1273"><a href="#cb157-1273" aria-hidden="true" tabindex="-1"></a><span class="co">#AUC and Performance Plot</span></span>
<span id="cb157-1274"><a href="#cb157-1274" aria-hidden="true" tabindex="-1"></a>predicted_classes <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(predicted_classes)</span>
<span id="cb157-1275"><a href="#cb157-1275" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(predicted_classes, test<span class="sc">$</span>good)</span>
<span id="cb157-1276"><a href="#cb157-1276" aria-hidden="true" tabindex="-1"></a>lda.perf <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj,<span class="st">"tpr"</span>,<span class="st">"fpr"</span>)</span>
<span id="cb157-1277"><a href="#cb157-1277" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb157-1278"><a href="#cb157-1278" aria-hidden="true" tabindex="-1"></a>auc_val</span>
<span id="cb157-1279"><a href="#cb157-1279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1280"><a href="#cb157-1280" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lda.perf, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb157-1281"><a href="#cb157-1281" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb157-1282"><a href="#cb157-1282" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb157-1283"><a href="#cb157-1283" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"MASS::lda ROC Curves"</span>)</span>
<span id="cb157-1284"><a href="#cb157-1284" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb157-1285"><a href="#cb157-1285" aria-hidden="true" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(lda.perf<span class="sc">@</span>x.values))</span>
<span id="cb157-1286"><a href="#cb157-1286" aria-hidden="true" tabindex="-1"></a>y_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(lda.perf<span class="sc">@</span>y.values))</span>
<span id="cb157-1287"><a href="#cb157-1287" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> x_values, <span class="at">y =</span> y_values, </span>
<span id="cb157-1288"><a href="#cb157-1288" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">rgb</span>(<span class="fl">0.3803922</span>, <span class="fl">0.6862745</span>, <span class="fl">0.9372549</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb157-1289"><a href="#cb157-1289" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb157-1290"><a href="#cb157-1290" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fu">paste</span>(<span class="st">"AUC ="</span>, <span class="fu">round</span>(auc_val, <span class="dv">4</span>)), <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span>
<span id="cb157-1291"><a href="#cb157-1291" aria-hidden="true" tabindex="-1"></a>lda.kfoldCV_MASS.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb157-1292"><a href="#cb157-1292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1293"><a href="#cb157-1293" aria-hidden="true" tabindex="-1"></a>lda_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">k =</span> <span class="dv">1</span><span class="sc">:</span>k,</span>
<span id="cb157-1294"><a href="#cb157-1294" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Accuracy =</span> <span class="dv">1</span><span class="sc">-</span>error_rate, </span>
<span id="cb157-1295"><a href="#cb157-1295" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Kappa =</span> kappa)</span>
<span id="cb157-1296"><a href="#cb157-1296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1297"><a href="#cb157-1297" aria-hidden="true" tabindex="-1"></a>lda.kfoldCV_MASS.plot <span class="ot">&lt;-</span> <span class="fu">accu.kappa.plot</span>(lda_df) <span class="sc">+</span> </span>
<span id="cb157-1298"><a href="#cb157-1298" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb157-1299"><a href="#cb157-1299" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">label =</span> <span class="fu">round</span>(Kappa, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb157-1300"><a href="#cb157-1300" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"MASS::lda Model Performance (10-Fold CV)"</span>)</span>
<span id="cb157-1301"><a href="#cb157-1301" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-1302"><a href="#cb157-1302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1303"><a href="#cb157-1303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1304"><a href="#cb157-1304" aria-hidden="true" tabindex="-1"></a>| Resampling Method | Error Rate | Sensitivity | Specificity | AUC       |</span>
<span id="cb157-1305"><a href="#cb157-1305" aria-hidden="true" tabindex="-1"></a>| ----------------- | ---------- | ----------- | ----------- | --------- |</span>
<span id="cb157-1306"><a href="#cb157-1306" aria-hidden="true" tabindex="-1"></a>| LDA (<span class="in">`caret`</span>)     | 0.1919     | 0.9283      | 0.3305      | 0.6294448 |</span>
<span id="cb157-1307"><a href="#cb157-1307" aria-hidden="true" tabindex="-1"></a>| LDA (<span class="in">`MASS`</span>)      | 0.1591     | 0.9969      | 0.1143      | 0.5488133 |</span>
<span id="cb157-1308"><a href="#cb157-1308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1309"><a href="#cb157-1309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1310"><a href="#cb157-1310" aria-hidden="true" tabindex="-1"></a><span class="fu">### Quadratic discriminant analysis</span></span>
<span id="cb157-1311"><a href="#cb157-1311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1312"><a href="#cb157-1312" aria-hidden="true" tabindex="-1"></a><span class="fu">#### K-fold CV (`caret`)</span></span>
<span id="cb157-1313"><a href="#cb157-1313" aria-hidden="true" tabindex="-1"></a><span class="in">```{r qda.model_savings, eval=FALSE}</span></span>
<span id="cb157-1314"><a href="#cb157-1314" aria-hidden="true" tabindex="-1"></a><span class="co">#---------------------------#</span></span>
<span id="cb157-1315"><a href="#cb157-1315" aria-hidden="true" tabindex="-1"></a><span class="co">#----Model Construction-----#</span></span>
<span id="cb157-1316"><a href="#cb157-1316" aria-hidden="true" tabindex="-1"></a><span class="co">#---------------------------#</span></span>
<span id="cb157-1317"><a href="#cb157-1317" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb157-1318"><a href="#cb157-1318" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">10</span>)</span>
<span id="cb157-1319"><a href="#cb157-1319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1320"><a href="#cb157-1320" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb157-1321"><a href="#cb157-1321" aria-hidden="true" tabindex="-1"></a>qda_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb157-1322"><a href="#cb157-1322" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train, </span>
<span id="cb157-1323"><a href="#cb157-1323" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"qda"</span>, </span>
<span id="cb157-1324"><a href="#cb157-1324" aria-hidden="true" tabindex="-1"></a>                   <span class="at">trControl =</span> train_control)</span>
<span id="cb157-1325"><a href="#cb157-1325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1326"><a href="#cb157-1326" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(qda_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">qda.model_kfoldCV.Rdata"</span>)</span>
<span id="cb157-1327"><a href="#cb157-1327" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-1328"><a href="#cb157-1328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1329"><a href="#cb157-1329" aria-hidden="true" tabindex="-1"></a><span class="in">```{r qda.kfoldCV_caret, fig.show='hide'}</span></span>
<span id="cb157-1330"><a href="#cb157-1330" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">qda.model_kfoldCV.Rdata"</span>)</span>
<span id="cb157-1331"><a href="#cb157-1331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1332"><a href="#cb157-1332" aria-hidden="true" tabindex="-1"></a>qda.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(qda_model, <span class="at">newdata =</span> test)</span>
<span id="cb157-1333"><a href="#cb157-1333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1334"><a href="#cb157-1334" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(qda.predictions, test<span class="sc">$</span>good)</span>
<span id="cb157-1335"><a href="#cb157-1335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1336"><a href="#cb157-1336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1337"><a href="#cb157-1337" aria-hidden="true" tabindex="-1"></a>qda.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(qda.predictions)</span>
<span id="cb157-1338"><a href="#cb157-1338" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(qda.predictions, test<span class="sc">$</span>good)</span>
<span id="cb157-1339"><a href="#cb157-1339" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the RMSE and MAE</span></span>
<span id="cb157-1340"><a href="#cb157-1340" aria-hidden="true" tabindex="-1"></a>RMSE <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">RMSE</span>(<span class="fu">as.numeric</span>(<span class="fu">unlist</span>(pred_obj<span class="sc">@</span>predictions)), <span class="fu">as.numeric</span>(test<span class="sc">$</span>good))</span>
<span id="cb157-1341"><a href="#cb157-1341" aria-hidden="true" tabindex="-1"></a>MAE <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">MAE</span>(<span class="fu">as.numeric</span>(<span class="fu">unlist</span>(pred_obj<span class="sc">@</span>predictions)), <span class="fu">as.numeric</span>(test<span class="sc">$</span>good))</span>
<span id="cb157-1342"><a href="#cb157-1342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1343"><a href="#cb157-1343" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute AUC value</span></span>
<span id="cb157-1344"><a href="#cb157-1344" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb157-1345"><a href="#cb157-1345" aria-hidden="true" tabindex="-1"></a>auc_val</span>
<span id="cb157-1346"><a href="#cb157-1346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1347"><a href="#cb157-1347" aria-hidden="true" tabindex="-1"></a>qda.perf <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb157-1348"><a href="#cb157-1348" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(qda.perf, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb157-1349"><a href="#cb157-1349" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb157-1350"><a href="#cb157-1350" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb157-1351"><a href="#cb157-1351" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"caret::glm ROC Curves"</span>)</span>
<span id="cb157-1352"><a href="#cb157-1352" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb157-1353"><a href="#cb157-1353" aria-hidden="true" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(qda.perf<span class="sc">@</span>x.values))</span>
<span id="cb157-1354"><a href="#cb157-1354" aria-hidden="true" tabindex="-1"></a>y_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(qda.perf<span class="sc">@</span>y.values))</span>
<span id="cb157-1355"><a href="#cb157-1355" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> x_values, <span class="at">y =</span> y_values, </span>
<span id="cb157-1356"><a href="#cb157-1356" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">rgb</span>(<span class="fl">0.3803922</span>, <span class="fl">0.6862745</span>, <span class="fl">0.9372549</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb157-1357"><a href="#cb157-1357" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb157-1358"><a href="#cb157-1358" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fu">paste</span>(<span class="st">"AUC ="</span>, <span class="fu">round</span>(auc_val, <span class="dv">4</span>)), <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span>
<span id="cb157-1359"><a href="#cb157-1359" aria-hidden="true" tabindex="-1"></a>qda.kfoldCV_caret.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb157-1360"><a href="#cb157-1360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1361"><a href="#cb157-1361" aria-hidden="true" tabindex="-1"></a>qda_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">k =</span> <span class="dv">1</span><span class="sc">:</span>k,</span>
<span id="cb157-1362"><a href="#cb157-1362" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Accuracy =</span> qda_model<span class="sc">$</span>results<span class="sc">$</span>Accuracy,</span>
<span id="cb157-1363"><a href="#cb157-1363" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Kappa =</span> qda_model<span class="sc">$</span>results<span class="sc">$</span>Kappa)</span>
<span id="cb157-1364"><a href="#cb157-1364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1365"><a href="#cb157-1365" aria-hidden="true" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(<span class="fu">data.frame</span>(<span class="st">"Error Rate"</span> <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> qda_model<span class="sc">$</span>results<span class="sc">$</span>Accuracy, </span>
<span id="cb157-1366"><a href="#cb157-1366" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"RMSE"</span> <span class="ot">=</span> RMSE, </span>
<span id="cb157-1367"><a href="#cb157-1367" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"MAE"</span> <span class="ot">=</span> MAE,</span>
<span id="cb157-1368"><a href="#cb157-1368" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Kappa"</span> <span class="ot">=</span> qda_model<span class="sc">$</span>results<span class="sc">$</span>Kappa), </span>
<span id="cb157-1369"><a href="#cb157-1369" aria-hidden="true" tabindex="-1"></a>               <span class="at">caption =</span> <span class="st">"caret::qda Performance (10-fold CV)"</span>)</span>
<span id="cb157-1370"><a href="#cb157-1370" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-1371"><a href="#cb157-1371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1372"><a href="#cb157-1372" aria-hidden="true" tabindex="-1"></a><span class="fu">#### K-fold CV (`MASS`)</span></span>
<span id="cb157-1373"><a href="#cb157-1373" aria-hidden="true" tabindex="-1"></a><span class="in">```{r qda.kfoldCV_MASS, fig.show='hide'}</span></span>
<span id="cb157-1374"><a href="#cb157-1374" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the number of folds</span></span>
<span id="cb157-1375"><a href="#cb157-1375" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb157-1376"><a href="#cb157-1376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1377"><a href="#cb157-1377" aria-hidden="true" tabindex="-1"></a><span class="co"># Randomly assign each row in the data to a fold</span></span>
<span id="cb157-1378"><a href="#cb157-1378" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>) <span class="co"># for reproducibility</span></span>
<span id="cb157-1379"><a href="#cb157-1379" aria-hidden="true" tabindex="-1"></a>fold_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>k, <span class="at">length.out =</span> <span class="fu">nrow</span>(wine.data_subset)))</span>
<span id="cb157-1380"><a href="#cb157-1380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1381"><a href="#cb157-1381" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize an empty list to store the folds</span></span>
<span id="cb157-1382"><a href="#cb157-1382" aria-hidden="true" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"list"</span>, k)</span>
<span id="cb157-1383"><a href="#cb157-1383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1384"><a href="#cb157-1384" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign each row to a fold</span></span>
<span id="cb157-1385"><a href="#cb157-1385" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb157-1386"><a href="#cb157-1386" aria-hidden="true" tabindex="-1"></a>  folds[[i]] <span class="ot">&lt;-</span> <span class="fu">which</span>(fold_indices <span class="sc">==</span> i)</span>
<span id="cb157-1387"><a href="#cb157-1387" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb157-1388"><a href="#cb157-1388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1389"><a href="#cb157-1389" aria-hidden="true" tabindex="-1"></a><span class="co">#To store the error rate of each fold</span></span>
<span id="cb157-1390"><a href="#cb157-1390" aria-hidden="true" tabindex="-1"></a>error_rate <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb157-1391"><a href="#cb157-1391" aria-hidden="true" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb157-1392"><a href="#cb157-1392" aria-hidden="true" tabindex="-1"></a>mae <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb157-1393"><a href="#cb157-1393" aria-hidden="true" tabindex="-1"></a>confusion_matrices <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"list"</span>, k)</span>
<span id="cb157-1394"><a href="#cb157-1394" aria-hidden="true" tabindex="-1"></a>kappa <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb157-1395"><a href="#cb157-1395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1396"><a href="#cb157-1396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1397"><a href="#cb157-1397" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each fold</span></span>
<span id="cb157-1398"><a href="#cb157-1398" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb157-1399"><a href="#cb157-1399" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the i-th fold as the testing set</span></span>
<span id="cb157-1400"><a href="#cb157-1400" aria-hidden="true" tabindex="-1"></a>  test_indices <span class="ot">&lt;-</span> <span class="fu">unlist</span>(folds[[i]])</span>
<span id="cb157-1401"><a href="#cb157-1401" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-1402"><a href="#cb157-1402" aria-hidden="true" tabindex="-1"></a>  test <span class="ot">&lt;-</span> wine.data_subset[test_indices, ]</span>
<span id="cb157-1403"><a href="#cb157-1403" aria-hidden="true" tabindex="-1"></a>  train <span class="ot">&lt;-</span> wine.data_subset[<span class="sc">-</span>test_indices, ]</span>
<span id="cb157-1404"><a href="#cb157-1404" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-1405"><a href="#cb157-1405" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fit the model on the training set</span></span>
<span id="cb157-1406"><a href="#cb157-1406" aria-hidden="true" tabindex="-1"></a>  qda_model <span class="ot">&lt;-</span> <span class="fu">qda</span>(good <span class="sc">~</span> ., <span class="at">data =</span> train, <span class="at">family =</span> binomial)</span>
<span id="cb157-1407"><a href="#cb157-1407" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-1408"><a href="#cb157-1408" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make predictions on the testing set and calculate the error rate</span></span>
<span id="cb157-1409"><a href="#cb157-1409" aria-hidden="true" tabindex="-1"></a>  qda.pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(qda_model, <span class="at">newdata =</span> test, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb157-1410"><a href="#cb157-1410" aria-hidden="true" tabindex="-1"></a>  predicted_classes <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(qda.pred<span class="sc">$</span>posterior[,<span class="dv">2</span>] <span class="sc">&gt;</span> <span class="fl">0.7</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb157-1411"><a href="#cb157-1411" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-1412"><a href="#cb157-1412" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute RMSE</span></span>
<span id="cb157-1413"><a href="#cb157-1413" aria-hidden="true" tabindex="-1"></a>  rmse[i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((predicted_classes <span class="sc">-</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>good)) <span class="sc">^</span> <span class="dv">2</span>))</span>
<span id="cb157-1414"><a href="#cb157-1414" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-1415"><a href="#cb157-1415" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute MAE</span></span>
<span id="cb157-1416"><a href="#cb157-1416" aria-hidden="true" tabindex="-1"></a>  mae[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(predicted_classes <span class="sc">-</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>good)))</span>
<span id="cb157-1417"><a href="#cb157-1417" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-1418"><a href="#cb157-1418" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute OER</span></span>
<span id="cb157-1419"><a href="#cb157-1419" aria-hidden="true" tabindex="-1"></a>  error_rate[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>((predicted_classes <span class="sc">&gt;</span> <span class="fl">0.7</span>) <span class="sc">!=</span> <span class="fu">as.numeric</span>(test<span class="sc">$</span>good))</span>
<span id="cb157-1420"><a href="#cb157-1420" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-1421"><a href="#cb157-1421" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute confusion matrix</span></span>
<span id="cb157-1422"><a href="#cb157-1422" aria-hidden="true" tabindex="-1"></a>  test<span class="sc">$</span>good <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(test<span class="sc">$</span>good)</span>
<span id="cb157-1423"><a href="#cb157-1423" aria-hidden="true" tabindex="-1"></a>  predicted_classes <span class="ot">&lt;-</span> <span class="fu">factor</span>(predicted_classes, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb157-1424"><a href="#cb157-1424" aria-hidden="true" tabindex="-1"></a>  confusion_matrices[[i]] <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">confusionMatrix</span>(predicted_classes, test<span class="sc">$</span>good)</span>
<span id="cb157-1425"><a href="#cb157-1425" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-1426"><a href="#cb157-1426" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute Kappa value</span></span>
<span id="cb157-1427"><a href="#cb157-1427" aria-hidden="true" tabindex="-1"></a>  kappa[i] <span class="ot">&lt;-</span> confusion_matrices[[i]]<span class="sc">$</span>overall[[<span class="dv">2</span>]]</span>
<span id="cb157-1428"><a href="#cb157-1428" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-1429"><a href="#cb157-1429" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Print the error rates for each fold</span></span>
<span id="cb157-1430"><a href="#cb157-1430" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"Fold "</span>, i, <span class="st">": "</span>, <span class="st">"OER:"</span>, error_rate[i], <span class="st">" RMSE:"</span>, rmse[i], <span class="st">" MAE:"</span>, mae[i], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb157-1431"><a href="#cb157-1431" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb157-1432"><a href="#cb157-1432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1433"><a href="#cb157-1433" aria-hidden="true" tabindex="-1"></a>best_confmat_index <span class="ot">&lt;-</span> <span class="fu">which.min</span>(error_rate)</span>
<span id="cb157-1434"><a href="#cb157-1434" aria-hidden="true" tabindex="-1"></a>best_confmat_index</span>
<span id="cb157-1435"><a href="#cb157-1435" aria-hidden="true" tabindex="-1"></a>best_confmat_indexi <span class="ot">&lt;-</span> <span class="fu">which.min</span>(rmse)</span>
<span id="cb157-1436"><a href="#cb157-1436" aria-hidden="true" tabindex="-1"></a>best_confmat_index</span>
<span id="cb157-1437"><a href="#cb157-1437" aria-hidden="true" tabindex="-1"></a>best_confmat_index <span class="ot">&lt;-</span> <span class="fu">which.min</span>(mae)</span>
<span id="cb157-1438"><a href="#cb157-1438" aria-hidden="true" tabindex="-1"></a>best_confmat_index</span>
<span id="cb157-1439"><a href="#cb157-1439" aria-hidden="true" tabindex="-1"></a>confusion_matrices[best_confmat_index]</span>
<span id="cb157-1440"><a href="#cb157-1440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1441"><a href="#cb157-1441" aria-hidden="true" tabindex="-1"></a><span class="co">#AUC and Performance Plot</span></span>
<span id="cb157-1442"><a href="#cb157-1442" aria-hidden="true" tabindex="-1"></a>predicted_classes <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(predicted_classes)</span>
<span id="cb157-1443"><a href="#cb157-1443" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(predicted_classes, test<span class="sc">$</span>good)</span>
<span id="cb157-1444"><a href="#cb157-1444" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb157-1445"><a href="#cb157-1445" aria-hidden="true" tabindex="-1"></a>qda.perf <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj,<span class="st">"tpr"</span>,<span class="st">"fpr"</span>)</span>
<span id="cb157-1446"><a href="#cb157-1446" aria-hidden="true" tabindex="-1"></a>auc_val</span>
<span id="cb157-1447"><a href="#cb157-1447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1448"><a href="#cb157-1448" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(qda.perf, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb157-1449"><a href="#cb157-1449" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb157-1450"><a href="#cb157-1450" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb157-1451"><a href="#cb157-1451" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"MASS::qda ROC Curves"</span>)</span>
<span id="cb157-1452"><a href="#cb157-1452" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb157-1453"><a href="#cb157-1453" aria-hidden="true" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(qda.perf<span class="sc">@</span>x.values))</span>
<span id="cb157-1454"><a href="#cb157-1454" aria-hidden="true" tabindex="-1"></a>y_values <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(qda.perf<span class="sc">@</span>y.values))</span>
<span id="cb157-1455"><a href="#cb157-1455" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> x_values, <span class="at">y =</span> y_values, </span>
<span id="cb157-1456"><a href="#cb157-1456" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">rgb</span>(<span class="fl">0.3803922</span>, <span class="fl">0.6862745</span>, <span class="fl">0.9372549</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>),</span>
<span id="cb157-1457"><a href="#cb157-1457" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb157-1458"><a href="#cb157-1458" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fu">paste</span>(<span class="st">"AUC ="</span>, <span class="fu">round</span>(auc_val, <span class="dv">4</span>)), <span class="at">srt =</span> <span class="dv">45</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span>
<span id="cb157-1459"><a href="#cb157-1459" aria-hidden="true" tabindex="-1"></a>qda.kfoldCV_MASS.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb157-1460"><a href="#cb157-1460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1461"><a href="#cb157-1461" aria-hidden="true" tabindex="-1"></a>qda_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">k =</span> <span class="dv">1</span><span class="sc">:</span>k,</span>
<span id="cb157-1462"><a href="#cb157-1462" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Accuracy =</span> <span class="dv">1</span><span class="sc">-</span>error_rate, </span>
<span id="cb157-1463"><a href="#cb157-1463" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Kappa =</span> kappa)</span>
<span id="cb157-1464"><a href="#cb157-1464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1465"><a href="#cb157-1465" aria-hidden="true" tabindex="-1"></a>qda.kfoldCV_MASS.plot <span class="ot">&lt;-</span> <span class="fu">accu.kappa.plot</span>(qda_df) <span class="sc">+</span> </span>
<span id="cb157-1466"><a href="#cb157-1466" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb157-1467"><a href="#cb157-1467" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">label =</span> <span class="fu">round</span>(Kappa, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb157-1468"><a href="#cb157-1468" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"MASS::qda Model Performance (10-Fold CV)"</span>)</span>
<span id="cb157-1469"><a href="#cb157-1469" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-1470"><a href="#cb157-1470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1471"><a href="#cb157-1471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1472"><a href="#cb157-1472" aria-hidden="true" tabindex="-1"></a>| Resampling Method | Error Rate | Sensitivity | Specificity | AUC       |</span>
<span id="cb157-1473"><a href="#cb157-1473" aria-hidden="true" tabindex="-1"></a>| ----------------- | ---------- | ----------- | ----------- | --------- |</span>
<span id="cb157-1474"><a href="#cb157-1474" aria-hidden="true" tabindex="-1"></a>| QDA (<span class="in">`caret`</span>)     | 0.2399     | 0.7743      | 0.7013      | 0.7377967 |</span>
<span id="cb157-1475"><a href="#cb157-1475" aria-hidden="true" tabindex="-1"></a>| QDA (<span class="in">`MASS`</span>)      | 0.1692     | 0.8934      | 0.5714      | 0.7324227 |</span>
<span id="cb157-1476"><a href="#cb157-1476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1477"><a href="#cb157-1477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1478"><a href="#cb157-1478" aria-hidden="true" tabindex="-1"></a><span class="fu">### Summary</span></span>
<span id="cb157-1479"><a href="#cb157-1479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1480"><a href="#cb157-1480" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.width=20, fig.height=15}</span></span>
<span id="cb157-1481"><a href="#cb157-1481" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(knn.kfoldCV.plot, </span>
<span id="cb157-1482"><a href="#cb157-1482" aria-hidden="true" tabindex="-1"></a>          logit.kfoldCV_MASS.plot,</span>
<span id="cb157-1483"><a href="#cb157-1483" aria-hidden="true" tabindex="-1"></a>          lda.kfoldCV_MASS.plot,</span>
<span id="cb157-1484"><a href="#cb157-1484" aria-hidden="true" tabindex="-1"></a>          qda.kfoldCV_MASS.plot,</span>
<span id="cb157-1485"><a href="#cb157-1485" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb157-1486"><a href="#cb157-1486" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-1487"><a href="#cb157-1487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1488"><a href="#cb157-1488" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.width=10, fig.height=10}</span></span>
<span id="cb157-1489"><a href="#cb157-1489" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(knn.kfoldCV.ROC.plot,</span>
<span id="cb157-1490"><a href="#cb157-1490" aria-hidden="true" tabindex="-1"></a>                   logit.kfoldCV_MASS.ROC.plot,</span>
<span id="cb157-1491"><a href="#cb157-1491" aria-hidden="true" tabindex="-1"></a>                   lda.kfoldCV_MASS.ROC.plot,</span>
<span id="cb157-1492"><a href="#cb157-1492" aria-hidden="true" tabindex="-1"></a>                   qda.kfoldCV_MASS.ROC.plot, </span>
<span id="cb157-1493"><a href="#cb157-1493" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">align =</span> <span class="st">"hv"</span>, <span class="at">scale =</span> <span class="fl">0.8</span>)</span>
<span id="cb157-1494"><a href="#cb157-1494" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-1495"><a href="#cb157-1495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-1496"><a href="#cb157-1496" aria-hidden="true" tabindex="-1"></a>| Resampling Method                                | Error Rate | Sensitivity | Specificity | AUC       |</span>
<span id="cb157-1497"><a href="#cb157-1497" aria-hidden="true" tabindex="-1"></a>| ------------------------------------------------ | ---------- | ----------- | ----------- | --------- |</span>
<span id="cb157-1498"><a href="#cb157-1498" aria-hidden="true" tabindex="-1"></a>| K-Fold CV                                        | 0.1692     | 0.9615      | 0.2775      | 0.6195157 |</span>
<span id="cb157-1499"><a href="#cb157-1499" aria-hidden="true" tabindex="-1"></a>| K-Fold CV (Tuned)                                | 0.1953     | 0.9750      | 0.0837      | 0.5293632 |</span>
<span id="cb157-1500"><a href="#cb157-1500" aria-hidden="true" tabindex="-1"></a>| Hold-out CV                                      | 0.1768     | 0.9563      | 0.2599      | 0.6081037 |</span>
<span id="cb157-1501"><a href="#cb157-1501" aria-hidden="true" tabindex="-1"></a>| Hold-out CV  (Tuned)                             | 0.1944     | 0.9886      | 0.03084     | 0.5096953 |</span>
<span id="cb157-1502"><a href="#cb157-1502" aria-hidden="true" tabindex="-1"></a>| LOOCV                                            | 0.1692     | 0.9605      | 0.2819      | 0.6211981 |</span>
<span id="cb157-1503"><a href="#cb157-1503" aria-hidden="true" tabindex="-1"></a>| LOOCV (Tuned)                                    | 0.1961     | 0.9740      | 0.0837      | 0.5288429 |</span>
<span id="cb157-1504"><a href="#cb157-1504" aria-hidden="true" tabindex="-1"></a>| Repeated CV                                      | 0.1069     | 0.9542      | 0.6344      | 0.7942878 |</span>
<span id="cb157-1505"><a href="#cb157-1505" aria-hidden="true" tabindex="-1"></a>| Repeated CV (Tuned)                              | 0.1204     | 0.9584      | 0.5463      | 0.7523161 |</span>
<span id="cb157-1506"><a href="#cb157-1506" aria-hidden="true" tabindex="-1"></a>|                                                  |            |             |             |           |</span>
<span id="cb157-1507"><a href="#cb157-1507" aria-hidden="true" tabindex="-1"></a>| Logistic Regression (<span class="in">`caret`</span>)                    | 0.1793     | 0.9324      | 0.3480      | 0.6401899 |</span>
<span id="cb157-1508"><a href="#cb157-1508" aria-hidden="true" tabindex="-1"></a>| Logistic Regression (<span class="in">`caret`</span> tuned with stepAIC) | 0.1801     | 0.99272     | 0.0881      | 0.5404108 |</span>
<span id="cb157-1509"><a href="#cb157-1509" aria-hidden="true" tabindex="-1"></a>| Logistic Regression (<span class="in">`MASS`</span> K-fold CV)           | 0.1616     | 1.00000     | 0.0857      | 0.5438871 |</span>
<span id="cb157-1510"><a href="#cb157-1510" aria-hidden="true" tabindex="-1"></a>| Logistic Regression (<span class="in">`MASS`</span> Hold-out CV)         | 0.1894     | 0.9884      | 0.1046      | 0.5465057 |</span>
<span id="cb157-1511"><a href="#cb157-1511" aria-hidden="true" tabindex="-1"></a>|                                                  |            |             |             |           |</span>
<span id="cb157-1512"><a href="#cb157-1512" aria-hidden="true" tabindex="-1"></a>| LDA (<span class="in">`caret`</span>)                                    | 0.1919     | 0.9283      | 0.3305      | 0.6294448 |</span>
<span id="cb157-1513"><a href="#cb157-1513" aria-hidden="true" tabindex="-1"></a>| LDA (<span class="in">`MASS`</span>)                                     | 0.1591     | 0.9969      | 0.1143      | 0.5488133 |</span>
<span id="cb157-1514"><a href="#cb157-1514" aria-hidden="true" tabindex="-1"></a>|                                                  |            |             |             |           |</span>
<span id="cb157-1515"><a href="#cb157-1515" aria-hidden="true" tabindex="-1"></a>| QDA (<span class="in">`caret`</span>)                                    | 0.2399     | 0.7743      | 0.7013      | 0.7377967 |</span>
<span id="cb157-1516"><a href="#cb157-1516" aria-hidden="true" tabindex="-1"></a>| QDA (<span class="in">`MASS`</span>)                                     | 0.1692     | 0.8934      | 0.5714      | 0.7324227 |</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



<script src="Sang_files/libs/quarto-html/zenscroll-min.js"></script>
</body></html>