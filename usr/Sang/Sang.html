<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Introduction to Statistical Learning</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Sang_files/libs/clipboard/clipboard.min.js"></script>
<script src="Sang_files/libs/quarto-html/quarto.js"></script>
<script src="Sang_files/libs/quarto-html/popper.min.js"></script>
<script src="Sang_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Sang_files/libs/quarto-html/anchor.min.js"></script>
<link href="Sang_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Sang_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="Sang_files/libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="Sang_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Sang_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Sang_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="Sang_files/libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<style>html{ scroll-behavior: smooth; }</style>

<link href="Sang_files/libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="Sang_files/libs/pagedtable-1.1/js/pagedtable.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of Contents</h2>
   
  <ul>
  <li><a href="#preamble" id="toc-preamble" class="nav-link active" data-scroll-target="#preamble">Preamble</a>
  <ul>
  <li><a href="#problem-statements" id="toc-problem-statements" class="nav-link" data-scroll-target="#problem-statements">Problem Statements</a></li>
  <li><a href="#methodologies" id="toc-methodologies" class="nav-link" data-scroll-target="#methodologies">Methodologies</a></li>
  <li><a href="#data-description" id="toc-data-description" class="nav-link" data-scroll-target="#data-description">Data Description</a></li>
  </ul></li>
  <li><a href="#exploratory-analysis" id="toc-exploratory-analysis" class="nav-link" data-scroll-target="#exploratory-analysis">Exploratory Analysis</a>
  <ul>
  <li><a href="#data-import" id="toc-data-import" class="nav-link" data-scroll-target="#data-import">Data Import</a></li>
  <li><a href="#data-analysis" id="toc-data-analysis" class="nav-link" data-scroll-target="#data-analysis">Data Analysis</a></li>
  <li><a href="#data-histograms" id="toc-data-histograms" class="nav-link" data-scroll-target="#data-histograms">Data Histograms</a></li>
  <li><a href="#data-relationships" id="toc-data-relationships" class="nav-link" data-scroll-target="#data-relationships">Data Relationships</a></li>
  <li><a href="#data-split" id="toc-data-split" class="nav-link" data-scroll-target="#data-split">Data Split</a></li>
  </ul></li>
  <li><a href="#k-nearest-neightbor" id="toc-k-nearest-neightbor" class="nav-link" data-scroll-target="#k-nearest-neightbor">K-Nearest Neightbor</a>
  <ul>
  <li><a href="#model-construction" id="toc-model-construction" class="nav-link" data-scroll-target="#model-construction">Model Construction</a></li>
  <li><a href="#k-fold-cv" id="toc-k-fold-cv" class="nav-link" data-scroll-target="#k-fold-cv">K-fold CV</a>
  <ul class="collapse">
  <li><a href="#tuned" id="toc-tuned" class="nav-link" data-scroll-target="#tuned">Tuned</a></li>
  </ul></li>
  <li><a href="#hold-out-cv-validation-set-approach" id="toc-hold-out-cv-validation-set-approach" class="nav-link" data-scroll-target="#hold-out-cv-validation-set-approach">Hold-out CV (Validation Set Approach)</a>
  <ul class="collapse">
  <li><a href="#tuned-1" id="toc-tuned-1" class="nav-link" data-scroll-target="#tuned-1">Tuned</a></li>
  </ul></li>
  <li><a href="#loocv" id="toc-loocv" class="nav-link" data-scroll-target="#loocv">LOOCV</a>
  <ul class="collapse">
  <li><a href="#tuned-2" id="toc-tuned-2" class="nav-link" data-scroll-target="#tuned-2">Tuned</a></li>
  </ul></li>
  <li><a href="#repeated-cv" id="toc-repeated-cv" class="nav-link" data-scroll-target="#repeated-cv">Repeated CV</a>
  <ul class="collapse">
  <li><a href="#tuned-3" id="toc-tuned-3" class="nav-link" data-scroll-target="#tuned-3">Tuned</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul></li>
  <li><a href="#logistic-regression" id="toc-logistic-regression" class="nav-link" data-scroll-target="#logistic-regression">Logistic Regression</a>
  <ul>
  <li><a href="#model-construction-1" id="toc-model-construction-1" class="nav-link" data-scroll-target="#model-construction-1">Model Construction</a></li>
  <li><a href="#k-fold-cv-1" id="toc-k-fold-cv-1" class="nav-link" data-scroll-target="#k-fold-cv-1">K-fold CV</a>
  <ul class="collapse">
  <li><a href="#tuned-4" id="toc-tuned-4" class="nav-link" data-scroll-target="#tuned-4">Tuned</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#linear-discriminant-analysis" id="toc-linear-discriminant-analysis" class="nav-link" data-scroll-target="#linear-discriminant-analysis">Linear Discriminant Analysis</a>
  <ul>
  <li><a href="#model-construction-2" id="toc-model-construction-2" class="nav-link" data-scroll-target="#model-construction-2">Model Construction</a></li>
  <li><a href="#k-fold-cv-2" id="toc-k-fold-cv-2" class="nav-link" data-scroll-target="#k-fold-cv-2">K-fold CV</a>
  <ul class="collapse">
  <li><a href="#tuned-5" id="toc-tuned-5" class="nav-link" data-scroll-target="#tuned-5">Tuned</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#quadratic-discriminant-analysis" id="toc-quadratic-discriminant-analysis" class="nav-link" data-scroll-target="#quadratic-discriminant-analysis">Quadratic discriminant analysis</a>
  <ul>
  <li><a href="#model-construction-3" id="toc-model-construction-3" class="nav-link" data-scroll-target="#model-construction-3">Model Construction</a></li>
  <li><a href="#k-fold-cv-3" id="toc-k-fold-cv-3" class="nav-link" data-scroll-target="#k-fold-cv-3">K-fold CV</a>
  <ul class="collapse">
  <li><a href="#tuned-6" id="toc-tuned-6" class="nav-link" data-scroll-target="#tuned-6">Tuned</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#summary-1" id="toc-summary-1" class="nav-link" data-scroll-target="#summary-1">Summary</a></li>
  <li><a href="#multi-regression" id="toc-multi-regression" class="nav-link" data-scroll-target="#multi-regression">Multi Regression</a>
  <ul>
  <li><a href="#model-construction-4" id="toc-model-construction-4" class="nav-link" data-scroll-target="#model-construction-4">Model Construction</a></li>
  <li><a href="#k-fold-cv-4" id="toc-k-fold-cv-4" class="nav-link" data-scroll-target="#k-fold-cv-4">K-fold CV</a>
  <ul class="collapse">
  <li><a href="#tuned-7" id="toc-tuned-7" class="nav-link" data-scroll-target="#tuned-7">Tuned</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#naive-bayes" id="toc-naive-bayes" class="nav-link" data-scroll-target="#naive-bayes">Naive Bayes</a>
  <ul>
  <li><a href="#model-construction-5" id="toc-model-construction-5" class="nav-link" data-scroll-target="#model-construction-5">Model Construction</a></li>
  <li><a href="#k-fold-cv-5" id="toc-k-fold-cv-5" class="nav-link" data-scroll-target="#k-fold-cv-5">K-fold CV</a>
  <ul class="collapse">
  <li><a href="#tuned-8" id="toc-tuned-8" class="nav-link" data-scroll-target="#tuned-8">Tuned</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#decision-forest" id="toc-decision-forest" class="nav-link" data-scroll-target="#decision-forest">Decision Forest</a>
  <ul>
  <li><a href="#model-construction-6" id="toc-model-construction-6" class="nav-link" data-scroll-target="#model-construction-6">Model Construction</a></li>
  <li><a href="#k-fold-cv-6" id="toc-k-fold-cv-6" class="nav-link" data-scroll-target="#k-fold-cv-6">K-fold CV</a>
  <ul class="collapse">
  <li><a href="#tuned-9" id="toc-tuned-9" class="nav-link" data-scroll-target="#tuned-9">Tuned</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#classification-tree" id="toc-classification-tree" class="nav-link" data-scroll-target="#classification-tree">Classification Tree</a>
  <ul>
  <li><a href="#model-construction-7" id="toc-model-construction-7" class="nav-link" data-scroll-target="#model-construction-7">Model Construction</a></li>
  <li><a href="#k-fold-cv-7" id="toc-k-fold-cv-7" class="nav-link" data-scroll-target="#k-fold-cv-7">K-fold CV</a>
  <ul class="collapse">
  <li><a href="#tuned-10" id="toc-tuned-10" class="nav-link" data-scroll-target="#tuned-10">Tuned</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#regression-tree" id="toc-regression-tree" class="nav-link" data-scroll-target="#regression-tree">Regression Tree</a>
  <ul>
  <li><a href="#model-construction-8" id="toc-model-construction-8" class="nav-link" data-scroll-target="#model-construction-8">Model Construction</a></li>
  <li><a href="#k-fold-cv-8" id="toc-k-fold-cv-8" class="nav-link" data-scroll-target="#k-fold-cv-8">K-fold CV</a>
  <ul class="collapse">
  <li><a href="#tuned-11" id="toc-tuned-11" class="nav-link" data-scroll-target="#tuned-11">Tuned</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#randome-forest---classification" id="toc-randome-forest---classification" class="nav-link" data-scroll-target="#randome-forest---classification">Randome Forest - Classification</a>
  <ul>
  <li><a href="#model-construction-9" id="toc-model-construction-9" class="nav-link" data-scroll-target="#model-construction-9">Model Construction</a></li>
  <li><a href="#k-fold-cv-9" id="toc-k-fold-cv-9" class="nav-link" data-scroll-target="#k-fold-cv-9">K-fold CV</a>
  <ul class="collapse">
  <li><a href="#tuned-12" id="toc-tuned-12" class="nav-link" data-scroll-target="#tuned-12">Tuned</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#randome-forest---regression" id="toc-randome-forest---regression" class="nav-link" data-scroll-target="#randome-forest---regression">Randome Forest - Regression</a>
  <ul>
  <li><a href="#model-construction-10" id="toc-model-construction-10" class="nav-link" data-scroll-target="#model-construction-10">Model Construction</a></li>
  <li><a href="#k-fold-cv-10" id="toc-k-fold-cv-10" class="nav-link" data-scroll-target="#k-fold-cv-10">K-fold CV</a>
  <ul class="collapse">
  <li><a href="#tuned-13" id="toc-tuned-13" class="nav-link" data-scroll-target="#tuned-13">Tuned</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#boosting" id="toc-boosting" class="nav-link" data-scroll-target="#boosting">Boosting</a>
  <ul>
  <li><a href="#model-construction-11" id="toc-model-construction-11" class="nav-link" data-scroll-target="#model-construction-11">Model Construction</a></li>
  <li><a href="#k-fold-cv-11" id="toc-k-fold-cv-11" class="nav-link" data-scroll-target="#k-fold-cv-11">K-fold CV</a>
  <ul class="collapse">
  <li><a href="#tuned-14" id="toc-tuned-14" class="nav-link" data-scroll-target="#tuned-14">Tuned</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#bagging" id="toc-bagging" class="nav-link" data-scroll-target="#bagging">Bagging</a>
  <ul>
  <li><a href="#model-construction-12" id="toc-model-construction-12" class="nav-link" data-scroll-target="#model-construction-12">Model Construction</a></li>
  <li><a href="#k-fold-cv-12" id="toc-k-fold-cv-12" class="nav-link" data-scroll-target="#k-fold-cv-12">K-fold CV</a>
  <ul class="collapse">
  <li><a href="#tuned-15" id="toc-tuned-15" class="nav-link" data-scroll-target="#tuned-15">Tuned</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#svm" id="toc-svm" class="nav-link" data-scroll-target="#svm">SVM</a>
  <ul>
  <li><a href="#model-construction-13" id="toc-model-construction-13" class="nav-link" data-scroll-target="#model-construction-13">Model Construction</a></li>
  <li><a href="#k-fold-cv-13" id="toc-k-fold-cv-13" class="nav-link" data-scroll-target="#k-fold-cv-13">K-fold CV</a>
  <ul class="collapse">
  <li><a href="#tuned-16" id="toc-tuned-16" class="nav-link" data-scroll-target="#tuned-16">Tuned</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Introduction to Statistical Learning</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i></button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">STAT 387</p>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<div class="cell">

<style type="text/css">
body {
font-family: "Times New Roman";
font-size: 0.8em;
}

h2, .h2, h2.anchored, 
h3, .h3, h3.anchored,
.quarto-title, 
.quarto-title-meta {
text-align: center;
}

h2, .h2 {
font-size: 1.5em;
}

h3, .h3 {
font-size: 1.25em;
}

h4, .h4 {
font-size: 1em;
}

h5, .h5 {
font-size: 0.75em;
}

h6, .h6 {
font-size: 0.7em;
}

.quarto-title-meta {
display: block!important;
}

.quarto-title-meta-heading {
display: none;
}

.content {
width: 1000px;
}
.dropdown-menu {
font-size: 0.8rem;
}

code {
color: #61AFEF;
}

.btn {
border-color: #f8f9fa9e!important;
}

body.quarto-dark {
background-color: #282c34;

color: #d8dee9;

.pagedtable .even {
background-color: #3b4252!important;
}

p code:not(.sourceCode), li code:not(.sourceCode) {
background-color: #4c566a!important;
}
}

#quarto-code-tools-menu{
position: absolute;
}

.top-right {
position: fixed;
}

#TOC::before {
content: "";
display: block;
height: 141px;
margin: 20px 20px 20px 20px;
background-image: url("https://raw.githubusercontent.com/theRealLeif/STAT387/main/README.asset/Logo.svg");
background-size: contain;
background-position: center center;
background-repeat: no-repeat;
}

</style>
</div>
<section id="preamble" class="level2">
<h2 class="anchored" data-anchor-id="preamble">Preamble</h2>
<p>Consider the wine quality dataset from <a href="https://archive.ics.uci.edu/ml/datasets/Wine+Quality">UCI Machine Learning Respository</a>. We will focus only on the data concerning white wines (and not red wines). Dichotomize the <code>quality</code> variable as <code>good</code>, which takes the value 1 if quality â‰¥ 7 and the value 0, otherwise. We will take <code>good</code> as response and all the 11 physiochemical characteristics of the wines in the data as predictors.</p>
<section id="problem-statements" class="level3">
<h3 class="anchored" data-anchor-id="problem-statements">Problem Statements</h3>
<p>Use 10-fold cross-validation for estimating the test error rates below and compute the estimates using <code>caret</code> package with seed set to 1234 before each computation.</p>
<ol type="a">
<li>Fit a KNN with K chosen optimally using test error rate. Report error rate, sensitivity, specificity, and AUC for the optimal KNN based on the training data. Also, report its estimated test error rate.</li>
<li>Repeat (a) using logistic regression.</li>
<li>Repeat (a) using LDA.</li>
<li>Repeat (a) using QDA.</li>
<li>Compare the results in (a)-(d). Which classifier would you recommend? Justify your answer.</li>
</ol>
</section>
<section id="methodologies" class="level3">
<h3 class="anchored" data-anchor-id="methodologies">Methodologies</h3>
<ul>
<li>KNN</li>
<li>GLM/logit/glmnet</li>
<li>LDA</li>
<li>QDA</li>
<li>Regression/Multi-Regression</li>
<li>Naive Bayes</li>
<li>Decision Tree</li>
<li>Classification Tree</li>
<li>Regression Tree</li>
<li>Classification and Regression Trees (CART)</li>
<li>Iterative Dichotomiser 3 (ID3)</li>
<li>C4.5</li>
<li>Random Forest</li>
<li>Classification</li>
<li>Regression</li>
<li>Bagged</li>
<li>Boosted</li>
<li>Gradient Boosted Trees (GBT)</li>
<li>Extremely Randomized Trees (ExtraTrees)</li>
<li>SVM</li>
</ul>
</section>
<section id="data-description" class="level3">
<h3 class="anchored" data-anchor-id="data-description">Data Description</h3>
<p>This is a dataset of wine quality containing 4898 observations of 12 variables. The variables are:</p>
<ul>
<li><code>fixed.acidity</code>: The amount of fixed acid in the wine (<span class="math inline">\(g/dm^3\)</span>)</li>
<li><code>volatile.acidity</code>: The amount of volatile acid in the wine (<span class="math inline">\(g/dm^4\)</span>)</li>
<li><code>citric.acid</code>: The amount of citric acid in the wine (<span class="math inline">\(g/dm^3\)</span>)</li>
<li><code>residual.sugar</code>: The amount of residual sugar in the wine (<span class="math inline">\(g/dm^3\)</span>)</li>
<li><code>chlorides</code>: The amount of salt in the wine (<span class="math inline">\(g/dm^3\)</span>)</li>
<li><code>free.sulfur.dioxide</code>: The amount of free sulfur dioxide in the wine (<span class="math inline">\(mg/dm^3\)</span>)</li>
<li><code>total.sulfur.dioxide</code>: The amount of total sulfur dioxide in the wine (<span class="math inline">\(mg/dm^3\)</span>)</li>
<li><code>density</code>: The density of the wine (<span class="math inline">\(g/dm^3\)</span>)</li>
<li><code>pH</code>: The <span class="math inline">\(pH\)</span> value of the wine</li>
<li><code>sulphates</code>: The amount of sulphates in the wine (<span class="math inline">\(g/dm^3\)</span>)</li>
<li><code>alcohol</code>: The alcohol content of the wine (<span class="math inline">\(\% vol\)</span>)</li>
<li><code>quality</code>: The quality score of the wine (<span class="math inline">\(0-10\)</span>)</li>
</ul>
<p>After removing the duplicate rows from our data set, we are left with 3961 observations of the above 11 variables minus <code>quality</code> column variable, and introduced a new variable <code>good</code> as our response:</p>
<ul>
<li><code>good</code>: A binary variable indicating whether the wine is good (<code>quality</code> <span class="math inline">\(\geq 7\)</span>) or not (<code>quality</code> <span class="math inline">\(&lt;7\)</span>).</li>
</ul>
</section>
</section>
<section id="exploratory-analysis" class="level2">
<h2 class="anchored" data-anchor-id="exploratory-analysis">Exploratory Analysis</h2>
<section id="data-import" class="level3">
<h3 class="anchored" data-anchor-id="data-import">Data Import</h3>
<div class="cell">
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>wine.data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">winequality-white.csv"</span>, <span class="at">sep=</span><span class="st">";"</span>, <span class="at">header =</span> T)</span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a>wine.data <span class="ot">&lt;-</span>  wine.data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">good =</span> <span class="fu">ifelse</span>(quality<span class="sc">&gt;=</span><span class="dv">7</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb1-4"><a href="#cb1-4"></a></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="fu">head</span>(wine.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["fixed.acidity"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["volatile.acidity"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["citric.acid"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["residual.sugar"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["chlorides"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["free.sulfur.dioxide"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["total.sulfur.dioxide"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["density"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["pH"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["sulphates"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["alcohol"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["quality"],"name":[12],"type":["int"],"align":["right"]},{"label":["good"],"name":[13],"type":["dbl"],"align":["right"]}],"data":[{"1":"7.0","2":"0.27","3":"0.36","4":"20.7","5":"0.045","6":"45","7":"170","8":"1.0010","9":"3.00","10":"0.45","11":"8.8","12":"6","13":"0","_rn_":"1"},{"1":"6.3","2":"0.30","3":"0.34","4":"1.6","5":"0.049","6":"14","7":"132","8":"0.9940","9":"3.30","10":"0.49","11":"9.5","12":"6","13":"0","_rn_":"2"},{"1":"8.1","2":"0.28","3":"0.40","4":"6.9","5":"0.050","6":"30","7":"97","8":"0.9951","9":"3.26","10":"0.44","11":"10.1","12":"6","13":"0","_rn_":"3"},{"1":"7.2","2":"0.23","3":"0.32","4":"8.5","5":"0.058","6":"47","7":"186","8":"0.9956","9":"3.19","10":"0.40","11":"9.9","12":"6","13":"0","_rn_":"4"},{"1":"7.2","2":"0.23","3":"0.32","4":"8.5","5":"0.058","6":"47","7":"186","8":"0.9956","9":"3.19","10":"0.40","11":"9.9","12":"6","13":"0","_rn_":"5"},{"1":"8.1","2":"0.28","3":"0.40","4":"6.9","5":"0.050","6":"30","7":"97","8":"0.9951","9":"3.26","10":"0.44","11":"10.1","12":"6","13":"0","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="data-analysis" class="level3">
<h3 class="anchored" data-anchor-id="data-analysis">Data Analysis</h3>
<div class="cell">
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">dim</span>(wine.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4898   13</code></pre>
</div>
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># Removing duplicate Rows</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>wine.data <span class="ot">&lt;-</span> wine.data[<span class="sc">!</span><span class="fu">duplicated</span>(wine.data), ]</span>
<span id="cb4-3"><a href="#cb4-3"></a></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="fu">dim</span>(wine.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3961   13</code></pre>
</div>
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="fu">str</span>(wine.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   3961 obs. of  13 variables:
 $ fixed.acidity       : num  7 6.3 8.1 7.2 6.2 8.1 8.1 8.6 7.9 6.6 ...
 $ volatile.acidity    : num  0.27 0.3 0.28 0.23 0.32 0.22 0.27 0.23 0.18 0.16 ...
 $ citric.acid         : num  0.36 0.34 0.4 0.32 0.16 0.43 0.41 0.4 0.37 0.4 ...
 $ residual.sugar      : num  20.7 1.6 6.9 8.5 7 1.5 1.45 4.2 1.2 1.5 ...
 $ chlorides           : num  0.045 0.049 0.05 0.058 0.045 0.044 0.033 0.035 0.04 0.044 ...
 $ free.sulfur.dioxide : num  45 14 30 47 30 28 11 17 16 48 ...
 $ total.sulfur.dioxide: num  170 132 97 186 136 129 63 109 75 143 ...
 $ density             : num  1.001 0.994 0.995 0.996 0.995 ...
 $ pH                  : num  3 3.3 3.26 3.19 3.18 3.22 2.99 3.14 3.18 3.54 ...
 $ sulphates           : num  0.45 0.49 0.44 0.4 0.47 0.45 0.56 0.53 0.63 0.52 ...
 $ alcohol             : num  8.8 9.5 10.1 9.9 9.6 11 12 9.7 10.8 12.4 ...
 $ quality             : int  6 6 6 6 6 6 5 5 5 7 ...
 $ good                : num  0 0 0 0 0 0 0 0 0 1 ...</code></pre>
</div>
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="fu">summary</span>(wine.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> fixed.acidity    volatile.acidity  citric.acid     residual.sugar  
 Min.   : 3.800   Min.   :0.0800   Min.   :0.0000   Min.   : 0.600  
 1st Qu.: 6.300   1st Qu.:0.2100   1st Qu.:0.2700   1st Qu.: 1.600  
 Median : 6.800   Median :0.2600   Median :0.3200   Median : 4.700  
 Mean   : 6.839   Mean   :0.2805   Mean   :0.3343   Mean   : 5.915  
 3rd Qu.: 7.300   3rd Qu.:0.3300   3rd Qu.:0.3900   3rd Qu.: 8.900  
 Max.   :14.200   Max.   :1.1000   Max.   :1.6600   Max.   :65.800  
   chlorides       free.sulfur.dioxide total.sulfur.dioxide    density      
 Min.   :0.00900   Min.   :  2.00      Min.   :  9.0        Min.   :0.9871  
 1st Qu.:0.03500   1st Qu.: 23.00      1st Qu.:106.0        1st Qu.:0.9916  
 Median :0.04200   Median : 33.00      Median :133.0        Median :0.9935  
 Mean   :0.04591   Mean   : 34.89      Mean   :137.2        Mean   :0.9938  
 3rd Qu.:0.05000   3rd Qu.: 45.00      3rd Qu.:166.0        3rd Qu.:0.9957  
 Max.   :0.34600   Max.   :289.00      Max.   :440.0        Max.   :1.0390  
       pH          sulphates         alcohol         quality     
 Min.   :2.720   Min.   :0.2200   Min.   : 8.00   Min.   :3.000  
 1st Qu.:3.090   1st Qu.:0.4100   1st Qu.: 9.50   1st Qu.:5.000  
 Median :3.180   Median :0.4800   Median :10.40   Median :6.000  
 Mean   :3.195   Mean   :0.4904   Mean   :10.59   Mean   :5.855  
 3rd Qu.:3.290   3rd Qu.:0.5500   3rd Qu.:11.40   3rd Qu.:6.000  
 Max.   :3.820   Max.   :1.0800   Max.   :14.20   Max.   :9.000  
      good       
 Min.   :0.0000  
 1st Qu.:0.0000  
 Median :0.0000  
 Mean   :0.2083  
 3rd Qu.:0.0000  
 Max.   :1.0000  </code></pre>
</div>
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># Check for NAs in dataset</span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(wine.data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># Counts at each combination of response's factor levels</span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="fu">table</span>(wine.data<span class="sc">$</span>quality)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
   3    4    5    6    7    8    9 
  20  153 1175 1788  689  131    5 </code></pre>
</div>
</div>
</section>
<section id="data-histograms" class="level3">
<h3 class="anchored" data-anchor-id="data-histograms">Data Histograms</h3>
<div class="cell">
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>wine.colnames <span class="ot">&lt;-</span> <span class="fu">colnames</span>(wine.data[, <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>])</span>
<span id="cb14-2"><a href="#cb14-2"></a>num_plots     <span class="ot">&lt;-</span> <span class="fu">length</span>(wine.colnames)</span>
<span id="cb14-3"><a href="#cb14-3"></a>num_rows      <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(num_plots<span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb14-4"><a href="#cb14-4"></a></span>
<span id="cb14-5"><a href="#cb14-5"></a></span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="co"># Create an empty list to store plots</span></span>
<span id="cb14-7"><a href="#cb14-7"></a>grid_arr      <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb14-8"><a href="#cb14-8"></a></span>
<span id="cb14-9"><a href="#cb14-9"></a></span>
<span id="cb14-10"><a href="#cb14-10"></a><span class="co"># Loop over each column name in the wine.colnames vector</span></span>
<span id="cb14-11"><a href="#cb14-11"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_plots) {</span>
<span id="cb14-12"><a href="#cb14-12"></a>  <span class="co"># Create a ggplot object for the current column using aes</span></span>
<span id="cb14-13"><a href="#cb14-13"></a>  plt <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> wine.data, <span class="fu">aes_string</span>(<span class="at">x =</span> wine.colnames[i])) <span class="sc">+</span></span>
<span id="cb14-14"><a href="#cb14-14"></a>    <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fu">diff</span>(<span class="fu">range</span>(wine.data[[wine.colnames[i]]]))<span class="sc">/</span><span class="dv">30</span>, </span>
<span id="cb14-15"><a href="#cb14-15"></a>                   <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"slategray3"</span>) <span class="sc">+</span></span>
<span id="cb14-16"><a href="#cb14-16"></a>    <span class="fu">labs</span>(<span class="at">x =</span> wine.colnames[i], <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb14-17"><a href="#cb14-17"></a>    <span class="fu">theme_bw</span>()</span>
<span id="cb14-18"><a href="#cb14-18"></a>  </span>
<span id="cb14-19"><a href="#cb14-19"></a>  <span class="co"># Add the current plot to the grid_arr list</span></span>
<span id="cb14-20"><a href="#cb14-20"></a>  grid_arr[[i]] <span class="ot">&lt;-</span> plt</span>
<span id="cb14-21"><a href="#cb14-21"></a>}</span>
<span id="cb14-22"><a href="#cb14-22"></a></span>
<span id="cb14-23"><a href="#cb14-23"></a>grid_arr <span class="ot">&lt;-</span> <span class="fu">do.call</span>(gridExtra<span class="sc">::</span>grid.arrange, <span class="fu">c</span>(grid_arr, <span class="at">ncol =</span> <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Sang_files/figure-html/hist_plot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">

</div>
</section>
<section id="data-relationships" class="level3">
<h3 class="anchored" data-anchor-id="data-relationships">Data Relationships</h3>
<div class="cell">
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>reshape2<span class="sc">::</span><span class="fu">melt</span>(wine.data[, <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>], <span class="st">"quality"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb15-2"><a href="#cb15-2"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(value, quality, <span class="at">color =</span> variable)) <span class="sc">+</span>  </span>
<span id="cb15-3"><a href="#cb15-3"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb15-4"><a href="#cb15-4"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(value,quality, <span class="at">colour=</span>variable), <span class="at">method=</span>lm, <span class="at">se=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb15-5"><a href="#cb15-5"></a>  <span class="fu">facet_wrap</span>(.<span class="sc">~</span>variable, <span class="at">scales =</span> <span class="st">"free"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Sang_files/figure-html/relation_plot-1.png" class="img-fluid" width="960"></p>
</div>
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="co"># Collinearity between Attributes</span></span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="fu">cor</span>(wine.data) <span class="sc">%&gt;%</span> </span>
<span id="cb16-3"><a href="#cb16-3"></a>  corrplot<span class="sc">::</span><span class="fu">corrplot</span>(<span class="at">method =</span> <span class="st">'number'</span>,  <span class="at">type =</span> <span class="st">"lower"</span>, <span class="at">tl.col =</span> <span class="st">"steelblue"</span>, <span class="at">number.cex =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Sang_files/figure-html/relation_plot-2.png" class="img-fluid" width="960"></p>
</div>
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co"># Remove quality from dataset, use good as response </span></span>
<span id="cb17-2"><a href="#cb17-2"></a>wine.data<span class="sc">$</span>quality <span class="ot">&lt;-</span> <span class="cn">NULL</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="data-split" class="level3">
<h3 class="anchored" data-anchor-id="data-split">Data Split</h3>
<div class="cell">
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="co"># Splitting the dataset into train and test (7/10th for train remaining for test)</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>inTrain <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">createDataPartition</span>(wine.data<span class="sc">$</span>good, <span class="at">p =</span> <span class="dv">7</span><span class="sc">/</span><span class="dv">10</span>, <span class="at">list =</span> F)</span>
<span id="cb18-3"><a href="#cb18-3"></a>train <span class="ot">&lt;-</span> wine.data[inTrain,]</span>
<span id="cb18-4"><a href="#cb18-4"></a>test <span class="ot">&lt;-</span> wine.data[<span class="sc">-</span>inTrain,]</span>
<span id="cb18-5"><a href="#cb18-5"></a></span>
<span id="cb18-6"><a href="#cb18-6"></a></span>
<span id="cb18-7"><a href="#cb18-7"></a><span class="co"># Convert the outcome variable to a factor with two levels</span></span>
<span id="cb18-8"><a href="#cb18-8"></a>train<span class="sc">$</span>good <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(train<span class="sc">$</span>good)</span>
<span id="cb18-9"><a href="#cb18-9"></a>test<span class="sc">$</span>good <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(test<span class="sc">$</span>good)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="k-nearest-neightbor" class="level2">
<h2 class="anchored" data-anchor-id="k-nearest-neightbor">K-Nearest Neightbor</h2>
<section id="model-construction" class="level3">
<h3 class="anchored" data-anchor-id="model-construction">Model Construction</h3>
<div class="cell">
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co">#--------------------#</span></span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="co">#-----K-fold CV------#</span></span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="co">#--------------------#</span></span>
<span id="cb19-4"><a href="#cb19-4"></a></span>
<span id="cb19-5"><a href="#cb19-5"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb19-6"><a href="#cb19-6"></a><span class="co"># Define the training control object for 10-fold cross-validation</span></span>
<span id="cb19-7"><a href="#cb19-7"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">10</span>)</span>
<span id="cb19-8"><a href="#cb19-8"></a></span>
<span id="cb19-9"><a href="#cb19-9"></a><span class="co"># Train the KNN model using 10-fold cross-validation</span></span>
<span id="cb19-10"><a href="#cb19-10"></a><span class="co"># tuneLength argument to specify the range of values of K to be considered for tuning</span></span>
<span id="cb19-11"><a href="#cb19-11"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb19-12"><a href="#cb19-12"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb19-13"><a href="#cb19-13"></a>                   <span class="at">data =</span> train, </span>
<span id="cb19-14"><a href="#cb19-14"></a>                   <span class="at">method =</span> <span class="st">"knn"</span>, </span>
<span id="cb19-15"><a href="#cb19-15"></a>                   <span class="at">trControl =</span> train_control)</span>
<span id="cb19-16"><a href="#cb19-16"></a></span>
<span id="cb19-17"><a href="#cb19-17"></a><span class="co"># Save the model into .Rdata for future import </span></span>
<span id="cb19-18"><a href="#cb19-18"></a><span class="fu">save</span>(knn_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_kfoldCV.Rdata"</span>)</span>
<span id="cb19-19"><a href="#cb19-19"></a></span>
<span id="cb19-20"><a href="#cb19-20"></a></span>
<span id="cb19-21"><a href="#cb19-21"></a><span class="co">#--------------------------#</span></span>
<span id="cb19-22"><a href="#cb19-22"></a><span class="co">#-----K-fold CV (Mod)------#</span></span>
<span id="cb19-23"><a href="#cb19-23"></a><span class="co">#--------------------------#</span></span>
<span id="cb19-24"><a href="#cb19-24"></a></span>
<span id="cb19-25"><a href="#cb19-25"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb19-26"><a href="#cb19-26"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">10</span>)</span>
<span id="cb19-27"><a href="#cb19-27"></a></span>
<span id="cb19-28"><a href="#cb19-28"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb19-29"><a href="#cb19-29"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb19-30"><a href="#cb19-30"></a>                   <span class="at">data =</span> train, </span>
<span id="cb19-31"><a href="#cb19-31"></a>                   <span class="at">method =</span> <span class="st">"knn"</span>, </span>
<span id="cb19-32"><a href="#cb19-32"></a>                   <span class="at">trControl =</span> train_control, </span>
<span id="cb19-33"><a href="#cb19-33"></a>                   <span class="at">tuneLength =</span> <span class="dv">10</span>)</span>
<span id="cb19-34"><a href="#cb19-34"></a></span>
<span id="cb19-35"><a href="#cb19-35"></a><span class="co"># Save the model into .Rdata for future import </span></span>
<span id="cb19-36"><a href="#cb19-36"></a><span class="fu">save</span>(knn_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_kfoldCV_mod.Rdata"</span>)</span>
<span id="cb19-37"><a href="#cb19-37"></a></span>
<span id="cb19-38"><a href="#cb19-38"></a></span>
<span id="cb19-39"><a href="#cb19-39"></a><span class="co">#--------------------#</span></span>
<span id="cb19-40"><a href="#cb19-40"></a><span class="co">#----Hold-out CV-----#</span></span>
<span id="cb19-41"><a href="#cb19-41"></a><span class="co">#--------------------#</span></span>
<span id="cb19-42"><a href="#cb19-42"></a></span>
<span id="cb19-43"><a href="#cb19-43"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb19-44"><a href="#cb19-44"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"none"</span>,)</span>
<span id="cb19-45"><a href="#cb19-45"></a></span>
<span id="cb19-46"><a href="#cb19-46"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb19-47"><a href="#cb19-47"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb19-48"><a href="#cb19-48"></a>                   <span class="at">data =</span> train, </span>
<span id="cb19-49"><a href="#cb19-49"></a>                   <span class="at">method =</span> <span class="st">"knn"</span>)</span>
<span id="cb19-50"><a href="#cb19-50"></a></span>
<span id="cb19-51"><a href="#cb19-51"></a><span class="fu">save</span>(knn_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_holdoutCV.Rdata"</span>)</span>
<span id="cb19-52"><a href="#cb19-52"></a></span>
<span id="cb19-53"><a href="#cb19-53"></a></span>
<span id="cb19-54"><a href="#cb19-54"></a><span class="co">#--------------------------#</span></span>
<span id="cb19-55"><a href="#cb19-55"></a><span class="co">#----Hold-out CV (Mod)-----#</span></span>
<span id="cb19-56"><a href="#cb19-56"></a><span class="co">#--------------------------#</span></span>
<span id="cb19-57"><a href="#cb19-57"></a></span>
<span id="cb19-58"><a href="#cb19-58"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb19-59"><a href="#cb19-59"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"none"</span>,)</span>
<span id="cb19-60"><a href="#cb19-60"></a></span>
<span id="cb19-61"><a href="#cb19-61"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb19-62"><a href="#cb19-62"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb19-63"><a href="#cb19-63"></a>                   <span class="at">data =</span> train, </span>
<span id="cb19-64"><a href="#cb19-64"></a>                   <span class="at">method =</span> <span class="st">"knn"</span>,</span>
<span id="cb19-65"><a href="#cb19-65"></a>                   <span class="at">tuneGrid =</span> <span class="fu">expand.grid</span>(<span class="at">k=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>))</span>
<span id="cb19-66"><a href="#cb19-66"></a></span>
<span id="cb19-67"><a href="#cb19-67"></a><span class="fu">save</span>(knn_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_holdoutCV_mod.Rdata"</span>)</span>
<span id="cb19-68"><a href="#cb19-68"></a></span>
<span id="cb19-69"><a href="#cb19-69"></a></span>
<span id="cb19-70"><a href="#cb19-70"></a><span class="co">#--------------------#</span></span>
<span id="cb19-71"><a href="#cb19-71"></a><span class="co">#-------LOOCV--------#</span></span>
<span id="cb19-72"><a href="#cb19-72"></a><span class="co">#--------------------#</span></span>
<span id="cb19-73"><a href="#cb19-73"></a></span>
<span id="cb19-74"><a href="#cb19-74"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb19-75"><a href="#cb19-75"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"LOOCV"</span>)</span>
<span id="cb19-76"><a href="#cb19-76"></a></span>
<span id="cb19-77"><a href="#cb19-77"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb19-78"><a href="#cb19-78"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb19-79"><a href="#cb19-79"></a>                   <span class="at">data =</span> train, </span>
<span id="cb19-80"><a href="#cb19-80"></a>                   <span class="at">method =</span> <span class="st">"knn"</span>, </span>
<span id="cb19-81"><a href="#cb19-81"></a>                   <span class="at">trControl =</span> train_control)</span>
<span id="cb19-82"><a href="#cb19-82"></a></span>
<span id="cb19-83"><a href="#cb19-83"></a><span class="fu">save</span>(knn_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_looCV.Rdata"</span>)</span>
<span id="cb19-84"><a href="#cb19-84"></a></span>
<span id="cb19-85"><a href="#cb19-85"></a></span>
<span id="cb19-86"><a href="#cb19-86"></a><span class="co">#--------------------------#</span></span>
<span id="cb19-87"><a href="#cb19-87"></a><span class="co">#-------LOOCV (Mod)--------#</span></span>
<span id="cb19-88"><a href="#cb19-88"></a><span class="co">#--------------------------#</span></span>
<span id="cb19-89"><a href="#cb19-89"></a></span>
<span id="cb19-90"><a href="#cb19-90"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb19-91"><a href="#cb19-91"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"LOOCV"</span>)</span>
<span id="cb19-92"><a href="#cb19-92"></a></span>
<span id="cb19-93"><a href="#cb19-93"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb19-94"><a href="#cb19-94"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb19-95"><a href="#cb19-95"></a>                   <span class="at">data =</span> train, </span>
<span id="cb19-96"><a href="#cb19-96"></a>                   <span class="at">method =</span> <span class="st">"knn"</span>, </span>
<span id="cb19-97"><a href="#cb19-97"></a>                   <span class="at">trControl =</span> train_control,</span>
<span id="cb19-98"><a href="#cb19-98"></a>                   <span class="at">tuneLength =</span> <span class="dv">10</span>,</span>
<span id="cb19-99"><a href="#cb19-99"></a>                   <span class="at">tuneGrid =</span> <span class="fu">expand.grid</span>(<span class="at">k =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>))</span>
<span id="cb19-100"><a href="#cb19-100"></a></span>
<span id="cb19-101"><a href="#cb19-101"></a><span class="fu">save</span>(knn_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_looCV_mod.Rdata"</span>)</span>
<span id="cb19-102"><a href="#cb19-102"></a></span>
<span id="cb19-103"><a href="#cb19-103"></a></span>
<span id="cb19-104"><a href="#cb19-104"></a><span class="co">#--------------------#</span></span>
<span id="cb19-105"><a href="#cb19-105"></a><span class="co">#----Repeated CV-----#</span></span>
<span id="cb19-106"><a href="#cb19-106"></a><span class="co">#--------------------#</span></span>
<span id="cb19-107"><a href="#cb19-107"></a></span>
<span id="cb19-108"><a href="#cb19-108"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb19-109"><a href="#cb19-109"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"repeatedcv"</span>, <span class="at">number =</span> <span class="dv">10</span>, <span class="at">repeats =</span> <span class="dv">5</span>)</span>
<span id="cb19-110"><a href="#cb19-110"></a></span>
<span id="cb19-111"><a href="#cb19-111"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb19-112"><a href="#cb19-112"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb19-113"><a href="#cb19-113"></a>                   <span class="at">data =</span> train, </span>
<span id="cb19-114"><a href="#cb19-114"></a>                   <span class="at">method =</span> <span class="st">"knn"</span>, </span>
<span id="cb19-115"><a href="#cb19-115"></a>                   <span class="at">trControl =</span> train_control)</span>
<span id="cb19-116"><a href="#cb19-116"></a></span>
<span id="cb19-117"><a href="#cb19-117"></a><span class="fu">save</span>(knn_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_repeatedCV.Rdata"</span>)</span>
<span id="cb19-118"><a href="#cb19-118"></a></span>
<span id="cb19-119"><a href="#cb19-119"></a></span>
<span id="cb19-120"><a href="#cb19-120"></a><span class="co">#--------------------------#</span></span>
<span id="cb19-121"><a href="#cb19-121"></a><span class="co">#----Repeated CV (Mod)-----#</span></span>
<span id="cb19-122"><a href="#cb19-122"></a><span class="co">#--------------------------#</span></span>
<span id="cb19-123"><a href="#cb19-123"></a></span>
<span id="cb19-124"><a href="#cb19-124"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb19-125"><a href="#cb19-125"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"repeatedcv"</span>, <span class="at">number =</span> <span class="dv">10</span>, <span class="at">repeats =</span> <span class="dv">5</span>)</span>
<span id="cb19-126"><a href="#cb19-126"></a></span>
<span id="cb19-127"><a href="#cb19-127"></a>kknn.grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">kmax =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span> ,<span class="dv">9</span>, <span class="dv">11</span>), <span class="at">distance =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb19-128"><a href="#cb19-128"></a>                         <span class="at">kernel =</span> <span class="fu">c</span>(<span class="st">"rectangular"</span>, <span class="st">"gaussian"</span>, <span class="st">"cos"</span>))</span>
<span id="cb19-129"><a href="#cb19-129"></a></span>
<span id="cb19-130"><a href="#cb19-130"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb19-131"><a href="#cb19-131"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb19-132"><a href="#cb19-132"></a>                   <span class="at">data =</span> train, </span>
<span id="cb19-133"><a href="#cb19-133"></a>                   <span class="at">method =</span> <span class="st">"kknn"</span>,</span>
<span id="cb19-134"><a href="#cb19-134"></a>                   <span class="at">trControl =</span> train_control, </span>
<span id="cb19-135"><a href="#cb19-135"></a>                   <span class="at">tuneGrid =</span> kknn.grid,</span>
<span id="cb19-136"><a href="#cb19-136"></a>                   <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>))</span>
<span id="cb19-137"><a href="#cb19-137"></a></span>
<span id="cb19-138"><a href="#cb19-138"></a><span class="fu">save</span>(knn_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_repeatedCV_mod.Rdata"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="k-fold-cv" class="level3">
<h3 class="anchored" data-anchor-id="k-fold-cv">K-fold CV</h3>
<div class="cell">
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="co"># Import model</span></span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_kfoldCV.Rdata"</span>)</span>
<span id="cb20-3"><a href="#cb20-3"></a></span>
<span id="cb20-4"><a href="#cb20-4"></a><span class="co"># Make predictions on the test data using the trained model and calculate the test error rate</span></span>
<span id="cb20-5"><a href="#cb20-5"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_model, <span class="at">newdata =</span> test)</span>
<span id="cb20-6"><a href="#cb20-6"></a></span>
<span id="cb20-7"><a href="#cb20-7"></a><span class="fu">confusionMatrix</span>(knn.predictions, test<span class="sc">$</span>good)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 873 194
         1  76  45
                                          
               Accuracy : 0.7727          
                 95% CI : (0.7478, 0.7963)
    No Information Rate : 0.7988          
    P-Value [Acc &gt; NIR] : 0.9878          
                                          
                  Kappa : 0.1327          
                                          
 Mcnemar's Test P-Value : 1.076e-12       
                                          
            Sensitivity : 0.9199          
            Specificity : 0.1883          
         Pos Pred Value : 0.8182          
         Neg Pred Value : 0.3719          
             Prevalence : 0.7988          
         Detection Rate : 0.7348          
   Detection Prevalence : 0.8981          
      Balanced Accuracy : 0.5541          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="co"># Convert predictions to a numeric vector</span></span>
<span id="cb22-2"><a href="#cb22-2"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(knn.predictions)</span>
<span id="cb22-3"><a href="#cb22-3"></a></span>
<span id="cb22-4"><a href="#cb22-4"></a><span class="co"># Calculate the AUC using the performance() and auc() functions:</span></span>
<span id="cb22-5"><a href="#cb22-5"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb22-6"><a href="#cb22-6"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb22-7"><a href="#cb22-7"></a>auc_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5541001</code></pre>
</div>
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="co"># Performance plot for TP and FP</span></span>
<span id="cb24-2"><a href="#cb24-2"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb24-3"><a href="#cb24-3"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb24-4"><a href="#cb24-4"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb24-5"><a href="#cb24-5"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb24-6"><a href="#cb24-6"></a>     <span class="at">main =</span> <span class="st">"ROC Curves from K-fold CV"</span>)</span>
<span id="cb24-7"><a href="#cb24-7"></a><span class="fu">points</span>(auc_val, <span class="dv">1</span> <span class="sc">-</span> auc_val, </span>
<span id="cb24-8"><a href="#cb24-8"></a>       <span class="at">col =</span> <span class="st">"steelblue"</span>, </span>
<span id="cb24-9"><a href="#cb24-9"></a>       <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb24-10"><a href="#cb24-10"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>knn.kfoldCV.ROC.plot<span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb25-2"><a href="#cb25-2"></a></span>
<span id="cb25-3"><a href="#cb25-3"></a><span class="co"># Accuracy and Kappa value plot</span></span>
<span id="cb25-4"><a href="#cb25-4"></a>knn.accu.kappa.plot <span class="ot">&lt;-</span> <span class="cf">function</span>(knn.model) {</span>
<span id="cb25-5"><a href="#cb25-5"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">data.frame</span>(<span class="at">k =</span> knn.model<span class="sc">$</span>results<span class="sc">$</span>k,</span>
<span id="cb25-6"><a href="#cb25-6"></a>                              <span class="at">Accuracy =</span> knn.model<span class="sc">$</span>results<span class="sc">$</span>Accuracy,</span>
<span id="cb25-7"><a href="#cb25-7"></a>                              <span class="at">Kappa =</span> knn.model<span class="sc">$</span>results<span class="sc">$</span>Kappa)) <span class="sc">+</span></span>
<span id="cb25-8"><a href="#cb25-8"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">color =</span> <span class="st">"Accuracy"</span>)) <span class="sc">+</span></span>
<span id="cb25-9"><a href="#cb25-9"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">color =</span> <span class="st">"Kappa"</span>)) <span class="sc">+</span></span>
<span id="cb25-10"><a href="#cb25-10"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">linetype =</span> <span class="st">"Accuracy"</span>, <span class="at">color =</span> <span class="st">"Accuracy"</span>)) <span class="sc">+</span></span>
<span id="cb25-11"><a href="#cb25-11"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">linetype =</span> <span class="st">"Kappa"</span>, <span class="at">color =</span> <span class="st">"Kappa"</span>)) <span class="sc">+</span></span>
<span id="cb25-12"><a href="#cb25-12"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#98c379"</span>, <span class="st">"#e06c75"</span>),</span>
<span id="cb25-13"><a href="#cb25-13"></a>                       <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>)) )) <span class="sc">+</span></span>
<span id="cb25-14"><a href="#cb25-14"></a>    <span class="fu">scale_linetype_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"solid"</span>, <span class="st">"dotted"</span>),</span>
<span id="cb25-15"><a href="#cb25-15"></a>                          <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="fu">c</span>(<span class="st">"#98c379"</span>, <span class="st">"#e06c75"</span>)))) <span class="sc">+</span></span>
<span id="cb25-16"><a href="#cb25-16"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"K value"</span>, </span>
<span id="cb25-17"><a href="#cb25-17"></a>         <span class="at">y =</span> <span class="st">"Accuracy / Kappa"</span>) <span class="sc">+</span></span>
<span id="cb25-18"><a href="#cb25-18"></a>    <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb25-19"><a href="#cb25-19"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb25-20"><a href="#cb25-20"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb25-21"><a href="#cb25-21"></a>    <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Metric"</span>),</span>
<span id="cb25-22"><a href="#cb25-22"></a>           <span class="at">linetype =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Metric"</span>))</span>
<span id="cb25-23"><a href="#cb25-23"></a>  <span class="fu">return</span>(p)</span>
<span id="cb25-24"><a href="#cb25-24"></a>}</span>
<span id="cb25-25"><a href="#cb25-25"></a></span>
<span id="cb25-26"><a href="#cb25-26"></a>knn.kfoldCV.plot <span class="ot">&lt;-</span> <span class="fu">knn.accu.kappa.plot</span>(knn_model) <span class="sc">+</span> </span>
<span id="cb25-27"><a href="#cb25-27"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb25-28"><a href="#cb25-28"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">label =</span> <span class="fu">round</span>(Kappa, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb25-29"><a href="#cb25-29"></a>  <span class="fu">ggtitle</span>(<span class="st">"KNN Model Performance (10-Fold CV)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="tuned" class="level4">
<h4 class="anchored" data-anchor-id="tuned">Tuned</h4>
<div class="cell">
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_kfoldCV_mod.Rdata"</span>)</span>
<span id="cb26-2"><a href="#cb26-2"></a></span>
<span id="cb26-3"><a href="#cb26-3"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_model, <span class="at">newdata =</span> test)</span>
<span id="cb26-4"><a href="#cb26-4"></a></span>
<span id="cb26-5"><a href="#cb26-5"></a><span class="fu">confusionMatrix</span>(knn.predictions, test<span class="sc">$</span>good)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 927 215
         1  22  24
                                          
               Accuracy : 0.8005          
                 95% CI : (0.7766, 0.8229)
    No Information Rate : 0.7988          
    P-Value [Acc &gt; NIR] : 0.4596          
                                          
                  Kappa : 0.1107          
                                          
 Mcnemar's Test P-Value : &lt;2e-16          
                                          
            Sensitivity : 0.9768          
            Specificity : 0.1004          
         Pos Pred Value : 0.8117          
         Neg Pred Value : 0.5217          
             Prevalence : 0.7988          
         Detection Rate : 0.7803          
   Detection Prevalence : 0.9613          
      Balanced Accuracy : 0.5386          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(knn.predictions)</span>
<span id="cb28-2"><a href="#cb28-2"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb28-3"><a href="#cb28-3"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb28-4"><a href="#cb28-4"></a>auc_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5386181</code></pre>
</div>
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb30-2"><a href="#cb30-2"></a><span class="fu">invisible</span>(<span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb30-3"><a href="#cb30-3"></a>               <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb30-4"><a href="#cb30-4"></a>               <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb30-5"><a href="#cb30-5"></a>               <span class="at">main =</span> <span class="st">"ROC Curves from Tuned K-fold CV"</span>))</span>
<span id="cb30-6"><a href="#cb30-6"></a><span class="fu">points</span>(auc_val, <span class="dv">1</span> <span class="sc">-</span> auc_val, </span>
<span id="cb30-7"><a href="#cb30-7"></a>       <span class="at">col =</span> <span class="st">"steelblue"</span>, </span>
<span id="cb30-8"><a href="#cb30-8"></a>       <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb30-9"><a href="#cb30-9"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>knn.kfoldCV_mod.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb31-2"><a href="#cb31-2"></a></span>
<span id="cb31-3"><a href="#cb31-3"></a>knn.kfoldCV_mod.plot <span class="ot">&lt;-</span> <span class="fu">knn.accu.kappa.plot</span>(knn_model) <span class="sc">+</span></span>
<span id="cb31-4"><a href="#cb31-4"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb31-5"><a href="#cb31-5"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">label =</span> <span class="fu">round</span>(Kappa, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb31-6"><a href="#cb31-6"></a>  <span class="fu">ggtitle</span>(<span class="st">"KNN Model Performance (Tuned 10-Fold CV)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="hold-out-cv-validation-set-approach" class="level3">
<h3 class="anchored" data-anchor-id="hold-out-cv-validation-set-approach">Hold-out CV (Validation Set Approach)</h3>
<div class="cell">
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_holdoutCV.Rdata"</span>)</span>
<span id="cb32-2"><a href="#cb32-2"></a></span>
<span id="cb32-3"><a href="#cb32-3"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_model, <span class="at">newdata =</span> test)</span>
<span id="cb32-4"><a href="#cb32-4"></a></span>
<span id="cb32-5"><a href="#cb32-5"></a><span class="fu">confusionMatrix</span>(knn.predictions, test<span class="sc">$</span>good)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 886 201
         1  63  38
                                         
               Accuracy : 0.7778         
                 95% CI : (0.753, 0.8011)
    No Information Rate : 0.7988         
    P-Value [Acc &gt; NIR] : 0.9663         
                                         
                  Kappa : 0.1181         
                                         
 Mcnemar's Test P-Value : &lt;2e-16         
                                         
            Sensitivity : 0.9336         
            Specificity : 0.1590         
         Pos Pred Value : 0.8151         
         Neg Pred Value : 0.3762         
             Prevalence : 0.7988         
         Detection Rate : 0.7458         
   Detection Prevalence : 0.9150         
      Balanced Accuracy : 0.5463         
                                         
       'Positive' Class : 0              
                                         </code></pre>
</div>
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(knn.predictions)</span>
<span id="cb34-2"><a href="#cb34-2"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb34-3"><a href="#cb34-3"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb34-4"><a href="#cb34-4"></a>auc_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5463051</code></pre>
</div>
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb36-2"><a href="#cb36-2"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb36-3"><a href="#cb36-3"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb36-4"><a href="#cb36-4"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb36-5"><a href="#cb36-5"></a>     <span class="at">main =</span> <span class="st">"ROC Curves from Hold-out CV"</span>)</span>
<span id="cb36-6"><a href="#cb36-6"></a><span class="fu">points</span>(auc_val, <span class="dv">1</span> <span class="sc">-</span> auc_val, </span>
<span id="cb36-7"><a href="#cb36-7"></a>       <span class="at">col =</span> <span class="st">"steelblue"</span>, </span>
<span id="cb36-8"><a href="#cb36-8"></a>       <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb36-9"><a href="#cb36-9"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>knn.holdoutCV.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb37-2"><a href="#cb37-2"></a></span>
<span id="cb37-3"><a href="#cb37-3"></a>knn.holdoutCV.plot <span class="ot">&lt;-</span> <span class="fu">knn.accu.kappa.plot</span>(knn_model) <span class="sc">+</span></span>
<span id="cb37-4"><a href="#cb37-4"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb37-5"><a href="#cb37-5"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">label =</span> <span class="fu">round</span>(Kappa, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb37-6"><a href="#cb37-6"></a>  <span class="fu">ggtitle</span>(<span class="st">"KNN Model Performance (Hold-out CV)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="tuned-1" class="level4">
<h4 class="anchored" data-anchor-id="tuned-1">Tuned</h4>
<div class="cell">
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_holdoutCV_mod.Rdata"</span>)</span>
<span id="cb38-2"><a href="#cb38-2"></a></span>
<span id="cb38-3"><a href="#cb38-3"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_model, <span class="at">newdata =</span> test)</span>
<span id="cb38-4"><a href="#cb38-4"></a></span>
<span id="cb38-5"><a href="#cb38-5"></a><span class="fu">confusionMatrix</span>(knn.predictions, test<span class="sc">$</span>good)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 942 234
         1   7   5
                                          
               Accuracy : 0.7971          
                 95% CI : (0.7731, 0.8197)
    No Information Rate : 0.7988          
    P-Value [Acc &gt; NIR] : 0.5745          
                                          
                  Kappa : 0.021           
                                          
 Mcnemar's Test P-Value : &lt;2e-16          
                                          
            Sensitivity : 0.99262         
            Specificity : 0.02092         
         Pos Pred Value : 0.80102         
         Neg Pred Value : 0.41667         
             Prevalence : 0.79882         
         Detection Rate : 0.79293         
   Detection Prevalence : 0.98990         
      Balanced Accuracy : 0.50677         
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(knn.predictions)</span>
<span id="cb40-2"><a href="#cb40-2"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb40-3"><a href="#cb40-3"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb40-4"><a href="#cb40-4"></a>auc_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5067722</code></pre>
</div>
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb42-2"><a href="#cb42-2"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb42-3"><a href="#cb42-3"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb42-4"><a href="#cb42-4"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb42-5"><a href="#cb42-5"></a>     <span class="at">main =</span> <span class="st">"ROC Curves from Tuned Hold-out CV"</span>)</span>
<span id="cb42-6"><a href="#cb42-6"></a><span class="fu">points</span>(auc_val, <span class="dv">1</span> <span class="sc">-</span> auc_val, </span>
<span id="cb42-7"><a href="#cb42-7"></a>       <span class="at">col =</span> <span class="st">"steelblue"</span>, </span>
<span id="cb42-8"><a href="#cb42-8"></a>       <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb42-9"><a href="#cb42-9"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a>knn.holdoutCV_mod.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb43-2"><a href="#cb43-2"></a></span>
<span id="cb43-3"><a href="#cb43-3"></a>knn.holdoutCV_mod.plot <span class="ot">&lt;-</span> <span class="fu">knn.accu.kappa.plot</span>(knn_model) <span class="sc">+</span> </span>
<span id="cb43-4"><a href="#cb43-4"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">3</span>)), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">angle=</span><span class="dv">90</span>) <span class="sc">+</span></span>
<span id="cb43-5"><a href="#cb43-5"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">label =</span> <span class="fu">round</span>(Kappa, <span class="dv">3</span>)), <span class="at">hjust=</span><span class="sc">-</span><span class="fl">0.3</span>, <span class="at">angle=</span><span class="dv">90</span>) <span class="sc">+</span></span>
<span id="cb43-6"><a href="#cb43-6"></a>  <span class="fu">ggtitle</span>(<span class="st">"KNN Model Performance (Tuned Hold-out CV)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="loocv" class="level3">
<h3 class="anchored" data-anchor-id="loocv">LOOCV</h3>
<div class="cell">
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_looCV.Rdata"</span>)</span>
<span id="cb44-2"><a href="#cb44-2"></a></span>
<span id="cb44-3"><a href="#cb44-3"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_model, <span class="at">newdata =</span> test)</span>
<span id="cb44-4"><a href="#cb44-4"></a><span class="fu">confusionMatrix</span>(knn.predictions, test<span class="sc">$</span>good)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 915 170
         1  34  69
                                          
               Accuracy : 0.8283          
                 95% CI : (0.8056, 0.8493)
    No Information Rate : 0.7988          
    P-Value [Acc &gt; NIR] : 0.00558         
                                          
                  Kappa : 0.3213          
                                          
 Mcnemar's Test P-Value : &lt; 2e-16         
                                          
            Sensitivity : 0.9642          
            Specificity : 0.2887          
         Pos Pred Value : 0.8433          
         Neg Pred Value : 0.6699          
             Prevalence : 0.7988          
         Detection Rate : 0.7702          
   Detection Prevalence : 0.9133          
      Balanced Accuracy : 0.6264          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(knn.predictions)</span>
<span id="cb46-2"><a href="#cb46-2"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb46-3"><a href="#cb46-3"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb46-4"><a href="#cb46-4"></a>auc_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6264379</code></pre>
</div>
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb48-2"><a href="#cb48-2"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb48-3"><a href="#cb48-3"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb48-4"><a href="#cb48-4"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb48-5"><a href="#cb48-5"></a>     <span class="at">main =</span> <span class="st">'ROC Curves from LOOCV'</span>)</span>
<span id="cb48-6"><a href="#cb48-6"></a><span class="fu">points</span>(auc_val, <span class="dv">1</span> <span class="sc">-</span> auc_val, </span>
<span id="cb48-7"><a href="#cb48-7"></a>       <span class="at">col =</span> <span class="st">"steelblue"</span>, </span>
<span id="cb48-8"><a href="#cb48-8"></a>       <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb48-9"><a href="#cb48-9"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a>knn.looCV.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb49-2"><a href="#cb49-2"></a></span>
<span id="cb49-3"><a href="#cb49-3"></a>knn.looCV.plot <span class="ot">&lt;-</span> <span class="fu">knn.accu.kappa.plot</span>(knn_model) <span class="sc">+</span> </span>
<span id="cb49-4"><a href="#cb49-4"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb49-5"><a href="#cb49-5"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">label =</span> <span class="fu">round</span>(Kappa, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb49-6"><a href="#cb49-6"></a>  <span class="fu">ggtitle</span>(<span class="st">"KNN Model Performance (LOOCV)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="tuned-2" class="level4">
<h4 class="anchored" data-anchor-id="tuned-2">Tuned</h4>
<div class="cell">
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_looCV_mod.Rdata"</span>)</span>
<span id="cb50-2"><a href="#cb50-2"></a></span>
<span id="cb50-3"><a href="#cb50-3"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_model, <span class="at">newdata =</span> test)</span>
<span id="cb50-4"><a href="#cb50-4"></a><span class="fu">confusionMatrix</span>(knn.predictions, test<span class="sc">$</span>good)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 927 215
         1  22  24
                                          
               Accuracy : 0.8005          
                 95% CI : (0.7766, 0.8229)
    No Information Rate : 0.7988          
    P-Value [Acc &gt; NIR] : 0.4596          
                                          
                  Kappa : 0.1107          
                                          
 Mcnemar's Test P-Value : &lt;2e-16          
                                          
            Sensitivity : 0.9768          
            Specificity : 0.1004          
         Pos Pred Value : 0.8117          
         Neg Pred Value : 0.5217          
             Prevalence : 0.7988          
         Detection Rate : 0.7803          
   Detection Prevalence : 0.9613          
      Balanced Accuracy : 0.5386          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(knn.predictions)</span>
<span id="cb52-2"><a href="#cb52-2"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb52-3"><a href="#cb52-3"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb52-4"><a href="#cb52-4"></a>auc_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5386181</code></pre>
</div>
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb54-2"><a href="#cb54-2"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb54-3"><a href="#cb54-3"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb54-4"><a href="#cb54-4"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb54-5"><a href="#cb54-5"></a>     <span class="at">main =</span> <span class="st">"ROC Curves from Tuned LOOCV"</span>)</span>
<span id="cb54-6"><a href="#cb54-6"></a><span class="fu">points</span>(auc_val, <span class="dv">1</span> <span class="sc">-</span> auc_val, </span>
<span id="cb54-7"><a href="#cb54-7"></a>       <span class="at">col =</span> <span class="st">"steelblue"</span>, </span>
<span id="cb54-8"><a href="#cb54-8"></a>       <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb54-9"><a href="#cb54-9"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a>knn.looCV_mod.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb55-2"><a href="#cb55-2"></a></span>
<span id="cb55-3"><a href="#cb55-3"></a>knn.looCV_mod.plot <span class="ot">&lt;-</span> <span class="fu">knn.accu.kappa.plot</span>(knn_model) <span class="sc">+</span> </span>
<span id="cb55-4"><a href="#cb55-4"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">3</span>)), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">angle=</span><span class="dv">90</span>) <span class="sc">+</span></span>
<span id="cb55-5"><a href="#cb55-5"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">label =</span> <span class="fu">round</span>(Kappa, <span class="dv">3</span>)), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">angle=</span><span class="dv">90</span>) <span class="sc">+</span></span>
<span id="cb55-6"><a href="#cb55-6"></a>  <span class="fu">ggtitle</span>(<span class="st">"KNN Model Performance (Tuned LOOCV)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="repeated-cv" class="level3">
<h3 class="anchored" data-anchor-id="repeated-cv">Repeated CV</h3>
<div class="cell">
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_repeatedCV.Rdata"</span>)</span>
<span id="cb56-2"><a href="#cb56-2"></a></span>
<span id="cb56-3"><a href="#cb56-3"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_model, <span class="at">newdata =</span> test)</span>
<span id="cb56-4"><a href="#cb56-4"></a></span>
<span id="cb56-5"><a href="#cb56-5"></a><span class="fu">confusionMatrix</span>(knn.predictions, test<span class="sc">$</span>good)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 864 126
         1  85 113
                                          
               Accuracy : 0.8224          
                 95% CI : (0.7994, 0.8437)
    No Information Rate : 0.7988          
    P-Value [Acc &gt; NIR] : 0.022056        
                                          
                  Kappa : 0.4095          
                                          
 Mcnemar's Test P-Value : 0.005892        
                                          
            Sensitivity : 0.9104          
            Specificity : 0.4728          
         Pos Pred Value : 0.8727          
         Neg Pred Value : 0.5707          
             Prevalence : 0.7988          
         Detection Rate : 0.7273          
   Detection Prevalence : 0.8333          
      Balanced Accuracy : 0.6916          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(knn.predictions)</span>
<span id="cb58-2"><a href="#cb58-2"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb58-3"><a href="#cb58-3"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb58-4"><a href="#cb58-4"></a>auc_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6916177</code></pre>
</div>
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb60-2"><a href="#cb60-2"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb60-3"><a href="#cb60-3"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb60-4"><a href="#cb60-4"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb60-5"><a href="#cb60-5"></a>     <span class="at">main =</span> <span class="st">"ROC Curves from Repeated CV"</span>)</span>
<span id="cb60-6"><a href="#cb60-6"></a><span class="fu">points</span>(auc_val, <span class="dv">1</span> <span class="sc">-</span> auc_val, </span>
<span id="cb60-7"><a href="#cb60-7"></a>       <span class="at">col =</span> <span class="st">"steelblue"</span>, </span>
<span id="cb60-8"><a href="#cb60-8"></a>       <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb60-9"><a href="#cb60-9"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a>knn.repeatedCV.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb61-2"><a href="#cb61-2"></a></span>
<span id="cb61-3"><a href="#cb61-3"></a>df <span class="ot">&lt;-</span> knn_model<span class="sc">$</span>results</span>
<span id="cb61-4"><a href="#cb61-4"></a>knn.repeatedCV.plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>df, <span class="fu">aes</span>(<span class="at">x =</span> kmax, <span class="at">y =</span> Accuracy)) <span class="sc">+</span></span>
<span id="cb61-5"><a href="#cb61-5"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Accuracy"</span>)) <span class="sc">+</span></span>
<span id="cb61-6"><a href="#cb61-6"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Kappa"</span>)) <span class="sc">+</span></span>
<span id="cb61-7"><a href="#cb61-7"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> <span class="st">"Accuracy"</span>, <span class="at">color =</span> <span class="st">"Accuracy"</span>)) <span class="sc">+</span></span>
<span id="cb61-8"><a href="#cb61-8"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Kappa, <span class="at">linetype =</span> <span class="st">"Kappa"</span>, <span class="at">color =</span> <span class="st">"Kappa"</span>)) <span class="sc">+</span></span>
<span id="cb61-9"><a href="#cb61-9"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb61-10"><a href="#cb61-10"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> Kappa, <span class="at">label =</span> <span class="fu">round</span>(Kappa, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb61-11"><a href="#cb61-11"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#98c379"</span>, <span class="st">"#e06c75"</span>),</span>
<span id="cb61-12"><a href="#cb61-12"></a>                     <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>)) )) <span class="sc">+</span></span>
<span id="cb61-13"><a href="#cb61-13"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"solid"</span>, <span class="st">"dotted"</span>),</span>
<span id="cb61-14"><a href="#cb61-14"></a>                        <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="fu">c</span>(<span class="st">"#98c379"</span>, <span class="st">"#e06c75"</span>)))) <span class="sc">+</span></span>
<span id="cb61-15"><a href="#cb61-15"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"K value"</span>, </span>
<span id="cb61-16"><a href="#cb61-16"></a>       <span class="at">y =</span> <span class="st">"Accuracy / Kappa"</span>,</span>
<span id="cb61-17"><a href="#cb61-17"></a>       <span class="at">title =</span> <span class="st">"KNN Model Performance (Repeated CV)"</span>) <span class="sc">+</span></span>
<span id="cb61-18"><a href="#cb61-18"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb61-19"><a href="#cb61-19"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb61-20"><a href="#cb61-20"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb61-21"><a href="#cb61-21"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Metric"</span>),</span>
<span id="cb61-22"><a href="#cb61-22"></a>         <span class="at">linetype =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Metric"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="tuned-3" class="level4">
<h4 class="anchored" data-anchor-id="tuned-3">Tuned</h4>
<div class="cell">
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_repeatedCV_mod.Rdata"</span>)</span>
<span id="cb62-2"><a href="#cb62-2"></a></span>
<span id="cb62-3"><a href="#cb62-3"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_model, <span class="at">newdata =</span> test)</span>
<span id="cb62-4"><a href="#cb62-4"></a></span>
<span id="cb62-5"><a href="#cb62-5"></a><span class="fu">confusionMatrix</span>(knn.predictions, test<span class="sc">$</span>good)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 906  90
         1  43 149
                                          
               Accuracy : 0.888           
                 95% CI : (0.8687, 0.9054)
    No Information Rate : 0.7988          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.624           
                                          
 Mcnemar's Test P-Value : 6.643e-05       
                                          
            Sensitivity : 0.9547          
            Specificity : 0.6234          
         Pos Pred Value : 0.9096          
         Neg Pred Value : 0.7760          
             Prevalence : 0.7988          
         Detection Rate : 0.7626          
   Detection Prevalence : 0.8384          
      Balanced Accuracy : 0.7891          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(knn.predictions)</span>
<span id="cb64-2"><a href="#cb64-2"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb64-3"><a href="#cb64-3"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb64-4"><a href="#cb64-4"></a>auc_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7890601</code></pre>
</div>
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb66-2"><a href="#cb66-2"></a></span>
<span id="cb66-3"><a href="#cb66-3"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb66-4"><a href="#cb66-4"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb66-5"><a href="#cb66-5"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb66-6"><a href="#cb66-6"></a>     <span class="at">main =</span> <span class="st">"ROC Curves from Tuned Repeated CV"</span>)</span>
<span id="cb66-7"><a href="#cb66-7"></a><span class="fu">points</span>(auc_val, <span class="dv">1</span> <span class="sc">-</span> auc_val, </span>
<span id="cb66-8"><a href="#cb66-8"></a>       <span class="at">col =</span> <span class="st">"steelblue"</span>, </span>
<span id="cb66-9"><a href="#cb66-9"></a>       <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb66-10"><a href="#cb66-10"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a>knn.repeatedCV_mod.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb67-2"><a href="#cb67-2"></a></span>
<span id="cb67-3"><a href="#cb67-3"></a>knn.repeatedCV_mod.plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(knn_model) <span class="sc">+</span></span>
<span id="cb67-4"><a href="#cb67-4"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"K value"</span>, </span>
<span id="cb67-5"><a href="#cb67-5"></a>       <span class="at">y =</span> <span class="st">"Accuracy"</span>, </span>
<span id="cb67-6"><a href="#cb67-6"></a>       <span class="at">title =</span> <span class="st">"KNN Model Performance (Tuned Repeated CV)"</span>) <span class="sc">+</span></span>
<span id="cb67-7"><a href="#cb67-7"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb67-8"><a href="#cb67-8"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="summary" class="level3">
<h3 class="anchored" data-anchor-id="summary">Summary</h3>
<div class="cell">
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a><span class="fu">ggarrange</span>(knn.kfoldCV.plot,</span>
<span id="cb68-2"><a href="#cb68-2"></a>          knn.kfoldCV_mod.plot,</span>
<span id="cb68-3"><a href="#cb68-3"></a>          knn.holdoutCV.plot,</span>
<span id="cb68-4"><a href="#cb68-4"></a>          knn.holdoutCV_mod.plot,</span>
<span id="cb68-5"><a href="#cb68-5"></a>          knn.looCV.plot,</span>
<span id="cb68-6"><a href="#cb68-6"></a>          knn.looCV_mod.plot,</span>
<span id="cb68-7"><a href="#cb68-7"></a>          knn.repeatedCV.plot,</span>
<span id="cb68-8"><a href="#cb68-8"></a>          knn.repeatedCV_mod.plot,</span>
<span id="cb68-9"><a href="#cb68-9"></a>          <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Sang_files/figure-html/knn.Accuracy.Kappa.Plot-1.png" class="img-fluid" width="1440"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(knn.kfoldCV.ROC.plot, knn.kfoldCV_mod.ROC.plot,</span>
<span id="cb69-2"><a href="#cb69-2"></a>                   <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">align =</span> <span class="st">"hv"</span>, <span class="at">scale =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Sang_files/figure-html/knn.ROC_curve-1.png" class="img-fluid" width="960"></p>
</div>
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(knn.holdoutCV.ROC.plot, knn.holdoutCV_mod.ROC.plot,</span>
<span id="cb70-2"><a href="#cb70-2"></a>                   <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">align =</span> <span class="st">"hv"</span>, <span class="at">scale =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Sang_files/figure-html/knn.ROC_curve-2.png" class="img-fluid" width="960"></p>
</div>
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(knn.looCV.ROC.plot, knn.looCV_mod.ROC.plot,</span>
<span id="cb71-2"><a href="#cb71-2"></a>                   <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">align =</span> <span class="st">"hv"</span>, <span class="at">scale =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Sang_files/figure-html/knn.ROC_curve-3.png" class="img-fluid" width="960"></p>
</div>
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(knn.repeatedCV.ROC.plot, knn.repeatedCV_mod.ROC.plot,</span>
<span id="cb72-2"><a href="#cb72-2"></a>                   <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">align =</span> <span class="st">"hv"</span>, <span class="at">scale =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Sang_files/figure-html/knn.ROC_curve-4.png" class="img-fluid" width="960"></p>
</div>
</div>
<table class="table">
<colgroup>
<col style="width: 32%">
<col style="width: 16%">
<col style="width: 18%">
<col style="width: 18%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th>Resampling Method</th>
<th>Error Rate</th>
<th>Sensitivity</th>
<th>Specificity</th>
<th>AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>K-Fold CV</td>
<td>0.2273</td>
<td>0.9199</td>
<td>0.1883</td>
<td>0.5541001</td>
</tr>
<tr class="even">
<td>K-Fold CV (Tuned)</td>
<td>0.1995</td>
<td>0.9768</td>
<td>0.1004</td>
<td>0.5386181</td>
</tr>
<tr class="odd">
<td>Hold-out CV</td>
<td>0.2222</td>
<td>0.9336</td>
<td>0.1590</td>
<td>0.5463051</td>
</tr>
<tr class="even">
<td>Hold-out CV (Tuned)</td>
<td>0.2022</td>
<td>0.9926</td>
<td>0.0251</td>
<td>0.5088642</td>
</tr>
<tr class="odd">
<td>LOOCV</td>
<td>0.1717</td>
<td>0.9642</td>
<td>0.2887</td>
<td>0.6264379</td>
</tr>
<tr class="even">
<td>LOOCV (Tuned)</td>
<td>0.1995</td>
<td>0.9768</td>
<td>0.1004</td>
<td>0.5386181</td>
</tr>
<tr class="odd">
<td>Repeated CV</td>
<td>0.1776</td>
<td>0.9104</td>
<td>0.4728</td>
<td>0.6916177</td>
</tr>
<tr class="even">
<td>Repeated CV (Tuned)</td>
<td>0.1120</td>
<td>0.9547</td>
<td>0.6234</td>
<td>0.7890601</td>
</tr>
</tbody>
</table>
<div class="cell">

</div>
</section>
</section>
<section id="logistic-regression" class="level2">
<h2 class="anchored" data-anchor-id="logistic-regression">Logistic Regression</h2>
<section id="model-construction-1" class="level3">
<h3 class="anchored" data-anchor-id="model-construction-1">Model Construction</h3>
<div class="cell">
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a><span class="co">#----------------------------#</span></span>
<span id="cb73-2"><a href="#cb73-2"></a><span class="co">#----Logistic Regression-----#</span></span>
<span id="cb73-3"><a href="#cb73-3"></a><span class="co">#----------------------------#</span></span>
<span id="cb73-4"><a href="#cb73-4"></a></span>
<span id="cb73-5"><a href="#cb73-5"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb73-6"><a href="#cb73-6"></a><span class="co"># Define the training control object for 10-fold cross-validation</span></span>
<span id="cb73-7"><a href="#cb73-7"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">10</span>)</span>
<span id="cb73-8"><a href="#cb73-8"></a></span>
<span id="cb73-9"><a href="#cb73-9"></a><span class="co"># Train the logistic regression model using 10-fold cross-validation</span></span>
<span id="cb73-10"><a href="#cb73-10"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb73-11"><a href="#cb73-11"></a>logit_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb73-12"><a href="#cb73-12"></a>                     <span class="at">data =</span> train, </span>
<span id="cb73-13"><a href="#cb73-13"></a>                     <span class="at">method =</span> <span class="st">"glm"</span>, </span>
<span id="cb73-14"><a href="#cb73-14"></a>                     <span class="at">family =</span> <span class="st">"binomial"</span>,</span>
<span id="cb73-15"><a href="#cb73-15"></a>                     <span class="at">trControl =</span> train_control)</span>
<span id="cb73-16"><a href="#cb73-16"></a></span>
<span id="cb73-17"><a href="#cb73-17"></a><span class="fu">save</span>(logit_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">logit.model_kfoldCV.Rdata"</span>)</span>
<span id="cb73-18"><a href="#cb73-18"></a></span>
<span id="cb73-19"><a href="#cb73-19"></a></span>
<span id="cb73-20"><a href="#cb73-20"></a><span class="co">#----------------------------------#</span></span>
<span id="cb73-21"><a href="#cb73-21"></a><span class="co">#----Logistic Regression (Mod)-----#</span></span>
<span id="cb73-22"><a href="#cb73-22"></a><span class="co">#----------------------------------#</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="k-fold-cv-1" class="level3">
<h3 class="anchored" data-anchor-id="k-fold-cv-1">K-fold CV</h3>
<div class="cell">
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">logit.model_kfoldCV.Rdata"</span>)</span>
<span id="cb74-2"><a href="#cb74-2"></a></span>
<span id="cb74-3"><a href="#cb74-3"></a>logit.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(logit_model, <span class="at">newdata =</span> test)</span>
<span id="cb74-4"><a href="#cb74-4"></a></span>
<span id="cb74-5"><a href="#cb74-5"></a><span class="fu">confusionMatrix</span>(logit.predictions, test<span class="sc">$</span>good)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 887 169
         1  62  70
                                          
               Accuracy : 0.8056          
                 95% CI : (0.7819, 0.8277)
    No Information Rate : 0.7988          
    P-Value [Acc &gt; NIR] : 0.2954          
                                          
                  Kappa : 0.2733          
                                          
 Mcnemar's Test P-Value : 3.074e-12       
                                          
            Sensitivity : 0.9347          
            Specificity : 0.2929          
         Pos Pred Value : 0.8400          
         Neg Pred Value : 0.5303          
             Prevalence : 0.7988          
         Detection Rate : 0.7466          
   Detection Prevalence : 0.8889          
      Balanced Accuracy : 0.6138          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a>logit.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(logit.predictions)</span>
<span id="cb76-2"><a href="#cb76-2"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(logit.predictions, test<span class="sc">$</span>good)</span>
<span id="cb76-3"><a href="#cb76-3"></a>auc_val  <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb76-4"><a href="#cb76-4"></a>auc_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6137776</code></pre>
</div>
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb78-2"><a href="#cb78-2"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb78-3"><a href="#cb78-3"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb78-4"><a href="#cb78-4"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb78-5"><a href="#cb78-5"></a>     <span class="at">main =</span> <span class="st">"ROC Curves from Repeated CV"</span>)</span>
<span id="cb78-6"><a href="#cb78-6"></a><span class="fu">points</span>(auc_val, <span class="dv">1</span> <span class="sc">-</span> auc_val, </span>
<span id="cb78-7"><a href="#cb78-7"></a>       <span class="at">col =</span> <span class="st">"steelblue"</span>, </span>
<span id="cb78-8"><a href="#cb78-8"></a>       <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb78-9"><a href="#cb78-9"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a>logit.kfoldCV.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="tuned-4" class="level4">
<h4 class="anchored" data-anchor-id="tuned-4">Tuned</h4>
<div class="cell">
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a>glm.model <span class="ot">&lt;-</span> <span class="fu">glm</span>(good <span class="sc">~</span> ., <span class="at">data=</span> train,<span class="at">family=</span><span class="st">"binomial"</span>)</span>
<span id="cb80-2"><a href="#cb80-2"></a>glm.fit<span class="ot">=</span> <span class="fu">stepAIC</span>(glm.model, <span class="at">direction =</span> <span class="st">'backward'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=2228.76
good ~ fixed.acidity + volatile.acidity + citric.acid + residual.sugar + 
    chlorides + free.sulfur.dioxide + total.sulfur.dioxide + 
    density + pH + sulphates + alcohol

                       Df Deviance    AIC
- citric.acid           1   2205.4 2227.4
- alcohol               1   2205.7 2227.7
&lt;none&gt;                      2204.8 2228.8
- total.sulfur.dioxide  1   2206.9 2228.9
- chlorides             1   2215.2 2237.2
- free.sulfur.dioxide   1   2216.8 2238.8
- sulphates             1   2224.5 2246.5
- fixed.acidity         1   2230.8 2252.8
- volatile.acidity      1   2231.5 2253.5
- density               1   2236.3 2258.3
- residual.sugar        1   2243.8 2265.8
- pH                    1   2259.9 2281.9

Step:  AIC=2227.37
good ~ fixed.acidity + volatile.acidity + residual.sugar + chlorides + 
    free.sulfur.dioxide + total.sulfur.dioxide + density + pH + 
    sulphates + alcohol

                       Df Deviance    AIC
- alcohol               1   2206.2 2226.2
&lt;none&gt;                      2205.4 2227.4
- total.sulfur.dioxide  1   2207.7 2227.7
- chlorides             1   2215.9 2235.9
- free.sulfur.dioxide   1   2217.4 2237.4
- sulphates             1   2225.0 2245.0
- fixed.acidity         1   2230.8 2250.8
- volatile.acidity      1   2231.7 2251.7
- density               1   2237.6 2257.6
- residual.sugar        1   2244.7 2264.7
- pH                    1   2260.8 2280.8

Step:  AIC=2226.16
good ~ fixed.acidity + volatile.acidity + residual.sugar + chlorides + 
    free.sulfur.dioxide + total.sulfur.dioxide + density + pH + 
    sulphates

                       Df Deviance    AIC
- total.sulfur.dioxide  1   2208.0 2226.0
&lt;none&gt;                      2206.2 2226.2
- chlorides             1   2216.4 2234.4
- free.sulfur.dioxide   1   2217.6 2235.6
- sulphates             1   2231.3 2249.3
- volatile.acidity      1   2231.7 2249.7
- fixed.acidity         1   2272.7 2290.7
- pH                    1   2316.6 2334.6
- residual.sugar        1   2383.1 2401.1
- density               1   2512.7 2530.7

Step:  AIC=2226.01
good ~ fixed.acidity + volatile.acidity + residual.sugar + chlorides + 
    free.sulfur.dioxide + density + pH + sulphates

                      Df Deviance    AIC
&lt;none&gt;                     2208.0 2226.0
- free.sulfur.dioxide  1   2218.1 2234.1
- chlorides            1   2218.6 2234.6
- sulphates            1   2232.6 2248.6
- volatile.acidity     1   2238.0 2254.0
- fixed.acidity        1   2274.6 2290.6
- pH                   1   2317.9 2333.9
- residual.sugar       1   2390.9 2406.9
- density              1   2560.1 2576.1</code></pre>
</div>
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a><span class="co"># Make predictions on test data and construct a confusion matrix</span></span>
<span id="cb82-2"><a href="#cb82-2"></a>logit.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(glm.fit, <span class="at">newdata =</span> test,<span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb82-3"><a href="#cb82-3"></a>logit.predictions <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(logit.predictions <span class="sc">&gt;</span> <span class="fl">0.7</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb82-4"><a href="#cb82-4"></a>                            <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb82-5"><a href="#cb82-5"></a><span class="fu">confusionMatrix</span>(logit.predictions, test<span class="sc">$</span>good)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 939 218
         1  10  21
                                          
               Accuracy : 0.8081          
                 95% CI : (0.7845, 0.8301)
    No Information Rate : 0.7988          
    P-Value [Acc &gt; NIR] : 0.2246          
                                          
                  Kappa : 0.1147          
                                          
 Mcnemar's Test P-Value : &lt;2e-16          
                                          
            Sensitivity : 0.98946         
            Specificity : 0.08787         
         Pos Pred Value : 0.81158         
         Neg Pred Value : 0.67742         
             Prevalence : 0.79882         
         Detection Rate : 0.79040         
   Detection Prevalence : 0.97391         
      Balanced Accuracy : 0.53866         
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a>logit.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(logit.predictions)</span>
<span id="cb84-2"><a href="#cb84-2"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(logit.predictions, test<span class="sc">$</span>good)</span>
<span id="cb84-3"><a href="#cb84-3"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb84-4"><a href="#cb84-4"></a>auc_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5386644</code></pre>
</div>
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb86-2"><a href="#cb86-2"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb86-3"><a href="#cb86-3"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb86-4"><a href="#cb86-4"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb86-5"><a href="#cb86-5"></a>     <span class="at">main =</span> <span class="st">"ROC Curves from Repeated CV"</span>)</span>
<span id="cb86-6"><a href="#cb86-6"></a><span class="fu">points</span>(auc_val, <span class="dv">1</span> <span class="sc">-</span> auc_val, </span>
<span id="cb86-7"><a href="#cb86-7"></a>       <span class="at">col =</span> <span class="st">"steelblue"</span>, </span>
<span id="cb86-8"><a href="#cb86-8"></a>       <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb86-9"><a href="#cb86-9"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Sang_files/figure-html/logit.kfoldCV_mod-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1"></a>logit.kfoldCV.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<table class="table">
<colgroup>
<col style="width: 39%">
<col style="width: 14%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th>Resampling Method</th>
<th>Error Rate</th>
<th>Sensitivity</th>
<th>Specificity</th>
<th>AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Logistic Regression</td>
<td>0.1944</td>
<td>0.9347</td>
<td>0.2929</td>
<td>0.6137776</td>
</tr>
<tr class="even">
<td>Logistic Regression (Tuned)</td>
<td>0.1919</td>
<td>0.98946</td>
<td>0.08787</td>
<td>0.5386644</td>
</tr>
</tbody>
</table>
</section>
</section>
</section>
<section id="linear-discriminant-analysis" class="level2">
<h2 class="anchored" data-anchor-id="linear-discriminant-analysis">Linear Discriminant Analysis</h2>
<section id="model-construction-2" class="level3">
<h3 class="anchored" data-anchor-id="model-construction-2">Model Construction</h3>
<div class="cell">
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1"></a><span class="co">#------------#</span></span>
<span id="cb88-2"><a href="#cb88-2"></a><span class="co">#----LDA-----#</span></span>
<span id="cb88-3"><a href="#cb88-3"></a><span class="co">#------------#</span></span>
<span id="cb88-4"><a href="#cb88-4"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb88-5"><a href="#cb88-5"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">10</span>)</span>
<span id="cb88-6"><a href="#cb88-6"></a></span>
<span id="cb88-7"><a href="#cb88-7"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb88-8"><a href="#cb88-8"></a>lda_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb88-9"><a href="#cb88-9"></a>                   <span class="at">data =</span> train, </span>
<span id="cb88-10"><a href="#cb88-10"></a>                   <span class="at">method =</span> <span class="st">"lda"</span>, </span>
<span id="cb88-11"><a href="#cb88-11"></a>                   <span class="at">trControl =</span> train_control)</span>
<span id="cb88-12"><a href="#cb88-12"></a></span>
<span id="cb88-13"><a href="#cb88-13"></a><span class="fu">save</span>(lda_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">lda.model_kfoldCV.Rdata"</span>)</span>
<span id="cb88-14"><a href="#cb88-14"></a></span>
<span id="cb88-15"><a href="#cb88-15"></a></span>
<span id="cb88-16"><a href="#cb88-16"></a><span class="co">#------------------#</span></span>
<span id="cb88-17"><a href="#cb88-17"></a><span class="co">#----LDA (Mod)-----#</span></span>
<span id="cb88-18"><a href="#cb88-18"></a><span class="co">#------------------#</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="k-fold-cv-2" class="level3">
<h3 class="anchored" data-anchor-id="k-fold-cv-2">K-fold CV</h3>
<div class="cell">
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">lda.model_kfoldCV.Rdata"</span>)</span>
<span id="cb89-2"><a href="#cb89-2"></a></span>
<span id="cb89-3"><a href="#cb89-3"></a>lda.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(lda_model, <span class="at">newdata =</span> test)</span>
<span id="cb89-4"><a href="#cb89-4"></a></span>
<span id="cb89-5"><a href="#cb89-5"></a><span class="fu">confusionMatrix</span>(lda.predictions, test<span class="sc">$</span>good)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 881 160
         1  68  79
                                          
               Accuracy : 0.8081          
                 95% CI : (0.7845, 0.8301)
    No Information Rate : 0.7988          
    P-Value [Acc &gt; NIR] : 0.2246          
                                          
                  Kappa : 0.3024          
                                          
 Mcnemar's Test P-Value : 1.674e-09       
                                          
            Sensitivity : 0.9283          
            Specificity : 0.3305          
         Pos Pred Value : 0.8463          
         Neg Pred Value : 0.5374          
             Prevalence : 0.7988          
         Detection Rate : 0.7416          
   Detection Prevalence : 0.8763          
      Balanced Accuracy : 0.6294          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1"></a>lda.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(lda.predictions)</span>
<span id="cb91-2"><a href="#cb91-2"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(lda.predictions, test<span class="sc">$</span>good)</span>
<span id="cb91-3"><a href="#cb91-3"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb91-4"><a href="#cb91-4"></a>auc_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6294448</code></pre>
</div>
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb93-2"><a href="#cb93-2"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb93-3"><a href="#cb93-3"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb93-4"><a href="#cb93-4"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb93-5"><a href="#cb93-5"></a>     <span class="at">main =</span> <span class="st">"ROC Curves from Repeated CV"</span>)</span>
<span id="cb93-6"><a href="#cb93-6"></a><span class="fu">points</span>(auc_val, <span class="dv">1</span> <span class="sc">-</span> auc_val, </span>
<span id="cb93-7"><a href="#cb93-7"></a>       <span class="at">col =</span> <span class="st">"steelblue"</span>, </span>
<span id="cb93-8"><a href="#cb93-8"></a>       <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb93-9"><a href="#cb93-9"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1"></a>lda.kfoldCV.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="tuned-5" class="level4">
<h4 class="anchored" data-anchor-id="tuned-5">Tuned</h4>
<div class="cell">

</div>
<table class="table">
<colgroup>
<col style="width: 29%">
<col style="width: 17%">
<col style="width: 18%">
<col style="width: 18%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th>Resampling Method</th>
<th>Error Rate</th>
<th>Sensitivity</th>
<th>Specificity</th>
<th>AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>LDA</td>
<td>0.1919</td>
<td>0.9283</td>
<td>0.3305</td>
<td>0.6294448</td>
</tr>
<tr class="even">
<td>LDA (Tuned)</td>
<td>0.xxxx</td>
<td>0.xxxx</td>
<td>0.xxxx</td>
<td>0.xxxxxxx</td>
</tr>
</tbody>
</table>
</section>
</section>
</section>
<section id="quadratic-discriminant-analysis" class="level2">
<h2 class="anchored" data-anchor-id="quadratic-discriminant-analysis">Quadratic discriminant analysis</h2>
<section id="model-construction-3" class="level3">
<h3 class="anchored" data-anchor-id="model-construction-3">Model Construction</h3>
<div class="cell">
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1"></a><span class="co">#------------#</span></span>
<span id="cb95-2"><a href="#cb95-2"></a><span class="co">#----QDA-----#</span></span>
<span id="cb95-3"><a href="#cb95-3"></a><span class="co">#------------#</span></span>
<span id="cb95-4"><a href="#cb95-4"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb95-5"><a href="#cb95-5"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">10</span>)</span>
<span id="cb95-6"><a href="#cb95-6"></a></span>
<span id="cb95-7"><a href="#cb95-7"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb95-8"><a href="#cb95-8"></a>qda_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb95-9"><a href="#cb95-9"></a>                   <span class="at">data =</span> train, </span>
<span id="cb95-10"><a href="#cb95-10"></a>                   <span class="at">method =</span> <span class="st">"qda"</span>, </span>
<span id="cb95-11"><a href="#cb95-11"></a>                   <span class="at">trControl =</span> train_control)</span>
<span id="cb95-12"><a href="#cb95-12"></a></span>
<span id="cb95-13"><a href="#cb95-13"></a><span class="fu">save</span>(qda_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">qda.model_kfoldCV.Rdata"</span>)</span>
<span id="cb95-14"><a href="#cb95-14"></a></span>
<span id="cb95-15"><a href="#cb95-15"></a><span class="co">#------------------#</span></span>
<span id="cb95-16"><a href="#cb95-16"></a><span class="co">#----QDA (Mod)-----#</span></span>
<span id="cb95-17"><a href="#cb95-17"></a><span class="co">#------------------#</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="k-fold-cv-3" class="level3">
<h3 class="anchored" data-anchor-id="k-fold-cv-3">K-fold CV</h3>
<div class="cell">
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">qda.model_kfoldCV.Rdata"</span>)</span>
<span id="cb96-2"><a href="#cb96-2"></a></span>
<span id="cb96-3"><a href="#cb96-3"></a>qda.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(qda_model, <span class="at">newdata =</span> test)</span>
<span id="cb96-4"><a href="#cb96-4"></a></span>
<span id="cb96-5"><a href="#cb96-5"></a><span class="fu">confusionMatrix</span>(qda.predictions, test<span class="sc">$</span>good)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 704  59
         1 245 180
                                          
               Accuracy : 0.7441          
                 95% CI : (0.7183, 0.7687)
    No Information Rate : 0.7988          
    P-Value [Acc &gt; NIR] : 1               
                                          
                  Kappa : 0.3834          
                                          
 Mcnemar's Test P-Value : &lt;2e-16          
                                          
            Sensitivity : 0.7418          
            Specificity : 0.7531          
         Pos Pred Value : 0.9227          
         Neg Pred Value : 0.4235          
             Prevalence : 0.7988          
         Detection Rate : 0.5926          
   Detection Prevalence : 0.6423          
      Balanced Accuracy : 0.7475          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1"></a>qda.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(qda.predictions)</span>
<span id="cb98-2"><a href="#cb98-2"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(qda.predictions, test<span class="sc">$</span>good)</span>
<span id="cb98-3"><a href="#cb98-3"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb98-4"><a href="#cb98-4"></a>auc_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7474858</code></pre>
</div>
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb100-2"><a href="#cb100-2"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb100-3"><a href="#cb100-3"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb100-4"><a href="#cb100-4"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb100-5"><a href="#cb100-5"></a>     <span class="at">main =</span> <span class="st">"ROC Curves from Repeated CV"</span>)</span>
<span id="cb100-6"><a href="#cb100-6"></a><span class="fu">points</span>(auc_val, <span class="dv">1</span> <span class="sc">-</span> auc_val, </span>
<span id="cb100-7"><a href="#cb100-7"></a>       <span class="at">col =</span> <span class="st">"steelblue"</span>, </span>
<span id="cb100-8"><a href="#cb100-8"></a>       <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb100-9"><a href="#cb100-9"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1"></a>qda.kfoldCV.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="tuned-6" class="level4">
<h4 class="anchored" data-anchor-id="tuned-6">Tuned</h4>
<div class="sourceCode" id="cb102"><pre class="sourceCode numberSource {rqda.kfoldcv_mod} number-lines code-with-copy"><code class="sourceCode"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table class="table">
<colgroup>
<col style="width: 29%">
<col style="width: 17%">
<col style="width: 18%">
<col style="width: 18%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th>Resampling Method</th>
<th>Error Rate</th>
<th>Sensitivity</th>
<th>Specificity</th>
<th>AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>QDA</td>
<td>0.2559</td>
<td>0.7418</td>
<td>0.7531</td>
<td>0.7474858</td>
</tr>
<tr class="even">
<td>QDA (Tuned)</td>
<td>0.xxxx</td>
<td>0.xxxx</td>
<td>0.xxxx</td>
<td>0.xxxxxxx</td>
</tr>
</tbody>
</table>
</section>
</section>
</section>
<section id="summary-1" class="level2">
<h2 class="anchored" data-anchor-id="summary-1">Summary</h2>
<div class="cell">
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(knn.kfoldCV.ROC.plot,</span>
<span id="cb103-2"><a href="#cb103-2"></a>                   logit.kfoldCV.ROC.plot,</span>
<span id="cb103-3"><a href="#cb103-3"></a>                   lda.kfoldCV.ROC.plot,</span>
<span id="cb103-4"><a href="#cb103-4"></a>                   qda.kfoldCV.ROC.plot, </span>
<span id="cb103-5"><a href="#cb103-5"></a>                   <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">align =</span> <span class="st">"hv"</span>, <span class="at">scale =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Sang_files/figure-html/log.lda.qda.ROC_curve-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<table class="table">
<colgroup>
<col style="width: 39%">
<col style="width: 14%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th>Resampling Method</th>
<th>Error Rate</th>
<th>Sensitivity</th>
<th>Specificity</th>
<th>AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Logistic Regression</td>
<td>0.1944</td>
<td>0.9347</td>
<td>0.2929</td>
<td>0.6137776</td>
</tr>
<tr class="even">
<td>Logistic Regression (Tuned)</td>
<td>0.1919</td>
<td>0.98946</td>
<td>0.08787</td>
<td>0.5386644</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>LDA</td>
<td>0.1919</td>
<td>0.9283</td>
<td>0.3305</td>
<td>0.6294448</td>
</tr>
<tr class="odd">
<td>LDA (Tuned)</td>
<td>0.xxxx</td>
<td>0.xxxx</td>
<td>0.xxxx</td>
<td>0.xxxxxxx</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>QDA</td>
<td>0.2559</td>
<td>0.7418</td>
<td>0.7531</td>
<td>0.7474858</td>
</tr>
<tr class="even">
<td>QDA (Tuned)</td>
<td>0.xxxx</td>
<td>0.xxxx</td>
<td>0.xxxx</td>
<td>0.xxxxxxx</td>
</tr>
</tbody>
</table>
</section>
<section id="multi-regression" class="level2">
<h2 class="anchored" data-anchor-id="multi-regression">Multi Regression</h2>
<section id="model-construction-4" class="level3">
<h3 class="anchored" data-anchor-id="model-construction-4">Model Construction</h3>
<div class="cell">
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="k-fold-cv-4" class="level3">
<h3 class="anchored" data-anchor-id="k-fold-cv-4">K-fold CV</h3>
<div class="cell">

</div>
<section id="tuned-7" class="level4">
<h4 class="anchored" data-anchor-id="tuned-7">Tuned</h4>
<div class="cell">

</div>
</section>
</section>
</section>
<section id="naive-bayes" class="level2">
<h2 class="anchored" data-anchor-id="naive-bayes">Naive Bayes</h2>
<section id="model-construction-5" class="level3">
<h3 class="anchored" data-anchor-id="model-construction-5">Model Construction</h3>
<div class="cell">
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="k-fold-cv-5" class="level3">
<h3 class="anchored" data-anchor-id="k-fold-cv-5">K-fold CV</h3>
<div class="cell">

</div>
<section id="tuned-8" class="level4">
<h4 class="anchored" data-anchor-id="tuned-8">Tuned</h4>
<div class="cell">

</div>
</section>
</section>
</section>
<section id="decision-forest" class="level2">
<h2 class="anchored" data-anchor-id="decision-forest">Decision Forest</h2>
<section id="model-construction-6" class="level3">
<h3 class="anchored" data-anchor-id="model-construction-6">Model Construction</h3>
<div class="cell">
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="k-fold-cv-6" class="level3">
<h3 class="anchored" data-anchor-id="k-fold-cv-6">K-fold CV</h3>
<div class="cell">

</div>
<section id="tuned-9" class="level4">
<h4 class="anchored" data-anchor-id="tuned-9">Tuned</h4>
<div class="cell">

</div>
</section>
</section>
</section>
<section id="classification-tree" class="level2">
<h2 class="anchored" data-anchor-id="classification-tree">Classification Tree</h2>
<section id="model-construction-7" class="level3">
<h3 class="anchored" data-anchor-id="model-construction-7">Model Construction</h3>
<div class="cell">
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="k-fold-cv-7" class="level3">
<h3 class="anchored" data-anchor-id="k-fold-cv-7">K-fold CV</h3>
<div class="cell">

</div>
<section id="tuned-10" class="level4">
<h4 class="anchored" data-anchor-id="tuned-10">Tuned</h4>
<div class="cell">

</div>
</section>
</section>
</section>
<section id="regression-tree" class="level2">
<h2 class="anchored" data-anchor-id="regression-tree">Regression Tree</h2>
<section id="model-construction-8" class="level3">
<h3 class="anchored" data-anchor-id="model-construction-8">Model Construction</h3>
<div class="cell">
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="k-fold-cv-8" class="level3">
<h3 class="anchored" data-anchor-id="k-fold-cv-8">K-fold CV</h3>
<div class="cell">

</div>
<section id="tuned-11" class="level4">
<h4 class="anchored" data-anchor-id="tuned-11">Tuned</h4>
<div class="cell">

</div>
</section>
</section>
</section>
<section id="randome-forest---classification" class="level2">
<h2 class="anchored" data-anchor-id="randome-forest---classification">Randome Forest - Classification</h2>
<section id="model-construction-9" class="level3">
<h3 class="anchored" data-anchor-id="model-construction-9">Model Construction</h3>
<div class="cell">
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="k-fold-cv-9" class="level3">
<h3 class="anchored" data-anchor-id="k-fold-cv-9">K-fold CV</h3>
<div class="cell">

</div>
<section id="tuned-12" class="level4">
<h4 class="anchored" data-anchor-id="tuned-12">Tuned</h4>
<div class="cell">

</div>
</section>
</section>
</section>
<section id="randome-forest---regression" class="level2">
<h2 class="anchored" data-anchor-id="randome-forest---regression">Randome Forest - Regression</h2>
<section id="model-construction-10" class="level3">
<h3 class="anchored" data-anchor-id="model-construction-10">Model Construction</h3>
<div class="cell">
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="k-fold-cv-10" class="level3">
<h3 class="anchored" data-anchor-id="k-fold-cv-10">K-fold CV</h3>
<div class="cell">

</div>
<section id="tuned-13" class="level4">
<h4 class="anchored" data-anchor-id="tuned-13">Tuned</h4>
<div class="cell">

</div>
</section>
</section>
</section>
<section id="boosting" class="level2">
<h2 class="anchored" data-anchor-id="boosting">Boosting</h2>
<section id="model-construction-11" class="level3">
<h3 class="anchored" data-anchor-id="model-construction-11">Model Construction</h3>
<div class="cell">
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="k-fold-cv-11" class="level3">
<h3 class="anchored" data-anchor-id="k-fold-cv-11">K-fold CV</h3>
<div class="cell">

</div>
<section id="tuned-14" class="level4">
<h4 class="anchored" data-anchor-id="tuned-14">Tuned</h4>
<div class="cell">

</div>
</section>
</section>
</section>
<section id="bagging" class="level2">
<h2 class="anchored" data-anchor-id="bagging">Bagging</h2>
<section id="model-construction-12" class="level3">
<h3 class="anchored" data-anchor-id="model-construction-12">Model Construction</h3>
<div class="cell">
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="k-fold-cv-12" class="level3">
<h3 class="anchored" data-anchor-id="k-fold-cv-12">K-fold CV</h3>
<div class="cell">

</div>
<section id="tuned-15" class="level4">
<h4 class="anchored" data-anchor-id="tuned-15">Tuned</h4>
<div class="cell">

</div>
</section>
</section>
</section>
<section id="svm" class="level2">
<h2 class="anchored" data-anchor-id="svm">SVM</h2>
<section id="model-construction-13" class="level3">
<h3 class="anchored" data-anchor-id="model-construction-13">Model Construction</h3>
<div class="cell">
<details>
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="k-fold-cv-13" class="level3">
<h3 class="anchored" data-anchor-id="k-fold-cv-13">K-fold CV</h3>
<div class="cell">

</div>
<section id="tuned-16" class="level4">
<h4 class="anchored" data-anchor-id="tuned-16">Tuned</h4>
<div class="cell">

</div>
<!-- -->

</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } 
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb114" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb114-1"><a href="#cb114-1"></a><span class="co">---</span></span>
<span id="cb114-2"><a href="#cb114-2"></a><span class="an">title:</span><span class="co"> "Introduction to Statistical Learning"</span></span>
<span id="cb114-3"><a href="#cb114-3"></a><span class="an">subtitle:</span><span class="co"> "STAT 387" </span></span>
<span id="cb114-4"><a href="#cb114-4"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb114-5"><a href="#cb114-5"></a><span class="co">  html:</span></span>
<span id="cb114-6"><a href="#cb114-6"></a><span class="co">    df-print: paged</span></span>
<span id="cb114-7"><a href="#cb114-7"></a><span class="co">    theme:</span></span>
<span id="cb114-8"><a href="#cb114-8"></a><span class="co">      light: materia</span></span>
<span id="cb114-9"><a href="#cb114-9"></a><span class="co">      dark: slate</span></span>
<span id="cb114-10"><a href="#cb114-10"></a><span class="co">    toc: true</span></span>
<span id="cb114-11"><a href="#cb114-11"></a><span class="co">    toc-title: Table of Contents</span></span>
<span id="cb114-12"><a href="#cb114-12"></a><span class="co">    toc-depth: 4</span></span>
<span id="cb114-13"><a href="#cb114-13"></a><span class="co">    toc-location: left</span></span>
<span id="cb114-14"><a href="#cb114-14"></a><span class="co">    number-sections: false</span></span>
<span id="cb114-15"><a href="#cb114-15"></a><span class="co">    number-depth: 3</span></span>
<span id="cb114-16"><a href="#cb114-16"></a><span class="co">    anchor-sections: true</span></span>
<span id="cb114-17"><a href="#cb114-17"></a><span class="co">    smooth-scroll: true</span></span>
<span id="cb114-18"><a href="#cb114-18"></a><span class="co">    link-external-icon: false</span></span>
<span id="cb114-19"><a href="#cb114-19"></a><span class="co">    link-external-newwindow: false</span></span>
<span id="cb114-20"><a href="#cb114-20"></a><span class="co">    code-fold: true</span></span>
<span id="cb114-21"><a href="#cb114-21"></a><span class="co">    code-line-numbers: true</span></span>
<span id="cb114-22"><a href="#cb114-22"></a><span class="co">    code-overflow: scroll</span></span>
<span id="cb114-23"><a href="#cb114-23"></a><span class="co">    code-tools: </span></span>
<span id="cb114-24"><a href="#cb114-24"></a><span class="co">      source: true</span></span>
<span id="cb114-25"><a href="#cb114-25"></a><span class="co">      toggle: true</span></span>
<span id="cb114-26"><a href="#cb114-26"></a><span class="co">      caption: none</span></span>
<span id="cb114-27"><a href="#cb114-27"></a><span class="co">    code-summary: "Show/Hide Code"</span></span>
<span id="cb114-28"><a href="#cb114-28"></a><span class="co">    highlight-style: atom-one</span></span>
<span id="cb114-29"><a href="#cb114-29"></a><span class="co">    link-external-filter: '^(?:http:|https:)\/\/www\.quarto\.org\/custom'</span></span>
<span id="cb114-30"><a href="#cb114-30"></a><span class="co">    self-contained-math: true</span></span>
<span id="cb114-31"><a href="#cb114-31"></a><span class="co">    fig-align: center</span></span>
<span id="cb114-32"><a href="#cb114-32"></a><span class="co">    html-math-method:</span></span>
<span id="cb114-33"><a href="#cb114-33"></a><span class="co">      method: mathjax</span></span>
<span id="cb114-34"><a href="#cb114-34"></a><span class="co">      url: "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"</span></span>
<span id="cb114-35"><a href="#cb114-35"></a><span class="co">---</span></span>
<span id="cb114-36"><a href="#cb114-36"></a></span>
<span id="cb114-37"><a href="#cb114-37"></a><span class="in">```{r setup, include=FALSE}</span></span>
<span id="cb114-38"><a href="#cb114-38"></a><span class="fu">library</span>(tidyverse)  <span class="co"># Load core packages: </span></span>
<span id="cb114-39"><a href="#cb114-39"></a><span class="co"># ggplot2,   for data visualization.</span></span>
<span id="cb114-40"><a href="#cb114-40"></a><span class="co"># dplyr,     for data manipulation.</span></span>
<span id="cb114-41"><a href="#cb114-41"></a><span class="co"># tidyr,     for data tidying.</span></span>
<span id="cb114-42"><a href="#cb114-42"></a><span class="co"># purrr,     for functional programming.</span></span>
<span id="cb114-43"><a href="#cb114-43"></a><span class="co"># tibble,    for tibbles, a modern re-imagining of data frames.</span></span>
<span id="cb114-44"><a href="#cb114-44"></a><span class="co"># stringr,   for strings.</span></span>
<span id="cb114-45"><a href="#cb114-45"></a><span class="co"># forcats,   for factors.</span></span>
<span id="cb114-46"><a href="#cb114-46"></a><span class="co"># lubridate, for date/times.</span></span>
<span id="cb114-47"><a href="#cb114-47"></a><span class="co"># readr,     for reading .csv, .tsv, and .fwf files.</span></span>
<span id="cb114-48"><a href="#cb114-48"></a><span class="co"># readxl,    for reading .xls, and .xlxs files.</span></span>
<span id="cb114-49"><a href="#cb114-49"></a><span class="co"># feather,   for sharing with Python and other languages.</span></span>
<span id="cb114-50"><a href="#cb114-50"></a><span class="co"># haven,     for SPSS, SAS and Stata files.</span></span>
<span id="cb114-51"><a href="#cb114-51"></a><span class="co"># httr,      for web apis.</span></span>
<span id="cb114-52"><a href="#cb114-52"></a><span class="co"># jsonlite   for JSON.</span></span>
<span id="cb114-53"><a href="#cb114-53"></a><span class="co"># rvest,     for web scraping.</span></span>
<span id="cb114-54"><a href="#cb114-54"></a><span class="co"># xml2,      for XML.</span></span>
<span id="cb114-55"><a href="#cb114-55"></a><span class="co"># modelr,    for modelling within a pipeline</span></span>
<span id="cb114-56"><a href="#cb114-56"></a><span class="co"># broom,     for turning models into tidy data</span></span>
<span id="cb114-57"><a href="#cb114-57"></a><span class="co"># hms,       for times.</span></span>
<span id="cb114-58"><a href="#cb114-58"></a></span>
<span id="cb114-59"><a href="#cb114-59"></a><span class="fu">library</span>(magrittr)   <span class="co"># Pipeline operator</span></span>
<span id="cb114-60"><a href="#cb114-60"></a><span class="fu">library</span>(lobstr)     <span class="co"># Visualizing abstract syntax trees, stack trees, and object sizes</span></span>
<span id="cb114-61"><a href="#cb114-61"></a><span class="fu">library</span>(pander)     <span class="co"># Exporting/converting complex pandoc documents, EX: df to Pandoc table</span></span>
<span id="cb114-62"><a href="#cb114-62"></a><span class="fu">library</span>(ggforce)    <span class="co"># More plot functions on top of ggplot2</span></span>
<span id="cb114-63"><a href="#cb114-63"></a><span class="fu">library</span>(ggpubr)     <span class="co"># Automatically add p-values and significance levels  plots. </span></span>
<span id="cb114-64"><a href="#cb114-64"></a><span class="co"># Arrange and annotate multiple plots on the same page. </span></span>
<span id="cb114-65"><a href="#cb114-65"></a><span class="co"># Change graphical parameters such as colors and labels.</span></span>
<span id="cb114-66"><a href="#cb114-66"></a><span class="fu">library</span>(sf)         <span class="co"># Geo-spatial vector manipulation: points, lines, polygons</span></span>
<span id="cb114-67"><a href="#cb114-67"></a><span class="fu">library</span>(kableExtra) <span class="co"># Generate 90 % of complex/advanced/self-customized/beautiful tables</span></span>
<span id="cb114-68"><a href="#cb114-68"></a><span class="fu">library</span>(cowplot)    <span class="co"># Multiple plots arrangement</span></span>
<span id="cb114-69"><a href="#cb114-69"></a><span class="fu">library</span>(gridExtra)  <span class="co"># Multiple plots arrangement</span></span>
<span id="cb114-70"><a href="#cb114-70"></a><span class="fu">library</span>(animation)  <span class="co"># Animated figure container</span></span>
<span id="cb114-71"><a href="#cb114-71"></a><span class="fu">library</span>(latex2exp)  <span class="co"># Latex axis titles in ggplot2</span></span>
<span id="cb114-72"><a href="#cb114-72"></a><span class="fu">library</span>(ellipse)    <span class="co"># Simultaneous confidence interval region to check C.I. of 2 slope parameters</span></span>
<span id="cb114-73"><a href="#cb114-73"></a><span class="fu">library</span>(plotly)     <span class="co"># User interactive plots</span></span>
<span id="cb114-74"><a href="#cb114-74"></a><span class="fu">library</span>(ellipse)    <span class="co"># Simultaneous confidence interval region to check C.I. of 2 regressors</span></span>
<span id="cb114-75"><a href="#cb114-75"></a><span class="fu">library</span>(olsrr)      <span class="co"># Model selections </span></span>
<span id="cb114-76"><a href="#cb114-76"></a><span class="fu">library</span>(leaps)      <span class="co"># Regression subsetting </span></span>
<span id="cb114-77"><a href="#cb114-77"></a><span class="fu">library</span>(pls)        <span class="co"># Partial Least squares</span></span>
<span id="cb114-78"><a href="#cb114-78"></a><span class="fu">library</span>(MASS)       <span class="co"># LDA, QDA, OLS, Ridge Regression, Box-Cox, stepAIC, etc,.</span></span>
<span id="cb114-79"><a href="#cb114-79"></a><span class="fu">library</span>(e1071)      <span class="co"># Naive Bayesian Classfier,SVM, GKNN, ICA, LCA</span></span>
<span id="cb114-80"><a href="#cb114-80"></a><span class="fu">library</span>(class)      <span class="co"># KNN, SOM, LVQ</span></span>
<span id="cb114-81"><a href="#cb114-81"></a><span class="fu">library</span>(ROCR)       <span class="co"># Precision/Recall/Sensitivity/Specificity performance plot </span></span>
<span id="cb114-82"><a href="#cb114-82"></a><span class="fu">library</span>(boot)       <span class="co"># LOOCV, Bootstrap,</span></span>
<span id="cb114-83"><a href="#cb114-83"></a><span class="fu">library</span>(caret)      <span class="co"># Classification/Regression Training, run ?caret::trainControl</span></span>
<span id="cb114-84"><a href="#cb114-84"></a><span class="fu">library</span>(corrgram)   <span class="co"># for correlation matrix</span></span>
<span id="cb114-85"><a href="#cb114-85"></a><span class="fu">library</span>(corrplot)   <span class="co"># for graphical display of correlation matrix</span></span>
<span id="cb114-86"><a href="#cb114-86"></a></span>
<span id="cb114-87"><a href="#cb114-87"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)        <span class="co"># make random results reproducible</span></span>
<span id="cb114-88"><a href="#cb114-88"></a></span>
<span id="cb114-89"><a href="#cb114-89"></a>current_dir <span class="ot">&lt;-</span> <span class="fu">getwd</span>()</span>
<span id="cb114-90"><a href="#cb114-90"></a></span>
<span id="cb114-91"><a href="#cb114-91"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(current_dir)) {</span>
<span id="cb114-92"><a href="#cb114-92"></a>  <span class="fu">setwd</span>(current_dir)</span>
<span id="cb114-93"><a href="#cb114-93"></a>  <span class="fu">remove</span>(current_dir)</span>
<span id="cb114-94"><a href="#cb114-94"></a>}</span>
<span id="cb114-95"><a href="#cb114-95"></a><span class="in">```</span></span>
<span id="cb114-96"><a href="#cb114-96"></a></span>
<span id="cb114-97"><a href="#cb114-97"></a><span class="in">```{css, echo=FALSE}</span></span>
<span id="cb114-98"><a href="#cb114-98"></a>body <span class="op">{</span></span>
<span id="cb114-99"><a href="#cb114-99"></a>font<span class="op">-</span>family<span class="op">:</span> <span class="st">"Times New Roman"</span><span class="op">;</span></span>
<span id="cb114-100"><a href="#cb114-100"></a>font<span class="op">-</span>size<span class="op">:</span> <span class="fl">0.8</span>em<span class="op">;</span></span>
<span id="cb114-101"><a href="#cb114-101"></a><span class="op">}</span></span>
<span id="cb114-102"><a href="#cb114-102"></a></span>
<span id="cb114-103"><a href="#cb114-103"></a>h2<span class="op">,</span> <span class="op">.</span><span class="fu">h2</span><span class="op">,</span> h2<span class="op">.</span><span class="fu">anchored</span><span class="op">,</span> </span>
<span id="cb114-104"><a href="#cb114-104"></a>h3<span class="op">,</span> <span class="op">.</span><span class="fu">h3</span><span class="op">,</span> h3<span class="op">.</span><span class="fu">anchored</span><span class="op">,</span></span>
<span id="cb114-105"><a href="#cb114-105"></a><span class="op">.</span><span class="fu">quarto</span><span class="op">-</span>title<span class="op">,</span> </span>
<span id="cb114-106"><a href="#cb114-106"></a><span class="op">.</span><span class="fu">quarto</span><span class="op">-</span>title<span class="op">-</span>meta <span class="op">{</span></span>
<span id="cb114-107"><a href="#cb114-107"></a>text<span class="op">-</span>align<span class="op">:</span> center<span class="op">;</span></span>
<span id="cb114-108"><a href="#cb114-108"></a><span class="op">}</span></span>
<span id="cb114-109"><a href="#cb114-109"></a></span>
<span id="cb114-110"><a href="#cb114-110"></a>h2<span class="op">,</span> <span class="op">.</span><span class="fu">h2</span> <span class="op">{</span></span>
<span id="cb114-111"><a href="#cb114-111"></a>font<span class="op">-</span>size<span class="op">:</span> <span class="fl">1.5</span>em<span class="op">;</span></span>
<span id="cb114-112"><a href="#cb114-112"></a><span class="op">}</span></span>
<span id="cb114-113"><a href="#cb114-113"></a></span>
<span id="cb114-114"><a href="#cb114-114"></a>h3<span class="op">,</span> <span class="op">.</span><span class="fu">h3</span> <span class="op">{</span></span>
<span id="cb114-115"><a href="#cb114-115"></a>font<span class="op">-</span>size<span class="op">:</span> <span class="fl">1.25</span>em<span class="op">;</span></span>
<span id="cb114-116"><a href="#cb114-116"></a><span class="op">}</span></span>
<span id="cb114-117"><a href="#cb114-117"></a></span>
<span id="cb114-118"><a href="#cb114-118"></a>h4<span class="op">,</span> <span class="op">.</span><span class="fu">h4</span> <span class="op">{</span></span>
<span id="cb114-119"><a href="#cb114-119"></a>font<span class="op">-</span>size<span class="op">:</span> 1em<span class="op">;</span></span>
<span id="cb114-120"><a href="#cb114-120"></a><span class="op">}</span></span>
<span id="cb114-121"><a href="#cb114-121"></a></span>
<span id="cb114-122"><a href="#cb114-122"></a>h5<span class="op">,</span> <span class="op">.</span><span class="fu">h5</span> <span class="op">{</span></span>
<span id="cb114-123"><a href="#cb114-123"></a>font<span class="op">-</span>size<span class="op">:</span> <span class="fl">0.75</span>em<span class="op">;</span></span>
<span id="cb114-124"><a href="#cb114-124"></a><span class="op">}</span></span>
<span id="cb114-125"><a href="#cb114-125"></a></span>
<span id="cb114-126"><a href="#cb114-126"></a>h6<span class="op">,</span> <span class="op">.</span><span class="fu">h6</span> <span class="op">{</span></span>
<span id="cb114-127"><a href="#cb114-127"></a>font<span class="op">-</span>size<span class="op">:</span> <span class="fl">0.7</span>em<span class="op">;</span></span>
<span id="cb114-128"><a href="#cb114-128"></a><span class="op">}</span></span>
<span id="cb114-129"><a href="#cb114-129"></a></span>
<span id="cb114-130"><a href="#cb114-130"></a><span class="op">.</span><span class="fu">quarto</span><span class="op">-</span>title<span class="op">-</span>meta <span class="op">{</span></span>
<span id="cb114-131"><a href="#cb114-131"></a>display<span class="op">:</span> block<span class="op">!</span>important<span class="op">;</span></span>
<span id="cb114-132"><a href="#cb114-132"></a><span class="op">}</span></span>
<span id="cb114-133"><a href="#cb114-133"></a></span>
<span id="cb114-134"><a href="#cb114-134"></a><span class="op">.</span><span class="fu">quarto</span><span class="op">-</span>title<span class="op">-</span>meta<span class="op">-</span>heading <span class="op">{</span></span>
<span id="cb114-135"><a href="#cb114-135"></a>display<span class="op">:</span> none<span class="op">;</span></span>
<span id="cb114-136"><a href="#cb114-136"></a><span class="op">}</span></span>
<span id="cb114-137"><a href="#cb114-137"></a></span>
<span id="cb114-138"><a href="#cb114-138"></a><span class="op">.</span><span class="fu">content</span> <span class="op">{</span></span>
<span id="cb114-139"><a href="#cb114-139"></a>width<span class="op">:</span> 1000px<span class="op">;</span></span>
<span id="cb114-140"><a href="#cb114-140"></a><span class="op">}</span></span>
<span id="cb114-141"><a href="#cb114-141"></a><span class="op">.</span><span class="fu">dropdown</span><span class="op">-</span>menu <span class="op">{</span></span>
<span id="cb114-142"><a href="#cb114-142"></a>font<span class="op">-</span>size<span class="op">:</span> <span class="fl">0.8</span>rem<span class="op">;</span></span>
<span id="cb114-143"><a href="#cb114-143"></a><span class="op">}</span></span>
<span id="cb114-144"><a href="#cb114-144"></a></span>
<span id="cb114-145"><a href="#cb114-145"></a>code <span class="op">{</span></span>
<span id="cb114-146"><a href="#cb114-146"></a>color<span class="op">:</span> #61AFEF<span class="op">;</span></span>
<span id="cb114-147"><a href="#cb114-147"></a><span class="op">}</span></span>
<span id="cb114-148"><a href="#cb114-148"></a></span>
<span id="cb114-149"><a href="#cb114-149"></a><span class="op">.</span><span class="fu">btn</span> <span class="op">{</span></span>
<span id="cb114-150"><a href="#cb114-150"></a>border<span class="op">-</span>color<span class="op">:</span> #f8f9fa9e<span class="op">!</span>important<span class="op">;</span></span>
<span id="cb114-151"><a href="#cb114-151"></a><span class="op">}</span></span>
<span id="cb114-152"><a href="#cb114-152"></a></span>
<span id="cb114-153"><a href="#cb114-153"></a>body<span class="op">.</span><span class="fu">quarto</span><span class="op">-</span>dark <span class="op">{</span></span>
<span id="cb114-154"><a href="#cb114-154"></a>background<span class="op">-</span>color<span class="op">:</span> #282c34<span class="op">;</span></span>
<span id="cb114-155"><a href="#cb114-155"></a></span>
<span id="cb114-156"><a href="#cb114-156"></a>color<span class="op">:</span> #d8dee9<span class="op">;</span></span>
<span id="cb114-157"><a href="#cb114-157"></a></span>
<span id="cb114-158"><a href="#cb114-158"></a><span class="op">.</span><span class="fu">pagedtable</span> <span class="op">.</span><span class="fu">even</span> <span class="op">{</span></span>
<span id="cb114-159"><a href="#cb114-159"></a>background<span class="op">-</span>color<span class="op">:</span> #3b4252<span class="op">!</span>important<span class="op">;</span></span>
<span id="cb114-160"><a href="#cb114-160"></a><span class="op">}</span></span>
<span id="cb114-161"><a href="#cb114-161"></a></span>
<span id="cb114-162"><a href="#cb114-162"></a>p code<span class="op">:</span><span class="fu">not</span><span class="op">(.</span><span class="fu">sourceCode</span><span class="op">),</span> li code<span class="op">:</span><span class="fu">not</span><span class="op">(.</span><span class="fu">sourceCode</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb114-163"><a href="#cb114-163"></a>background<span class="op">-</span>color<span class="op">:</span> #4c566a<span class="op">!</span>important<span class="op">;</span></span>
<span id="cb114-164"><a href="#cb114-164"></a><span class="op">}</span></span>
<span id="cb114-165"><a href="#cb114-165"></a><span class="op">}</span></span>
<span id="cb114-166"><a href="#cb114-166"></a></span>
<span id="cb114-167"><a href="#cb114-167"></a>#quarto<span class="op">-</span>code<span class="op">-</span>tools<span class="op">-</span>menu<span class="op">{</span></span>
<span id="cb114-168"><a href="#cb114-168"></a>position<span class="op">:</span> absolute<span class="op">;</span></span>
<span id="cb114-169"><a href="#cb114-169"></a><span class="op">}</span></span>
<span id="cb114-170"><a href="#cb114-170"></a></span>
<span id="cb114-171"><a href="#cb114-171"></a><span class="op">.</span><span class="fu">top</span><span class="op">-</span>right <span class="op">{</span></span>
<span id="cb114-172"><a href="#cb114-172"></a>position<span class="op">:</span> <span class="kw">fixed</span><span class="op">;</span></span>
<span id="cb114-173"><a href="#cb114-173"></a><span class="op">}</span></span>
<span id="cb114-174"><a href="#cb114-174"></a></span>
<span id="cb114-175"><a href="#cb114-175"></a>#TOC<span class="op">::</span>before <span class="op">{</span></span>
<span id="cb114-176"><a href="#cb114-176"></a>content<span class="op">:</span> <span class="st">""</span><span class="op">;</span></span>
<span id="cb114-177"><a href="#cb114-177"></a>display<span class="op">:</span> block<span class="op">;</span></span>
<span id="cb114-178"><a href="#cb114-178"></a>height<span class="op">:</span> 141px<span class="op">;</span></span>
<span id="cb114-179"><a href="#cb114-179"></a>margin<span class="op">:</span> 20px 20px 20px 20px<span class="op">;</span></span>
<span id="cb114-180"><a href="#cb114-180"></a>background<span class="op">-</span>image<span class="op">:</span> <span class="fu">url</span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/theRealLeif/STAT387/main/README.asset/Logo.svg"</span><span class="op">);</span></span>
<span id="cb114-181"><a href="#cb114-181"></a>background<span class="op">-</span>size<span class="op">:</span> contain<span class="op">;</span></span>
<span id="cb114-182"><a href="#cb114-182"></a>background<span class="op">-</span>position<span class="op">:</span> center center<span class="op">;</span></span>
<span id="cb114-183"><a href="#cb114-183"></a>background<span class="op">-</span>repeat<span class="op">:</span> no<span class="op">-</span>repeat<span class="op">;</span></span>
<span id="cb114-184"><a href="#cb114-184"></a><span class="op">}</span></span>
<span id="cb114-185"><a href="#cb114-185"></a></span>
<span id="cb114-186"><a href="#cb114-186"></a><span class="in">```</span></span>
<span id="cb114-187"><a href="#cb114-187"></a></span>
<span id="cb114-188"><a href="#cb114-188"></a></span>
<span id="cb114-189"><a href="#cb114-189"></a><span class="fu">## Preamble</span></span>
<span id="cb114-190"><a href="#cb114-190"></a></span>
<span id="cb114-191"><a href="#cb114-191"></a>Consider the wine quality dataset from <span class="co">[</span><span class="ot">UCI Machine Learning Respository</span><span class="co">](https://archive.ics.uci.edu/ml/datasets/Wine+Quality)</span>. We will focus only on the data concerning white wines (and not red wines). Dichotomize the <span class="in">`quality`</span> variable as <span class="in">`good`</span>, which takes the value 1 if quality â‰¥ 7 and the value 0, otherwise. We will take <span class="in">`good`</span> as response and all the 11 physiochemical characteristics of the wines in the data as predictors.</span>
<span id="cb114-192"><a href="#cb114-192"></a></span>
<span id="cb114-193"><a href="#cb114-193"></a><span class="fu">### Problem Statements</span></span>
<span id="cb114-194"><a href="#cb114-194"></a></span>
<span id="cb114-195"><a href="#cb114-195"></a>Use 10-fold cross-validation for estimating the test error rates below and compute the estimates using <span class="in">`caret`</span> package with seed set to 1234 before each computation.</span>
<span id="cb114-196"><a href="#cb114-196"></a></span>
<span id="cb114-197"><a href="#cb114-197"></a>(a) Fit a KNN with K chosen optimally using test error rate. Report error rate, sensitivity, specificity, and AUC for the optimal KNN based on the training data. Also, report its estimated test error rate.</span>
<span id="cb114-198"><a href="#cb114-198"></a>(b) Repeat (a) using logistic regression.</span>
<span id="cb114-199"><a href="#cb114-199"></a>(c) Repeat (a) using LDA.</span>
<span id="cb114-200"><a href="#cb114-200"></a>(d) Repeat (a) using QDA.</span>
<span id="cb114-201"><a href="#cb114-201"></a>(e) Compare the results in (a)-(d). Which classifier would you recommend? Justify your answer.</span>
<span id="cb114-202"><a href="#cb114-202"></a></span>
<span id="cb114-203"><a href="#cb114-203"></a></span>
<span id="cb114-204"><a href="#cb114-204"></a></span>
<span id="cb114-205"><a href="#cb114-205"></a><span class="fu">### Methodologies</span></span>
<span id="cb114-206"><a href="#cb114-206"></a><span class="ss">- </span>KNN</span>
<span id="cb114-207"><a href="#cb114-207"></a><span class="ss">- </span>GLM/logit/glmnet</span>
<span id="cb114-208"><a href="#cb114-208"></a><span class="ss">- </span>LDA</span>
<span id="cb114-209"><a href="#cb114-209"></a><span class="ss">- </span>QDA</span>
<span id="cb114-210"><a href="#cb114-210"></a><span class="ss">- </span>Regression/Multi-Regression</span>
<span id="cb114-211"><a href="#cb114-211"></a><span class="ss">- </span>Naive Bayes</span>
<span id="cb114-212"><a href="#cb114-212"></a><span class="ss">- </span>Decision Tree</span>
<span id="cb114-213"><a href="#cb114-213"></a><span class="ss">- </span>Classification Tree</span>
<span id="cb114-214"><a href="#cb114-214"></a><span class="ss">- </span>Regression Tree</span>
<span id="cb114-215"><a href="#cb114-215"></a><span class="ss">- </span>Classification and Regression Trees (CART)</span>
<span id="cb114-216"><a href="#cb114-216"></a><span class="ss">- </span>Iterative Dichotomiser 3 (ID3)</span>
<span id="cb114-217"><a href="#cb114-217"></a><span class="ss">- </span>C4.5</span>
<span id="cb114-218"><a href="#cb114-218"></a><span class="ss">- </span>Random Forest</span>
<span id="cb114-219"><a href="#cb114-219"></a><span class="ss">- </span>Classification</span>
<span id="cb114-220"><a href="#cb114-220"></a><span class="ss">- </span>Regression</span>
<span id="cb114-221"><a href="#cb114-221"></a><span class="ss">- </span>Bagged</span>
<span id="cb114-222"><a href="#cb114-222"></a><span class="ss">- </span>Boosted</span>
<span id="cb114-223"><a href="#cb114-223"></a><span class="ss">- </span>Gradient Boosted Trees (GBT)</span>
<span id="cb114-224"><a href="#cb114-224"></a><span class="ss">- </span>Extremely Randomized Trees (ExtraTrees)</span>
<span id="cb114-225"><a href="#cb114-225"></a><span class="ss">- </span>SVM</span>
<span id="cb114-226"><a href="#cb114-226"></a></span>
<span id="cb114-227"><a href="#cb114-227"></a><span class="fu">### Data Description</span></span>
<span id="cb114-228"><a href="#cb114-228"></a>This is a dataset of wine quality containing 4898 observations of 12 variables. The variables are:</span>
<span id="cb114-229"><a href="#cb114-229"></a></span>
<span id="cb114-230"><a href="#cb114-230"></a><span class="ss">- </span><span class="in">`fixed.acidity`</span>: The amount of fixed acid in the wine ($g/dm^3$)</span>
<span id="cb114-231"><a href="#cb114-231"></a><span class="ss">- </span><span class="in">`volatile.acidity`</span>: The amount of volatile acid in the wine ($g/dm^4$)</span>
<span id="cb114-232"><a href="#cb114-232"></a><span class="ss">- </span><span class="in">`citric.acid`</span>: The amount of citric acid in the wine ($g/dm^3$)</span>
<span id="cb114-233"><a href="#cb114-233"></a><span class="ss">- </span><span class="in">`residual.sugar`</span>: The amount of residual sugar in the wine ($g/dm^3$)</span>
<span id="cb114-234"><a href="#cb114-234"></a><span class="ss">- </span><span class="in">`chlorides`</span>: The amount of salt in the wine ($g/dm^3$)</span>
<span id="cb114-235"><a href="#cb114-235"></a><span class="ss">- </span><span class="in">`free.sulfur.dioxide`</span>: The amount of free sulfur dioxide in the wine ($mg/dm^3$)</span>
<span id="cb114-236"><a href="#cb114-236"></a><span class="ss">- </span><span class="in">`total.sulfur.dioxide`</span>: The amount of total sulfur dioxide in the wine ($mg/dm^3$)</span>
<span id="cb114-237"><a href="#cb114-237"></a><span class="ss">- </span><span class="in">`density`</span>: The density of the wine ($g/dm^3$)</span>
<span id="cb114-238"><a href="#cb114-238"></a><span class="ss">- </span><span class="in">`pH`</span>: The $pH$ value of the wine</span>
<span id="cb114-239"><a href="#cb114-239"></a><span class="ss">- </span><span class="in">`sulphates`</span>: The amount of sulphates in the wine ($g/dm^3$)</span>
<span id="cb114-240"><a href="#cb114-240"></a><span class="ss">- </span><span class="in">`alcohol`</span>: The alcohol content of the wine ($\% vol$)</span>
<span id="cb114-241"><a href="#cb114-241"></a><span class="ss">- </span><span class="in">`quality`</span>: The quality score of the wine ($0-10$)</span>
<span id="cb114-242"><a href="#cb114-242"></a></span>
<span id="cb114-243"><a href="#cb114-243"></a>After removing the duplicate rows from our data set, we are left with 3961 observations of the above 11 variables minus <span class="in">`quality`</span> column variable, and introduced a new variable <span class="in">`good`</span> as our response:</span>
<span id="cb114-244"><a href="#cb114-244"></a></span>
<span id="cb114-245"><a href="#cb114-245"></a><span class="ss">- </span><span class="in">`good`</span>: A binary variable indicating whether the wine is good (<span class="in">`quality`</span> $\geq 7$) or not (<span class="in">`quality`</span> $&lt;7$).</span>
<span id="cb114-246"><a href="#cb114-246"></a></span>
<span id="cb114-247"><a href="#cb114-247"></a></span>
<span id="cb114-248"><a href="#cb114-248"></a><span class="fu">## Exploratory Analysis</span></span>
<span id="cb114-249"><a href="#cb114-249"></a></span>
<span id="cb114-250"><a href="#cb114-250"></a><span class="fu">### Data Import</span></span>
<span id="cb114-251"><a href="#cb114-251"></a><span class="in">```{r data_import}</span></span>
<span id="cb114-252"><a href="#cb114-252"></a>wine.data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">winequality-white.csv"</span>, <span class="at">sep=</span><span class="st">";"</span>, <span class="at">header =</span> T)</span>
<span id="cb114-253"><a href="#cb114-253"></a></span>
<span id="cb114-254"><a href="#cb114-254"></a>wine.data <span class="ot">&lt;-</span>  wine.data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">good =</span> <span class="fu">ifelse</span>(quality<span class="sc">&gt;=</span><span class="dv">7</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb114-255"><a href="#cb114-255"></a></span>
<span id="cb114-256"><a href="#cb114-256"></a><span class="fu">head</span>(wine.data)</span>
<span id="cb114-257"><a href="#cb114-257"></a><span class="in">```</span></span>
<span id="cb114-258"><a href="#cb114-258"></a></span>
<span id="cb114-259"><a href="#cb114-259"></a><span class="fu">### Data Analysis</span></span>
<span id="cb114-260"><a href="#cb114-260"></a><span class="in">```{r basic_analysis}</span></span>
<span id="cb114-261"><a href="#cb114-261"></a><span class="fu">dim</span>(wine.data)</span>
<span id="cb114-262"><a href="#cb114-262"></a></span>
<span id="cb114-263"><a href="#cb114-263"></a><span class="co"># Removing duplicate Rows</span></span>
<span id="cb114-264"><a href="#cb114-264"></a>wine.data <span class="ot">&lt;-</span> wine.data[<span class="sc">!</span><span class="fu">duplicated</span>(wine.data), ]</span>
<span id="cb114-265"><a href="#cb114-265"></a></span>
<span id="cb114-266"><a href="#cb114-266"></a><span class="fu">dim</span>(wine.data)</span>
<span id="cb114-267"><a href="#cb114-267"></a></span>
<span id="cb114-268"><a href="#cb114-268"></a><span class="fu">str</span>(wine.data)</span>
<span id="cb114-269"><a href="#cb114-269"></a><span class="fu">summary</span>(wine.data)</span>
<span id="cb114-270"><a href="#cb114-270"></a></span>
<span id="cb114-271"><a href="#cb114-271"></a><span class="co"># Check for NAs in dataset</span></span>
<span id="cb114-272"><a href="#cb114-272"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(wine.data))</span>
<span id="cb114-273"><a href="#cb114-273"></a></span>
<span id="cb114-274"><a href="#cb114-274"></a><span class="co"># Counts at each combination of response's factor levels</span></span>
<span id="cb114-275"><a href="#cb114-275"></a><span class="fu">table</span>(wine.data<span class="sc">$</span>quality)</span>
<span id="cb114-276"><a href="#cb114-276"></a><span class="in">```</span></span>
<span id="cb114-277"><a href="#cb114-277"></a></span>
<span id="cb114-278"><a href="#cb114-278"></a><span class="fu">### Data Histograms</span></span>
<span id="cb114-279"><a href="#cb114-279"></a><span class="in">```{r hist_plot, warning=FALSE}</span></span>
<span id="cb114-280"><a href="#cb114-280"></a>wine.colnames <span class="ot">&lt;-</span> <span class="fu">colnames</span>(wine.data[, <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>])</span>
<span id="cb114-281"><a href="#cb114-281"></a>num_plots     <span class="ot">&lt;-</span> <span class="fu">length</span>(wine.colnames)</span>
<span id="cb114-282"><a href="#cb114-282"></a>num_rows      <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(num_plots<span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb114-283"><a href="#cb114-283"></a></span>
<span id="cb114-284"><a href="#cb114-284"></a></span>
<span id="cb114-285"><a href="#cb114-285"></a><span class="co"># Create an empty list to store plots</span></span>
<span id="cb114-286"><a href="#cb114-286"></a>grid_arr      <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb114-287"><a href="#cb114-287"></a></span>
<span id="cb114-288"><a href="#cb114-288"></a></span>
<span id="cb114-289"><a href="#cb114-289"></a><span class="co"># Loop over each column name in the wine.colnames vector</span></span>
<span id="cb114-290"><a href="#cb114-290"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_plots) {</span>
<span id="cb114-291"><a href="#cb114-291"></a>  <span class="co"># Create a ggplot object for the current column using aes</span></span>
<span id="cb114-292"><a href="#cb114-292"></a>  plt <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> wine.data, <span class="fu">aes_string</span>(<span class="at">x =</span> wine.colnames[i])) <span class="sc">+</span></span>
<span id="cb114-293"><a href="#cb114-293"></a>    <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fu">diff</span>(<span class="fu">range</span>(wine.data[[wine.colnames[i]]]))<span class="sc">/</span><span class="dv">30</span>, </span>
<span id="cb114-294"><a href="#cb114-294"></a>                   <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"slategray3"</span>) <span class="sc">+</span></span>
<span id="cb114-295"><a href="#cb114-295"></a>    <span class="fu">labs</span>(<span class="at">x =</span> wine.colnames[i], <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb114-296"><a href="#cb114-296"></a>    <span class="fu">theme_bw</span>()</span>
<span id="cb114-297"><a href="#cb114-297"></a>  </span>
<span id="cb114-298"><a href="#cb114-298"></a>  <span class="co"># Add the current plot to the grid_arr list</span></span>
<span id="cb114-299"><a href="#cb114-299"></a>  grid_arr[[i]] <span class="ot">&lt;-</span> plt</span>
<span id="cb114-300"><a href="#cb114-300"></a>}</span>
<span id="cb114-301"><a href="#cb114-301"></a></span>
<span id="cb114-302"><a href="#cb114-302"></a>grid_arr <span class="ot">&lt;-</span> <span class="fu">do.call</span>(gridExtra<span class="sc">::</span>grid.arrange, <span class="fu">c</span>(grid_arr, <span class="at">ncol =</span> <span class="dv">3</span>))</span>
<span id="cb114-303"><a href="#cb114-303"></a><span class="in">```</span></span>
<span id="cb114-304"><a href="#cb114-304"></a></span>
<span id="cb114-305"><a href="#cb114-305"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb114-306"><a href="#cb114-306"></a><span class="co"># Remove unnecessary variables</span></span>
<span id="cb114-307"><a href="#cb114-307"></a><span class="fu">remove</span>(grid_arr)</span>
<span id="cb114-308"><a href="#cb114-308"></a><span class="fu">remove</span>(plt)</span>
<span id="cb114-309"><a href="#cb114-309"></a><span class="fu">remove</span>(i)</span>
<span id="cb114-310"><a href="#cb114-310"></a><span class="fu">remove</span>(num_plots)</span>
<span id="cb114-311"><a href="#cb114-311"></a><span class="fu">remove</span>(num_rows)</span>
<span id="cb114-312"><a href="#cb114-312"></a><span class="in">```</span></span>
<span id="cb114-313"><a href="#cb114-313"></a></span>
<span id="cb114-314"><a href="#cb114-314"></a><span class="fu">### Data Relationships</span></span>
<span id="cb114-315"><a href="#cb114-315"></a><span class="in">```{r relation_plot, fig.width=10, fig.height=5, message=FALSE}</span></span>
<span id="cb114-316"><a href="#cb114-316"></a>reshape2<span class="sc">::</span><span class="fu">melt</span>(wine.data[, <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>], <span class="st">"quality"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb114-317"><a href="#cb114-317"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(value, quality, <span class="at">color =</span> variable)) <span class="sc">+</span>  </span>
<span id="cb114-318"><a href="#cb114-318"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb114-319"><a href="#cb114-319"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(value,quality, <span class="at">colour=</span>variable), <span class="at">method=</span>lm, <span class="at">se=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb114-320"><a href="#cb114-320"></a>  <span class="fu">facet_wrap</span>(.<span class="sc">~</span>variable, <span class="at">scales =</span> <span class="st">"free"</span>)</span>
<span id="cb114-321"><a href="#cb114-321"></a></span>
<span id="cb114-322"><a href="#cb114-322"></a><span class="co"># Collinearity between Attributes</span></span>
<span id="cb114-323"><a href="#cb114-323"></a><span class="fu">cor</span>(wine.data) <span class="sc">%&gt;%</span> </span>
<span id="cb114-324"><a href="#cb114-324"></a>  corrplot<span class="sc">::</span><span class="fu">corrplot</span>(<span class="at">method =</span> <span class="st">'number'</span>,  <span class="at">type =</span> <span class="st">"lower"</span>, <span class="at">tl.col =</span> <span class="st">"steelblue"</span>, <span class="at">number.cex =</span> <span class="fl">0.5</span>)</span>
<span id="cb114-325"><a href="#cb114-325"></a></span>
<span id="cb114-326"><a href="#cb114-326"></a><span class="co"># Remove quality from dataset, use good as response </span></span>
<span id="cb114-327"><a href="#cb114-327"></a>wine.data<span class="sc">$</span>quality <span class="ot">&lt;-</span> <span class="cn">NULL</span> </span>
<span id="cb114-328"><a href="#cb114-328"></a><span class="in">```</span></span>
<span id="cb114-329"><a href="#cb114-329"></a></span>
<span id="cb114-330"><a href="#cb114-330"></a><span class="fu">### Data Split</span></span>
<span id="cb114-331"><a href="#cb114-331"></a><span class="in">```{r data_split}</span></span>
<span id="cb114-332"><a href="#cb114-332"></a><span class="co"># Splitting the dataset into train and test (7/10th for train remaining for test)</span></span>
<span id="cb114-333"><a href="#cb114-333"></a>inTrain <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">createDataPartition</span>(wine.data<span class="sc">$</span>good, <span class="at">p =</span> <span class="dv">7</span><span class="sc">/</span><span class="dv">10</span>, <span class="at">list =</span> F)</span>
<span id="cb114-334"><a href="#cb114-334"></a>train <span class="ot">&lt;-</span> wine.data[inTrain,]</span>
<span id="cb114-335"><a href="#cb114-335"></a>test <span class="ot">&lt;-</span> wine.data[<span class="sc">-</span>inTrain,]</span>
<span id="cb114-336"><a href="#cb114-336"></a></span>
<span id="cb114-337"><a href="#cb114-337"></a></span>
<span id="cb114-338"><a href="#cb114-338"></a><span class="co"># Convert the outcome variable to a factor with two levels</span></span>
<span id="cb114-339"><a href="#cb114-339"></a>train<span class="sc">$</span>good <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(train<span class="sc">$</span>good)</span>
<span id="cb114-340"><a href="#cb114-340"></a>test<span class="sc">$</span>good <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(test<span class="sc">$</span>good)</span>
<span id="cb114-341"><a href="#cb114-341"></a><span class="in">```</span></span>
<span id="cb114-342"><a href="#cb114-342"></a></span>
<span id="cb114-343"><a href="#cb114-343"></a><span class="fu">## K-Nearest Neightbor</span></span>
<span id="cb114-344"><a href="#cb114-344"></a></span>
<span id="cb114-345"><a href="#cb114-345"></a><span class="fu">### Model Construction</span></span>
<span id="cb114-346"><a href="#cb114-346"></a><span class="in">```{r knn.model_savings, eval=FALSE}</span></span>
<span id="cb114-347"><a href="#cb114-347"></a><span class="co">#--------------------#</span></span>
<span id="cb114-348"><a href="#cb114-348"></a><span class="co">#-----K-fold CV------#</span></span>
<span id="cb114-349"><a href="#cb114-349"></a><span class="co">#--------------------#</span></span>
<span id="cb114-350"><a href="#cb114-350"></a></span>
<span id="cb114-351"><a href="#cb114-351"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb114-352"><a href="#cb114-352"></a><span class="co"># Define the training control object for 10-fold cross-validation</span></span>
<span id="cb114-353"><a href="#cb114-353"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">10</span>)</span>
<span id="cb114-354"><a href="#cb114-354"></a></span>
<span id="cb114-355"><a href="#cb114-355"></a><span class="co"># Train the KNN model using 10-fold cross-validation</span></span>
<span id="cb114-356"><a href="#cb114-356"></a><span class="co"># tuneLength argument to specify the range of values of K to be considered for tuning</span></span>
<span id="cb114-357"><a href="#cb114-357"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb114-358"><a href="#cb114-358"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb114-359"><a href="#cb114-359"></a>                   <span class="at">data =</span> train, </span>
<span id="cb114-360"><a href="#cb114-360"></a>                   <span class="at">method =</span> <span class="st">"knn"</span>, </span>
<span id="cb114-361"><a href="#cb114-361"></a>                   <span class="at">trControl =</span> train_control)</span>
<span id="cb114-362"><a href="#cb114-362"></a></span>
<span id="cb114-363"><a href="#cb114-363"></a><span class="co"># Save the model into .Rdata for future import </span></span>
<span id="cb114-364"><a href="#cb114-364"></a><span class="fu">save</span>(knn_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_kfoldCV.Rdata"</span>)</span>
<span id="cb114-365"><a href="#cb114-365"></a></span>
<span id="cb114-366"><a href="#cb114-366"></a></span>
<span id="cb114-367"><a href="#cb114-367"></a><span class="co">#--------------------------#</span></span>
<span id="cb114-368"><a href="#cb114-368"></a><span class="co">#-----K-fold CV (Mod)------#</span></span>
<span id="cb114-369"><a href="#cb114-369"></a><span class="co">#--------------------------#</span></span>
<span id="cb114-370"><a href="#cb114-370"></a></span>
<span id="cb114-371"><a href="#cb114-371"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb114-372"><a href="#cb114-372"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">10</span>)</span>
<span id="cb114-373"><a href="#cb114-373"></a></span>
<span id="cb114-374"><a href="#cb114-374"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb114-375"><a href="#cb114-375"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb114-376"><a href="#cb114-376"></a>                   <span class="at">data =</span> train, </span>
<span id="cb114-377"><a href="#cb114-377"></a>                   <span class="at">method =</span> <span class="st">"knn"</span>, </span>
<span id="cb114-378"><a href="#cb114-378"></a>                   <span class="at">trControl =</span> train_control, </span>
<span id="cb114-379"><a href="#cb114-379"></a>                   <span class="at">tuneLength =</span> <span class="dv">10</span>)</span>
<span id="cb114-380"><a href="#cb114-380"></a></span>
<span id="cb114-381"><a href="#cb114-381"></a><span class="co"># Save the model into .Rdata for future import </span></span>
<span id="cb114-382"><a href="#cb114-382"></a><span class="fu">save</span>(knn_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_kfoldCV_mod.Rdata"</span>)</span>
<span id="cb114-383"><a href="#cb114-383"></a></span>
<span id="cb114-384"><a href="#cb114-384"></a></span>
<span id="cb114-385"><a href="#cb114-385"></a><span class="co">#--------------------#</span></span>
<span id="cb114-386"><a href="#cb114-386"></a><span class="co">#----Hold-out CV-----#</span></span>
<span id="cb114-387"><a href="#cb114-387"></a><span class="co">#--------------------#</span></span>
<span id="cb114-388"><a href="#cb114-388"></a></span>
<span id="cb114-389"><a href="#cb114-389"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb114-390"><a href="#cb114-390"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"none"</span>,)</span>
<span id="cb114-391"><a href="#cb114-391"></a></span>
<span id="cb114-392"><a href="#cb114-392"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb114-393"><a href="#cb114-393"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb114-394"><a href="#cb114-394"></a>                   <span class="at">data =</span> train, </span>
<span id="cb114-395"><a href="#cb114-395"></a>                   <span class="at">method =</span> <span class="st">"knn"</span>)</span>
<span id="cb114-396"><a href="#cb114-396"></a></span>
<span id="cb114-397"><a href="#cb114-397"></a><span class="fu">save</span>(knn_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_holdoutCV.Rdata"</span>)</span>
<span id="cb114-398"><a href="#cb114-398"></a></span>
<span id="cb114-399"><a href="#cb114-399"></a></span>
<span id="cb114-400"><a href="#cb114-400"></a><span class="co">#--------------------------#</span></span>
<span id="cb114-401"><a href="#cb114-401"></a><span class="co">#----Hold-out CV (Mod)-----#</span></span>
<span id="cb114-402"><a href="#cb114-402"></a><span class="co">#--------------------------#</span></span>
<span id="cb114-403"><a href="#cb114-403"></a></span>
<span id="cb114-404"><a href="#cb114-404"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb114-405"><a href="#cb114-405"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"none"</span>,)</span>
<span id="cb114-406"><a href="#cb114-406"></a></span>
<span id="cb114-407"><a href="#cb114-407"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb114-408"><a href="#cb114-408"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb114-409"><a href="#cb114-409"></a>                   <span class="at">data =</span> train, </span>
<span id="cb114-410"><a href="#cb114-410"></a>                   <span class="at">method =</span> <span class="st">"knn"</span>,</span>
<span id="cb114-411"><a href="#cb114-411"></a>                   <span class="at">tuneGrid =</span> <span class="fu">expand.grid</span>(<span class="at">k=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>))</span>
<span id="cb114-412"><a href="#cb114-412"></a></span>
<span id="cb114-413"><a href="#cb114-413"></a><span class="fu">save</span>(knn_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_holdoutCV_mod.Rdata"</span>)</span>
<span id="cb114-414"><a href="#cb114-414"></a></span>
<span id="cb114-415"><a href="#cb114-415"></a></span>
<span id="cb114-416"><a href="#cb114-416"></a><span class="co">#--------------------#</span></span>
<span id="cb114-417"><a href="#cb114-417"></a><span class="co">#-------LOOCV--------#</span></span>
<span id="cb114-418"><a href="#cb114-418"></a><span class="co">#--------------------#</span></span>
<span id="cb114-419"><a href="#cb114-419"></a></span>
<span id="cb114-420"><a href="#cb114-420"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb114-421"><a href="#cb114-421"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"LOOCV"</span>)</span>
<span id="cb114-422"><a href="#cb114-422"></a></span>
<span id="cb114-423"><a href="#cb114-423"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb114-424"><a href="#cb114-424"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb114-425"><a href="#cb114-425"></a>                   <span class="at">data =</span> train, </span>
<span id="cb114-426"><a href="#cb114-426"></a>                   <span class="at">method =</span> <span class="st">"knn"</span>, </span>
<span id="cb114-427"><a href="#cb114-427"></a>                   <span class="at">trControl =</span> train_control)</span>
<span id="cb114-428"><a href="#cb114-428"></a></span>
<span id="cb114-429"><a href="#cb114-429"></a><span class="fu">save</span>(knn_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_looCV.Rdata"</span>)</span>
<span id="cb114-430"><a href="#cb114-430"></a></span>
<span id="cb114-431"><a href="#cb114-431"></a></span>
<span id="cb114-432"><a href="#cb114-432"></a><span class="co">#--------------------------#</span></span>
<span id="cb114-433"><a href="#cb114-433"></a><span class="co">#-------LOOCV (Mod)--------#</span></span>
<span id="cb114-434"><a href="#cb114-434"></a><span class="co">#--------------------------#</span></span>
<span id="cb114-435"><a href="#cb114-435"></a></span>
<span id="cb114-436"><a href="#cb114-436"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb114-437"><a href="#cb114-437"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"LOOCV"</span>)</span>
<span id="cb114-438"><a href="#cb114-438"></a></span>
<span id="cb114-439"><a href="#cb114-439"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb114-440"><a href="#cb114-440"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb114-441"><a href="#cb114-441"></a>                   <span class="at">data =</span> train, </span>
<span id="cb114-442"><a href="#cb114-442"></a>                   <span class="at">method =</span> <span class="st">"knn"</span>, </span>
<span id="cb114-443"><a href="#cb114-443"></a>                   <span class="at">trControl =</span> train_control,</span>
<span id="cb114-444"><a href="#cb114-444"></a>                   <span class="at">tuneLength =</span> <span class="dv">10</span>,</span>
<span id="cb114-445"><a href="#cb114-445"></a>                   <span class="at">tuneGrid =</span> <span class="fu">expand.grid</span>(<span class="at">k =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>))</span>
<span id="cb114-446"><a href="#cb114-446"></a></span>
<span id="cb114-447"><a href="#cb114-447"></a><span class="fu">save</span>(knn_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_looCV_mod.Rdata"</span>)</span>
<span id="cb114-448"><a href="#cb114-448"></a></span>
<span id="cb114-449"><a href="#cb114-449"></a></span>
<span id="cb114-450"><a href="#cb114-450"></a><span class="co">#--------------------#</span></span>
<span id="cb114-451"><a href="#cb114-451"></a><span class="co">#----Repeated CV-----#</span></span>
<span id="cb114-452"><a href="#cb114-452"></a><span class="co">#--------------------#</span></span>
<span id="cb114-453"><a href="#cb114-453"></a></span>
<span id="cb114-454"><a href="#cb114-454"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb114-455"><a href="#cb114-455"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"repeatedcv"</span>, <span class="at">number =</span> <span class="dv">10</span>, <span class="at">repeats =</span> <span class="dv">5</span>)</span>
<span id="cb114-456"><a href="#cb114-456"></a></span>
<span id="cb114-457"><a href="#cb114-457"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb114-458"><a href="#cb114-458"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb114-459"><a href="#cb114-459"></a>                   <span class="at">data =</span> train, </span>
<span id="cb114-460"><a href="#cb114-460"></a>                   <span class="at">method =</span> <span class="st">"knn"</span>, </span>
<span id="cb114-461"><a href="#cb114-461"></a>                   <span class="at">trControl =</span> train_control)</span>
<span id="cb114-462"><a href="#cb114-462"></a></span>
<span id="cb114-463"><a href="#cb114-463"></a><span class="fu">save</span>(knn_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_repeatedCV.Rdata"</span>)</span>
<span id="cb114-464"><a href="#cb114-464"></a></span>
<span id="cb114-465"><a href="#cb114-465"></a></span>
<span id="cb114-466"><a href="#cb114-466"></a><span class="co">#--------------------------#</span></span>
<span id="cb114-467"><a href="#cb114-467"></a><span class="co">#----Repeated CV (Mod)-----#</span></span>
<span id="cb114-468"><a href="#cb114-468"></a><span class="co">#--------------------------#</span></span>
<span id="cb114-469"><a href="#cb114-469"></a></span>
<span id="cb114-470"><a href="#cb114-470"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb114-471"><a href="#cb114-471"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"repeatedcv"</span>, <span class="at">number =</span> <span class="dv">10</span>, <span class="at">repeats =</span> <span class="dv">5</span>)</span>
<span id="cb114-472"><a href="#cb114-472"></a></span>
<span id="cb114-473"><a href="#cb114-473"></a>kknn.grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">kmax =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span> ,<span class="dv">9</span>, <span class="dv">11</span>), <span class="at">distance =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb114-474"><a href="#cb114-474"></a>                         <span class="at">kernel =</span> <span class="fu">c</span>(<span class="st">"rectangular"</span>, <span class="st">"gaussian"</span>, <span class="st">"cos"</span>))</span>
<span id="cb114-475"><a href="#cb114-475"></a></span>
<span id="cb114-476"><a href="#cb114-476"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb114-477"><a href="#cb114-477"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb114-478"><a href="#cb114-478"></a>                   <span class="at">data =</span> train, </span>
<span id="cb114-479"><a href="#cb114-479"></a>                   <span class="at">method =</span> <span class="st">"kknn"</span>,</span>
<span id="cb114-480"><a href="#cb114-480"></a>                   <span class="at">trControl =</span> train_control, </span>
<span id="cb114-481"><a href="#cb114-481"></a>                   <span class="at">tuneGrid =</span> kknn.grid,</span>
<span id="cb114-482"><a href="#cb114-482"></a>                   <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>))</span>
<span id="cb114-483"><a href="#cb114-483"></a></span>
<span id="cb114-484"><a href="#cb114-484"></a><span class="fu">save</span>(knn_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_repeatedCV_mod.Rdata"</span>)</span>
<span id="cb114-485"><a href="#cb114-485"></a><span class="in">```</span></span>
<span id="cb114-486"><a href="#cb114-486"></a></span>
<span id="cb114-487"><a href="#cb114-487"></a></span>
<span id="cb114-488"><a href="#cb114-488"></a><span class="fu">### K-fold CV </span></span>
<span id="cb114-489"><a href="#cb114-489"></a><span class="in">```{r knn.kfoldCV, fig.show='hide'}</span></span>
<span id="cb114-490"><a href="#cb114-490"></a><span class="co"># Import model</span></span>
<span id="cb114-491"><a href="#cb114-491"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_kfoldCV.Rdata"</span>)</span>
<span id="cb114-492"><a href="#cb114-492"></a></span>
<span id="cb114-493"><a href="#cb114-493"></a><span class="co"># Make predictions on the test data using the trained model and calculate the test error rate</span></span>
<span id="cb114-494"><a href="#cb114-494"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_model, <span class="at">newdata =</span> test)</span>
<span id="cb114-495"><a href="#cb114-495"></a></span>
<span id="cb114-496"><a href="#cb114-496"></a><span class="fu">confusionMatrix</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb114-497"><a href="#cb114-497"></a></span>
<span id="cb114-498"><a href="#cb114-498"></a></span>
<span id="cb114-499"><a href="#cb114-499"></a><span class="co"># Convert predictions to a numeric vector</span></span>
<span id="cb114-500"><a href="#cb114-500"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(knn.predictions)</span>
<span id="cb114-501"><a href="#cb114-501"></a></span>
<span id="cb114-502"><a href="#cb114-502"></a><span class="co"># Calculate the AUC using the performance() and auc() functions:</span></span>
<span id="cb114-503"><a href="#cb114-503"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb114-504"><a href="#cb114-504"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb114-505"><a href="#cb114-505"></a>auc_val</span>
<span id="cb114-506"><a href="#cb114-506"></a></span>
<span id="cb114-507"><a href="#cb114-507"></a><span class="co"># Performance plot for TP and FP</span></span>
<span id="cb114-508"><a href="#cb114-508"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb114-509"><a href="#cb114-509"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb114-510"><a href="#cb114-510"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb114-511"><a href="#cb114-511"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb114-512"><a href="#cb114-512"></a>     <span class="at">main =</span> <span class="st">"ROC Curves from K-fold CV"</span>)</span>
<span id="cb114-513"><a href="#cb114-513"></a><span class="fu">points</span>(auc_val, <span class="dv">1</span> <span class="sc">-</span> auc_val, </span>
<span id="cb114-514"><a href="#cb114-514"></a>       <span class="at">col =</span> <span class="st">"steelblue"</span>, </span>
<span id="cb114-515"><a href="#cb114-515"></a>       <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb114-516"><a href="#cb114-516"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb114-517"><a href="#cb114-517"></a>knn.kfoldCV.ROC.plot<span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb114-518"><a href="#cb114-518"></a></span>
<span id="cb114-519"><a href="#cb114-519"></a><span class="co"># Accuracy and Kappa value plot</span></span>
<span id="cb114-520"><a href="#cb114-520"></a>knn.accu.kappa.plot <span class="ot">&lt;-</span> <span class="cf">function</span>(knn.model) {</span>
<span id="cb114-521"><a href="#cb114-521"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">data.frame</span>(<span class="at">k =</span> knn.model<span class="sc">$</span>results<span class="sc">$</span>k,</span>
<span id="cb114-522"><a href="#cb114-522"></a>                              <span class="at">Accuracy =</span> knn.model<span class="sc">$</span>results<span class="sc">$</span>Accuracy,</span>
<span id="cb114-523"><a href="#cb114-523"></a>                              <span class="at">Kappa =</span> knn.model<span class="sc">$</span>results<span class="sc">$</span>Kappa)) <span class="sc">+</span></span>
<span id="cb114-524"><a href="#cb114-524"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">color =</span> <span class="st">"Accuracy"</span>)) <span class="sc">+</span></span>
<span id="cb114-525"><a href="#cb114-525"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">color =</span> <span class="st">"Kappa"</span>)) <span class="sc">+</span></span>
<span id="cb114-526"><a href="#cb114-526"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">linetype =</span> <span class="st">"Accuracy"</span>, <span class="at">color =</span> <span class="st">"Accuracy"</span>)) <span class="sc">+</span></span>
<span id="cb114-527"><a href="#cb114-527"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">linetype =</span> <span class="st">"Kappa"</span>, <span class="at">color =</span> <span class="st">"Kappa"</span>)) <span class="sc">+</span></span>
<span id="cb114-528"><a href="#cb114-528"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#98c379"</span>, <span class="st">"#e06c75"</span>),</span>
<span id="cb114-529"><a href="#cb114-529"></a>                       <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>)) )) <span class="sc">+</span></span>
<span id="cb114-530"><a href="#cb114-530"></a>    <span class="fu">scale_linetype_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"solid"</span>, <span class="st">"dotted"</span>),</span>
<span id="cb114-531"><a href="#cb114-531"></a>                          <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="fu">c</span>(<span class="st">"#98c379"</span>, <span class="st">"#e06c75"</span>)))) <span class="sc">+</span></span>
<span id="cb114-532"><a href="#cb114-532"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"K value"</span>, </span>
<span id="cb114-533"><a href="#cb114-533"></a>         <span class="at">y =</span> <span class="st">"Accuracy / Kappa"</span>) <span class="sc">+</span></span>
<span id="cb114-534"><a href="#cb114-534"></a>    <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb114-535"><a href="#cb114-535"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb114-536"><a href="#cb114-536"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb114-537"><a href="#cb114-537"></a>    <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Metric"</span>),</span>
<span id="cb114-538"><a href="#cb114-538"></a>           <span class="at">linetype =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Metric"</span>))</span>
<span id="cb114-539"><a href="#cb114-539"></a>  <span class="fu">return</span>(p)</span>
<span id="cb114-540"><a href="#cb114-540"></a>}</span>
<span id="cb114-541"><a href="#cb114-541"></a></span>
<span id="cb114-542"><a href="#cb114-542"></a>knn.kfoldCV.plot <span class="ot">&lt;-</span> <span class="fu">knn.accu.kappa.plot</span>(knn_model) <span class="sc">+</span> </span>
<span id="cb114-543"><a href="#cb114-543"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb114-544"><a href="#cb114-544"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">label =</span> <span class="fu">round</span>(Kappa, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb114-545"><a href="#cb114-545"></a>  <span class="fu">ggtitle</span>(<span class="st">"KNN Model Performance (10-Fold CV)"</span>)</span>
<span id="cb114-546"><a href="#cb114-546"></a><span class="in">```</span></span>
<span id="cb114-547"><a href="#cb114-547"></a></span>
<span id="cb114-548"><a href="#cb114-548"></a><span class="fu">#### Tuned</span></span>
<span id="cb114-549"><a href="#cb114-549"></a><span class="in">```{r knn.kfoldCV_mod, fig.show='hide'}</span></span>
<span id="cb114-550"><a href="#cb114-550"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_kfoldCV_mod.Rdata"</span>)</span>
<span id="cb114-551"><a href="#cb114-551"></a></span>
<span id="cb114-552"><a href="#cb114-552"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_model, <span class="at">newdata =</span> test)</span>
<span id="cb114-553"><a href="#cb114-553"></a></span>
<span id="cb114-554"><a href="#cb114-554"></a><span class="fu">confusionMatrix</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb114-555"><a href="#cb114-555"></a></span>
<span id="cb114-556"><a href="#cb114-556"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(knn.predictions)</span>
<span id="cb114-557"><a href="#cb114-557"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb114-558"><a href="#cb114-558"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb114-559"><a href="#cb114-559"></a>auc_val</span>
<span id="cb114-560"><a href="#cb114-560"></a></span>
<span id="cb114-561"><a href="#cb114-561"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb114-562"><a href="#cb114-562"></a><span class="fu">invisible</span>(<span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb114-563"><a href="#cb114-563"></a>               <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb114-564"><a href="#cb114-564"></a>               <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb114-565"><a href="#cb114-565"></a>               <span class="at">main =</span> <span class="st">"ROC Curves from Tuned K-fold CV"</span>))</span>
<span id="cb114-566"><a href="#cb114-566"></a><span class="fu">points</span>(auc_val, <span class="dv">1</span> <span class="sc">-</span> auc_val, </span>
<span id="cb114-567"><a href="#cb114-567"></a>       <span class="at">col =</span> <span class="st">"steelblue"</span>, </span>
<span id="cb114-568"><a href="#cb114-568"></a>       <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb114-569"><a href="#cb114-569"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb114-570"><a href="#cb114-570"></a>knn.kfoldCV_mod.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb114-571"><a href="#cb114-571"></a></span>
<span id="cb114-572"><a href="#cb114-572"></a>knn.kfoldCV_mod.plot <span class="ot">&lt;-</span> <span class="fu">knn.accu.kappa.plot</span>(knn_model) <span class="sc">+</span></span>
<span id="cb114-573"><a href="#cb114-573"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb114-574"><a href="#cb114-574"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">label =</span> <span class="fu">round</span>(Kappa, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb114-575"><a href="#cb114-575"></a>  <span class="fu">ggtitle</span>(<span class="st">"KNN Model Performance (Tuned 10-Fold CV)"</span>)</span>
<span id="cb114-576"><a href="#cb114-576"></a><span class="in">```</span></span>
<span id="cb114-577"><a href="#cb114-577"></a></span>
<span id="cb114-578"><a href="#cb114-578"></a></span>
<span id="cb114-579"><a href="#cb114-579"></a><span class="fu">### Hold-out CV (Validation Set Approach)</span></span>
<span id="cb114-580"><a href="#cb114-580"></a><span class="in">```{r knn.holdoutCV, fig.show='hide'}</span></span>
<span id="cb114-581"><a href="#cb114-581"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_holdoutCV.Rdata"</span>)</span>
<span id="cb114-582"><a href="#cb114-582"></a></span>
<span id="cb114-583"><a href="#cb114-583"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_model, <span class="at">newdata =</span> test)</span>
<span id="cb114-584"><a href="#cb114-584"></a></span>
<span id="cb114-585"><a href="#cb114-585"></a><span class="fu">confusionMatrix</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb114-586"><a href="#cb114-586"></a></span>
<span id="cb114-587"><a href="#cb114-587"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(knn.predictions)</span>
<span id="cb114-588"><a href="#cb114-588"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb114-589"><a href="#cb114-589"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb114-590"><a href="#cb114-590"></a>auc_val</span>
<span id="cb114-591"><a href="#cb114-591"></a></span>
<span id="cb114-592"><a href="#cb114-592"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb114-593"><a href="#cb114-593"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb114-594"><a href="#cb114-594"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb114-595"><a href="#cb114-595"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb114-596"><a href="#cb114-596"></a>     <span class="at">main =</span> <span class="st">"ROC Curves from Hold-out CV"</span>)</span>
<span id="cb114-597"><a href="#cb114-597"></a><span class="fu">points</span>(auc_val, <span class="dv">1</span> <span class="sc">-</span> auc_val, </span>
<span id="cb114-598"><a href="#cb114-598"></a>       <span class="at">col =</span> <span class="st">"steelblue"</span>, </span>
<span id="cb114-599"><a href="#cb114-599"></a>       <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb114-600"><a href="#cb114-600"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb114-601"><a href="#cb114-601"></a>knn.holdoutCV.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb114-602"><a href="#cb114-602"></a></span>
<span id="cb114-603"><a href="#cb114-603"></a>knn.holdoutCV.plot <span class="ot">&lt;-</span> <span class="fu">knn.accu.kappa.plot</span>(knn_model) <span class="sc">+</span></span>
<span id="cb114-604"><a href="#cb114-604"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb114-605"><a href="#cb114-605"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">label =</span> <span class="fu">round</span>(Kappa, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb114-606"><a href="#cb114-606"></a>  <span class="fu">ggtitle</span>(<span class="st">"KNN Model Performance (Hold-out CV)"</span>)</span>
<span id="cb114-607"><a href="#cb114-607"></a><span class="in">```</span></span>
<span id="cb114-608"><a href="#cb114-608"></a></span>
<span id="cb114-609"><a href="#cb114-609"></a><span class="fu">#### Tuned</span></span>
<span id="cb114-610"><a href="#cb114-610"></a><span class="in">```{r knn.holdoutCV_mod, fig.show='hide'}</span></span>
<span id="cb114-611"><a href="#cb114-611"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_holdoutCV_mod.Rdata"</span>)</span>
<span id="cb114-612"><a href="#cb114-612"></a></span>
<span id="cb114-613"><a href="#cb114-613"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_model, <span class="at">newdata =</span> test)</span>
<span id="cb114-614"><a href="#cb114-614"></a></span>
<span id="cb114-615"><a href="#cb114-615"></a><span class="fu">confusionMatrix</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb114-616"><a href="#cb114-616"></a></span>
<span id="cb114-617"><a href="#cb114-617"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(knn.predictions)</span>
<span id="cb114-618"><a href="#cb114-618"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb114-619"><a href="#cb114-619"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb114-620"><a href="#cb114-620"></a>auc_val</span>
<span id="cb114-621"><a href="#cb114-621"></a></span>
<span id="cb114-622"><a href="#cb114-622"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb114-623"><a href="#cb114-623"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb114-624"><a href="#cb114-624"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb114-625"><a href="#cb114-625"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb114-626"><a href="#cb114-626"></a>     <span class="at">main =</span> <span class="st">"ROC Curves from Tuned Hold-out CV"</span>)</span>
<span id="cb114-627"><a href="#cb114-627"></a><span class="fu">points</span>(auc_val, <span class="dv">1</span> <span class="sc">-</span> auc_val, </span>
<span id="cb114-628"><a href="#cb114-628"></a>       <span class="at">col =</span> <span class="st">"steelblue"</span>, </span>
<span id="cb114-629"><a href="#cb114-629"></a>       <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb114-630"><a href="#cb114-630"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb114-631"><a href="#cb114-631"></a>knn.holdoutCV_mod.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb114-632"><a href="#cb114-632"></a></span>
<span id="cb114-633"><a href="#cb114-633"></a>knn.holdoutCV_mod.plot <span class="ot">&lt;-</span> <span class="fu">knn.accu.kappa.plot</span>(knn_model) <span class="sc">+</span> </span>
<span id="cb114-634"><a href="#cb114-634"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">3</span>)), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">angle=</span><span class="dv">90</span>) <span class="sc">+</span></span>
<span id="cb114-635"><a href="#cb114-635"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">label =</span> <span class="fu">round</span>(Kappa, <span class="dv">3</span>)), <span class="at">hjust=</span><span class="sc">-</span><span class="fl">0.3</span>, <span class="at">angle=</span><span class="dv">90</span>) <span class="sc">+</span></span>
<span id="cb114-636"><a href="#cb114-636"></a>  <span class="fu">ggtitle</span>(<span class="st">"KNN Model Performance (Tuned Hold-out CV)"</span>)</span>
<span id="cb114-637"><a href="#cb114-637"></a><span class="in">```</span></span>
<span id="cb114-638"><a href="#cb114-638"></a></span>
<span id="cb114-639"><a href="#cb114-639"></a></span>
<span id="cb114-640"><a href="#cb114-640"></a><span class="fu">### LOOCV</span></span>
<span id="cb114-641"><a href="#cb114-641"></a><span class="in">```{r knn.LOOCV, fig.show='hide'}</span></span>
<span id="cb114-642"><a href="#cb114-642"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_looCV.Rdata"</span>)</span>
<span id="cb114-643"><a href="#cb114-643"></a></span>
<span id="cb114-644"><a href="#cb114-644"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_model, <span class="at">newdata =</span> test)</span>
<span id="cb114-645"><a href="#cb114-645"></a><span class="fu">confusionMatrix</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb114-646"><a href="#cb114-646"></a></span>
<span id="cb114-647"><a href="#cb114-647"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(knn.predictions)</span>
<span id="cb114-648"><a href="#cb114-648"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb114-649"><a href="#cb114-649"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb114-650"><a href="#cb114-650"></a>auc_val</span>
<span id="cb114-651"><a href="#cb114-651"></a></span>
<span id="cb114-652"><a href="#cb114-652"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb114-653"><a href="#cb114-653"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb114-654"><a href="#cb114-654"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb114-655"><a href="#cb114-655"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb114-656"><a href="#cb114-656"></a>     <span class="at">main =</span> <span class="st">'ROC Curves from LOOCV'</span>)</span>
<span id="cb114-657"><a href="#cb114-657"></a><span class="fu">points</span>(auc_val, <span class="dv">1</span> <span class="sc">-</span> auc_val, </span>
<span id="cb114-658"><a href="#cb114-658"></a>       <span class="at">col =</span> <span class="st">"steelblue"</span>, </span>
<span id="cb114-659"><a href="#cb114-659"></a>       <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb114-660"><a href="#cb114-660"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb114-661"><a href="#cb114-661"></a>knn.looCV.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb114-662"><a href="#cb114-662"></a></span>
<span id="cb114-663"><a href="#cb114-663"></a>knn.looCV.plot <span class="ot">&lt;-</span> <span class="fu">knn.accu.kappa.plot</span>(knn_model) <span class="sc">+</span> </span>
<span id="cb114-664"><a href="#cb114-664"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb114-665"><a href="#cb114-665"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">label =</span> <span class="fu">round</span>(Kappa, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb114-666"><a href="#cb114-666"></a>  <span class="fu">ggtitle</span>(<span class="st">"KNN Model Performance (LOOCV)"</span>)</span>
<span id="cb114-667"><a href="#cb114-667"></a><span class="in">```</span></span>
<span id="cb114-668"><a href="#cb114-668"></a></span>
<span id="cb114-669"><a href="#cb114-669"></a><span class="fu">#### Tuned</span></span>
<span id="cb114-670"><a href="#cb114-670"></a><span class="in">```{r knn.LOOCV_mod, fig.show='hide'}</span></span>
<span id="cb114-671"><a href="#cb114-671"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_looCV_mod.Rdata"</span>)</span>
<span id="cb114-672"><a href="#cb114-672"></a></span>
<span id="cb114-673"><a href="#cb114-673"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_model, <span class="at">newdata =</span> test)</span>
<span id="cb114-674"><a href="#cb114-674"></a><span class="fu">confusionMatrix</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb114-675"><a href="#cb114-675"></a></span>
<span id="cb114-676"><a href="#cb114-676"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(knn.predictions)</span>
<span id="cb114-677"><a href="#cb114-677"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb114-678"><a href="#cb114-678"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb114-679"><a href="#cb114-679"></a>auc_val</span>
<span id="cb114-680"><a href="#cb114-680"></a></span>
<span id="cb114-681"><a href="#cb114-681"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb114-682"><a href="#cb114-682"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb114-683"><a href="#cb114-683"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb114-684"><a href="#cb114-684"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb114-685"><a href="#cb114-685"></a>     <span class="at">main =</span> <span class="st">"ROC Curves from Tuned LOOCV"</span>)</span>
<span id="cb114-686"><a href="#cb114-686"></a><span class="fu">points</span>(auc_val, <span class="dv">1</span> <span class="sc">-</span> auc_val, </span>
<span id="cb114-687"><a href="#cb114-687"></a>       <span class="at">col =</span> <span class="st">"steelblue"</span>, </span>
<span id="cb114-688"><a href="#cb114-688"></a>       <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb114-689"><a href="#cb114-689"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb114-690"><a href="#cb114-690"></a>knn.looCV_mod.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb114-691"><a href="#cb114-691"></a></span>
<span id="cb114-692"><a href="#cb114-692"></a>knn.looCV_mod.plot <span class="ot">&lt;-</span> <span class="fu">knn.accu.kappa.plot</span>(knn_model) <span class="sc">+</span> </span>
<span id="cb114-693"><a href="#cb114-693"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">3</span>)), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">angle=</span><span class="dv">90</span>) <span class="sc">+</span></span>
<span id="cb114-694"><a href="#cb114-694"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">label =</span> <span class="fu">round</span>(Kappa, <span class="dv">3</span>)), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">angle=</span><span class="dv">90</span>) <span class="sc">+</span></span>
<span id="cb114-695"><a href="#cb114-695"></a>  <span class="fu">ggtitle</span>(<span class="st">"KNN Model Performance (Tuned LOOCV)"</span>)</span>
<span id="cb114-696"><a href="#cb114-696"></a><span class="in">```</span></span>
<span id="cb114-697"><a href="#cb114-697"></a></span>
<span id="cb114-698"><a href="#cb114-698"></a></span>
<span id="cb114-699"><a href="#cb114-699"></a><span class="fu">### Repeated CV</span></span>
<span id="cb114-700"><a href="#cb114-700"></a><span class="in">```{r knn.repeatedCV, fig.show='hide'}</span></span>
<span id="cb114-701"><a href="#cb114-701"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_repeatedCV.Rdata"</span>)</span>
<span id="cb114-702"><a href="#cb114-702"></a></span>
<span id="cb114-703"><a href="#cb114-703"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_model, <span class="at">newdata =</span> test)</span>
<span id="cb114-704"><a href="#cb114-704"></a></span>
<span id="cb114-705"><a href="#cb114-705"></a><span class="fu">confusionMatrix</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb114-706"><a href="#cb114-706"></a></span>
<span id="cb114-707"><a href="#cb114-707"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(knn.predictions)</span>
<span id="cb114-708"><a href="#cb114-708"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb114-709"><a href="#cb114-709"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb114-710"><a href="#cb114-710"></a>auc_val</span>
<span id="cb114-711"><a href="#cb114-711"></a></span>
<span id="cb114-712"><a href="#cb114-712"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb114-713"><a href="#cb114-713"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb114-714"><a href="#cb114-714"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb114-715"><a href="#cb114-715"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb114-716"><a href="#cb114-716"></a>     <span class="at">main =</span> <span class="st">"ROC Curves from Repeated CV"</span>)</span>
<span id="cb114-717"><a href="#cb114-717"></a><span class="fu">points</span>(auc_val, <span class="dv">1</span> <span class="sc">-</span> auc_val, </span>
<span id="cb114-718"><a href="#cb114-718"></a>       <span class="at">col =</span> <span class="st">"steelblue"</span>, </span>
<span id="cb114-719"><a href="#cb114-719"></a>       <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb114-720"><a href="#cb114-720"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb114-721"><a href="#cb114-721"></a>knn.repeatedCV.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb114-722"><a href="#cb114-722"></a></span>
<span id="cb114-723"><a href="#cb114-723"></a>df <span class="ot">&lt;-</span> knn_model<span class="sc">$</span>results</span>
<span id="cb114-724"><a href="#cb114-724"></a>knn.repeatedCV.plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>df, <span class="fu">aes</span>(<span class="at">x =</span> kmax, <span class="at">y =</span> Accuracy)) <span class="sc">+</span></span>
<span id="cb114-725"><a href="#cb114-725"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Accuracy"</span>)) <span class="sc">+</span></span>
<span id="cb114-726"><a href="#cb114-726"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Kappa"</span>)) <span class="sc">+</span></span>
<span id="cb114-727"><a href="#cb114-727"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> <span class="st">"Accuracy"</span>, <span class="at">color =</span> <span class="st">"Accuracy"</span>)) <span class="sc">+</span></span>
<span id="cb114-728"><a href="#cb114-728"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Kappa, <span class="at">linetype =</span> <span class="st">"Kappa"</span>, <span class="at">color =</span> <span class="st">"Kappa"</span>)) <span class="sc">+</span></span>
<span id="cb114-729"><a href="#cb114-729"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb114-730"><a href="#cb114-730"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> Kappa, <span class="at">label =</span> <span class="fu">round</span>(Kappa, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb114-731"><a href="#cb114-731"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#98c379"</span>, <span class="st">"#e06c75"</span>),</span>
<span id="cb114-732"><a href="#cb114-732"></a>                     <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>)) )) <span class="sc">+</span></span>
<span id="cb114-733"><a href="#cb114-733"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"solid"</span>, <span class="st">"dotted"</span>),</span>
<span id="cb114-734"><a href="#cb114-734"></a>                        <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="fu">c</span>(<span class="st">"#98c379"</span>, <span class="st">"#e06c75"</span>)))) <span class="sc">+</span></span>
<span id="cb114-735"><a href="#cb114-735"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"K value"</span>, </span>
<span id="cb114-736"><a href="#cb114-736"></a>       <span class="at">y =</span> <span class="st">"Accuracy / Kappa"</span>,</span>
<span id="cb114-737"><a href="#cb114-737"></a>       <span class="at">title =</span> <span class="st">"KNN Model Performance (Repeated CV)"</span>) <span class="sc">+</span></span>
<span id="cb114-738"><a href="#cb114-738"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb114-739"><a href="#cb114-739"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb114-740"><a href="#cb114-740"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb114-741"><a href="#cb114-741"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Metric"</span>),</span>
<span id="cb114-742"><a href="#cb114-742"></a>         <span class="at">linetype =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Metric"</span>))</span>
<span id="cb114-743"><a href="#cb114-743"></a><span class="in">```</span></span>
<span id="cb114-744"><a href="#cb114-744"></a></span>
<span id="cb114-745"><a href="#cb114-745"></a><span class="fu">#### Tuned</span></span>
<span id="cb114-746"><a href="#cb114-746"></a><span class="in">```{r knn.repeatedCV_mod, fig.show='hide'}</span></span>
<span id="cb114-747"><a href="#cb114-747"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_repeatedCV_mod.Rdata"</span>)</span>
<span id="cb114-748"><a href="#cb114-748"></a></span>
<span id="cb114-749"><a href="#cb114-749"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_model, <span class="at">newdata =</span> test)</span>
<span id="cb114-750"><a href="#cb114-750"></a></span>
<span id="cb114-751"><a href="#cb114-751"></a><span class="fu">confusionMatrix</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb114-752"><a href="#cb114-752"></a></span>
<span id="cb114-753"><a href="#cb114-753"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(knn.predictions)</span>
<span id="cb114-754"><a href="#cb114-754"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb114-755"><a href="#cb114-755"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb114-756"><a href="#cb114-756"></a>auc_val</span>
<span id="cb114-757"><a href="#cb114-757"></a></span>
<span id="cb114-758"><a href="#cb114-758"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb114-759"><a href="#cb114-759"></a></span>
<span id="cb114-760"><a href="#cb114-760"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb114-761"><a href="#cb114-761"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb114-762"><a href="#cb114-762"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb114-763"><a href="#cb114-763"></a>     <span class="at">main =</span> <span class="st">"ROC Curves from Tuned Repeated CV"</span>)</span>
<span id="cb114-764"><a href="#cb114-764"></a><span class="fu">points</span>(auc_val, <span class="dv">1</span> <span class="sc">-</span> auc_val, </span>
<span id="cb114-765"><a href="#cb114-765"></a>       <span class="at">col =</span> <span class="st">"steelblue"</span>, </span>
<span id="cb114-766"><a href="#cb114-766"></a>       <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb114-767"><a href="#cb114-767"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb114-768"><a href="#cb114-768"></a>knn.repeatedCV_mod.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb114-769"><a href="#cb114-769"></a></span>
<span id="cb114-770"><a href="#cb114-770"></a>knn.repeatedCV_mod.plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(knn_model) <span class="sc">+</span></span>
<span id="cb114-771"><a href="#cb114-771"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"K value"</span>, </span>
<span id="cb114-772"><a href="#cb114-772"></a>       <span class="at">y =</span> <span class="st">"Accuracy"</span>, </span>
<span id="cb114-773"><a href="#cb114-773"></a>       <span class="at">title =</span> <span class="st">"KNN Model Performance (Tuned Repeated CV)"</span>) <span class="sc">+</span></span>
<span id="cb114-774"><a href="#cb114-774"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb114-775"><a href="#cb114-775"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) </span>
<span id="cb114-776"><a href="#cb114-776"></a><span class="in">```</span></span>
<span id="cb114-777"><a href="#cb114-777"></a></span>
<span id="cb114-778"><a href="#cb114-778"></a></span>
<span id="cb114-779"><a href="#cb114-779"></a><span class="fu">### Summary</span></span>
<span id="cb114-780"><a href="#cb114-780"></a></span>
<span id="cb114-781"><a href="#cb114-781"></a><span class="in">```{r knn.Accuracy.Kappa.Plot, fig.width=15, fig.height=20}</span></span>
<span id="cb114-782"><a href="#cb114-782"></a><span class="fu">ggarrange</span>(knn.kfoldCV.plot,</span>
<span id="cb114-783"><a href="#cb114-783"></a>          knn.kfoldCV_mod.plot,</span>
<span id="cb114-784"><a href="#cb114-784"></a>          knn.holdoutCV.plot,</span>
<span id="cb114-785"><a href="#cb114-785"></a>          knn.holdoutCV_mod.plot,</span>
<span id="cb114-786"><a href="#cb114-786"></a>          knn.looCV.plot,</span>
<span id="cb114-787"><a href="#cb114-787"></a>          knn.looCV_mod.plot,</span>
<span id="cb114-788"><a href="#cb114-788"></a>          knn.repeatedCV.plot,</span>
<span id="cb114-789"><a href="#cb114-789"></a>          knn.repeatedCV_mod.plot,</span>
<span id="cb114-790"><a href="#cb114-790"></a>          <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">4</span>)</span>
<span id="cb114-791"><a href="#cb114-791"></a><span class="in">```</span></span>
<span id="cb114-792"><a href="#cb114-792"></a></span>
<span id="cb114-793"><a href="#cb114-793"></a><span class="in">```{r knn.ROC_curve, fig.width=10}</span></span>
<span id="cb114-794"><a href="#cb114-794"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(knn.kfoldCV.ROC.plot, knn.kfoldCV_mod.ROC.plot,</span>
<span id="cb114-795"><a href="#cb114-795"></a>                   <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">align =</span> <span class="st">"hv"</span>, <span class="at">scale =</span> <span class="fl">0.8</span>)</span>
<span id="cb114-796"><a href="#cb114-796"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(knn.holdoutCV.ROC.plot, knn.holdoutCV_mod.ROC.plot,</span>
<span id="cb114-797"><a href="#cb114-797"></a>                   <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">align =</span> <span class="st">"hv"</span>, <span class="at">scale =</span> <span class="fl">0.8</span>)</span>
<span id="cb114-798"><a href="#cb114-798"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(knn.looCV.ROC.plot, knn.looCV_mod.ROC.plot,</span>
<span id="cb114-799"><a href="#cb114-799"></a>                   <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">align =</span> <span class="st">"hv"</span>, <span class="at">scale =</span> <span class="fl">0.8</span>)</span>
<span id="cb114-800"><a href="#cb114-800"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(knn.repeatedCV.ROC.plot, knn.repeatedCV_mod.ROC.plot,</span>
<span id="cb114-801"><a href="#cb114-801"></a>                   <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">align =</span> <span class="st">"hv"</span>, <span class="at">scale =</span> <span class="fl">0.8</span>)</span>
<span id="cb114-802"><a href="#cb114-802"></a><span class="in">```</span></span>
<span id="cb114-803"><a href="#cb114-803"></a></span>
<span id="cb114-804"><a href="#cb114-804"></a></span>
<span id="cb114-805"><a href="#cb114-805"></a></span>
<span id="cb114-806"><a href="#cb114-806"></a>| Resampling Method    | Error Rate | Sensitivity | Specificity | AUC       |</span>
<span id="cb114-807"><a href="#cb114-807"></a>| -------------------- | ---------- | ----------- | ----------- | --------- |</span>
<span id="cb114-808"><a href="#cb114-808"></a>| K-Fold CV            | 0.2273     | 0.9199      | 0.1883      | 0.5541001 |</span>
<span id="cb114-809"><a href="#cb114-809"></a>| K-Fold CV (Tuned)    | 0.1995     | 0.9768      | 0.1004      | 0.5386181 |</span>
<span id="cb114-810"><a href="#cb114-810"></a>| Hold-out CV          | 0.2222     | 0.9336      | 0.1590      | 0.5463051 |</span>
<span id="cb114-811"><a href="#cb114-811"></a>| Hold-out CV  (Tuned) | 0.2022     | 0.9926      | 0.0251      | 0.5088642 |</span>
<span id="cb114-812"><a href="#cb114-812"></a>| LOOCV                | 0.1717     | 0.9642      | 0.2887      | 0.6264379 |</span>
<span id="cb114-813"><a href="#cb114-813"></a>| LOOCV (Tuned)        | 0.1995     | 0.9768      | 0.1004      | 0.5386181 |</span>
<span id="cb114-814"><a href="#cb114-814"></a>| Repeated CV          | 0.1776     | 0.9104      | 0.4728      | 0.6916177 |</span>
<span id="cb114-815"><a href="#cb114-815"></a>| Repeated CV (Tuned)  | 0.1120     | 0.9547      | 0.6234      | 0.7890601 |</span>
<span id="cb114-816"><a href="#cb114-816"></a></span>
<span id="cb114-817"><a href="#cb114-817"></a></span>
<span id="cb114-818"><a href="#cb114-818"></a><span class="in">```{r echo=FALSE}</span></span>
<span id="cb114-819"><a href="#cb114-819"></a><span class="fu">remove</span>(knn_model, df,</span>
<span id="cb114-820"><a href="#cb114-820"></a>       knn.kfoldCV.plot,</span>
<span id="cb114-821"><a href="#cb114-821"></a>       knn.kfoldCV_mod.plot,</span>
<span id="cb114-822"><a href="#cb114-822"></a>       knn.holdoutCV.plot,</span>
<span id="cb114-823"><a href="#cb114-823"></a>       knn.holdoutCV_mod.plot,</span>
<span id="cb114-824"><a href="#cb114-824"></a>       knn.looCV.plot,</span>
<span id="cb114-825"><a href="#cb114-825"></a>       knn.looCV_mod.plot,</span>
<span id="cb114-826"><a href="#cb114-826"></a>       knn.repeatedCV.plot,</span>
<span id="cb114-827"><a href="#cb114-827"></a>       knn.repeatedCV_mod.plot)</span>
<span id="cb114-828"><a href="#cb114-828"></a><span class="fu">remove</span>(pred_obj, roc_obj)</span>
<span id="cb114-829"><a href="#cb114-829"></a><span class="fu">remove</span>(auc_val, knn.predictions)</span>
<span id="cb114-830"><a href="#cb114-830"></a><span class="in">```</span></span>
<span id="cb114-831"><a href="#cb114-831"></a></span>
<span id="cb114-832"><a href="#cb114-832"></a></span>
<span id="cb114-833"><a href="#cb114-833"></a><span class="fu">## Logistic Regression</span></span>
<span id="cb114-834"><a href="#cb114-834"></a><span class="fu">### Model Construction</span></span>
<span id="cb114-835"><a href="#cb114-835"></a><span class="in">```{r logit.model_savings, eval=FALSE}</span></span>
<span id="cb114-836"><a href="#cb114-836"></a><span class="co">#----------------------------#</span></span>
<span id="cb114-837"><a href="#cb114-837"></a><span class="co">#----Logistic Regression-----#</span></span>
<span id="cb114-838"><a href="#cb114-838"></a><span class="co">#----------------------------#</span></span>
<span id="cb114-839"><a href="#cb114-839"></a></span>
<span id="cb114-840"><a href="#cb114-840"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb114-841"><a href="#cb114-841"></a><span class="co"># Define the training control object for 10-fold cross-validation</span></span>
<span id="cb114-842"><a href="#cb114-842"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">10</span>)</span>
<span id="cb114-843"><a href="#cb114-843"></a></span>
<span id="cb114-844"><a href="#cb114-844"></a><span class="co"># Train the logistic regression model using 10-fold cross-validation</span></span>
<span id="cb114-845"><a href="#cb114-845"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb114-846"><a href="#cb114-846"></a>logit_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb114-847"><a href="#cb114-847"></a>                     <span class="at">data =</span> train, </span>
<span id="cb114-848"><a href="#cb114-848"></a>                     <span class="at">method =</span> <span class="st">"glm"</span>, </span>
<span id="cb114-849"><a href="#cb114-849"></a>                     <span class="at">family =</span> <span class="st">"binomial"</span>,</span>
<span id="cb114-850"><a href="#cb114-850"></a>                     <span class="at">trControl =</span> train_control)</span>
<span id="cb114-851"><a href="#cb114-851"></a></span>
<span id="cb114-852"><a href="#cb114-852"></a><span class="fu">save</span>(logit_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">logit.model_kfoldCV.Rdata"</span>)</span>
<span id="cb114-853"><a href="#cb114-853"></a></span>
<span id="cb114-854"><a href="#cb114-854"></a></span>
<span id="cb114-855"><a href="#cb114-855"></a><span class="co">#----------------------------------#</span></span>
<span id="cb114-856"><a href="#cb114-856"></a><span class="co">#----Logistic Regression (Mod)-----#</span></span>
<span id="cb114-857"><a href="#cb114-857"></a><span class="co">#----------------------------------#</span></span>
<span id="cb114-858"><a href="#cb114-858"></a></span>
<span id="cb114-859"><a href="#cb114-859"></a><span class="in">```</span></span>
<span id="cb114-860"><a href="#cb114-860"></a></span>
<span id="cb114-861"><a href="#cb114-861"></a><span class="fu">### K-fold CV</span></span>
<span id="cb114-862"><a href="#cb114-862"></a><span class="in">```{r logit.kfoldCV, fig.show='hide', message=FALSE}</span></span>
<span id="cb114-863"><a href="#cb114-863"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">logit.model_kfoldCV.Rdata"</span>)</span>
<span id="cb114-864"><a href="#cb114-864"></a></span>
<span id="cb114-865"><a href="#cb114-865"></a>logit.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(logit_model, <span class="at">newdata =</span> test)</span>
<span id="cb114-866"><a href="#cb114-866"></a></span>
<span id="cb114-867"><a href="#cb114-867"></a><span class="fu">confusionMatrix</span>(logit.predictions, test<span class="sc">$</span>good)</span>
<span id="cb114-868"><a href="#cb114-868"></a></span>
<span id="cb114-869"><a href="#cb114-869"></a></span>
<span id="cb114-870"><a href="#cb114-870"></a>logit.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(logit.predictions)</span>
<span id="cb114-871"><a href="#cb114-871"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(logit.predictions, test<span class="sc">$</span>good)</span>
<span id="cb114-872"><a href="#cb114-872"></a>auc_val  <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb114-873"><a href="#cb114-873"></a>auc_val</span>
<span id="cb114-874"><a href="#cb114-874"></a></span>
<span id="cb114-875"><a href="#cb114-875"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb114-876"><a href="#cb114-876"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb114-877"><a href="#cb114-877"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb114-878"><a href="#cb114-878"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb114-879"><a href="#cb114-879"></a>     <span class="at">main =</span> <span class="st">"ROC Curves from Repeated CV"</span>)</span>
<span id="cb114-880"><a href="#cb114-880"></a><span class="fu">points</span>(auc_val, <span class="dv">1</span> <span class="sc">-</span> auc_val, </span>
<span id="cb114-881"><a href="#cb114-881"></a>       <span class="at">col =</span> <span class="st">"steelblue"</span>, </span>
<span id="cb114-882"><a href="#cb114-882"></a>       <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb114-883"><a href="#cb114-883"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb114-884"><a href="#cb114-884"></a>logit.kfoldCV.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb114-885"><a href="#cb114-885"></a><span class="in">```</span></span>
<span id="cb114-886"><a href="#cb114-886"></a></span>
<span id="cb114-887"><a href="#cb114-887"></a><span class="fu">#### Tuned</span></span>
<span id="cb114-888"><a href="#cb114-888"></a><span class="in">```{r logit.kfoldCV_mod}</span></span>
<span id="cb114-889"><a href="#cb114-889"></a>glm.model <span class="ot">&lt;-</span> <span class="fu">glm</span>(good <span class="sc">~</span> ., <span class="at">data=</span> train,<span class="at">family=</span><span class="st">"binomial"</span>)</span>
<span id="cb114-890"><a href="#cb114-890"></a>glm.fit<span class="ot">=</span> <span class="fu">stepAIC</span>(glm.model, <span class="at">direction =</span> <span class="st">'backward'</span>)</span>
<span id="cb114-891"><a href="#cb114-891"></a></span>
<span id="cb114-892"><a href="#cb114-892"></a><span class="co"># Make predictions on test data and construct a confusion matrix</span></span>
<span id="cb114-893"><a href="#cb114-893"></a>logit.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(glm.fit, <span class="at">newdata =</span> test,<span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb114-894"><a href="#cb114-894"></a>logit.predictions <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(logit.predictions <span class="sc">&gt;</span> <span class="fl">0.7</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb114-895"><a href="#cb114-895"></a>                            <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb114-896"><a href="#cb114-896"></a><span class="fu">confusionMatrix</span>(logit.predictions, test<span class="sc">$</span>good)</span>
<span id="cb114-897"><a href="#cb114-897"></a></span>
<span id="cb114-898"><a href="#cb114-898"></a></span>
<span id="cb114-899"><a href="#cb114-899"></a>logit.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(logit.predictions)</span>
<span id="cb114-900"><a href="#cb114-900"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(logit.predictions, test<span class="sc">$</span>good)</span>
<span id="cb114-901"><a href="#cb114-901"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb114-902"><a href="#cb114-902"></a>auc_val</span>
<span id="cb114-903"><a href="#cb114-903"></a></span>
<span id="cb114-904"><a href="#cb114-904"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb114-905"><a href="#cb114-905"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb114-906"><a href="#cb114-906"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb114-907"><a href="#cb114-907"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb114-908"><a href="#cb114-908"></a>     <span class="at">main =</span> <span class="st">"ROC Curves from Repeated CV"</span>)</span>
<span id="cb114-909"><a href="#cb114-909"></a><span class="fu">points</span>(auc_val, <span class="dv">1</span> <span class="sc">-</span> auc_val, </span>
<span id="cb114-910"><a href="#cb114-910"></a>       <span class="at">col =</span> <span class="st">"steelblue"</span>, </span>
<span id="cb114-911"><a href="#cb114-911"></a>       <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb114-912"><a href="#cb114-912"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb114-913"><a href="#cb114-913"></a>logit.kfoldCV.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb114-914"><a href="#cb114-914"></a><span class="in">```</span></span>
<span id="cb114-915"><a href="#cb114-915"></a></span>
<span id="cb114-916"><a href="#cb114-916"></a>| Resampling Method           | Error Rate | Sensitivity | Specificity | AUC       |</span>
<span id="cb114-917"><a href="#cb114-917"></a>| --------------------------- | ---------- | ----------- | ----------- | --------- |</span>
<span id="cb114-918"><a href="#cb114-918"></a>| Logistic Regression         | 0.1944     | 0.9347      | 0.2929      | 0.6137776 |</span>
<span id="cb114-919"><a href="#cb114-919"></a>| Logistic Regression (Tuned) | 0.1919     | 0.98946     | 0.08787     | 0.5386644 |</span>
<span id="cb114-920"><a href="#cb114-920"></a></span>
<span id="cb114-921"><a href="#cb114-921"></a></span>
<span id="cb114-922"><a href="#cb114-922"></a><span class="fu">## Linear Discriminant Analysis</span></span>
<span id="cb114-923"><a href="#cb114-923"></a></span>
<span id="cb114-924"><a href="#cb114-924"></a><span class="fu">### Model Construction</span></span>
<span id="cb114-925"><a href="#cb114-925"></a><span class="in">```{r lda.model_savings, eval=FALSE}</span></span>
<span id="cb114-926"><a href="#cb114-926"></a><span class="co">#------------#</span></span>
<span id="cb114-927"><a href="#cb114-927"></a><span class="co">#----LDA-----#</span></span>
<span id="cb114-928"><a href="#cb114-928"></a><span class="co">#------------#</span></span>
<span id="cb114-929"><a href="#cb114-929"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb114-930"><a href="#cb114-930"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">10</span>)</span>
<span id="cb114-931"><a href="#cb114-931"></a></span>
<span id="cb114-932"><a href="#cb114-932"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb114-933"><a href="#cb114-933"></a>lda_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb114-934"><a href="#cb114-934"></a>                   <span class="at">data =</span> train, </span>
<span id="cb114-935"><a href="#cb114-935"></a>                   <span class="at">method =</span> <span class="st">"lda"</span>, </span>
<span id="cb114-936"><a href="#cb114-936"></a>                   <span class="at">trControl =</span> train_control)</span>
<span id="cb114-937"><a href="#cb114-937"></a></span>
<span id="cb114-938"><a href="#cb114-938"></a><span class="fu">save</span>(lda_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">lda.model_kfoldCV.Rdata"</span>)</span>
<span id="cb114-939"><a href="#cb114-939"></a></span>
<span id="cb114-940"><a href="#cb114-940"></a></span>
<span id="cb114-941"><a href="#cb114-941"></a><span class="co">#------------------#</span></span>
<span id="cb114-942"><a href="#cb114-942"></a><span class="co">#----LDA (Mod)-----#</span></span>
<span id="cb114-943"><a href="#cb114-943"></a><span class="co">#------------------#</span></span>
<span id="cb114-944"><a href="#cb114-944"></a></span>
<span id="cb114-945"><a href="#cb114-945"></a><span class="in">```</span></span>
<span id="cb114-946"><a href="#cb114-946"></a></span>
<span id="cb114-947"><a href="#cb114-947"></a><span class="fu">### K-fold CV</span></span>
<span id="cb114-948"><a href="#cb114-948"></a><span class="in">```{r lda.kfoldCV, fig.show='hide'}</span></span>
<span id="cb114-949"><a href="#cb114-949"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">lda.model_kfoldCV.Rdata"</span>)</span>
<span id="cb114-950"><a href="#cb114-950"></a></span>
<span id="cb114-951"><a href="#cb114-951"></a>lda.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(lda_model, <span class="at">newdata =</span> test)</span>
<span id="cb114-952"><a href="#cb114-952"></a></span>
<span id="cb114-953"><a href="#cb114-953"></a><span class="fu">confusionMatrix</span>(lda.predictions, test<span class="sc">$</span>good)</span>
<span id="cb114-954"><a href="#cb114-954"></a></span>
<span id="cb114-955"><a href="#cb114-955"></a></span>
<span id="cb114-956"><a href="#cb114-956"></a>lda.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(lda.predictions)</span>
<span id="cb114-957"><a href="#cb114-957"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(lda.predictions, test<span class="sc">$</span>good)</span>
<span id="cb114-958"><a href="#cb114-958"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb114-959"><a href="#cb114-959"></a>auc_val</span>
<span id="cb114-960"><a href="#cb114-960"></a></span>
<span id="cb114-961"><a href="#cb114-961"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb114-962"><a href="#cb114-962"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb114-963"><a href="#cb114-963"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb114-964"><a href="#cb114-964"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb114-965"><a href="#cb114-965"></a>     <span class="at">main =</span> <span class="st">"ROC Curves from Repeated CV"</span>)</span>
<span id="cb114-966"><a href="#cb114-966"></a><span class="fu">points</span>(auc_val, <span class="dv">1</span> <span class="sc">-</span> auc_val, </span>
<span id="cb114-967"><a href="#cb114-967"></a>       <span class="at">col =</span> <span class="st">"steelblue"</span>, </span>
<span id="cb114-968"><a href="#cb114-968"></a>       <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb114-969"><a href="#cb114-969"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb114-970"><a href="#cb114-970"></a>lda.kfoldCV.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb114-971"><a href="#cb114-971"></a><span class="in">```</span></span>
<span id="cb114-972"><a href="#cb114-972"></a></span>
<span id="cb114-973"><a href="#cb114-973"></a><span class="fu">#### Tuned</span></span>
<span id="cb114-974"><a href="#cb114-974"></a><span class="in">```{r, lda.kfoldCV_mod, fig.show='hide'}</span></span>
<span id="cb114-975"><a href="#cb114-975"></a></span>
<span id="cb114-976"><a href="#cb114-976"></a><span class="in">```</span></span>
<span id="cb114-977"><a href="#cb114-977"></a></span>
<span id="cb114-978"><a href="#cb114-978"></a>| Resampling Method | Error Rate | Sensitivity | Specificity | AUC       |</span>
<span id="cb114-979"><a href="#cb114-979"></a>| ----------------- | ---------- | ----------- | ----------- | --------- |</span>
<span id="cb114-980"><a href="#cb114-980"></a>| LDA               | 0.1919     | 0.9283      | 0.3305      | 0.6294448 |</span>
<span id="cb114-981"><a href="#cb114-981"></a>| LDA (Tuned)       | 0.xxxx     | 0.xxxx      | 0.xxxx      | 0.xxxxxxx |</span>
<span id="cb114-982"><a href="#cb114-982"></a></span>
<span id="cb114-983"><a href="#cb114-983"></a></span>
<span id="cb114-984"><a href="#cb114-984"></a><span class="fu">## Quadratic discriminant analysis</span></span>
<span id="cb114-985"><a href="#cb114-985"></a></span>
<span id="cb114-986"><a href="#cb114-986"></a><span class="fu">### Model Construction</span></span>
<span id="cb114-987"><a href="#cb114-987"></a><span class="in">```{r qda.model_savings, eval=FALSE}</span></span>
<span id="cb114-988"><a href="#cb114-988"></a><span class="co">#------------#</span></span>
<span id="cb114-989"><a href="#cb114-989"></a><span class="co">#----QDA-----#</span></span>
<span id="cb114-990"><a href="#cb114-990"></a><span class="co">#------------#</span></span>
<span id="cb114-991"><a href="#cb114-991"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb114-992"><a href="#cb114-992"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">10</span>)</span>
<span id="cb114-993"><a href="#cb114-993"></a></span>
<span id="cb114-994"><a href="#cb114-994"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb114-995"><a href="#cb114-995"></a>qda_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb114-996"><a href="#cb114-996"></a>                   <span class="at">data =</span> train, </span>
<span id="cb114-997"><a href="#cb114-997"></a>                   <span class="at">method =</span> <span class="st">"qda"</span>, </span>
<span id="cb114-998"><a href="#cb114-998"></a>                   <span class="at">trControl =</span> train_control)</span>
<span id="cb114-999"><a href="#cb114-999"></a></span>
<span id="cb114-1000"><a href="#cb114-1000"></a><span class="fu">save</span>(qda_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">qda.model_kfoldCV.Rdata"</span>)</span>
<span id="cb114-1001"><a href="#cb114-1001"></a></span>
<span id="cb114-1002"><a href="#cb114-1002"></a><span class="co">#------------------#</span></span>
<span id="cb114-1003"><a href="#cb114-1003"></a><span class="co">#----QDA (Mod)-----#</span></span>
<span id="cb114-1004"><a href="#cb114-1004"></a><span class="co">#------------------#</span></span>
<span id="cb114-1005"><a href="#cb114-1005"></a></span>
<span id="cb114-1006"><a href="#cb114-1006"></a><span class="in">```</span></span>
<span id="cb114-1007"><a href="#cb114-1007"></a></span>
<span id="cb114-1008"><a href="#cb114-1008"></a><span class="fu">### K-fold CV</span></span>
<span id="cb114-1009"><a href="#cb114-1009"></a><span class="in">```{r qda.kfoldCV, fig.show='hide'}</span></span>
<span id="cb114-1010"><a href="#cb114-1010"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">qda.model_kfoldCV.Rdata"</span>)</span>
<span id="cb114-1011"><a href="#cb114-1011"></a></span>
<span id="cb114-1012"><a href="#cb114-1012"></a>qda.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(qda_model, <span class="at">newdata =</span> test)</span>
<span id="cb114-1013"><a href="#cb114-1013"></a></span>
<span id="cb114-1014"><a href="#cb114-1014"></a><span class="fu">confusionMatrix</span>(qda.predictions, test<span class="sc">$</span>good)</span>
<span id="cb114-1015"><a href="#cb114-1015"></a></span>
<span id="cb114-1016"><a href="#cb114-1016"></a></span>
<span id="cb114-1017"><a href="#cb114-1017"></a>qda.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(qda.predictions)</span>
<span id="cb114-1018"><a href="#cb114-1018"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(qda.predictions, test<span class="sc">$</span>good)</span>
<span id="cb114-1019"><a href="#cb114-1019"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb114-1020"><a href="#cb114-1020"></a>auc_val</span>
<span id="cb114-1021"><a href="#cb114-1021"></a></span>
<span id="cb114-1022"><a href="#cb114-1022"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb114-1023"><a href="#cb114-1023"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb114-1024"><a href="#cb114-1024"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb114-1025"><a href="#cb114-1025"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb114-1026"><a href="#cb114-1026"></a>     <span class="at">main =</span> <span class="st">"ROC Curves from Repeated CV"</span>)</span>
<span id="cb114-1027"><a href="#cb114-1027"></a><span class="fu">points</span>(auc_val, <span class="dv">1</span> <span class="sc">-</span> auc_val, </span>
<span id="cb114-1028"><a href="#cb114-1028"></a>       <span class="at">col =</span> <span class="st">"steelblue"</span>, </span>
<span id="cb114-1029"><a href="#cb114-1029"></a>       <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb114-1030"><a href="#cb114-1030"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb114-1031"><a href="#cb114-1031"></a>qda.kfoldCV.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb114-1032"><a href="#cb114-1032"></a><span class="in">```</span></span>
<span id="cb114-1033"><a href="#cb114-1033"></a></span>
<span id="cb114-1034"><a href="#cb114-1034"></a><span class="fu">#### Tuned</span></span>
<span id="cb114-1035"><a href="#cb114-1035"></a><span class="in">```{rqda.kfoldCV_mod}</span></span>
<span id="cb114-1036"><a href="#cb114-1036"></a></span>
<span id="cb114-1037"><a href="#cb114-1037"></a><span class="in">```</span></span>
<span id="cb114-1038"><a href="#cb114-1038"></a></span>
<span id="cb114-1039"><a href="#cb114-1039"></a>| Resampling Method | Error Rate | Sensitivity | Specificity | AUC       |</span>
<span id="cb114-1040"><a href="#cb114-1040"></a>| ----------------- | ---------- | ----------- | ----------- | --------- |</span>
<span id="cb114-1041"><a href="#cb114-1041"></a>| QDA               | 0.2559     | 0.7418      | 0.7531      | 0.7474858 |</span>
<span id="cb114-1042"><a href="#cb114-1042"></a>| QDA (Tuned)       | 0.xxxx     | 0.xxxx      | 0.xxxx      | 0.xxxxxxx |</span>
<span id="cb114-1043"><a href="#cb114-1043"></a></span>
<span id="cb114-1044"><a href="#cb114-1044"></a></span>
<span id="cb114-1045"><a href="#cb114-1045"></a><span class="fu">## Summary</span></span>
<span id="cb114-1046"><a href="#cb114-1046"></a></span>
<span id="cb114-1047"><a href="#cb114-1047"></a><span class="in">```{r log.lda.qda.ROC_curve, fig.width=10, fig.height=10}</span></span>
<span id="cb114-1048"><a href="#cb114-1048"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(knn.kfoldCV.ROC.plot,</span>
<span id="cb114-1049"><a href="#cb114-1049"></a>                   logit.kfoldCV.ROC.plot,</span>
<span id="cb114-1050"><a href="#cb114-1050"></a>                   lda.kfoldCV.ROC.plot,</span>
<span id="cb114-1051"><a href="#cb114-1051"></a>                   qda.kfoldCV.ROC.plot, </span>
<span id="cb114-1052"><a href="#cb114-1052"></a>                   <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">align =</span> <span class="st">"hv"</span>, <span class="at">scale =</span> <span class="fl">0.8</span>)</span>
<span id="cb114-1053"><a href="#cb114-1053"></a><span class="in">```</span></span>
<span id="cb114-1054"><a href="#cb114-1054"></a></span>
<span id="cb114-1055"><a href="#cb114-1055"></a></span>
<span id="cb114-1056"><a href="#cb114-1056"></a>| Resampling Method           | Error Rate | Sensitivity | Specificity | AUC       |</span>
<span id="cb114-1057"><a href="#cb114-1057"></a>| --------------------------- | ---------- | ----------- | ----------- | --------- |</span>
<span id="cb114-1058"><a href="#cb114-1058"></a>| Logistic Regression         | 0.1944     | 0.9347      | 0.2929      | 0.6137776 |</span>
<span id="cb114-1059"><a href="#cb114-1059"></a>| Logistic Regression (Tuned) | 0.1919     | 0.98946     | 0.08787     | 0.5386644 |</span>
<span id="cb114-1060"><a href="#cb114-1060"></a>|                             |            |             |             |           |</span>
<span id="cb114-1061"><a href="#cb114-1061"></a>| LDA                         | 0.1919     | 0.9283      | 0.3305      | 0.6294448 |</span>
<span id="cb114-1062"><a href="#cb114-1062"></a>| LDA (Tuned)                 | 0.xxxx     | 0.xxxx      | 0.xxxx      | 0.xxxxxxx |</span>
<span id="cb114-1063"><a href="#cb114-1063"></a>|                             |            |             |             |           |</span>
<span id="cb114-1064"><a href="#cb114-1064"></a>| QDA                         | 0.2559     | 0.7418      | 0.7531      | 0.7474858 |</span>
<span id="cb114-1065"><a href="#cb114-1065"></a>| QDA (Tuned)                 | 0.xxxx     | 0.xxxx      | 0.xxxx      | 0.xxxxxxx |</span>
<span id="cb114-1066"><a href="#cb114-1066"></a></span>
<span id="cb114-1067"><a href="#cb114-1067"></a></span>
<span id="cb114-1068"><a href="#cb114-1068"></a><span class="fu">## Multi Regression</span></span>
<span id="cb114-1069"><a href="#cb114-1069"></a></span>
<span id="cb114-1070"><a href="#cb114-1070"></a><span class="fu">### Model Construction</span></span>
<span id="cb114-1073"><a href="#cb114-1073"></a><span class="in">```{r}</span></span>
<span id="cb114-1074"><a href="#cb114-1074"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb114-1075"><a href="#cb114-1075"></a></span>
<span id="cb114-1076"><a href="#cb114-1076"></a></span>
<span id="cb114-1077"><a href="#cb114-1077"></a><span class="in">```</span></span>
<span id="cb114-1078"><a href="#cb114-1078"></a></span>
<span id="cb114-1079"><a href="#cb114-1079"></a><span class="fu">### K-fold CV</span></span>
<span id="cb114-1082"><a href="#cb114-1082"></a><span class="in">```{r}</span></span>
<span id="cb114-1083"><a href="#cb114-1083"></a><span class="in">```</span></span>
<span id="cb114-1084"><a href="#cb114-1084"></a></span>
<span id="cb114-1085"><a href="#cb114-1085"></a><span class="fu">#### Tuned</span></span>
<span id="cb114-1088"><a href="#cb114-1088"></a><span class="in">```{r}</span></span>
<span id="cb114-1089"><a href="#cb114-1089"></a><span class="in">```</span></span>
<span id="cb114-1090"><a href="#cb114-1090"></a></span>
<span id="cb114-1091"><a href="#cb114-1091"></a></span>
<span id="cb114-1092"><a href="#cb114-1092"></a><span class="fu">## Naive Bayes</span></span>
<span id="cb114-1093"><a href="#cb114-1093"></a></span>
<span id="cb114-1094"><a href="#cb114-1094"></a><span class="fu">### Model Construction</span></span>
<span id="cb114-1097"><a href="#cb114-1097"></a><span class="in">```{r}</span></span>
<span id="cb114-1098"><a href="#cb114-1098"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb114-1099"><a href="#cb114-1099"></a></span>
<span id="cb114-1100"><a href="#cb114-1100"></a></span>
<span id="cb114-1101"><a href="#cb114-1101"></a><span class="in">```</span></span>
<span id="cb114-1102"><a href="#cb114-1102"></a></span>
<span id="cb114-1103"><a href="#cb114-1103"></a><span class="fu">### K-fold CV</span></span>
<span id="cb114-1106"><a href="#cb114-1106"></a><span class="in">```{r}</span></span>
<span id="cb114-1107"><a href="#cb114-1107"></a><span class="in">```</span></span>
<span id="cb114-1108"><a href="#cb114-1108"></a></span>
<span id="cb114-1109"><a href="#cb114-1109"></a><span class="fu">#### Tuned</span></span>
<span id="cb114-1112"><a href="#cb114-1112"></a><span class="in">```{r}</span></span>
<span id="cb114-1113"><a href="#cb114-1113"></a><span class="in">```</span></span>
<span id="cb114-1114"><a href="#cb114-1114"></a></span>
<span id="cb114-1115"><a href="#cb114-1115"></a></span>
<span id="cb114-1116"><a href="#cb114-1116"></a><span class="fu">## Decision Forest</span></span>
<span id="cb114-1117"><a href="#cb114-1117"></a></span>
<span id="cb114-1118"><a href="#cb114-1118"></a><span class="fu">### Model Construction</span></span>
<span id="cb114-1121"><a href="#cb114-1121"></a><span class="in">```{r}</span></span>
<span id="cb114-1122"><a href="#cb114-1122"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb114-1123"><a href="#cb114-1123"></a></span>
<span id="cb114-1124"><a href="#cb114-1124"></a></span>
<span id="cb114-1125"><a href="#cb114-1125"></a><span class="in">```</span></span>
<span id="cb114-1126"><a href="#cb114-1126"></a></span>
<span id="cb114-1127"><a href="#cb114-1127"></a><span class="fu">### K-fold CV</span></span>
<span id="cb114-1130"><a href="#cb114-1130"></a><span class="in">```{r}</span></span>
<span id="cb114-1131"><a href="#cb114-1131"></a><span class="in">```</span></span>
<span id="cb114-1132"><a href="#cb114-1132"></a></span>
<span id="cb114-1133"><a href="#cb114-1133"></a><span class="fu">#### Tuned</span></span>
<span id="cb114-1136"><a href="#cb114-1136"></a><span class="in">```{r}</span></span>
<span id="cb114-1137"><a href="#cb114-1137"></a><span class="in">```</span></span>
<span id="cb114-1138"><a href="#cb114-1138"></a></span>
<span id="cb114-1139"><a href="#cb114-1139"></a></span>
<span id="cb114-1140"><a href="#cb114-1140"></a><span class="fu">## Classification Tree</span></span>
<span id="cb114-1141"><a href="#cb114-1141"></a></span>
<span id="cb114-1142"><a href="#cb114-1142"></a><span class="fu">### Model Construction</span></span>
<span id="cb114-1145"><a href="#cb114-1145"></a><span class="in">```{r}</span></span>
<span id="cb114-1146"><a href="#cb114-1146"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb114-1147"><a href="#cb114-1147"></a></span>
<span id="cb114-1148"><a href="#cb114-1148"></a></span>
<span id="cb114-1149"><a href="#cb114-1149"></a><span class="in">```</span></span>
<span id="cb114-1150"><a href="#cb114-1150"></a></span>
<span id="cb114-1151"><a href="#cb114-1151"></a><span class="fu">### K-fold CV</span></span>
<span id="cb114-1154"><a href="#cb114-1154"></a><span class="in">```{r}</span></span>
<span id="cb114-1155"><a href="#cb114-1155"></a><span class="in">```</span></span>
<span id="cb114-1156"><a href="#cb114-1156"></a></span>
<span id="cb114-1157"><a href="#cb114-1157"></a><span class="fu">#### Tuned</span></span>
<span id="cb114-1160"><a href="#cb114-1160"></a><span class="in">```{r}</span></span>
<span id="cb114-1161"><a href="#cb114-1161"></a><span class="in">```</span></span>
<span id="cb114-1162"><a href="#cb114-1162"></a></span>
<span id="cb114-1163"><a href="#cb114-1163"></a></span>
<span id="cb114-1164"><a href="#cb114-1164"></a><span class="fu">## Regression Tree</span></span>
<span id="cb114-1165"><a href="#cb114-1165"></a></span>
<span id="cb114-1166"><a href="#cb114-1166"></a><span class="fu">### Model Construction</span></span>
<span id="cb114-1169"><a href="#cb114-1169"></a><span class="in">```{r}</span></span>
<span id="cb114-1170"><a href="#cb114-1170"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb114-1171"><a href="#cb114-1171"></a></span>
<span id="cb114-1172"><a href="#cb114-1172"></a></span>
<span id="cb114-1173"><a href="#cb114-1173"></a><span class="in">```</span></span>
<span id="cb114-1174"><a href="#cb114-1174"></a></span>
<span id="cb114-1175"><a href="#cb114-1175"></a><span class="fu">### K-fold CV</span></span>
<span id="cb114-1178"><a href="#cb114-1178"></a><span class="in">```{r}</span></span>
<span id="cb114-1179"><a href="#cb114-1179"></a><span class="in">```</span></span>
<span id="cb114-1180"><a href="#cb114-1180"></a></span>
<span id="cb114-1181"><a href="#cb114-1181"></a><span class="fu">#### Tuned</span></span>
<span id="cb114-1184"><a href="#cb114-1184"></a><span class="in">```{r}</span></span>
<span id="cb114-1185"><a href="#cb114-1185"></a><span class="in">```</span></span>
<span id="cb114-1186"><a href="#cb114-1186"></a></span>
<span id="cb114-1187"><a href="#cb114-1187"></a></span>
<span id="cb114-1188"><a href="#cb114-1188"></a><span class="fu">## Randome Forest - Classification</span></span>
<span id="cb114-1189"><a href="#cb114-1189"></a></span>
<span id="cb114-1190"><a href="#cb114-1190"></a><span class="fu">### Model Construction</span></span>
<span id="cb114-1193"><a href="#cb114-1193"></a><span class="in">```{r}</span></span>
<span id="cb114-1194"><a href="#cb114-1194"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb114-1195"><a href="#cb114-1195"></a></span>
<span id="cb114-1196"><a href="#cb114-1196"></a></span>
<span id="cb114-1197"><a href="#cb114-1197"></a><span class="in">```</span></span>
<span id="cb114-1198"><a href="#cb114-1198"></a></span>
<span id="cb114-1199"><a href="#cb114-1199"></a><span class="fu">### K-fold CV</span></span>
<span id="cb114-1202"><a href="#cb114-1202"></a><span class="in">```{r}</span></span>
<span id="cb114-1203"><a href="#cb114-1203"></a><span class="in">```</span></span>
<span id="cb114-1204"><a href="#cb114-1204"></a></span>
<span id="cb114-1205"><a href="#cb114-1205"></a><span class="fu">#### Tuned</span></span>
<span id="cb114-1208"><a href="#cb114-1208"></a><span class="in">```{r}</span></span>
<span id="cb114-1209"><a href="#cb114-1209"></a><span class="in">```</span></span>
<span id="cb114-1210"><a href="#cb114-1210"></a></span>
<span id="cb114-1211"><a href="#cb114-1211"></a></span>
<span id="cb114-1212"><a href="#cb114-1212"></a><span class="fu">## Randome Forest - Regression</span></span>
<span id="cb114-1213"><a href="#cb114-1213"></a></span>
<span id="cb114-1214"><a href="#cb114-1214"></a><span class="fu">### Model Construction</span></span>
<span id="cb114-1217"><a href="#cb114-1217"></a><span class="in">```{r}</span></span>
<span id="cb114-1218"><a href="#cb114-1218"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb114-1219"><a href="#cb114-1219"></a></span>
<span id="cb114-1220"><a href="#cb114-1220"></a></span>
<span id="cb114-1221"><a href="#cb114-1221"></a><span class="in">```</span></span>
<span id="cb114-1222"><a href="#cb114-1222"></a></span>
<span id="cb114-1223"><a href="#cb114-1223"></a><span class="fu">### K-fold CV</span></span>
<span id="cb114-1226"><a href="#cb114-1226"></a><span class="in">```{r}</span></span>
<span id="cb114-1227"><a href="#cb114-1227"></a><span class="in">```</span></span>
<span id="cb114-1228"><a href="#cb114-1228"></a></span>
<span id="cb114-1229"><a href="#cb114-1229"></a><span class="fu">#### Tuned</span></span>
<span id="cb114-1232"><a href="#cb114-1232"></a><span class="in">```{r}</span></span>
<span id="cb114-1233"><a href="#cb114-1233"></a><span class="in">```</span></span>
<span id="cb114-1234"><a href="#cb114-1234"></a></span>
<span id="cb114-1235"><a href="#cb114-1235"></a></span>
<span id="cb114-1236"><a href="#cb114-1236"></a><span class="fu">## Boosting</span></span>
<span id="cb114-1237"><a href="#cb114-1237"></a></span>
<span id="cb114-1238"><a href="#cb114-1238"></a><span class="fu">### Model Construction</span></span>
<span id="cb114-1241"><a href="#cb114-1241"></a><span class="in">```{r}</span></span>
<span id="cb114-1242"><a href="#cb114-1242"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb114-1243"><a href="#cb114-1243"></a></span>
<span id="cb114-1244"><a href="#cb114-1244"></a></span>
<span id="cb114-1245"><a href="#cb114-1245"></a><span class="in">```</span></span>
<span id="cb114-1246"><a href="#cb114-1246"></a></span>
<span id="cb114-1247"><a href="#cb114-1247"></a><span class="fu">### K-fold CV</span></span>
<span id="cb114-1250"><a href="#cb114-1250"></a><span class="in">```{r}</span></span>
<span id="cb114-1251"><a href="#cb114-1251"></a><span class="in">```</span></span>
<span id="cb114-1252"><a href="#cb114-1252"></a></span>
<span id="cb114-1253"><a href="#cb114-1253"></a><span class="fu">#### Tuned</span></span>
<span id="cb114-1256"><a href="#cb114-1256"></a><span class="in">```{r}</span></span>
<span id="cb114-1257"><a href="#cb114-1257"></a><span class="in">```</span></span>
<span id="cb114-1258"><a href="#cb114-1258"></a></span>
<span id="cb114-1259"><a href="#cb114-1259"></a></span>
<span id="cb114-1260"><a href="#cb114-1260"></a><span class="fu">## Bagging</span></span>
<span id="cb114-1261"><a href="#cb114-1261"></a></span>
<span id="cb114-1262"><a href="#cb114-1262"></a><span class="fu">### Model Construction</span></span>
<span id="cb114-1265"><a href="#cb114-1265"></a><span class="in">```{r}</span></span>
<span id="cb114-1266"><a href="#cb114-1266"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb114-1267"><a href="#cb114-1267"></a></span>
<span id="cb114-1268"><a href="#cb114-1268"></a></span>
<span id="cb114-1269"><a href="#cb114-1269"></a><span class="in">```</span></span>
<span id="cb114-1270"><a href="#cb114-1270"></a></span>
<span id="cb114-1271"><a href="#cb114-1271"></a><span class="fu">### K-fold CV</span></span>
<span id="cb114-1274"><a href="#cb114-1274"></a><span class="in">```{r}</span></span>
<span id="cb114-1275"><a href="#cb114-1275"></a><span class="in">```</span></span>
<span id="cb114-1276"><a href="#cb114-1276"></a></span>
<span id="cb114-1277"><a href="#cb114-1277"></a><span class="fu">#### Tuned</span></span>
<span id="cb114-1280"><a href="#cb114-1280"></a><span class="in">```{r}</span></span>
<span id="cb114-1281"><a href="#cb114-1281"></a><span class="in">```</span></span>
<span id="cb114-1282"><a href="#cb114-1282"></a></span>
<span id="cb114-1283"><a href="#cb114-1283"></a><span class="fu">## SVM</span></span>
<span id="cb114-1284"><a href="#cb114-1284"></a></span>
<span id="cb114-1285"><a href="#cb114-1285"></a><span class="fu">### Model Construction</span></span>
<span id="cb114-1288"><a href="#cb114-1288"></a><span class="in">```{r}</span></span>
<span id="cb114-1289"><a href="#cb114-1289"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb114-1290"><a href="#cb114-1290"></a></span>
<span id="cb114-1291"><a href="#cb114-1291"></a></span>
<span id="cb114-1292"><a href="#cb114-1292"></a><span class="in">```</span></span>
<span id="cb114-1293"><a href="#cb114-1293"></a></span>
<span id="cb114-1294"><a href="#cb114-1294"></a><span class="fu">### K-fold CV</span></span>
<span id="cb114-1297"><a href="#cb114-1297"></a><span class="in">```{r}</span></span>
<span id="cb114-1298"><a href="#cb114-1298"></a><span class="in">```</span></span>
<span id="cb114-1299"><a href="#cb114-1299"></a></span>
<span id="cb114-1300"><a href="#cb114-1300"></a><span class="fu">#### Tuned</span></span>
<span id="cb114-1303"><a href="#cb114-1303"></a><span class="in">```{r}</span></span>
<span id="cb114-1304"><a href="#cb114-1304"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



<script src="Sang_files/libs/quarto-html/zenscroll-min.js"></script>
</body></html>