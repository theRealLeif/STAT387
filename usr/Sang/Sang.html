<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.242">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Introduction to Statistical Learning</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Sang_files/libs/clipboard/clipboard.min.js"></script>
<script src="Sang_files/libs/quarto-html/quarto.js"></script>
<script src="Sang_files/libs/quarto-html/popper.min.js"></script>
<script src="Sang_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Sang_files/libs/quarto-html/anchor.min.js"></script>
<link href="Sang_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Sang_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="Sang_files/libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="Sang_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Sang_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Sang_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="Sang_files/libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<style>html{ scroll-behavior: smooth; }</style>

<link href="Sang_files/libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="Sang_files/libs/pagedtable-1.1/js/pagedtable.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of Contents</h2>
   
  <ul>
  <li><a href="#preamble" id="toc-preamble" class="nav-link active" data-scroll-target="#preamble">Preamble</a>
  <ul>
  <li><a href="#problem-statements" id="toc-problem-statements" class="nav-link" data-scroll-target="#problem-statements">Problem Statements</a></li>
  <li><a href="#methodologies" id="toc-methodologies" class="nav-link" data-scroll-target="#methodologies">Methodologies</a></li>
  <li><a href="#data-description" id="toc-data-description" class="nav-link" data-scroll-target="#data-description">Data Description</a></li>
  </ul></li>
  <li><a href="#exploratory-analysis" id="toc-exploratory-analysis" class="nav-link" data-scroll-target="#exploratory-analysis">Exploratory Analysis</a>
  <ul>
  <li><a href="#data-import" id="toc-data-import" class="nav-link" data-scroll-target="#data-import">Data Import</a></li>
  <li><a href="#data-analysis" id="toc-data-analysis" class="nav-link" data-scroll-target="#data-analysis">Data Analysis</a></li>
  <li><a href="#data-histograms" id="toc-data-histograms" class="nav-link" data-scroll-target="#data-histograms">Data Histograms</a></li>
  <li><a href="#data-relationships" id="toc-data-relationships" class="nav-link" data-scroll-target="#data-relationships">Data Relationships</a></li>
  <li><a href="#data-split" id="toc-data-split" class="nav-link" data-scroll-target="#data-split">Data Split</a></li>
  </ul></li>
  <li><a href="#data-modeling" id="toc-data-modeling" class="nav-link" data-scroll-target="#data-modeling">Data Modeling</a>
  <ul>
  <li><a href="#k-nearest-neightbor" id="toc-k-nearest-neightbor" class="nav-link" data-scroll-target="#k-nearest-neightbor">K-Nearest Neightbor</a>
  <ul class="collapse">
  <li><a href="#model-construction" id="toc-model-construction" class="nav-link" data-scroll-target="#model-construction">Model Construction</a></li>
  <li><a href="#k-fold-cv" id="toc-k-fold-cv" class="nav-link" data-scroll-target="#k-fold-cv">K-fold CV</a></li>
  <li><a href="#hold-out-cv" id="toc-hold-out-cv" class="nav-link" data-scroll-target="#hold-out-cv">Hold-out CV</a></li>
  <li><a href="#loocv" id="toc-loocv" class="nav-link" data-scroll-target="#loocv">LOOCV</a></li>
  <li><a href="#repeated-cv" id="toc-repeated-cv" class="nav-link" data-scroll-target="#repeated-cv">Repeated CV</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul></li>
  <li><a href="#logistic-regression" id="toc-logistic-regression" class="nav-link" data-scroll-target="#logistic-regression">Logistic Regression</a>
  <ul class="collapse">
  <li><a href="#model-construction-1" id="toc-model-construction-1" class="nav-link" data-scroll-target="#model-construction-1">Model Construction</a></li>
  <li><a href="#k-fold-cv-1" id="toc-k-fold-cv-1" class="nav-link" data-scroll-target="#k-fold-cv-1">K-fold CV</a></li>
  </ul></li>
  <li><a href="#linear-discriminant-analysis" id="toc-linear-discriminant-analysis" class="nav-link" data-scroll-target="#linear-discriminant-analysis">Linear Discriminant Analysis</a>
  <ul class="collapse">
  <li><a href="#model-construction-2" id="toc-model-construction-2" class="nav-link" data-scroll-target="#model-construction-2">Model Construction</a></li>
  <li><a href="#k-fold-cv-2" id="toc-k-fold-cv-2" class="nav-link" data-scroll-target="#k-fold-cv-2">K-fold CV</a></li>
  </ul></li>
  <li><a href="#quadratic-discriminant-analysis" id="toc-quadratic-discriminant-analysis" class="nav-link" data-scroll-target="#quadratic-discriminant-analysis">Quadratic discriminant analysis</a>
  <ul class="collapse">
  <li><a href="#model-construction-3" id="toc-model-construction-3" class="nav-link" data-scroll-target="#model-construction-3">Model Construction</a></li>
  <li><a href="#k-fold-cv-3" id="toc-k-fold-cv-3" class="nav-link" data-scroll-target="#k-fold-cv-3">K-fold CV</a></li>
  </ul></li>
  <li><a href="#summary-1" id="toc-summary-1" class="nav-link" data-scroll-target="#summary-1">Summary</a></li>
  </ul></li>
  <li><a href="#furthuer-modeling" id="toc-furthuer-modeling" class="nav-link" data-scroll-target="#furthuer-modeling">Furthuer Modeling</a>
  <ul>
  <li><a href="#naive-bayes" id="toc-naive-bayes" class="nav-link" data-scroll-target="#naive-bayes">Naive Bayes</a>
  <ul class="collapse">
  <li><a href="#model-construction-4" id="toc-model-construction-4" class="nav-link" data-scroll-target="#model-construction-4">Model Construction</a></li>
  <li><a href="#k-fold-cv-4" id="toc-k-fold-cv-4" class="nav-link" data-scroll-target="#k-fold-cv-4">K-fold CV</a></li>
  </ul></li>
  <li><a href="#decision-tree" id="toc-decision-tree" class="nav-link" data-scroll-target="#decision-tree">Decision Tree</a>
  <ul class="collapse">
  <li><a href="#model-construction-5" id="toc-model-construction-5" class="nav-link" data-scroll-target="#model-construction-5">Model Construction</a></li>
  <li><a href="#k-fold-cv-5" id="toc-k-fold-cv-5" class="nav-link" data-scroll-target="#k-fold-cv-5">K-fold CV</a></li>
  </ul></li>
  <li><a href="#randome-forest" id="toc-randome-forest" class="nav-link" data-scroll-target="#randome-forest">Randome Forest</a>
  <ul class="collapse">
  <li><a href="#model-construction-6" id="toc-model-construction-6" class="nav-link" data-scroll-target="#model-construction-6">Model Construction</a></li>
  <li><a href="#k-fold-cv-6" id="toc-k-fold-cv-6" class="nav-link" data-scroll-target="#k-fold-cv-6">K-fold CV</a></li>
  </ul></li>
  <li><a href="#bagging" id="toc-bagging" class="nav-link" data-scroll-target="#bagging">Bagging</a>
  <ul class="collapse">
  <li><a href="#model-construction-7" id="toc-model-construction-7" class="nav-link" data-scroll-target="#model-construction-7">Model Construction</a></li>
  <li><a href="#k-fold-cv-7" id="toc-k-fold-cv-7" class="nav-link" data-scroll-target="#k-fold-cv-7">K-fold CV</a></li>
  </ul></li>
  <li><a href="#boosting" id="toc-boosting" class="nav-link" data-scroll-target="#boosting">Boosting</a>
  <ul class="collapse">
  <li><a href="#model-construction-8" id="toc-model-construction-8" class="nav-link" data-scroll-target="#model-construction-8">Model Construction</a></li>
  <li><a href="#k-fold-cv-8" id="toc-k-fold-cv-8" class="nav-link" data-scroll-target="#k-fold-cv-8">K-fold CV</a></li>
  </ul></li>
  <li><a href="#svm" id="toc-svm" class="nav-link" data-scroll-target="#svm">SVM</a>
  <ul class="collapse">
  <li><a href="#model-construction-9" id="toc-model-construction-9" class="nav-link" data-scroll-target="#model-construction-9">Model Construction</a></li>
  <li><a href="#k-fold-cv-9" id="toc-k-fold-cv-9" class="nav-link" data-scroll-target="#k-fold-cv-9">K-fold CV</a></li>
  </ul></li>
  <li><a href="#summary-2" id="toc-summary-2" class="nav-link" data-scroll-target="#summary-2">Summary</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Introduction to Statistical Learning</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i></button></div></div>
<p class="subtitle lead">STAT 387</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="cell" data-layout-align="TRUE">

<style type="text/css">
body {
font-family: "Times New Roman";
font-size: 0.8em;
}

h2, .h2, h2.anchored, 
h3, .h3, h3.anchored,
.quarto-title, 
.quarto-title-meta {
text-align: center;
}

h2, .h2 {
font-size: 1.5em;
}

h3, .h3 {
font-size: 1.25em;
}

h4, .h4 {
font-size: 1em;
}

h5, .h5 {
font-size: 0.75em;
}

h6, .h6 {
font-size: 0.7em;
}

.quarto-title-meta {
display: block!important;
}

.quarto-title-meta-heading {
display: none;
}

.content {
width: 1000px;
}
.dropdown-menu {
font-size: 0.8rem;
}

code {
color: #61AFEF;
}

.btn {
border-color: #f8f9fa9e!important;
}

body.quarto-dark {
background-color: #282c34;

color: #d8dee9;

.pagedtable .even {
background-color: #3b4252!important;
}

p code:not(.sourceCode), li code:not(.sourceCode) {
background-color: #4c566a!important;
}
}

#quarto-code-tools-menu{
position: absolute;
}

.top-right {
position: fixed;
}

#TOC::before {
content: "";
display: block;
height: 141px;
margin: 20px 20px 20px 20px;
background-image: url("https://raw.githubusercontent.com/theRealLeif/STAT387/main/README.asset/Logo.svg");
background-size: contain;
background-position: center center;
background-repeat: no-repeat;
}

</style>
</div>
<section id="preamble" class="level2">
<h2 class="anchored" data-anchor-id="preamble">Preamble</h2>
<p>Consider the wine quality dataset from <a href="https://archive.ics.uci.edu/ml/datasets/Wine+Quality">UCI Machine Learning Respository</a>. We will focus only on the data concerning white wines (and not red wines). Dichotomize the <code>quality</code> variable as <code>good</code>, which takes the value 1 if quality â‰¥ 7 and the value 0, otherwise. We will take <code>good</code> as response and all the 11 physiochemical characteristics of the wines in the data as predictors.</p>
<section id="problem-statements" class="level3">
<h3 class="anchored" data-anchor-id="problem-statements">Problem Statements</h3>
<p>Use 10-fold cross-validation for estimating the test error rates below and compute the estimates using <code>caret</code> package with seed set to 1234 before each computation.</p>
<ol type="a">
<li>Fit a KNN with K chosen optimally using test error rate. Report error rate, sensitivity, specificity, and AUC for the optimal KNN based on the training data. Also, report its estimated test error rate.</li>
<li>Repeat (a) using logistic regression.</li>
<li>Repeat (a) using LDA.</li>
<li>Repeat (a) using QDA.</li>
<li>Compare the results in (a)-(d). Which classifier would you recommend? Justify your answer.</li>
</ol>
</section>
<section id="methodologies" class="level3">
<h3 class="anchored" data-anchor-id="methodologies">Methodologies</h3>
<ul>
<li>KNN</li>
<li>GLM/logit/glmnet</li>
<li>LDA</li>
<li>QDA</li>
<li>Naive Bayes</li>
<li>Decision Tree
<ul>
<li>Classification and Regression Trees (CART)</li>
</ul></li>
<li>Random Forest (Classification)</li>
<li>Bagging (Bootstrap Aggregation)</li>
<li>Boosting (Gradient Boosting Machine (GBM))</li>
<li>eXtreme Gradient Boosting (XGBoost)</li>
<li>Extremely Randomized Trees (ExtraTrees)</li>
<li>SVM</li>
<li>Neural Networks (NNET)</li>
</ul>
</section>
<section id="data-description" class="level3">
<h3 class="anchored" data-anchor-id="data-description">Data Description</h3>
<p>This is a dataset of wine quality containing 4898 observations of 12 variables. The variables are:</p>
<ul>
<li><code>fixed.acidity</code>: The amount of fixed acid in the wine (<span class="math inline">\(g/dm^3\)</span>)</li>
<li><code>volatile.acidity</code>: The amount of volatile acid in the wine (<span class="math inline">\(g/dm^4\)</span>)</li>
<li><code>citric.acid</code>: The amount of citric acid in the wine (<span class="math inline">\(g/dm^3\)</span>)</li>
<li><code>residual.sugar</code>: The amount of residual sugar in the wine (<span class="math inline">\(g/dm^3\)</span>)</li>
<li><code>chlorides</code>: The amount of salt in the wine (<span class="math inline">\(g/dm^3\)</span>)</li>
<li><code>free.sulfur.dioxide</code>: The amount of free sulfur dioxide in the wine (<span class="math inline">\(mg/dm^3\)</span>)</li>
<li><code>total.sulfur.dioxide</code>: The amount of total sulfur dioxide in the wine (<span class="math inline">\(mg/dm^3\)</span>)</li>
<li><code>density</code>: The density of the wine (<span class="math inline">\(g/dm^3\)</span>)</li>
<li><code>pH</code>: The <span class="math inline">\(pH\)</span> value of the wine</li>
<li><code>sulphates</code>: The amount of sulphates in the wine (<span class="math inline">\(g/dm^3\)</span>)</li>
<li><code>alcohol</code>: The alcohol content of the wine (<span class="math inline">\(\% vol\)</span>)</li>
<li><code>quality</code>: The quality score of the wine (0-10)</li>
</ul>
<p>After removing the duplicate rows from our data set, we are left with 3961 observations of the above 11 variables minus <code>quality</code> column variable, and introduced a new variable <code>good</code> as our response:</p>
<ul>
<li><code>good</code>: A binary variable indicating whether the wine is good (<code>quality</code> <span class="math inline">\(\geq\)</span> 7) or not (<code>quality</code> <span class="math inline">\(&lt;\)</span> 7).</li>
</ul>
</section>
</section>
<section id="exploratory-analysis" class="level2">
<h2 class="anchored" data-anchor-id="exploratory-analysis">Exploratory Analysis</h2>
<section id="data-import" class="level3">
<h3 class="anchored" data-anchor-id="data-import">Data Import</h3>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>wine.data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">winequality-white.csv"</span>, <span class="at">sep=</span><span class="st">";"</span>, <span class="at">header =</span> T)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>wine.data_subset <span class="ot">&lt;-</span>  wine.data <span class="sc">%&gt;%</span> </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">good =</span> <span class="fu">ifelse</span>(quality<span class="sc">&gt;=</span><span class="dv">7</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>, <span class="dv">13</span>))</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(wine.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["fixed.acidity"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["volatile.acidity"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["citric.acid"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["residual.sugar"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["chlorides"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["free.sulfur.dioxide"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["total.sulfur.dioxide"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["density"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["pH"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["sulphates"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["alcohol"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["quality"],"name":[12],"type":["int"],"align":["right"]}],"data":[{"1":"7.0","2":"0.27","3":"0.36","4":"20.7","5":"0.045","6":"45","7":"170","8":"1.0010","9":"3.00","10":"0.45","11":"8.8","12":"6","_rn_":"1"},{"1":"6.3","2":"0.30","3":"0.34","4":"1.6","5":"0.049","6":"14","7":"132","8":"0.9940","9":"3.30","10":"0.49","11":"9.5","12":"6","_rn_":"2"},{"1":"8.1","2":"0.28","3":"0.40","4":"6.9","5":"0.050","6":"30","7":"97","8":"0.9951","9":"3.26","10":"0.44","11":"10.1","12":"6","_rn_":"3"},{"1":"7.2","2":"0.23","3":"0.32","4":"8.5","5":"0.058","6":"47","7":"186","8":"0.9956","9":"3.19","10":"0.40","11":"9.9","12":"6","_rn_":"4"},{"1":"7.2","2":"0.23","3":"0.32","4":"8.5","5":"0.058","6":"47","7":"186","8":"0.9956","9":"3.19","10":"0.40","11":"9.9","12":"6","_rn_":"5"},{"1":"8.1","2":"0.28","3":"0.40","4":"6.9","5":"0.050","6":"30","7":"97","8":"0.9951","9":"3.26","10":"0.44","11":"10.1","12":"6","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(wine.data_subset)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["fixed.acidity"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["volatile.acidity"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["citric.acid"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["residual.sugar"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["chlorides"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["free.sulfur.dioxide"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["total.sulfur.dioxide"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["density"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["pH"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["sulphates"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["alcohol"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["good"],"name":[12],"type":["dbl"],"align":["right"]}],"data":[{"1":"7.0","2":"0.27","3":"0.36","4":"20.7","5":"0.045","6":"45","7":"170","8":"1.0010","9":"3.00","10":"0.45","11":"8.8","12":"0","_rn_":"1"},{"1":"6.3","2":"0.30","3":"0.34","4":"1.6","5":"0.049","6":"14","7":"132","8":"0.9940","9":"3.30","10":"0.49","11":"9.5","12":"0","_rn_":"2"},{"1":"8.1","2":"0.28","3":"0.40","4":"6.9","5":"0.050","6":"30","7":"97","8":"0.9951","9":"3.26","10":"0.44","11":"10.1","12":"0","_rn_":"3"},{"1":"7.2","2":"0.23","3":"0.32","4":"8.5","5":"0.058","6":"47","7":"186","8":"0.9956","9":"3.19","10":"0.40","11":"9.9","12":"0","_rn_":"4"},{"1":"6.2","2":"0.32","3":"0.16","4":"7.0","5":"0.045","6":"30","7":"136","8":"0.9949","9":"3.18","10":"0.47","11":"9.6","12":"0","_rn_":"5"},{"1":"8.1","2":"0.22","3":"0.43","4":"1.5","5":"0.044","6":"28","7":"129","8":"0.9938","9":"3.22","10":"0.45","11":"11.0","12":"0","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="data-analysis" class="level3">
<h3 class="anchored" data-anchor-id="data-analysis">Data Analysis</h3>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(wine.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4898   12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(wine.data_subset)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3961   12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(wine.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   4898 obs. of  12 variables:
 $ fixed.acidity       : num  7 6.3 8.1 7.2 7.2 8.1 6.2 7 6.3 8.1 ...
 $ volatile.acidity    : num  0.27 0.3 0.28 0.23 0.23 0.28 0.32 0.27 0.3 0.22 ...
 $ citric.acid         : num  0.36 0.34 0.4 0.32 0.32 0.4 0.16 0.36 0.34 0.43 ...
 $ residual.sugar      : num  20.7 1.6 6.9 8.5 8.5 6.9 7 20.7 1.6 1.5 ...
 $ chlorides           : num  0.045 0.049 0.05 0.058 0.058 0.05 0.045 0.045 0.049 0.044 ...
 $ free.sulfur.dioxide : num  45 14 30 47 47 30 30 45 14 28 ...
 $ total.sulfur.dioxide: num  170 132 97 186 186 97 136 170 132 129 ...
 $ density             : num  1.001 0.994 0.995 0.996 0.996 ...
 $ pH                  : num  3 3.3 3.26 3.19 3.19 3.26 3.18 3 3.3 3.22 ...
 $ sulphates           : num  0.45 0.49 0.44 0.4 0.4 0.44 0.47 0.45 0.49 0.45 ...
 $ alcohol             : num  8.8 9.5 10.1 9.9 9.9 10.1 9.6 8.8 9.5 11 ...
 $ quality             : int  6 6 6 6 6 6 6 6 6 6 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(wine.data_subset)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   3961 obs. of  12 variables:
 $ fixed.acidity       : num  7 6.3 8.1 7.2 6.2 8.1 8.1 8.6 7.9 6.6 ...
 $ volatile.acidity    : num  0.27 0.3 0.28 0.23 0.32 0.22 0.27 0.23 0.18 0.16 ...
 $ citric.acid         : num  0.36 0.34 0.4 0.32 0.16 0.43 0.41 0.4 0.37 0.4 ...
 $ residual.sugar      : num  20.7 1.6 6.9 8.5 7 1.5 1.45 4.2 1.2 1.5 ...
 $ chlorides           : num  0.045 0.049 0.05 0.058 0.045 0.044 0.033 0.035 0.04 0.044 ...
 $ free.sulfur.dioxide : num  45 14 30 47 30 28 11 17 16 48 ...
 $ total.sulfur.dioxide: num  170 132 97 186 136 129 63 109 75 143 ...
 $ density             : num  1.001 0.994 0.995 0.996 0.995 ...
 $ pH                  : num  3 3.3 3.26 3.19 3.18 3.22 2.99 3.14 3.18 3.54 ...
 $ sulphates           : num  0.45 0.49 0.44 0.4 0.47 0.45 0.56 0.53 0.63 0.52 ...
 $ alcohol             : num  8.8 9.5 10.1 9.9 9.6 11 12 9.7 10.8 12.4 ...
 $ good                : num  0 0 0 0 0 0 0 0 0 1 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wine.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> fixed.acidity    volatile.acidity  citric.acid     residual.sugar  
 Min.   : 3.800   Min.   :0.0800   Min.   :0.0000   Min.   : 0.600  
 1st Qu.: 6.300   1st Qu.:0.2100   1st Qu.:0.2700   1st Qu.: 1.700  
 Median : 6.800   Median :0.2600   Median :0.3200   Median : 5.200  
 Mean   : 6.855   Mean   :0.2782   Mean   :0.3342   Mean   : 6.391  
 3rd Qu.: 7.300   3rd Qu.:0.3200   3rd Qu.:0.3900   3rd Qu.: 9.900  
 Max.   :14.200   Max.   :1.1000   Max.   :1.6600   Max.   :65.800  
   chlorides       free.sulfur.dioxide total.sulfur.dioxide    density      
 Min.   :0.00900   Min.   :  2.00      Min.   :  9.0        Min.   :0.9871  
 1st Qu.:0.03600   1st Qu.: 23.00      1st Qu.:108.0        1st Qu.:0.9917  
 Median :0.04300   Median : 34.00      Median :134.0        Median :0.9937  
 Mean   :0.04577   Mean   : 35.31      Mean   :138.4        Mean   :0.9940  
 3rd Qu.:0.05000   3rd Qu.: 46.00      3rd Qu.:167.0        3rd Qu.:0.9961  
 Max.   :0.34600   Max.   :289.00      Max.   :440.0        Max.   :1.0390  
       pH          sulphates         alcohol         quality     
 Min.   :2.720   Min.   :0.2200   Min.   : 8.00   Min.   :3.000  
 1st Qu.:3.090   1st Qu.:0.4100   1st Qu.: 9.50   1st Qu.:5.000  
 Median :3.180   Median :0.4700   Median :10.40   Median :6.000  
 Mean   :3.188   Mean   :0.4898   Mean   :10.51   Mean   :5.878  
 3rd Qu.:3.280   3rd Qu.:0.5500   3rd Qu.:11.40   3rd Qu.:6.000  
 Max.   :3.820   Max.   :1.0800   Max.   :14.20   Max.   :9.000  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wine.data_subset)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> fixed.acidity    volatile.acidity  citric.acid     residual.sugar  
 Min.   : 3.800   Min.   :0.0800   Min.   :0.0000   Min.   : 0.600  
 1st Qu.: 6.300   1st Qu.:0.2100   1st Qu.:0.2700   1st Qu.: 1.600  
 Median : 6.800   Median :0.2600   Median :0.3200   Median : 4.700  
 Mean   : 6.839   Mean   :0.2805   Mean   :0.3343   Mean   : 5.915  
 3rd Qu.: 7.300   3rd Qu.:0.3300   3rd Qu.:0.3900   3rd Qu.: 8.900  
 Max.   :14.200   Max.   :1.1000   Max.   :1.6600   Max.   :65.800  
   chlorides       free.sulfur.dioxide total.sulfur.dioxide    density      
 Min.   :0.00900   Min.   :  2.00      Min.   :  9.0        Min.   :0.9871  
 1st Qu.:0.03500   1st Qu.: 23.00      1st Qu.:106.0        1st Qu.:0.9916  
 Median :0.04200   Median : 33.00      Median :133.0        Median :0.9935  
 Mean   :0.04591   Mean   : 34.89      Mean   :137.2        Mean   :0.9938  
 3rd Qu.:0.05000   3rd Qu.: 45.00      3rd Qu.:166.0        3rd Qu.:0.9957  
 Max.   :0.34600   Max.   :289.00      Max.   :440.0        Max.   :1.0390  
       pH          sulphates         alcohol           good       
 Min.   :2.720   Min.   :0.2200   Min.   : 8.00   Min.   :0.0000  
 1st Qu.:3.090   1st Qu.:0.4100   1st Qu.: 9.50   1st Qu.:0.0000  
 Median :3.180   Median :0.4800   Median :10.40   Median :0.0000  
 Mean   :3.195   Mean   :0.4904   Mean   :10.59   Mean   :0.2083  
 3rd Qu.:3.290   3rd Qu.:0.5500   3rd Qu.:11.40   3rd Qu.:0.0000  
 Max.   :3.820   Max.   :1.0800   Max.   :14.20   Max.   :1.0000  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for NAs in dataset</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(wine.data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Counts at each combination of response's factor levels</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(wine.data<span class="sc">$</span>quality)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   3    4    5    6    7    8    9 
  20  163 1457 2198  880  175    5 </code></pre>
</div>
</div>
</section>
<section id="data-histograms" class="level3">
<h3 class="anchored" data-anchor-id="data-histograms">Data Histograms</h3>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>wine.colnames <span class="ot">&lt;-</span> <span class="fu">colnames</span>(wine.data_subset[, <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>])</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>num_plots     <span class="ot">&lt;-</span> <span class="fu">length</span>(wine.colnames)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>num_rows      <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(num_plots<span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an empty list to store plots</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>grid_arr      <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop over each column name in the wine.colnames vector</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_plots) {</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a ggplot object for the current column using aes</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  plt <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> wine.data_subset, <span class="fu">aes_string</span>(<span class="at">x =</span> wine.colnames[i])) <span class="sc">+</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fu">diff</span>(<span class="fu">range</span>(wine.data_subset[[wine.colnames[i]]]))<span class="sc">/</span><span class="dv">30</span>, </span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"slategray3"</span>) <span class="sc">+</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> wine.colnames[i], <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add the current plot to the grid_arr list</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>  grid_arr[[i]] <span class="ot">&lt;-</span> plt</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>grid_arr <span class="ot">&lt;-</span> <span class="fu">do.call</span>(gridExtra<span class="sc">::</span>grid.arrange, <span class="fu">c</span>(grid_arr, <span class="at">ncol =</span> <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Sang_files/figure-html/hist_plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="data-relationships" class="level3">
<h3 class="anchored" data-anchor-id="data-relationships">Data Relationships</h3>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>reshape2<span class="sc">::</span><span class="fu">melt</span>(wine.data[, <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>], <span class="st">"quality"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(value, quality, <span class="at">color =</span> variable)) <span class="sc">+</span>  </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(value,quality, <span class="at">colour=</span>variable), <span class="at">method=</span>lm, <span class="at">se=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(.<span class="sc">~</span>variable, <span class="at">scales =</span> <span class="st">"free"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Sang_files/figure-html/relation_plot-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Collinearity between Attributes</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(wine.data_subset) <span class="sc">%&gt;%</span> </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  corrplot<span class="sc">::</span><span class="fu">corrplot</span>(<span class="at">method =</span> <span class="st">'number'</span>,  <span class="at">type =</span> <span class="st">"lower"</span>, <span class="at">tl.col =</span> <span class="st">"steelblue"</span>, <span class="at">number.cex =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Sang_files/figure-html/relation_plot-2.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove quality from dataset, use good as response </span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>wine.data_subset<span class="sc">$</span>quality <span class="ot">&lt;-</span> <span class="cn">NULL</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-split" class="level3">
<h3 class="anchored" data-anchor-id="data-split">Data Split</h3>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Splitting the dataset into train and test (7/10th for train remaining for test)</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>inTrain <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">createDataPartition</span>(wine.data_subset<span class="sc">$</span>good, <span class="at">p =</span> <span class="dv">7</span><span class="sc">/</span><span class="dv">10</span>, <span class="at">list =</span> F)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> wine.data_subset[inTrain,]</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> wine.data_subset[<span class="sc">-</span>inTrain,]</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the outcome variable to a factor with two levels</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>train<span class="sc">$</span>good <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(train<span class="sc">$</span>good)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>test<span class="sc">$</span>good <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(test<span class="sc">$</span>good)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="data-modeling" class="level2">
<h2 class="anchored" data-anchor-id="data-modeling">Data Modeling</h2>
<section id="k-nearest-neightbor" class="level3">
<h3 class="anchored" data-anchor-id="k-nearest-neightbor">K-Nearest Neightbor</h3>
<section id="model-construction" class="level4">
<h4 class="anchored" data-anchor-id="model-construction">Model Construction</h4>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------#</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co">#-----K-fold CV------#</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------#</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the training control object for 10-fold cross-validation</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">10</span>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the KNN model using 10-fold cross-validation</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="co"># tuneLength argument to specify the range of values of K to be considered for tuning</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train, </span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"knn"</span>, </span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">trControl =</span> train_control)</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the model into .Rdata for future import </span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(knn_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_kfoldCV.Rdata"</span>)</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------#</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a><span class="co">#-----K-fold CV (Mod)------#</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------#</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">10</span>)</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train, </span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"knn"</span>, </span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>                   <span class="at">trControl =</span> train_control, </span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tuneLength =</span> <span class="dv">10</span>)</span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the model into .Rdata for future import </span></span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(knn_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_kfoldCV_mod.Rdata"</span>)</span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------#</span></span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a><span class="co">#----Hold-out CV-----#</span></span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------#</span></span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"none"</span>,)</span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train, </span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"knn"</span>)</span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(knn_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_holdoutCV.Rdata"</span>)</span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------#</span></span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a><span class="co">#----Hold-out CV (Mod)-----#</span></span>
<span id="cb24-56"><a href="#cb24-56" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------#</span></span>
<span id="cb24-57"><a href="#cb24-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-58"><a href="#cb24-58" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb24-59"><a href="#cb24-59" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"none"</span>,)</span>
<span id="cb24-60"><a href="#cb24-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-61"><a href="#cb24-61" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb24-62"><a href="#cb24-62" aria-hidden="true" tabindex="-1"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb24-63"><a href="#cb24-63" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train, </span>
<span id="cb24-64"><a href="#cb24-64" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"knn"</span>,</span>
<span id="cb24-65"><a href="#cb24-65" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tuneGrid =</span> <span class="fu">expand.grid</span>(<span class="at">k=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>))</span>
<span id="cb24-66"><a href="#cb24-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-67"><a href="#cb24-67" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(knn_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_holdoutCV_mod.Rdata"</span>)</span>
<span id="cb24-68"><a href="#cb24-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-69"><a href="#cb24-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-70"><a href="#cb24-70" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------#</span></span>
<span id="cb24-71"><a href="#cb24-71" aria-hidden="true" tabindex="-1"></a><span class="co">#-------LOOCV--------#</span></span>
<span id="cb24-72"><a href="#cb24-72" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------#</span></span>
<span id="cb24-73"><a href="#cb24-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-74"><a href="#cb24-74" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb24-75"><a href="#cb24-75" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"LOOCV"</span>)</span>
<span id="cb24-76"><a href="#cb24-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-77"><a href="#cb24-77" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb24-78"><a href="#cb24-78" aria-hidden="true" tabindex="-1"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb24-79"><a href="#cb24-79" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train, </span>
<span id="cb24-80"><a href="#cb24-80" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"knn"</span>, </span>
<span id="cb24-81"><a href="#cb24-81" aria-hidden="true" tabindex="-1"></a>                   <span class="at">trControl =</span> train_control)</span>
<span id="cb24-82"><a href="#cb24-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-83"><a href="#cb24-83" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(knn_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_looCV.Rdata"</span>)</span>
<span id="cb24-84"><a href="#cb24-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-85"><a href="#cb24-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-86"><a href="#cb24-86" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------#</span></span>
<span id="cb24-87"><a href="#cb24-87" aria-hidden="true" tabindex="-1"></a><span class="co">#-------LOOCV (Mod)--------#</span></span>
<span id="cb24-88"><a href="#cb24-88" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------#</span></span>
<span id="cb24-89"><a href="#cb24-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-90"><a href="#cb24-90" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb24-91"><a href="#cb24-91" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"LOOCV"</span>)</span>
<span id="cb24-92"><a href="#cb24-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-93"><a href="#cb24-93" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb24-94"><a href="#cb24-94" aria-hidden="true" tabindex="-1"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb24-95"><a href="#cb24-95" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train, </span>
<span id="cb24-96"><a href="#cb24-96" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"knn"</span>, </span>
<span id="cb24-97"><a href="#cb24-97" aria-hidden="true" tabindex="-1"></a>                   <span class="at">trControl =</span> train_control,</span>
<span id="cb24-98"><a href="#cb24-98" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tuneLength =</span> <span class="dv">10</span>,</span>
<span id="cb24-99"><a href="#cb24-99" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tuneGrid =</span> <span class="fu">expand.grid</span>(<span class="at">k =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>))</span>
<span id="cb24-100"><a href="#cb24-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-101"><a href="#cb24-101" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(knn_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_looCV_mod.Rdata"</span>)</span>
<span id="cb24-102"><a href="#cb24-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-103"><a href="#cb24-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-104"><a href="#cb24-104" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------#</span></span>
<span id="cb24-105"><a href="#cb24-105" aria-hidden="true" tabindex="-1"></a><span class="co">#----Repeated CV-----#</span></span>
<span id="cb24-106"><a href="#cb24-106" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------#</span></span>
<span id="cb24-107"><a href="#cb24-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-108"><a href="#cb24-108" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb24-109"><a href="#cb24-109" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"repeatedcv"</span>, <span class="at">number =</span> <span class="dv">10</span>, <span class="at">repeats =</span> <span class="dv">5</span>)</span>
<span id="cb24-110"><a href="#cb24-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-111"><a href="#cb24-111" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb24-112"><a href="#cb24-112" aria-hidden="true" tabindex="-1"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb24-113"><a href="#cb24-113" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train, </span>
<span id="cb24-114"><a href="#cb24-114" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"knn"</span>, </span>
<span id="cb24-115"><a href="#cb24-115" aria-hidden="true" tabindex="-1"></a>                   <span class="at">trControl =</span> train_control)</span>
<span id="cb24-116"><a href="#cb24-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-117"><a href="#cb24-117" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(knn_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_repeatedCV.Rdata"</span>)</span>
<span id="cb24-118"><a href="#cb24-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-119"><a href="#cb24-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-120"><a href="#cb24-120" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------#</span></span>
<span id="cb24-121"><a href="#cb24-121" aria-hidden="true" tabindex="-1"></a><span class="co">#----Repeated CV (Mod)-----#</span></span>
<span id="cb24-122"><a href="#cb24-122" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------#</span></span>
<span id="cb24-123"><a href="#cb24-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-124"><a href="#cb24-124" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb24-125"><a href="#cb24-125" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"repeatedcv"</span>, <span class="at">number =</span> <span class="dv">10</span>, <span class="at">repeats =</span> <span class="dv">5</span>)</span>
<span id="cb24-126"><a href="#cb24-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-127"><a href="#cb24-127" aria-hidden="true" tabindex="-1"></a>kknn.grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">kmax =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span> ,<span class="dv">9</span>, <span class="dv">11</span>), <span class="at">distance =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb24-128"><a href="#cb24-128" aria-hidden="true" tabindex="-1"></a>                         <span class="at">kernel =</span> <span class="fu">c</span>(<span class="st">"rectangular"</span>, <span class="st">"gaussian"</span>, <span class="st">"cos"</span>))</span>
<span id="cb24-129"><a href="#cb24-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-130"><a href="#cb24-130" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb24-131"><a href="#cb24-131" aria-hidden="true" tabindex="-1"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb24-132"><a href="#cb24-132" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train, </span>
<span id="cb24-133"><a href="#cb24-133" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"kknn"</span>,</span>
<span id="cb24-134"><a href="#cb24-134" aria-hidden="true" tabindex="-1"></a>                   <span class="at">trControl =</span> train_control, </span>
<span id="cb24-135"><a href="#cb24-135" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tuneGrid =</span> kknn.grid,</span>
<span id="cb24-136"><a href="#cb24-136" aria-hidden="true" tabindex="-1"></a>                   <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>))</span>
<span id="cb24-137"><a href="#cb24-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-138"><a href="#cb24-138" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(knn_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_repeatedCV_mod.Rdata"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="k-fold-cv" class="level4">
<h4 class="anchored" data-anchor-id="k-fold-cv">K-fold CV</h4>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import model</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_kfoldCV.Rdata"</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the test data using the trained model and calculate the test error rate</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_model, <span class="at">newdata =</span> test)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(knn.predictions, test<span class="sc">$</span>good)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 903 164
         1  58  63
                                          
               Accuracy : 0.8131          
                 95% CI : (0.7898, 0.8349)
    No Information Rate : 0.8089          
    P-Value [Acc &gt; NIR] : 0.3725          
                                          
                  Kappa : 0.2643          
                                          
 Mcnemar's Test P-Value : 1.826e-12       
                                          
            Sensitivity : 0.9396          
            Specificity : 0.2775          
         Pos Pred Value : 0.8463          
         Neg Pred Value : 0.5207          
             Prevalence : 0.8089          
         Detection Rate : 0.7601          
   Detection Prevalence : 0.8981          
      Balanced Accuracy : 0.6086          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert predictions to a numeric vector</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(knn.predictions)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the AUC using the performance() and auc() functions:</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>auc_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6085896</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Performance plot for TP and FP</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"ROC Curves from 10-fold CV"</span>)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(auc_val, <span class="dv">1</span> <span class="sc">-</span> auc_val, </span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"steelblue"</span>, </span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>knn.kfoldCV.ROC.plot<span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Accuracy and Kappa value plot</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>knn.accu.kappa.plot <span class="ot">&lt;-</span> <span class="cf">function</span>(knn.model) {</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">data.frame</span>(<span class="at">k =</span> knn.model<span class="sc">$</span>results<span class="sc">$</span>k,</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>                              <span class="at">Accuracy =</span> knn.model<span class="sc">$</span>results<span class="sc">$</span>Accuracy,</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>                              <span class="at">Kappa =</span> knn.model<span class="sc">$</span>results<span class="sc">$</span>Kappa)) <span class="sc">+</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">color =</span> <span class="st">"Accuracy"</span>)) <span class="sc">+</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">color =</span> <span class="st">"Kappa"</span>)) <span class="sc">+</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">linetype =</span> <span class="st">"Accuracy"</span>, <span class="at">color =</span> <span class="st">"Accuracy"</span>)) <span class="sc">+</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">linetype =</span> <span class="st">"Kappa"</span>, <span class="at">color =</span> <span class="st">"Kappa"</span>)) <span class="sc">+</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#98c379"</span>, <span class="st">"#e06c75"</span>),</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>                       <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>)) )) <span class="sc">+</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_linetype_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"solid"</span>, <span class="st">"dotted"</span>),</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>                          <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="fu">c</span>(<span class="st">"#98c379"</span>, <span class="st">"#e06c75"</span>)))) <span class="sc">+</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"K value"</span>, </span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Accuracy / Kappa"</span>) <span class="sc">+</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Metric"</span>),</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>           <span class="at">linetype =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Metric"</span>))</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>knn.kfoldCV.plot <span class="ot">&lt;-</span> <span class="fu">knn.accu.kappa.plot</span>(knn_model) <span class="sc">+</span> </span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">label =</span> <span class="fu">round</span>(Kappa, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"KNN Model Performance (10-Fold CV)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="tuned" class="level5">
<h5 class="anchored" data-anchor-id="tuned">Tuned</h5>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_kfoldCV_mod.Rdata"</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_model, <span class="at">newdata =</span> test)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(knn.predictions, test<span class="sc">$</span>good)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 935 208
         1  26  19
                                          
               Accuracy : 0.803           
                 95% CI : (0.7793, 0.8253)
    No Information Rate : 0.8089          
    P-Value [Acc &gt; NIR] : 0.7118          
                                          
                  Kappa : 0.0816          
                                          
 Mcnemar's Test P-Value : &lt;2e-16          
                                          
            Sensitivity : 0.9729          
            Specificity : 0.0837          
         Pos Pred Value : 0.8180          
         Neg Pred Value : 0.4222          
             Prevalence : 0.8089          
         Detection Rate : 0.7870          
   Detection Prevalence : 0.9621          
      Balanced Accuracy : 0.5283          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(knn.predictions)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>auc_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5283226</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">main =</span> <span class="st">"ROC Curves from Tuned K-fold CV"</span>))</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(auc_val, <span class="dv">1</span> <span class="sc">-</span> auc_val, </span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"steelblue"</span>, </span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>knn.kfoldCV_mod.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>knn.kfoldCV_mod.plot <span class="ot">&lt;-</span> <span class="fu">knn.accu.kappa.plot</span>(knn_model) <span class="sc">+</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">label =</span> <span class="fu">round</span>(Kappa, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"KNN Model Performance (Tuned 10-Fold CV)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="hold-out-cv" class="level4">
<h4 class="anchored" data-anchor-id="hold-out-cv">Hold-out CV</h4>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_holdoutCV.Rdata"</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_model, <span class="at">newdata =</span> test)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(knn.predictions, test<span class="sc">$</span>good)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 911 174
         1  50  53
                                         
               Accuracy : 0.8114         
                 95% CI : (0.788, 0.8333)
    No Information Rate : 0.8089         
    P-Value [Acc &gt; NIR] : 0.4297         
                                         
                  Kappa : 0.2293         
                                         
 Mcnemar's Test P-Value : &lt;2e-16         
                                         
            Sensitivity : 0.9480         
            Specificity : 0.2335         
         Pos Pred Value : 0.8396         
         Neg Pred Value : 0.5146         
             Prevalence : 0.8089         
         Detection Rate : 0.7668         
   Detection Prevalence : 0.9133         
      Balanced Accuracy : 0.5907         
                                         
       'Positive' Class : 0              
                                         </code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(knn.predictions)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>auc_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5907255</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"ROC Curves from Hold-out CV"</span>)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(auc_val, <span class="dv">1</span> <span class="sc">-</span> auc_val, </span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"steelblue"</span>, </span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>knn.holdoutCV.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>knn.holdoutCV.plot <span class="ot">&lt;-</span> <span class="fu">knn.accu.kappa.plot</span>(knn_model) <span class="sc">+</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">label =</span> <span class="fu">round</span>(Kappa, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"KNN Model Performance (Hold-out CV)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="tuned-1" class="level5">
<h5 class="anchored" data-anchor-id="tuned-1">Tuned</h5>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_holdoutCV_mod.Rdata"</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_model, <span class="at">newdata =</span> test)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(knn.predictions, test<span class="sc">$</span>good)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 952 219
         1   9   8
                                          
               Accuracy : 0.8081          
                 95% CI : (0.7845, 0.8301)
    No Information Rate : 0.8089          
    P-Value [Acc &gt; NIR] : 0.547           
                                          
                  Kappa : 0.04            
                                          
 Mcnemar's Test P-Value : &lt;2e-16          
                                          
            Sensitivity : 0.99063         
            Specificity : 0.03524         
         Pos Pred Value : 0.81298         
         Neg Pred Value : 0.47059         
             Prevalence : 0.80892         
         Detection Rate : 0.80135         
   Detection Prevalence : 0.98569         
      Balanced Accuracy : 0.51294         
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(knn.predictions)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>auc_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5129385</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"ROC Curves from Tuned Hold-out CV"</span>)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(auc_val, <span class="dv">1</span> <span class="sc">-</span> auc_val, </span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"steelblue"</span>, </span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>knn.holdoutCV_mod.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>knn.holdoutCV_mod.plot <span class="ot">&lt;-</span> <span class="fu">knn.accu.kappa.plot</span>(knn_model) <span class="sc">+</span> </span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">3</span>)), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">angle=</span><span class="dv">90</span>) <span class="sc">+</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">label =</span> <span class="fu">round</span>(Kappa, <span class="dv">3</span>)), <span class="at">hjust=</span><span class="sc">-</span><span class="fl">0.3</span>, <span class="at">angle=</span><span class="dv">90</span>) <span class="sc">+</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"KNN Model Performance (Tuned Hold-out CV)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="loocv" class="level4">
<h4 class="anchored" data-anchor-id="loocv">LOOCV</h4>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_looCV.Rdata"</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_model, <span class="at">newdata =</span> test)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(knn.predictions, test<span class="sc">$</span>good)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 921 171
         1  40  56
                                          
               Accuracy : 0.8224          
                 95% CI : (0.7994, 0.8437)
    No Information Rate : 0.8089          
    P-Value [Acc &gt; NIR] : 0.1258          
                                          
                  Kappa : 0.263           
                                          
 Mcnemar's Test P-Value : &lt;2e-16          
                                          
            Sensitivity : 0.9584          
            Specificity : 0.2467          
         Pos Pred Value : 0.8434          
         Neg Pred Value : 0.5833          
             Prevalence : 0.8089          
         Detection Rate : 0.7753          
   Detection Prevalence : 0.9192          
      Balanced Accuracy : 0.6025          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(knn.predictions)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>auc_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6025364</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">'ROC Curves from LOOCV'</span>)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(auc_val, <span class="dv">1</span> <span class="sc">-</span> auc_val, </span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"steelblue"</span>, </span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>knn.looCV.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>knn.looCV.plot <span class="ot">&lt;-</span> <span class="fu">knn.accu.kappa.plot</span>(knn_model) <span class="sc">+</span> </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">label =</span> <span class="fu">round</span>(Kappa, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"KNN Model Performance (LOOCV)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="tuned-2" class="level5">
<h5 class="anchored" data-anchor-id="tuned-2">Tuned</h5>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_looCV_mod.Rdata"</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_model, <span class="at">newdata =</span> test)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(knn.predictions, test<span class="sc">$</span>good)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 935 208
         1  26  19
                                          
               Accuracy : 0.803           
                 95% CI : (0.7793, 0.8253)
    No Information Rate : 0.8089          
    P-Value [Acc &gt; NIR] : 0.7118          
                                          
                  Kappa : 0.0816          
                                          
 Mcnemar's Test P-Value : &lt;2e-16          
                                          
            Sensitivity : 0.9729          
            Specificity : 0.0837          
         Pos Pred Value : 0.8180          
         Neg Pred Value : 0.4222          
             Prevalence : 0.8089          
         Detection Rate : 0.7870          
   Detection Prevalence : 0.9621          
      Balanced Accuracy : 0.5283          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(knn.predictions)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>auc_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5283226</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"ROC Curves from Tuned LOOCV"</span>)</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(auc_val, <span class="dv">1</span> <span class="sc">-</span> auc_val, </span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"steelblue"</span>, </span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>knn.looCV_mod.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>knn.looCV_mod.plot <span class="ot">&lt;-</span> <span class="fu">knn.accu.kappa.plot</span>(knn_model) <span class="sc">+</span> </span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">3</span>)), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">angle=</span><span class="dv">90</span>) <span class="sc">+</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">label =</span> <span class="fu">round</span>(Kappa, <span class="dv">3</span>)), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">angle=</span><span class="dv">90</span>) <span class="sc">+</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"KNN Model Performance (Tuned LOOCV)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="repeated-cv" class="level4">
<h4 class="anchored" data-anchor-id="repeated-cv">Repeated CV</h4>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_repeatedCV.Rdata"</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_model, <span class="at">newdata =</span> test)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(knn.predictions, test<span class="sc">$</span>good)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 917  83
         1  44 144
                                          
               Accuracy : 0.8931          
                 95% CI : (0.8741, 0.9101)
    No Information Rate : 0.8089          
    P-Value [Acc &gt; NIR] : 1.966e-15       
                                          
                  Kappa : 0.6299          
                                          
 Mcnemar's Test P-Value : 0.0007464       
                                          
            Sensitivity : 0.9542          
            Specificity : 0.6344          
         Pos Pred Value : 0.9170          
         Neg Pred Value : 0.7660          
             Prevalence : 0.8089          
         Detection Rate : 0.7719          
   Detection Prevalence : 0.8418          
      Balanced Accuracy : 0.7943          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(knn.predictions)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>auc_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7942878</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"ROC Curves from Repeated CV"</span>)</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(auc_val, <span class="dv">1</span> <span class="sc">-</span> auc_val, </span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"steelblue"</span>, </span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>knn.repeatedCV.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> knn_model<span class="sc">$</span>results</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>knn.repeatedCV.plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>df, <span class="fu">aes</span>(<span class="at">x =</span> kmax, <span class="at">y =</span> Accuracy)) <span class="sc">+</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Accuracy"</span>)) <span class="sc">+</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Kappa"</span>)) <span class="sc">+</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> <span class="st">"Accuracy"</span>, <span class="at">color =</span> <span class="st">"Accuracy"</span>)) <span class="sc">+</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Kappa, <span class="at">linetype =</span> <span class="st">"Kappa"</span>, <span class="at">color =</span> <span class="st">"Kappa"</span>)) <span class="sc">+</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> Kappa, <span class="at">label =</span> <span class="fu">round</span>(Kappa, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#98c379"</span>, <span class="st">"#e06c75"</span>),</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>)) )) <span class="sc">+</span></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"solid"</span>, <span class="st">"dotted"</span>),</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>                        <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="fu">c</span>(<span class="st">"#98c379"</span>, <span class="st">"#e06c75"</span>)))) <span class="sc">+</span></span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"K value"</span>, </span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Accuracy / Kappa"</span>,</span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"KNN Model Performance (Repeated CV)"</span>) <span class="sc">+</span></span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Metric"</span>),</span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">linetype =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Metric"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="tuned-3" class="level5">
<h5 class="anchored" data-anchor-id="tuned-3">Tuned</h5>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_repeatedCV_mod.Rdata"</span>)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_model, <span class="at">newdata =</span> test)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(knn.predictions, test<span class="sc">$</span>good)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 921 103
         1  40 124
                                          
               Accuracy : 0.8796          
                 95% CI : (0.8598, 0.8976)
    No Information Rate : 0.8089          
    P-Value [Acc &gt; NIR] : 3.875e-11       
                                          
                  Kappa : 0.5645          
                                          
 Mcnemar's Test P-Value : 2.164e-07       
                                          
            Sensitivity : 0.9584          
            Specificity : 0.5463          
         Pos Pred Value : 0.8994          
         Neg Pred Value : 0.7561          
             Prevalence : 0.8089          
         Detection Rate : 0.7753          
   Detection Prevalence : 0.8620          
      Balanced Accuracy : 0.7523          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(knn.predictions)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>auc_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7523161</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"ROC Curves from Tuned Repeated CV"</span>)</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(auc_val, <span class="dv">1</span> <span class="sc">-</span> auc_val, </span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"steelblue"</span>, </span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>knn.repeatedCV_mod.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>knn.repeatedCV_mod.plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(knn_model) <span class="sc">+</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"K value"</span>, </span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Accuracy"</span>, </span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"KNN Model Performance (Tuned Repeated CV)"</span>) <span class="sc">+</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="summary" class="level4">
<h4 class="anchored" data-anchor-id="summary">Summary</h4>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(knn.kfoldCV.plot,</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>          knn.kfoldCV_mod.plot,</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>          knn.holdoutCV.plot,</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>          knn.holdoutCV_mod.plot,</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>          knn.looCV.plot,</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>          knn.looCV_mod.plot,</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>          knn.repeatedCV.plot,</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>          knn.repeatedCV_mod.plot,</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Sang_files/figure-html/knn.Accuracy.Kappa.Plot-1.png" class="img-fluid figure-img" width="1440"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(knn.kfoldCV.ROC.plot, knn.kfoldCV_mod.ROC.plot,</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">align =</span> <span class="st">"hv"</span>, <span class="at">scale =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Sang_files/figure-html/knn.ROC_curve-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(knn.holdoutCV.ROC.plot, knn.holdoutCV_mod.ROC.plot,</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">align =</span> <span class="st">"hv"</span>, <span class="at">scale =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Sang_files/figure-html/knn.ROC_curve-2.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(knn.looCV.ROC.plot, knn.looCV_mod.ROC.plot,</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">align =</span> <span class="st">"hv"</span>, <span class="at">scale =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Sang_files/figure-html/knn.ROC_curve-3.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(knn.repeatedCV.ROC.plot, knn.repeatedCV_mod.ROC.plot,</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">align =</span> <span class="st">"hv"</span>, <span class="at">scale =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Sang_files/figure-html/knn.ROC_curve-4.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<table class="table">
<colgroup>
<col style="width: 32%">
<col style="width: 16%">
<col style="width: 18%">
<col style="width: 18%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th>Resampling Method</th>
<th>Error Rate</th>
<th>Sensitivity</th>
<th>Specificity</th>
<th>AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>K-Fold CV</td>
<td>0.2273</td>
<td>0.9199</td>
<td>0.1883</td>
<td>0.5541001</td>
</tr>
<tr class="even">
<td>K-Fold CV (Tuned)</td>
<td>0.1995</td>
<td>0.9768</td>
<td>0.1004</td>
<td>0.5386181</td>
</tr>
<tr class="odd">
<td>Hold-out CV</td>
<td>0.2222</td>
<td>0.9336</td>
<td>0.1590</td>
<td>0.5463051</td>
</tr>
<tr class="even">
<td>Hold-out CV (Tuned)</td>
<td>0.2022</td>
<td>0.9926</td>
<td>0.0251</td>
<td>0.5088642</td>
</tr>
<tr class="odd">
<td>LOOCV</td>
<td>0.1717</td>
<td>0.9642</td>
<td>0.2887</td>
<td>0.6264379</td>
</tr>
<tr class="even">
<td>LOOCV (Tuned)</td>
<td>0.1995</td>
<td>0.9768</td>
<td>0.1004</td>
<td>0.5386181</td>
</tr>
<tr class="odd">
<td>Repeated CV</td>
<td>0.1776</td>
<td>0.9104</td>
<td>0.4728</td>
<td>0.6916177</td>
</tr>
<tr class="even">
<td>Repeated CV (Tuned)</td>
<td>0.1120</td>
<td>0.9547</td>
<td>0.6234</td>
<td>0.7890601</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="logistic-regression" class="level3">
<h3 class="anchored" data-anchor-id="logistic-regression">Logistic Regression</h3>
<section id="model-construction-1" class="level4">
<h4 class="anchored" data-anchor-id="model-construction-1">Model Construction</h4>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------#</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="co">#----Logistic Regression-----#</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------#</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the training control object for 10-fold cross-validation</span></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">10</span>)</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the logistic regression model using 10-fold cross-validation</span></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>logit_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> train, </span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">method =</span> <span class="st">"glm"</span>, </span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">family =</span> <span class="st">"binomial"</span>,</span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>                     <span class="at">trControl =</span> train_control)</span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(logit_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">logit.model_kfoldCV.Rdata"</span>)</span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------#</span></span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a><span class="co">#----Logistic Regression (Mod)-----#</span></span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------#</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="k-fold-cv-1" class="level4">
<h4 class="anchored" data-anchor-id="k-fold-cv-1">K-fold CV</h4>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">logit.model_kfoldCV.Rdata"</span>)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>logit.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(logit_model, <span class="at">newdata =</span> test)</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(logit.predictions, test<span class="sc">$</span>good)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 899 154
         1  62  73
                                          
               Accuracy : 0.8182          
                 95% CI : (0.7951, 0.8397)
    No Information Rate : 0.8089          
    P-Value [Acc &gt; NIR] : 0.2201          
                                          
                  Kappa : 0.3041          
                                          
 Mcnemar's Test P-Value : 5.949e-10       
                                          
            Sensitivity : 0.9355          
            Specificity : 0.3216          
         Pos Pred Value : 0.8538          
         Neg Pred Value : 0.5407          
             Prevalence : 0.8089          
         Detection Rate : 0.7567          
   Detection Prevalence : 0.8864          
      Balanced Accuracy : 0.6285          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>logit.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(logit.predictions)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(logit.predictions, test<span class="sc">$</span>good)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>auc_val  <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>auc_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6285349</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"ROC Curves from Repeated CV"</span>)</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(auc_val, <span class="dv">1</span> <span class="sc">-</span> auc_val, </span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"steelblue"</span>, </span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>logit.kfoldCV.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="tuned-4" class="level5">
<h5 class="anchored" data-anchor-id="tuned-4">Tuned</h5>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>glm.model <span class="ot">&lt;-</span> <span class="fu">glm</span>(good <span class="sc">~</span> ., <span class="at">data=</span> train,<span class="at">family=</span><span class="st">"binomial"</span>)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>glm.fit<span class="ot">=</span> <span class="fu">stepAIC</span>(glm.model, <span class="at">direction =</span> <span class="st">'backward'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=2263
good ~ fixed.acidity + volatile.acidity + citric.acid + residual.sugar + 
    chlorides + free.sulfur.dioxide + total.sulfur.dioxide + 
    density + pH + sulphates + alcohol

                       Df Deviance    AIC
- citric.acid           1   2240.1 2262.1
&lt;none&gt;                      2239.0 2263.0
- alcohol               1   2241.3 2263.3
- total.sulfur.dioxide  1   2243.0 2265.0
- chlorides             1   2252.2 2274.2
- volatile.acidity      1   2254.3 2276.3
- sulphates             1   2256.6 2278.6
- free.sulfur.dioxide   1   2258.1 2280.1
- fixed.acidity         1   2258.6 2280.6
- density               1   2263.2 2285.2
- residual.sugar        1   2266.6 2288.6
- pH                    1   2295.8 2317.8

Step:  AIC=2262.05
good ~ fixed.acidity + volatile.acidity + residual.sugar + chlorides + 
    free.sulfur.dioxide + total.sulfur.dioxide + density + pH + 
    sulphates + alcohol

                       Df Deviance    AIC
&lt;none&gt;                      2240.1 2262.1
- alcohol               1   2242.7 2262.7
- total.sulfur.dioxide  1   2243.7 2263.7
- chlorides             1   2252.8 2272.8
- sulphates             1   2257.9 2277.9
- volatile.acidity      1   2258.4 2278.4
- free.sulfur.dioxide   1   2258.8 2278.8
- fixed.acidity         1   2261.2 2281.2
- density               1   2263.7 2283.7
- residual.sugar        1   2267.2 2287.2
- pH                    1   2296.2 2316.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on test data and construct a confusion matrix</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>logit.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(glm.fit, <span class="at">newdata =</span> test,<span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>logit.predictions <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(logit.predictions <span class="sc">&gt;</span> <span class="fl">0.7</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(logit.predictions, test<span class="sc">$</span>good)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 954 207
         1   7  20
                                          
               Accuracy : 0.8199          
                 95% CI : (0.7968, 0.8413)
    No Information Rate : 0.8089          
    P-Value [Acc &gt; NIR] : 0.1784          
                                          
                  Kappa : 0.1218          
                                          
 Mcnemar's Test P-Value : &lt;2e-16          
                                          
            Sensitivity : 0.99272         
            Specificity : 0.08811         
         Pos Pred Value : 0.82171         
         Neg Pred Value : 0.74074         
             Prevalence : 0.80892         
         Detection Rate : 0.80303         
   Detection Prevalence : 0.97727         
      Balanced Accuracy : 0.54041         
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>logit.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(logit.predictions)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(logit.predictions, test<span class="sc">$</span>good)</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>auc_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5404108</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"ROC Curves from Repeated CV"</span>)</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(auc_val, <span class="dv">1</span> <span class="sc">-</span> auc_val, </span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"steelblue"</span>, </span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Sang_files/figure-html/logit.kfoldCV_mod-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>logit.kfoldCV.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<table class="table">
<colgroup>
<col style="width: 39%">
<col style="width: 14%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th>Resampling Method</th>
<th>Error Rate</th>
<th>Sensitivity</th>
<th>Specificity</th>
<th>AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Logistic Regression</td>
<td>0.1944</td>
<td>0.9347</td>
<td>0.2929</td>
<td>0.6137776</td>
</tr>
<tr class="even">
<td>Logistic Regression (Tuned)</td>
<td>0.1919</td>
<td>0.98946</td>
<td>0.08787</td>
<td>0.5386644</td>
</tr>
</tbody>
</table>
</section>
</section>
</section>
<section id="linear-discriminant-analysis" class="level3">
<h3 class="anchored" data-anchor-id="linear-discriminant-analysis">Linear Discriminant Analysis</h3>
<section id="model-construction-2" class="level4">
<h4 class="anchored" data-anchor-id="model-construction-2">Model Construction</h4>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co">#------------#</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="co">#----LDA-----#</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="co">#------------#</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">10</span>)</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>lda_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train, </span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"lda"</span>, </span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">trControl =</span> train_control)</span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(lda_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">lda.model_kfoldCV.Rdata"</span>)</span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------#</span></span>
<span id="cb93-17"><a href="#cb93-17" aria-hidden="true" tabindex="-1"></a><span class="co">#----LDA (Mod)-----#</span></span>
<span id="cb93-18"><a href="#cb93-18" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------#</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="k-fold-cv-2" class="level4">
<h4 class="anchored" data-anchor-id="k-fold-cv-2">K-fold CV</h4>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">lda.model_kfoldCV.Rdata"</span>)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>lda.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(lda_model, <span class="at">newdata =</span> test)</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(lda.predictions, test<span class="sc">$</span>good)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 889 144
         1  72  83
                                          
               Accuracy : 0.8182          
                 95% CI : (0.7951, 0.8397)
    No Information Rate : 0.8089          
    P-Value [Acc &gt; NIR] : 0.2201          
                                          
                  Kappa : 0.3308          
                                          
 Mcnemar's Test P-Value : 1.359e-06       
                                          
            Sensitivity : 0.9251          
            Specificity : 0.3656          
         Pos Pred Value : 0.8606          
         Neg Pred Value : 0.5355          
             Prevalence : 0.8089          
         Detection Rate : 0.7483          
   Detection Prevalence : 0.8695          
      Balanced Accuracy : 0.6454          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>lda.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(lda.predictions)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(lda.predictions, test<span class="sc">$</span>good)</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>auc_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6453584</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"ROC Curves from Repeated CV"</span>)</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(auc_val, <span class="dv">1</span> <span class="sc">-</span> auc_val, </span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"steelblue"</span>, </span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>lda.kfoldCV.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="tuned-5" class="level5">
<h5 class="anchored" data-anchor-id="tuned-5">Tuned</h5>
<table class="table">
<colgroup>
<col style="width: 29%">
<col style="width: 17%">
<col style="width: 18%">
<col style="width: 18%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th>Resampling Method</th>
<th>Error Rate</th>
<th>Sensitivity</th>
<th>Specificity</th>
<th>AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>LDA</td>
<td>0.1919</td>
<td>0.9283</td>
<td>0.3305</td>
<td>0.6294448</td>
</tr>
<tr class="even">
<td>LDA (Tuned)</td>
<td>0.xxxx</td>
<td>0.xxxx</td>
<td>0.xxxx</td>
<td>0.xxxxxxx</td>
</tr>
</tbody>
</table>
</section>
</section>
</section>
<section id="quadratic-discriminant-analysis" class="level3">
<h3 class="anchored" data-anchor-id="quadratic-discriminant-analysis">Quadratic discriminant analysis</h3>
<section id="model-construction-3" class="level4">
<h4 class="anchored" data-anchor-id="model-construction-3">Model Construction</h4>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co">#------------#</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="co">#----QDA-----#</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="co">#------------#</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">10</span>)</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>qda_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train, </span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"qda"</span>, </span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">trControl =</span> train_control)</span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(qda_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">qda.model_kfoldCV.Rdata"</span>)</span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------#</span></span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true" tabindex="-1"></a><span class="co">#----QDA (Mod)-----#</span></span>
<span id="cb100-17"><a href="#cb100-17" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------#</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="k-fold-cv-3" class="level4">
<h4 class="anchored" data-anchor-id="k-fold-cv-3">K-fold CV</h4>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">qda.model_kfoldCV.Rdata"</span>)</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>qda.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(qda_model, <span class="at">newdata =</span> test)</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(qda.predictions, test<span class="sc">$</span>good)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 710  52
         1 251 175
                                          
               Accuracy : 0.7449          
                 95% CI : (0.7192, 0.7695)
    No Information Rate : 0.8089          
    P-Value [Acc &gt; NIR] : 1               
                                          
                  Kappa : 0.3819          
                                          
 Mcnemar's Test P-Value : &lt;2e-16          
                                          
            Sensitivity : 0.7388          
            Specificity : 0.7709          
         Pos Pred Value : 0.9318          
         Neg Pred Value : 0.4108          
             Prevalence : 0.8089          
         Detection Rate : 0.5976          
   Detection Prevalence : 0.6414          
      Balanced Accuracy : 0.7549          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>qda.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(qda.predictions)</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(qda.predictions, test<span class="sc">$</span>good)</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>auc_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7548694</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"ROC Curves from Repeated CV"</span>)</span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(auc_val, <span class="dv">1</span> <span class="sc">-</span> auc_val, </span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"steelblue"</span>, </span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>qda.kfoldCV.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="tuned-6" class="level5">
<h5 class="anchored" data-anchor-id="tuned-6">Tuned</h5>
<table class="table">
<colgroup>
<col style="width: 29%">
<col style="width: 17%">
<col style="width: 18%">
<col style="width: 18%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th>Resampling Method</th>
<th>Error Rate</th>
<th>Sensitivity</th>
<th>Specificity</th>
<th>AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>QDA</td>
<td>0.2559</td>
<td>0.7418</td>
<td>0.7531</td>
<td>0.7474858</td>
</tr>
<tr class="even">
<td>QDA (Tuned)</td>
<td>0.xxxx</td>
<td>0.xxxx</td>
<td>0.xxxx</td>
<td>0.xxxxxxx</td>
</tr>
</tbody>
</table>
</section>
</section>
</section>
<section id="summary-1" class="level3">
<h3 class="anchored" data-anchor-id="summary-1">Summary</h3>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(knn.kfoldCV.ROC.plot,</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>                   logit.kfoldCV.ROC.plot,</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>                   lda.kfoldCV.ROC.plot,</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>                   qda.kfoldCV.ROC.plot, </span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">align =</span> <span class="st">"hv"</span>, <span class="at">scale =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Sang_files/figure-html/log.lda.qda.ROC_curve-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<table class="table">
<colgroup>
<col style="width: 39%">
<col style="width: 14%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th>Resampling Method</th>
<th>Error Rate</th>
<th>Sensitivity</th>
<th>Specificity</th>
<th>AUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Logistic Regression</td>
<td>0.1944</td>
<td>0.9347</td>
<td>0.2929</td>
<td>0.6137776</td>
</tr>
<tr class="even">
<td>Logistic Regression (Tuned)</td>
<td>0.1919</td>
<td>0.98946</td>
<td>0.08787</td>
<td>0.5386644</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>LDA</td>
<td>0.1919</td>
<td>0.9283</td>
<td>0.3305</td>
<td>0.6294448</td>
</tr>
<tr class="odd">
<td>LDA (Tuned)</td>
<td>0.xxxx</td>
<td>0.xxxx</td>
<td>0.xxxx</td>
<td>0.xxxxxxx</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>QDA</td>
<td>0.2559</td>
<td>0.7418</td>
<td>0.7531</td>
<td>0.7474858</td>
</tr>
<tr class="even">
<td>QDA (Tuned)</td>
<td>0.xxxx</td>
<td>0.xxxx</td>
<td>0.xxxx</td>
<td>0.xxxxxxx</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="furthuer-modeling" class="level2">
<h2 class="anchored" data-anchor-id="furthuer-modeling">Furthuer Modeling</h2>
<section id="naive-bayes" class="level3">
<h3 class="anchored" data-anchor-id="naive-bayes">Naive Bayes</h3>
<section id="model-construction-4" class="level4">
<h4 class="anchored" data-anchor-id="model-construction-4">Model Construction</h4>
</section>
<section id="k-fold-cv-4" class="level4">
<h4 class="anchored" data-anchor-id="k-fold-cv-4">K-fold CV</h4>
<section id="tuned-7" class="level5">
<h5 class="anchored" data-anchor-id="tuned-7">Tuned</h5>
</section>
</section>
</section>
<section id="decision-tree" class="level3">
<h3 class="anchored" data-anchor-id="decision-tree">Decision Tree</h3>
<section id="model-construction-5" class="level4">
<h4 class="anchored" data-anchor-id="model-construction-5">Model Construction</h4>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="k-fold-cv-5" class="level4">
<h4 class="anchored" data-anchor-id="k-fold-cv-5">K-fold CV</h4>
<section id="tuned-8" class="level5">
<h5 class="anchored" data-anchor-id="tuned-8">Tuned</h5>
</section>
</section>
</section>
<section id="randome-forest" class="level3">
<h3 class="anchored" data-anchor-id="randome-forest">Randome Forest</h3>
<section id="model-construction-6" class="level4">
<h4 class="anchored" data-anchor-id="model-construction-6">Model Construction</h4>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="k-fold-cv-6" class="level4">
<h4 class="anchored" data-anchor-id="k-fold-cv-6">K-fold CV</h4>
<section id="tuned-9" class="level5">
<h5 class="anchored" data-anchor-id="tuned-9">Tuned</h5>
</section>
</section>
</section>
<section id="bagging" class="level3">
<h3 class="anchored" data-anchor-id="bagging">Bagging</h3>
<section id="model-construction-7" class="level4">
<h4 class="anchored" data-anchor-id="model-construction-7">Model Construction</h4>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="k-fold-cv-7" class="level4">
<h4 class="anchored" data-anchor-id="k-fold-cv-7">K-fold CV</h4>
<section id="tuned-10" class="level5">
<h5 class="anchored" data-anchor-id="tuned-10">Tuned</h5>
</section>
</section>
</section>
<section id="boosting" class="level3">
<h3 class="anchored" data-anchor-id="boosting">Boosting</h3>
<section id="model-construction-8" class="level4">
<h4 class="anchored" data-anchor-id="model-construction-8">Model Construction</h4>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="k-fold-cv-8" class="level4">
<h4 class="anchored" data-anchor-id="k-fold-cv-8">K-fold CV</h4>
<section id="tuned-11" class="level5">
<h5 class="anchored" data-anchor-id="tuned-11">Tuned</h5>
</section>
</section>
</section>
<section id="svm" class="level3">
<h3 class="anchored" data-anchor-id="svm">SVM</h3>
<section id="model-construction-9" class="level4">
<h4 class="anchored" data-anchor-id="model-construction-9">Model Construction</h4>
<div class="cell" data-layout-align="TRUE">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="k-fold-cv-9" class="level4">
<h4 class="anchored" data-anchor-id="k-fold-cv-9">K-fold CV</h4>
<section id="tuned-12" class="level5">
<h5 class="anchored" data-anchor-id="tuned-12">Tuned</h5>
</section>
</section>
</section>
<section id="summary-2" class="level3">
<h3 class="anchored" data-anchor-id="summary-2">Summary</h3>
<!-- -->

</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb113" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Introduction to Statistical Learning"</span></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "STAT 387" </span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a><span class="co">    df-print: paged</span></span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a><span class="co">    theme:</span></span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a><span class="co">      light: materia</span></span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a><span class="co">      dark: slate</span></span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-title: Table of Contents</span></span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 4</span></span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: left</span></span>
<span id="cb113-14"><a href="#cb113-14" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: false</span></span>
<span id="cb113-15"><a href="#cb113-15" aria-hidden="true" tabindex="-1"></a><span class="co">    number-depth: 3</span></span>
<span id="cb113-16"><a href="#cb113-16" aria-hidden="true" tabindex="-1"></a><span class="co">    anchor-sections: true</span></span>
<span id="cb113-17"><a href="#cb113-17" aria-hidden="true" tabindex="-1"></a><span class="co">    smooth-scroll: true</span></span>
<span id="cb113-18"><a href="#cb113-18" aria-hidden="true" tabindex="-1"></a><span class="co">    link-external-icon: false</span></span>
<span id="cb113-19"><a href="#cb113-19" aria-hidden="true" tabindex="-1"></a><span class="co">    link-external-newwindow: false</span></span>
<span id="cb113-20"><a href="#cb113-20" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: false</span></span>
<span id="cb113-21"><a href="#cb113-21" aria-hidden="true" tabindex="-1"></a><span class="co">    code-line-numbers: false</span></span>
<span id="cb113-22"><a href="#cb113-22" aria-hidden="true" tabindex="-1"></a><span class="co">    code-overflow: scroll</span></span>
<span id="cb113-23"><a href="#cb113-23" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: </span></span>
<span id="cb113-24"><a href="#cb113-24" aria-hidden="true" tabindex="-1"></a><span class="co">      source: true</span></span>
<span id="cb113-25"><a href="#cb113-25" aria-hidden="true" tabindex="-1"></a><span class="co">      toggle: true</span></span>
<span id="cb113-26"><a href="#cb113-26" aria-hidden="true" tabindex="-1"></a><span class="co">      caption: none</span></span>
<span id="cb113-27"><a href="#cb113-27" aria-hidden="true" tabindex="-1"></a><span class="co">    code-summary: "Show/Hide Code"</span></span>
<span id="cb113-28"><a href="#cb113-28" aria-hidden="true" tabindex="-1"></a><span class="co">    highlight-style: atom-one</span></span>
<span id="cb113-29"><a href="#cb113-29" aria-hidden="true" tabindex="-1"></a><span class="co">    link-external-filter: '^(?:http:|https:)\/\/www\.quarto\.org\/custom'</span></span>
<span id="cb113-30"><a href="#cb113-30" aria-hidden="true" tabindex="-1"></a><span class="co">    self-contained-math: true</span></span>
<span id="cb113-31"><a href="#cb113-31" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-align: center</span></span>
<span id="cb113-32"><a href="#cb113-32" aria-hidden="true" tabindex="-1"></a><span class="co">    html-math-method:</span></span>
<span id="cb113-33"><a href="#cb113-33" aria-hidden="true" tabindex="-1"></a><span class="co">      method: mathjax</span></span>
<span id="cb113-34"><a href="#cb113-34" aria-hidden="true" tabindex="-1"></a><span class="co">      url: "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"</span></span>
<span id="cb113-35"><a href="#cb113-35" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb113-36"><a href="#cb113-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-37"><a href="#cb113-37" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup, include=FALSE}</span></span>
<span id="cb113-38"><a href="#cb113-38" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">fig.align =</span> <span class="cn">TRUE</span>)</span>
<span id="cb113-39"><a href="#cb113-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-40"><a href="#cb113-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)  <span class="co"># Load core packages: </span></span>
<span id="cb113-41"><a href="#cb113-41" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot2,   for data visualization.</span></span>
<span id="cb113-42"><a href="#cb113-42" aria-hidden="true" tabindex="-1"></a><span class="co"># dplyr,     for data manipulation.</span></span>
<span id="cb113-43"><a href="#cb113-43" aria-hidden="true" tabindex="-1"></a><span class="co"># tidyr,     for data tidying.</span></span>
<span id="cb113-44"><a href="#cb113-44" aria-hidden="true" tabindex="-1"></a><span class="co"># purrr,     for functional programming.</span></span>
<span id="cb113-45"><a href="#cb113-45" aria-hidden="true" tabindex="-1"></a><span class="co"># tibble,    for tibbles, a modern re-imagining of data frames.</span></span>
<span id="cb113-46"><a href="#cb113-46" aria-hidden="true" tabindex="-1"></a><span class="co"># stringr,   for strings.</span></span>
<span id="cb113-47"><a href="#cb113-47" aria-hidden="true" tabindex="-1"></a><span class="co"># forcats,   for factors.</span></span>
<span id="cb113-48"><a href="#cb113-48" aria-hidden="true" tabindex="-1"></a><span class="co"># lubridate, for date/times.</span></span>
<span id="cb113-49"><a href="#cb113-49" aria-hidden="true" tabindex="-1"></a><span class="co"># readr,     for reading .csv, .tsv, and .fwf files.</span></span>
<span id="cb113-50"><a href="#cb113-50" aria-hidden="true" tabindex="-1"></a><span class="co"># readxl,    for reading .xls, and .xlxs files.</span></span>
<span id="cb113-51"><a href="#cb113-51" aria-hidden="true" tabindex="-1"></a><span class="co"># feather,   for sharing with Python and other languages.</span></span>
<span id="cb113-52"><a href="#cb113-52" aria-hidden="true" tabindex="-1"></a><span class="co"># haven,     for SPSS, SAS and Stata files.</span></span>
<span id="cb113-53"><a href="#cb113-53" aria-hidden="true" tabindex="-1"></a><span class="co"># httr,      for web apis.</span></span>
<span id="cb113-54"><a href="#cb113-54" aria-hidden="true" tabindex="-1"></a><span class="co"># jsonlite   for JSON.</span></span>
<span id="cb113-55"><a href="#cb113-55" aria-hidden="true" tabindex="-1"></a><span class="co"># rvest,     for web scraping.</span></span>
<span id="cb113-56"><a href="#cb113-56" aria-hidden="true" tabindex="-1"></a><span class="co"># xml2,      for XML.</span></span>
<span id="cb113-57"><a href="#cb113-57" aria-hidden="true" tabindex="-1"></a><span class="co"># modelr,    for modelling within a pipeline</span></span>
<span id="cb113-58"><a href="#cb113-58" aria-hidden="true" tabindex="-1"></a><span class="co"># broom,     for turning models into tidy data</span></span>
<span id="cb113-59"><a href="#cb113-59" aria-hidden="true" tabindex="-1"></a><span class="co"># hms,       for times.</span></span>
<span id="cb113-60"><a href="#cb113-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-61"><a href="#cb113-61" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)   <span class="co"># Pipeline operator</span></span>
<span id="cb113-62"><a href="#cb113-62" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lobstr)     <span class="co"># Visualizing abstract syntax trees, stack trees, and object sizes</span></span>
<span id="cb113-63"><a href="#cb113-63" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pander)     <span class="co"># Exporting/converting complex pandoc documents, EX: df to Pandoc table</span></span>
<span id="cb113-64"><a href="#cb113-64" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggforce)    <span class="co"># More plot functions on top of ggplot2</span></span>
<span id="cb113-65"><a href="#cb113-65" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)     <span class="co"># Automatically add p-values and significance levels  plots. </span></span>
<span id="cb113-66"><a href="#cb113-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrange and annotate multiple plots on the same page. </span></span>
<span id="cb113-67"><a href="#cb113-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Change graphical parameters such as colors and labels.</span></span>
<span id="cb113-68"><a href="#cb113-68" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)         <span class="co"># Geo-spatial vector manipulation: points, lines, polygons</span></span>
<span id="cb113-69"><a href="#cb113-69" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra) <span class="co"># Generate 90 % of complex/advanced/self-customized/beautiful tables</span></span>
<span id="cb113-70"><a href="#cb113-70" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)    <span class="co"># Multiple plots arrangement</span></span>
<span id="cb113-71"><a href="#cb113-71" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)  <span class="co"># Multiple plots arrangement</span></span>
<span id="cb113-72"><a href="#cb113-72" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(animation)  <span class="co"># Animated figure container</span></span>
<span id="cb113-73"><a href="#cb113-73" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(latex2exp)  <span class="co"># Latex axis titles in ggplot2</span></span>
<span id="cb113-74"><a href="#cb113-74" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ellipse)    <span class="co"># Simultaneous confidence interval region to check C.I. of 2 slope parameters</span></span>
<span id="cb113-75"><a href="#cb113-75" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)     <span class="co"># User interactive plots</span></span>
<span id="cb113-76"><a href="#cb113-76" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ellipse)    <span class="co"># Simultaneous confidence interval region to check C.I. of 2 regressors</span></span>
<span id="cb113-77"><a href="#cb113-77" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(olsrr)      <span class="co"># Model selections </span></span>
<span id="cb113-78"><a href="#cb113-78" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaps)      <span class="co"># Regression subsetting </span></span>
<span id="cb113-79"><a href="#cb113-79" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pls)        <span class="co"># Partial Least squares</span></span>
<span id="cb113-80"><a href="#cb113-80" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)       <span class="co"># LDA, QDA, OLS, Ridge Regression, Box-Cox, stepAIC, etc,.</span></span>
<span id="cb113-81"><a href="#cb113-81" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(e1071)      <span class="co"># Naive Bayesian Classfier,SVM, GKNN, ICA, LCA</span></span>
<span id="cb113-82"><a href="#cb113-82" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(class)      <span class="co"># KNN, SOM, LVQ</span></span>
<span id="cb113-83"><a href="#cb113-83" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ROCR)       <span class="co"># Precision/Recall/Sensitivity/Specificity performance plot </span></span>
<span id="cb113-84"><a href="#cb113-84" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)       <span class="co"># LOOCV, Bootstrap,</span></span>
<span id="cb113-85"><a href="#cb113-85" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)      <span class="co"># Classification/Regression Training, run ?caret::trainControl</span></span>
<span id="cb113-86"><a href="#cb113-86" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrgram)   <span class="co"># for correlation matrix</span></span>
<span id="cb113-87"><a href="#cb113-87" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)   <span class="co"># for graphical display of correlation matrix</span></span>
<span id="cb113-88"><a href="#cb113-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-89"><a href="#cb113-89" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)        <span class="co"># make random results reproducible</span></span>
<span id="cb113-90"><a href="#cb113-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-91"><a href="#cb113-91" aria-hidden="true" tabindex="-1"></a>current_dir <span class="ot">&lt;-</span> <span class="fu">getwd</span>()</span>
<span id="cb113-92"><a href="#cb113-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-93"><a href="#cb113-93" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(current_dir)) {</span>
<span id="cb113-94"><a href="#cb113-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setwd</span>(current_dir)</span>
<span id="cb113-95"><a href="#cb113-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove</span>(current_dir)</span>
<span id="cb113-96"><a href="#cb113-96" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb113-97"><a href="#cb113-97" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-98"><a href="#cb113-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-99"><a href="#cb113-99" aria-hidden="true" tabindex="-1"></a><span class="in">```{css, echo=FALSE}</span></span>
<span id="cb113-100"><a href="#cb113-100" aria-hidden="true" tabindex="-1"></a>body <span class="op">{</span></span>
<span id="cb113-101"><a href="#cb113-101" aria-hidden="true" tabindex="-1"></a>font<span class="op">-</span>family<span class="op">:</span> <span class="st">"Times New Roman"</span><span class="op">;</span></span>
<span id="cb113-102"><a href="#cb113-102" aria-hidden="true" tabindex="-1"></a>font<span class="op">-</span>size<span class="op">:</span> <span class="fl">0.8</span>em<span class="op">;</span></span>
<span id="cb113-103"><a href="#cb113-103" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb113-104"><a href="#cb113-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-105"><a href="#cb113-105" aria-hidden="true" tabindex="-1"></a>h2<span class="op">,</span> <span class="op">.</span><span class="fu">h2</span><span class="op">,</span> h2<span class="op">.</span><span class="fu">anchored</span><span class="op">,</span> </span>
<span id="cb113-106"><a href="#cb113-106" aria-hidden="true" tabindex="-1"></a>h3<span class="op">,</span> <span class="op">.</span><span class="fu">h3</span><span class="op">,</span> h3<span class="op">.</span><span class="fu">anchored</span><span class="op">,</span></span>
<span id="cb113-107"><a href="#cb113-107" aria-hidden="true" tabindex="-1"></a><span class="op">.</span><span class="fu">quarto</span><span class="op">-</span>title<span class="op">,</span> </span>
<span id="cb113-108"><a href="#cb113-108" aria-hidden="true" tabindex="-1"></a><span class="op">.</span><span class="fu">quarto</span><span class="op">-</span>title<span class="op">-</span>meta <span class="op">{</span></span>
<span id="cb113-109"><a href="#cb113-109" aria-hidden="true" tabindex="-1"></a>text<span class="op">-</span>align<span class="op">:</span> center<span class="op">;</span></span>
<span id="cb113-110"><a href="#cb113-110" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb113-111"><a href="#cb113-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-112"><a href="#cb113-112" aria-hidden="true" tabindex="-1"></a>h2<span class="op">,</span> <span class="op">.</span><span class="fu">h2</span> <span class="op">{</span></span>
<span id="cb113-113"><a href="#cb113-113" aria-hidden="true" tabindex="-1"></a>font<span class="op">-</span>size<span class="op">:</span> <span class="fl">1.5</span>em<span class="op">;</span></span>
<span id="cb113-114"><a href="#cb113-114" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb113-115"><a href="#cb113-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-116"><a href="#cb113-116" aria-hidden="true" tabindex="-1"></a>h3<span class="op">,</span> <span class="op">.</span><span class="fu">h3</span> <span class="op">{</span></span>
<span id="cb113-117"><a href="#cb113-117" aria-hidden="true" tabindex="-1"></a>font<span class="op">-</span>size<span class="op">:</span> <span class="fl">1.25</span>em<span class="op">;</span></span>
<span id="cb113-118"><a href="#cb113-118" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb113-119"><a href="#cb113-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-120"><a href="#cb113-120" aria-hidden="true" tabindex="-1"></a>h4<span class="op">,</span> <span class="op">.</span><span class="fu">h4</span> <span class="op">{</span></span>
<span id="cb113-121"><a href="#cb113-121" aria-hidden="true" tabindex="-1"></a>font<span class="op">-</span>size<span class="op">:</span> 1em<span class="op">;</span></span>
<span id="cb113-122"><a href="#cb113-122" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb113-123"><a href="#cb113-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-124"><a href="#cb113-124" aria-hidden="true" tabindex="-1"></a>h5<span class="op">,</span> <span class="op">.</span><span class="fu">h5</span> <span class="op">{</span></span>
<span id="cb113-125"><a href="#cb113-125" aria-hidden="true" tabindex="-1"></a>font<span class="op">-</span>size<span class="op">:</span> <span class="fl">0.75</span>em<span class="op">;</span></span>
<span id="cb113-126"><a href="#cb113-126" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb113-127"><a href="#cb113-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-128"><a href="#cb113-128" aria-hidden="true" tabindex="-1"></a>h6<span class="op">,</span> <span class="op">.</span><span class="fu">h6</span> <span class="op">{</span></span>
<span id="cb113-129"><a href="#cb113-129" aria-hidden="true" tabindex="-1"></a>font<span class="op">-</span>size<span class="op">:</span> <span class="fl">0.7</span>em<span class="op">;</span></span>
<span id="cb113-130"><a href="#cb113-130" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb113-131"><a href="#cb113-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-132"><a href="#cb113-132" aria-hidden="true" tabindex="-1"></a><span class="op">.</span><span class="fu">quarto</span><span class="op">-</span>title<span class="op">-</span>meta <span class="op">{</span></span>
<span id="cb113-133"><a href="#cb113-133" aria-hidden="true" tabindex="-1"></a>display<span class="op">:</span> block<span class="op">!</span>important<span class="op">;</span></span>
<span id="cb113-134"><a href="#cb113-134" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb113-135"><a href="#cb113-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-136"><a href="#cb113-136" aria-hidden="true" tabindex="-1"></a><span class="op">.</span><span class="fu">quarto</span><span class="op">-</span>title<span class="op">-</span>meta<span class="op">-</span>heading <span class="op">{</span></span>
<span id="cb113-137"><a href="#cb113-137" aria-hidden="true" tabindex="-1"></a>display<span class="op">:</span> none<span class="op">;</span></span>
<span id="cb113-138"><a href="#cb113-138" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb113-139"><a href="#cb113-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-140"><a href="#cb113-140" aria-hidden="true" tabindex="-1"></a><span class="op">.</span><span class="fu">content</span> <span class="op">{</span></span>
<span id="cb113-141"><a href="#cb113-141" aria-hidden="true" tabindex="-1"></a>width<span class="op">:</span> 1000px<span class="op">;</span></span>
<span id="cb113-142"><a href="#cb113-142" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb113-143"><a href="#cb113-143" aria-hidden="true" tabindex="-1"></a><span class="op">.</span><span class="fu">dropdown</span><span class="op">-</span>menu <span class="op">{</span></span>
<span id="cb113-144"><a href="#cb113-144" aria-hidden="true" tabindex="-1"></a>font<span class="op">-</span>size<span class="op">:</span> <span class="fl">0.8</span>rem<span class="op">;</span></span>
<span id="cb113-145"><a href="#cb113-145" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb113-146"><a href="#cb113-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-147"><a href="#cb113-147" aria-hidden="true" tabindex="-1"></a>code <span class="op">{</span></span>
<span id="cb113-148"><a href="#cb113-148" aria-hidden="true" tabindex="-1"></a>color<span class="op">:</span> #61AFEF<span class="op">;</span></span>
<span id="cb113-149"><a href="#cb113-149" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb113-150"><a href="#cb113-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-151"><a href="#cb113-151" aria-hidden="true" tabindex="-1"></a><span class="op">.</span><span class="fu">btn</span> <span class="op">{</span></span>
<span id="cb113-152"><a href="#cb113-152" aria-hidden="true" tabindex="-1"></a>border<span class="op">-</span>color<span class="op">:</span> #f8f9fa9e<span class="op">!</span>important<span class="op">;</span></span>
<span id="cb113-153"><a href="#cb113-153" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb113-154"><a href="#cb113-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-155"><a href="#cb113-155" aria-hidden="true" tabindex="-1"></a>body<span class="op">.</span><span class="fu">quarto</span><span class="op">-</span>dark <span class="op">{</span></span>
<span id="cb113-156"><a href="#cb113-156" aria-hidden="true" tabindex="-1"></a>background<span class="op">-</span>color<span class="op">:</span> #282c34<span class="op">;</span></span>
<span id="cb113-157"><a href="#cb113-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-158"><a href="#cb113-158" aria-hidden="true" tabindex="-1"></a>color<span class="op">:</span> #d8dee9<span class="op">;</span></span>
<span id="cb113-159"><a href="#cb113-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-160"><a href="#cb113-160" aria-hidden="true" tabindex="-1"></a><span class="op">.</span><span class="fu">pagedtable</span> <span class="op">.</span><span class="fu">even</span> <span class="op">{</span></span>
<span id="cb113-161"><a href="#cb113-161" aria-hidden="true" tabindex="-1"></a>background<span class="op">-</span>color<span class="op">:</span> #3b4252<span class="op">!</span>important<span class="op">;</span></span>
<span id="cb113-162"><a href="#cb113-162" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb113-163"><a href="#cb113-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-164"><a href="#cb113-164" aria-hidden="true" tabindex="-1"></a>p code<span class="op">:</span><span class="fu">not</span><span class="op">(.</span><span class="fu">sourceCode</span><span class="op">),</span> li code<span class="op">:</span><span class="fu">not</span><span class="op">(.</span><span class="fu">sourceCode</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb113-165"><a href="#cb113-165" aria-hidden="true" tabindex="-1"></a>background<span class="op">-</span>color<span class="op">:</span> #4c566a<span class="op">!</span>important<span class="op">;</span></span>
<span id="cb113-166"><a href="#cb113-166" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb113-167"><a href="#cb113-167" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb113-168"><a href="#cb113-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-169"><a href="#cb113-169" aria-hidden="true" tabindex="-1"></a>#quarto<span class="op">-</span>code<span class="op">-</span>tools<span class="op">-</span>menu<span class="op">{</span></span>
<span id="cb113-170"><a href="#cb113-170" aria-hidden="true" tabindex="-1"></a>position<span class="op">:</span> absolute<span class="op">;</span></span>
<span id="cb113-171"><a href="#cb113-171" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb113-172"><a href="#cb113-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-173"><a href="#cb113-173" aria-hidden="true" tabindex="-1"></a><span class="op">.</span><span class="fu">top</span><span class="op">-</span>right <span class="op">{</span></span>
<span id="cb113-174"><a href="#cb113-174" aria-hidden="true" tabindex="-1"></a>position<span class="op">:</span> <span class="kw">fixed</span><span class="op">;</span></span>
<span id="cb113-175"><a href="#cb113-175" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb113-176"><a href="#cb113-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-177"><a href="#cb113-177" aria-hidden="true" tabindex="-1"></a>#TOC<span class="op">::</span>before <span class="op">{</span></span>
<span id="cb113-178"><a href="#cb113-178" aria-hidden="true" tabindex="-1"></a>content<span class="op">:</span> <span class="st">""</span><span class="op">;</span></span>
<span id="cb113-179"><a href="#cb113-179" aria-hidden="true" tabindex="-1"></a>display<span class="op">:</span> block<span class="op">;</span></span>
<span id="cb113-180"><a href="#cb113-180" aria-hidden="true" tabindex="-1"></a>height<span class="op">:</span> 141px<span class="op">;</span></span>
<span id="cb113-181"><a href="#cb113-181" aria-hidden="true" tabindex="-1"></a>margin<span class="op">:</span> 20px 20px 20px 20px<span class="op">;</span></span>
<span id="cb113-182"><a href="#cb113-182" aria-hidden="true" tabindex="-1"></a>background<span class="op">-</span>image<span class="op">:</span> <span class="fu">url</span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/theRealLeif/STAT387/main/README.asset/Logo.svg"</span><span class="op">);</span></span>
<span id="cb113-183"><a href="#cb113-183" aria-hidden="true" tabindex="-1"></a>background<span class="op">-</span>size<span class="op">:</span> contain<span class="op">;</span></span>
<span id="cb113-184"><a href="#cb113-184" aria-hidden="true" tabindex="-1"></a>background<span class="op">-</span>position<span class="op">:</span> center center<span class="op">;</span></span>
<span id="cb113-185"><a href="#cb113-185" aria-hidden="true" tabindex="-1"></a>background<span class="op">-</span>repeat<span class="op">:</span> no<span class="op">-</span>repeat<span class="op">;</span></span>
<span id="cb113-186"><a href="#cb113-186" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb113-187"><a href="#cb113-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-188"><a href="#cb113-188" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-189"><a href="#cb113-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-190"><a href="#cb113-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-191"><a href="#cb113-191" aria-hidden="true" tabindex="-1"></a><span class="fu">## Preamble</span></span>
<span id="cb113-192"><a href="#cb113-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-193"><a href="#cb113-193" aria-hidden="true" tabindex="-1"></a>Consider the wine quality dataset from <span class="co">[</span><span class="ot">UCI Machine Learning Respository</span><span class="co">](https://archive.ics.uci.edu/ml/datasets/Wine+Quality)</span>. We will focus only on the data concerning white wines (and not red wines). Dichotomize the <span class="in">`quality`</span> variable as <span class="in">`good`</span>, which takes the value 1 if quality â‰¥ 7 and the value 0, otherwise. We will take <span class="in">`good`</span> as response and all the 11 physiochemical characteristics of the wines in the data as predictors.</span>
<span id="cb113-194"><a href="#cb113-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-195"><a href="#cb113-195" aria-hidden="true" tabindex="-1"></a><span class="fu">### Problem Statements</span></span>
<span id="cb113-196"><a href="#cb113-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-197"><a href="#cb113-197" aria-hidden="true" tabindex="-1"></a>Use 10-fold cross-validation for estimating the test error rates below and compute the estimates using <span class="in">`caret`</span> package with seed set to 1234 before each computation.</span>
<span id="cb113-198"><a href="#cb113-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-199"><a href="#cb113-199" aria-hidden="true" tabindex="-1"></a>(a) Fit a KNN with K chosen optimally using test error rate. Report error rate, sensitivity, specificity, and AUC for the optimal KNN based on the training data. Also, report its estimated test error rate.</span>
<span id="cb113-200"><a href="#cb113-200" aria-hidden="true" tabindex="-1"></a>(b) Repeat (a) using logistic regression.</span>
<span id="cb113-201"><a href="#cb113-201" aria-hidden="true" tabindex="-1"></a>(c) Repeat (a) using LDA.</span>
<span id="cb113-202"><a href="#cb113-202" aria-hidden="true" tabindex="-1"></a>(d) Repeat (a) using QDA.</span>
<span id="cb113-203"><a href="#cb113-203" aria-hidden="true" tabindex="-1"></a>(e) Compare the results in (a)-(d). Which classifier would you recommend? Justify your answer.</span>
<span id="cb113-204"><a href="#cb113-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-205"><a href="#cb113-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-206"><a href="#cb113-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-207"><a href="#cb113-207" aria-hidden="true" tabindex="-1"></a><span class="fu">### Methodologies</span></span>
<span id="cb113-208"><a href="#cb113-208" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>KNN</span>
<span id="cb113-209"><a href="#cb113-209" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>GLM/logit/glmnet</span>
<span id="cb113-210"><a href="#cb113-210" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>LDA</span>
<span id="cb113-211"><a href="#cb113-211" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>QDA</span>
<span id="cb113-212"><a href="#cb113-212" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Naive Bayes</span>
<span id="cb113-213"><a href="#cb113-213" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Decision Tree</span>
<span id="cb113-214"><a href="#cb113-214" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Classification and Regression Trees (CART)</span>
<span id="cb113-215"><a href="#cb113-215" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Random Forest (Classification)</span>
<span id="cb113-216"><a href="#cb113-216" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Bagging (Bootstrap Aggregation)</span>
<span id="cb113-217"><a href="#cb113-217" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Boosting (Gradient Boosting Machine (GBM))</span>
<span id="cb113-218"><a href="#cb113-218" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>eXtreme Gradient Boosting (XGBoost)</span>
<span id="cb113-219"><a href="#cb113-219" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Extremely Randomized Trees (ExtraTrees)</span>
<span id="cb113-220"><a href="#cb113-220" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>SVM</span>
<span id="cb113-221"><a href="#cb113-221" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Neural Networks (NNET)</span>
<span id="cb113-222"><a href="#cb113-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-223"><a href="#cb113-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-224"><a href="#cb113-224" aria-hidden="true" tabindex="-1"></a><span class="fu">### Data Description</span></span>
<span id="cb113-225"><a href="#cb113-225" aria-hidden="true" tabindex="-1"></a>This is a dataset of wine quality containing 4898 observations of 12 variables. The variables are:</span>
<span id="cb113-226"><a href="#cb113-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-227"><a href="#cb113-227" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`fixed.acidity`</span>: The amount of fixed acid in the wine ($g/dm^3$)</span>
<span id="cb113-228"><a href="#cb113-228" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`volatile.acidity`</span>: The amount of volatile acid in the wine ($g/dm^4$)</span>
<span id="cb113-229"><a href="#cb113-229" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`citric.acid`</span>: The amount of citric acid in the wine ($g/dm^3$)</span>
<span id="cb113-230"><a href="#cb113-230" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`residual.sugar`</span>: The amount of residual sugar in the wine ($g/dm^3$)</span>
<span id="cb113-231"><a href="#cb113-231" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`chlorides`</span>: The amount of salt in the wine ($g/dm^3$)</span>
<span id="cb113-232"><a href="#cb113-232" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`free.sulfur.dioxide`</span>: The amount of free sulfur dioxide in the wine ($mg/dm^3$)</span>
<span id="cb113-233"><a href="#cb113-233" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`total.sulfur.dioxide`</span>: The amount of total sulfur dioxide in the wine ($mg/dm^3$)</span>
<span id="cb113-234"><a href="#cb113-234" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`density`</span>: The density of the wine ($g/dm^3$)</span>
<span id="cb113-235"><a href="#cb113-235" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`pH`</span>: The $pH$ value of the wine</span>
<span id="cb113-236"><a href="#cb113-236" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`sulphates`</span>: The amount of sulphates in the wine ($g/dm^3$)</span>
<span id="cb113-237"><a href="#cb113-237" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`alcohol`</span>: The alcohol content of the wine ($\% vol$)</span>
<span id="cb113-238"><a href="#cb113-238" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`quality`</span>: The quality score of the wine (0-10)</span>
<span id="cb113-239"><a href="#cb113-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-240"><a href="#cb113-240" aria-hidden="true" tabindex="-1"></a>After removing the duplicate rows from our data set, we are left with 3961 observations of the above 11 variables minus <span class="in">`quality`</span> column variable, and introduced a new variable <span class="in">`good`</span> as our response:</span>
<span id="cb113-241"><a href="#cb113-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-242"><a href="#cb113-242" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`good`</span>: A binary variable indicating whether the wine is good (<span class="in">`quality`</span> $\geq$ 7) or not (<span class="in">`quality`</span> $&lt;$ 7).</span>
<span id="cb113-243"><a href="#cb113-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-244"><a href="#cb113-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-245"><a href="#cb113-245" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exploratory Analysis</span></span>
<span id="cb113-246"><a href="#cb113-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-247"><a href="#cb113-247" aria-hidden="true" tabindex="-1"></a><span class="fu">### Data Import</span></span>
<span id="cb113-248"><a href="#cb113-248" aria-hidden="true" tabindex="-1"></a><span class="in">```{r data_import}</span></span>
<span id="cb113-249"><a href="#cb113-249" aria-hidden="true" tabindex="-1"></a>wine.data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">winequality-white.csv"</span>, <span class="at">sep=</span><span class="st">";"</span>, <span class="at">header =</span> T)</span>
<span id="cb113-250"><a href="#cb113-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-251"><a href="#cb113-251" aria-hidden="true" tabindex="-1"></a>wine.data_subset <span class="ot">&lt;-</span>  wine.data <span class="sc">%&gt;%</span> </span>
<span id="cb113-252"><a href="#cb113-252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">good =</span> <span class="fu">ifelse</span>(quality<span class="sc">&gt;=</span><span class="dv">7</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb113-253"><a href="#cb113-253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb113-254"><a href="#cb113-254" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>, <span class="dv">13</span>))</span>
<span id="cb113-255"><a href="#cb113-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-256"><a href="#cb113-256" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(wine.data)</span>
<span id="cb113-257"><a href="#cb113-257" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(wine.data_subset)</span>
<span id="cb113-258"><a href="#cb113-258" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-259"><a href="#cb113-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-260"><a href="#cb113-260" aria-hidden="true" tabindex="-1"></a><span class="fu">### Data Analysis</span></span>
<span id="cb113-261"><a href="#cb113-261" aria-hidden="true" tabindex="-1"></a><span class="in">```{r basic_analysis}</span></span>
<span id="cb113-262"><a href="#cb113-262" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(wine.data)</span>
<span id="cb113-263"><a href="#cb113-263" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(wine.data_subset)</span>
<span id="cb113-264"><a href="#cb113-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-265"><a href="#cb113-265" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(wine.data)</span>
<span id="cb113-266"><a href="#cb113-266" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(wine.data_subset)</span>
<span id="cb113-267"><a href="#cb113-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-268"><a href="#cb113-268" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wine.data)</span>
<span id="cb113-269"><a href="#cb113-269" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wine.data_subset)</span>
<span id="cb113-270"><a href="#cb113-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-271"><a href="#cb113-271" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for NAs in dataset</span></span>
<span id="cb113-272"><a href="#cb113-272" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(wine.data))</span>
<span id="cb113-273"><a href="#cb113-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-274"><a href="#cb113-274" aria-hidden="true" tabindex="-1"></a><span class="co"># Counts at each combination of response's factor levels</span></span>
<span id="cb113-275"><a href="#cb113-275" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(wine.data<span class="sc">$</span>quality)</span>
<span id="cb113-276"><a href="#cb113-276" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-277"><a href="#cb113-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-278"><a href="#cb113-278" aria-hidden="true" tabindex="-1"></a><span class="fu">### Data Histograms</span></span>
<span id="cb113-279"><a href="#cb113-279" aria-hidden="true" tabindex="-1"></a><span class="in">```{r hist_plot, warning=FALSE}</span></span>
<span id="cb113-280"><a href="#cb113-280" aria-hidden="true" tabindex="-1"></a>wine.colnames <span class="ot">&lt;-</span> <span class="fu">colnames</span>(wine.data_subset[, <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>])</span>
<span id="cb113-281"><a href="#cb113-281" aria-hidden="true" tabindex="-1"></a>num_plots     <span class="ot">&lt;-</span> <span class="fu">length</span>(wine.colnames)</span>
<span id="cb113-282"><a href="#cb113-282" aria-hidden="true" tabindex="-1"></a>num_rows      <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(num_plots<span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb113-283"><a href="#cb113-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-284"><a href="#cb113-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-285"><a href="#cb113-285" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an empty list to store plots</span></span>
<span id="cb113-286"><a href="#cb113-286" aria-hidden="true" tabindex="-1"></a>grid_arr      <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb113-287"><a href="#cb113-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-288"><a href="#cb113-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-289"><a href="#cb113-289" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop over each column name in the wine.colnames vector</span></span>
<span id="cb113-290"><a href="#cb113-290" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_plots) {</span>
<span id="cb113-291"><a href="#cb113-291" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a ggplot object for the current column using aes</span></span>
<span id="cb113-292"><a href="#cb113-292" aria-hidden="true" tabindex="-1"></a>  plt <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> wine.data_subset, <span class="fu">aes_string</span>(<span class="at">x =</span> wine.colnames[i])) <span class="sc">+</span></span>
<span id="cb113-293"><a href="#cb113-293" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fu">diff</span>(<span class="fu">range</span>(wine.data_subset[[wine.colnames[i]]]))<span class="sc">/</span><span class="dv">30</span>, </span>
<span id="cb113-294"><a href="#cb113-294" aria-hidden="true" tabindex="-1"></a>                   <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"slategray3"</span>) <span class="sc">+</span></span>
<span id="cb113-295"><a href="#cb113-295" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> wine.colnames[i], <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb113-296"><a href="#cb113-296" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span>
<span id="cb113-297"><a href="#cb113-297" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb113-298"><a href="#cb113-298" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add the current plot to the grid_arr list</span></span>
<span id="cb113-299"><a href="#cb113-299" aria-hidden="true" tabindex="-1"></a>  grid_arr[[i]] <span class="ot">&lt;-</span> plt</span>
<span id="cb113-300"><a href="#cb113-300" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb113-301"><a href="#cb113-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-302"><a href="#cb113-302" aria-hidden="true" tabindex="-1"></a>grid_arr <span class="ot">&lt;-</span> <span class="fu">do.call</span>(gridExtra<span class="sc">::</span>grid.arrange, <span class="fu">c</span>(grid_arr, <span class="at">ncol =</span> <span class="dv">3</span>))</span>
<span id="cb113-303"><a href="#cb113-303" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-304"><a href="#cb113-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-305"><a href="#cb113-305" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb113-306"><a href="#cb113-306" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove unnecessary variables</span></span>
<span id="cb113-307"><a href="#cb113-307" aria-hidden="true" tabindex="-1"></a><span class="fu">remove</span>(grid_arr)</span>
<span id="cb113-308"><a href="#cb113-308" aria-hidden="true" tabindex="-1"></a><span class="fu">remove</span>(plt)</span>
<span id="cb113-309"><a href="#cb113-309" aria-hidden="true" tabindex="-1"></a><span class="fu">remove</span>(i)</span>
<span id="cb113-310"><a href="#cb113-310" aria-hidden="true" tabindex="-1"></a><span class="fu">remove</span>(num_plots)</span>
<span id="cb113-311"><a href="#cb113-311" aria-hidden="true" tabindex="-1"></a><span class="fu">remove</span>(num_rows)</span>
<span id="cb113-312"><a href="#cb113-312" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-313"><a href="#cb113-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-314"><a href="#cb113-314" aria-hidden="true" tabindex="-1"></a><span class="fu">### Data Relationships</span></span>
<span id="cb113-315"><a href="#cb113-315" aria-hidden="true" tabindex="-1"></a><span class="in">```{r relation_plot, fig.width=10, fig.height=5, message=FALSE}</span></span>
<span id="cb113-316"><a href="#cb113-316" aria-hidden="true" tabindex="-1"></a>reshape2<span class="sc">::</span><span class="fu">melt</span>(wine.data[, <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>], <span class="st">"quality"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb113-317"><a href="#cb113-317" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(value, quality, <span class="at">color =</span> variable)) <span class="sc">+</span>  </span>
<span id="cb113-318"><a href="#cb113-318" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb113-319"><a href="#cb113-319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(value,quality, <span class="at">colour=</span>variable), <span class="at">method=</span>lm, <span class="at">se=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb113-320"><a href="#cb113-320" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(.<span class="sc">~</span>variable, <span class="at">scales =</span> <span class="st">"free"</span>)</span>
<span id="cb113-321"><a href="#cb113-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-322"><a href="#cb113-322" aria-hidden="true" tabindex="-1"></a><span class="co"># Collinearity between Attributes</span></span>
<span id="cb113-323"><a href="#cb113-323" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(wine.data_subset) <span class="sc">%&gt;%</span> </span>
<span id="cb113-324"><a href="#cb113-324" aria-hidden="true" tabindex="-1"></a>  corrplot<span class="sc">::</span><span class="fu">corrplot</span>(<span class="at">method =</span> <span class="st">'number'</span>,  <span class="at">type =</span> <span class="st">"lower"</span>, <span class="at">tl.col =</span> <span class="st">"steelblue"</span>, <span class="at">number.cex =</span> <span class="fl">0.5</span>)</span>
<span id="cb113-325"><a href="#cb113-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-326"><a href="#cb113-326" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove quality from dataset, use good as response </span></span>
<span id="cb113-327"><a href="#cb113-327" aria-hidden="true" tabindex="-1"></a>wine.data_subset<span class="sc">$</span>quality <span class="ot">&lt;-</span> <span class="cn">NULL</span> </span>
<span id="cb113-328"><a href="#cb113-328" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-329"><a href="#cb113-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-330"><a href="#cb113-330" aria-hidden="true" tabindex="-1"></a><span class="fu">### Data Split</span></span>
<span id="cb113-331"><a href="#cb113-331" aria-hidden="true" tabindex="-1"></a><span class="in">```{r data_split}</span></span>
<span id="cb113-332"><a href="#cb113-332" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb113-333"><a href="#cb113-333" aria-hidden="true" tabindex="-1"></a><span class="co"># Splitting the dataset into train and test (7/10th for train remaining for test)</span></span>
<span id="cb113-334"><a href="#cb113-334" aria-hidden="true" tabindex="-1"></a>inTrain <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">createDataPartition</span>(wine.data_subset<span class="sc">$</span>good, <span class="at">p =</span> <span class="dv">7</span><span class="sc">/</span><span class="dv">10</span>, <span class="at">list =</span> F)</span>
<span id="cb113-335"><a href="#cb113-335" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> wine.data_subset[inTrain,]</span>
<span id="cb113-336"><a href="#cb113-336" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> wine.data_subset[<span class="sc">-</span>inTrain,]</span>
<span id="cb113-337"><a href="#cb113-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-338"><a href="#cb113-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-339"><a href="#cb113-339" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the outcome variable to a factor with two levels</span></span>
<span id="cb113-340"><a href="#cb113-340" aria-hidden="true" tabindex="-1"></a>train<span class="sc">$</span>good <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(train<span class="sc">$</span>good)</span>
<span id="cb113-341"><a href="#cb113-341" aria-hidden="true" tabindex="-1"></a>test<span class="sc">$</span>good <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(test<span class="sc">$</span>good)</span>
<span id="cb113-342"><a href="#cb113-342" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-343"><a href="#cb113-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-344"><a href="#cb113-344" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data Modeling</span></span>
<span id="cb113-345"><a href="#cb113-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-346"><a href="#cb113-346" aria-hidden="true" tabindex="-1"></a><span class="fu">### K-Nearest Neightbor</span></span>
<span id="cb113-347"><a href="#cb113-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-348"><a href="#cb113-348" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Model Construction</span></span>
<span id="cb113-349"><a href="#cb113-349" aria-hidden="true" tabindex="-1"></a><span class="in">```{r knn.model_savings, eval=FALSE}</span></span>
<span id="cb113-350"><a href="#cb113-350" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------#</span></span>
<span id="cb113-351"><a href="#cb113-351" aria-hidden="true" tabindex="-1"></a><span class="co">#-----K-fold CV------#</span></span>
<span id="cb113-352"><a href="#cb113-352" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------#</span></span>
<span id="cb113-353"><a href="#cb113-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-354"><a href="#cb113-354" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb113-355"><a href="#cb113-355" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the training control object for 10-fold cross-validation</span></span>
<span id="cb113-356"><a href="#cb113-356" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">10</span>)</span>
<span id="cb113-357"><a href="#cb113-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-358"><a href="#cb113-358" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the KNN model using 10-fold cross-validation</span></span>
<span id="cb113-359"><a href="#cb113-359" aria-hidden="true" tabindex="-1"></a><span class="co"># tuneLength argument to specify the range of values of K to be considered for tuning</span></span>
<span id="cb113-360"><a href="#cb113-360" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb113-361"><a href="#cb113-361" aria-hidden="true" tabindex="-1"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb113-362"><a href="#cb113-362" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train, </span>
<span id="cb113-363"><a href="#cb113-363" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"knn"</span>, </span>
<span id="cb113-364"><a href="#cb113-364" aria-hidden="true" tabindex="-1"></a>                   <span class="at">trControl =</span> train_control)</span>
<span id="cb113-365"><a href="#cb113-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-366"><a href="#cb113-366" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the model into .Rdata for future import </span></span>
<span id="cb113-367"><a href="#cb113-367" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(knn_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_kfoldCV.Rdata"</span>)</span>
<span id="cb113-368"><a href="#cb113-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-369"><a href="#cb113-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-370"><a href="#cb113-370" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------#</span></span>
<span id="cb113-371"><a href="#cb113-371" aria-hidden="true" tabindex="-1"></a><span class="co">#-----K-fold CV (Mod)------#</span></span>
<span id="cb113-372"><a href="#cb113-372" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------#</span></span>
<span id="cb113-373"><a href="#cb113-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-374"><a href="#cb113-374" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb113-375"><a href="#cb113-375" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">10</span>)</span>
<span id="cb113-376"><a href="#cb113-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-377"><a href="#cb113-377" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb113-378"><a href="#cb113-378" aria-hidden="true" tabindex="-1"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb113-379"><a href="#cb113-379" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train, </span>
<span id="cb113-380"><a href="#cb113-380" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"knn"</span>, </span>
<span id="cb113-381"><a href="#cb113-381" aria-hidden="true" tabindex="-1"></a>                   <span class="at">trControl =</span> train_control, </span>
<span id="cb113-382"><a href="#cb113-382" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tuneLength =</span> <span class="dv">10</span>)</span>
<span id="cb113-383"><a href="#cb113-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-384"><a href="#cb113-384" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the model into .Rdata for future import </span></span>
<span id="cb113-385"><a href="#cb113-385" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(knn_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_kfoldCV_mod.Rdata"</span>)</span>
<span id="cb113-386"><a href="#cb113-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-387"><a href="#cb113-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-388"><a href="#cb113-388" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------#</span></span>
<span id="cb113-389"><a href="#cb113-389" aria-hidden="true" tabindex="-1"></a><span class="co">#----Hold-out CV-----#</span></span>
<span id="cb113-390"><a href="#cb113-390" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------#</span></span>
<span id="cb113-391"><a href="#cb113-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-392"><a href="#cb113-392" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb113-393"><a href="#cb113-393" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"none"</span>,)</span>
<span id="cb113-394"><a href="#cb113-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-395"><a href="#cb113-395" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb113-396"><a href="#cb113-396" aria-hidden="true" tabindex="-1"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb113-397"><a href="#cb113-397" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train, </span>
<span id="cb113-398"><a href="#cb113-398" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"knn"</span>)</span>
<span id="cb113-399"><a href="#cb113-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-400"><a href="#cb113-400" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(knn_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_holdoutCV.Rdata"</span>)</span>
<span id="cb113-401"><a href="#cb113-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-402"><a href="#cb113-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-403"><a href="#cb113-403" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------#</span></span>
<span id="cb113-404"><a href="#cb113-404" aria-hidden="true" tabindex="-1"></a><span class="co">#----Hold-out CV (Mod)-----#</span></span>
<span id="cb113-405"><a href="#cb113-405" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------#</span></span>
<span id="cb113-406"><a href="#cb113-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-407"><a href="#cb113-407" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb113-408"><a href="#cb113-408" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"none"</span>,)</span>
<span id="cb113-409"><a href="#cb113-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-410"><a href="#cb113-410" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb113-411"><a href="#cb113-411" aria-hidden="true" tabindex="-1"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb113-412"><a href="#cb113-412" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train, </span>
<span id="cb113-413"><a href="#cb113-413" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"knn"</span>,</span>
<span id="cb113-414"><a href="#cb113-414" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tuneGrid =</span> <span class="fu">expand.grid</span>(<span class="at">k=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>))</span>
<span id="cb113-415"><a href="#cb113-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-416"><a href="#cb113-416" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(knn_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_holdoutCV_mod.Rdata"</span>)</span>
<span id="cb113-417"><a href="#cb113-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-418"><a href="#cb113-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-419"><a href="#cb113-419" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------#</span></span>
<span id="cb113-420"><a href="#cb113-420" aria-hidden="true" tabindex="-1"></a><span class="co">#-------LOOCV--------#</span></span>
<span id="cb113-421"><a href="#cb113-421" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------#</span></span>
<span id="cb113-422"><a href="#cb113-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-423"><a href="#cb113-423" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb113-424"><a href="#cb113-424" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"LOOCV"</span>)</span>
<span id="cb113-425"><a href="#cb113-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-426"><a href="#cb113-426" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb113-427"><a href="#cb113-427" aria-hidden="true" tabindex="-1"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb113-428"><a href="#cb113-428" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train, </span>
<span id="cb113-429"><a href="#cb113-429" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"knn"</span>, </span>
<span id="cb113-430"><a href="#cb113-430" aria-hidden="true" tabindex="-1"></a>                   <span class="at">trControl =</span> train_control)</span>
<span id="cb113-431"><a href="#cb113-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-432"><a href="#cb113-432" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(knn_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_looCV.Rdata"</span>)</span>
<span id="cb113-433"><a href="#cb113-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-434"><a href="#cb113-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-435"><a href="#cb113-435" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------#</span></span>
<span id="cb113-436"><a href="#cb113-436" aria-hidden="true" tabindex="-1"></a><span class="co">#-------LOOCV (Mod)--------#</span></span>
<span id="cb113-437"><a href="#cb113-437" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------#</span></span>
<span id="cb113-438"><a href="#cb113-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-439"><a href="#cb113-439" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb113-440"><a href="#cb113-440" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"LOOCV"</span>)</span>
<span id="cb113-441"><a href="#cb113-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-442"><a href="#cb113-442" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb113-443"><a href="#cb113-443" aria-hidden="true" tabindex="-1"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb113-444"><a href="#cb113-444" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train, </span>
<span id="cb113-445"><a href="#cb113-445" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"knn"</span>, </span>
<span id="cb113-446"><a href="#cb113-446" aria-hidden="true" tabindex="-1"></a>                   <span class="at">trControl =</span> train_control,</span>
<span id="cb113-447"><a href="#cb113-447" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tuneLength =</span> <span class="dv">10</span>,</span>
<span id="cb113-448"><a href="#cb113-448" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tuneGrid =</span> <span class="fu">expand.grid</span>(<span class="at">k =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>))</span>
<span id="cb113-449"><a href="#cb113-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-450"><a href="#cb113-450" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(knn_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_looCV_mod.Rdata"</span>)</span>
<span id="cb113-451"><a href="#cb113-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-452"><a href="#cb113-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-453"><a href="#cb113-453" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------#</span></span>
<span id="cb113-454"><a href="#cb113-454" aria-hidden="true" tabindex="-1"></a><span class="co">#----Repeated CV-----#</span></span>
<span id="cb113-455"><a href="#cb113-455" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------#</span></span>
<span id="cb113-456"><a href="#cb113-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-457"><a href="#cb113-457" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb113-458"><a href="#cb113-458" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"repeatedcv"</span>, <span class="at">number =</span> <span class="dv">10</span>, <span class="at">repeats =</span> <span class="dv">5</span>)</span>
<span id="cb113-459"><a href="#cb113-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-460"><a href="#cb113-460" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb113-461"><a href="#cb113-461" aria-hidden="true" tabindex="-1"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb113-462"><a href="#cb113-462" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train, </span>
<span id="cb113-463"><a href="#cb113-463" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"knn"</span>, </span>
<span id="cb113-464"><a href="#cb113-464" aria-hidden="true" tabindex="-1"></a>                   <span class="at">trControl =</span> train_control)</span>
<span id="cb113-465"><a href="#cb113-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-466"><a href="#cb113-466" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(knn_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_repeatedCV.Rdata"</span>)</span>
<span id="cb113-467"><a href="#cb113-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-468"><a href="#cb113-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-469"><a href="#cb113-469" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------#</span></span>
<span id="cb113-470"><a href="#cb113-470" aria-hidden="true" tabindex="-1"></a><span class="co">#----Repeated CV (Mod)-----#</span></span>
<span id="cb113-471"><a href="#cb113-471" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------#</span></span>
<span id="cb113-472"><a href="#cb113-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-473"><a href="#cb113-473" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb113-474"><a href="#cb113-474" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"repeatedcv"</span>, <span class="at">number =</span> <span class="dv">10</span>, <span class="at">repeats =</span> <span class="dv">5</span>)</span>
<span id="cb113-475"><a href="#cb113-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-476"><a href="#cb113-476" aria-hidden="true" tabindex="-1"></a>kknn.grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">kmax =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span> ,<span class="dv">9</span>, <span class="dv">11</span>), <span class="at">distance =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb113-477"><a href="#cb113-477" aria-hidden="true" tabindex="-1"></a>                         <span class="at">kernel =</span> <span class="fu">c</span>(<span class="st">"rectangular"</span>, <span class="st">"gaussian"</span>, <span class="st">"cos"</span>))</span>
<span id="cb113-478"><a href="#cb113-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-479"><a href="#cb113-479" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb113-480"><a href="#cb113-480" aria-hidden="true" tabindex="-1"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb113-481"><a href="#cb113-481" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train, </span>
<span id="cb113-482"><a href="#cb113-482" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"kknn"</span>,</span>
<span id="cb113-483"><a href="#cb113-483" aria-hidden="true" tabindex="-1"></a>                   <span class="at">trControl =</span> train_control, </span>
<span id="cb113-484"><a href="#cb113-484" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tuneGrid =</span> kknn.grid,</span>
<span id="cb113-485"><a href="#cb113-485" aria-hidden="true" tabindex="-1"></a>                   <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>))</span>
<span id="cb113-486"><a href="#cb113-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-487"><a href="#cb113-487" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(knn_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_repeatedCV_mod.Rdata"</span>)</span>
<span id="cb113-488"><a href="#cb113-488" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-489"><a href="#cb113-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-490"><a href="#cb113-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-491"><a href="#cb113-491" aria-hidden="true" tabindex="-1"></a><span class="fu">#### K-fold CV </span></span>
<span id="cb113-492"><a href="#cb113-492" aria-hidden="true" tabindex="-1"></a><span class="in">```{r knn.kfoldCV, fig.show='hide'}</span></span>
<span id="cb113-493"><a href="#cb113-493" aria-hidden="true" tabindex="-1"></a><span class="co"># Import model</span></span>
<span id="cb113-494"><a href="#cb113-494" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_kfoldCV.Rdata"</span>)</span>
<span id="cb113-495"><a href="#cb113-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-496"><a href="#cb113-496" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the test data using the trained model and calculate the test error rate</span></span>
<span id="cb113-497"><a href="#cb113-497" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_model, <span class="at">newdata =</span> test)</span>
<span id="cb113-498"><a href="#cb113-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-499"><a href="#cb113-499" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb113-500"><a href="#cb113-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-501"><a href="#cb113-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-502"><a href="#cb113-502" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert predictions to a numeric vector</span></span>
<span id="cb113-503"><a href="#cb113-503" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(knn.predictions)</span>
<span id="cb113-504"><a href="#cb113-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-505"><a href="#cb113-505" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the AUC using the performance() and auc() functions:</span></span>
<span id="cb113-506"><a href="#cb113-506" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb113-507"><a href="#cb113-507" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb113-508"><a href="#cb113-508" aria-hidden="true" tabindex="-1"></a>auc_val</span>
<span id="cb113-509"><a href="#cb113-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-510"><a href="#cb113-510" aria-hidden="true" tabindex="-1"></a><span class="co"># Performance plot for TP and FP</span></span>
<span id="cb113-511"><a href="#cb113-511" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb113-512"><a href="#cb113-512" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb113-513"><a href="#cb113-513" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb113-514"><a href="#cb113-514" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb113-515"><a href="#cb113-515" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"ROC Curves from 10-fold CV"</span>)</span>
<span id="cb113-516"><a href="#cb113-516" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(auc_val, <span class="dv">1</span> <span class="sc">-</span> auc_val, </span>
<span id="cb113-517"><a href="#cb113-517" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"steelblue"</span>, </span>
<span id="cb113-518"><a href="#cb113-518" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb113-519"><a href="#cb113-519" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb113-520"><a href="#cb113-520" aria-hidden="true" tabindex="-1"></a>knn.kfoldCV.ROC.plot<span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb113-521"><a href="#cb113-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-522"><a href="#cb113-522" aria-hidden="true" tabindex="-1"></a><span class="co"># Accuracy and Kappa value plot</span></span>
<span id="cb113-523"><a href="#cb113-523" aria-hidden="true" tabindex="-1"></a>knn.accu.kappa.plot <span class="ot">&lt;-</span> <span class="cf">function</span>(knn.model) {</span>
<span id="cb113-524"><a href="#cb113-524" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">data.frame</span>(<span class="at">k =</span> knn.model<span class="sc">$</span>results<span class="sc">$</span>k,</span>
<span id="cb113-525"><a href="#cb113-525" aria-hidden="true" tabindex="-1"></a>                              <span class="at">Accuracy =</span> knn.model<span class="sc">$</span>results<span class="sc">$</span>Accuracy,</span>
<span id="cb113-526"><a href="#cb113-526" aria-hidden="true" tabindex="-1"></a>                              <span class="at">Kappa =</span> knn.model<span class="sc">$</span>results<span class="sc">$</span>Kappa)) <span class="sc">+</span></span>
<span id="cb113-527"><a href="#cb113-527" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">color =</span> <span class="st">"Accuracy"</span>)) <span class="sc">+</span></span>
<span id="cb113-528"><a href="#cb113-528" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">color =</span> <span class="st">"Kappa"</span>)) <span class="sc">+</span></span>
<span id="cb113-529"><a href="#cb113-529" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">linetype =</span> <span class="st">"Accuracy"</span>, <span class="at">color =</span> <span class="st">"Accuracy"</span>)) <span class="sc">+</span></span>
<span id="cb113-530"><a href="#cb113-530" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">linetype =</span> <span class="st">"Kappa"</span>, <span class="at">color =</span> <span class="st">"Kappa"</span>)) <span class="sc">+</span></span>
<span id="cb113-531"><a href="#cb113-531" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#98c379"</span>, <span class="st">"#e06c75"</span>),</span>
<span id="cb113-532"><a href="#cb113-532" aria-hidden="true" tabindex="-1"></a>                       <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>)) )) <span class="sc">+</span></span>
<span id="cb113-533"><a href="#cb113-533" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_linetype_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"solid"</span>, <span class="st">"dotted"</span>),</span>
<span id="cb113-534"><a href="#cb113-534" aria-hidden="true" tabindex="-1"></a>                          <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="fu">c</span>(<span class="st">"#98c379"</span>, <span class="st">"#e06c75"</span>)))) <span class="sc">+</span></span>
<span id="cb113-535"><a href="#cb113-535" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"K value"</span>, </span>
<span id="cb113-536"><a href="#cb113-536" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Accuracy / Kappa"</span>) <span class="sc">+</span></span>
<span id="cb113-537"><a href="#cb113-537" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb113-538"><a href="#cb113-538" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb113-539"><a href="#cb113-539" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb113-540"><a href="#cb113-540" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Metric"</span>),</span>
<span id="cb113-541"><a href="#cb113-541" aria-hidden="true" tabindex="-1"></a>           <span class="at">linetype =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Metric"</span>))</span>
<span id="cb113-542"><a href="#cb113-542" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb113-543"><a href="#cb113-543" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb113-544"><a href="#cb113-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-545"><a href="#cb113-545" aria-hidden="true" tabindex="-1"></a>knn.kfoldCV.plot <span class="ot">&lt;-</span> <span class="fu">knn.accu.kappa.plot</span>(knn_model) <span class="sc">+</span> </span>
<span id="cb113-546"><a href="#cb113-546" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb113-547"><a href="#cb113-547" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">label =</span> <span class="fu">round</span>(Kappa, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb113-548"><a href="#cb113-548" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"KNN Model Performance (10-Fold CV)"</span>)</span>
<span id="cb113-549"><a href="#cb113-549" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-550"><a href="#cb113-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-551"><a href="#cb113-551" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Tuned</span></span>
<span id="cb113-552"><a href="#cb113-552" aria-hidden="true" tabindex="-1"></a><span class="in">```{r knn.kfoldCV_mod, fig.show='hide'}</span></span>
<span id="cb113-553"><a href="#cb113-553" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_kfoldCV_mod.Rdata"</span>)</span>
<span id="cb113-554"><a href="#cb113-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-555"><a href="#cb113-555" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_model, <span class="at">newdata =</span> test)</span>
<span id="cb113-556"><a href="#cb113-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-557"><a href="#cb113-557" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb113-558"><a href="#cb113-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-559"><a href="#cb113-559" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(knn.predictions)</span>
<span id="cb113-560"><a href="#cb113-560" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb113-561"><a href="#cb113-561" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb113-562"><a href="#cb113-562" aria-hidden="true" tabindex="-1"></a>auc_val</span>
<span id="cb113-563"><a href="#cb113-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-564"><a href="#cb113-564" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb113-565"><a href="#cb113-565" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb113-566"><a href="#cb113-566" aria-hidden="true" tabindex="-1"></a>               <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb113-567"><a href="#cb113-567" aria-hidden="true" tabindex="-1"></a>               <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb113-568"><a href="#cb113-568" aria-hidden="true" tabindex="-1"></a>               <span class="at">main =</span> <span class="st">"ROC Curves from Tuned K-fold CV"</span>))</span>
<span id="cb113-569"><a href="#cb113-569" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(auc_val, <span class="dv">1</span> <span class="sc">-</span> auc_val, </span>
<span id="cb113-570"><a href="#cb113-570" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"steelblue"</span>, </span>
<span id="cb113-571"><a href="#cb113-571" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb113-572"><a href="#cb113-572" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb113-573"><a href="#cb113-573" aria-hidden="true" tabindex="-1"></a>knn.kfoldCV_mod.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb113-574"><a href="#cb113-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-575"><a href="#cb113-575" aria-hidden="true" tabindex="-1"></a>knn.kfoldCV_mod.plot <span class="ot">&lt;-</span> <span class="fu">knn.accu.kappa.plot</span>(knn_model) <span class="sc">+</span></span>
<span id="cb113-576"><a href="#cb113-576" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb113-577"><a href="#cb113-577" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">label =</span> <span class="fu">round</span>(Kappa, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb113-578"><a href="#cb113-578" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"KNN Model Performance (Tuned 10-Fold CV)"</span>)</span>
<span id="cb113-579"><a href="#cb113-579" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-580"><a href="#cb113-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-581"><a href="#cb113-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-582"><a href="#cb113-582" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Hold-out CV</span></span>
<span id="cb113-583"><a href="#cb113-583" aria-hidden="true" tabindex="-1"></a><span class="in">```{r knn.holdoutCV, fig.show='hide'}</span></span>
<span id="cb113-584"><a href="#cb113-584" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_holdoutCV.Rdata"</span>)</span>
<span id="cb113-585"><a href="#cb113-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-586"><a href="#cb113-586" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_model, <span class="at">newdata =</span> test)</span>
<span id="cb113-587"><a href="#cb113-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-588"><a href="#cb113-588" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb113-589"><a href="#cb113-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-590"><a href="#cb113-590" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(knn.predictions)</span>
<span id="cb113-591"><a href="#cb113-591" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb113-592"><a href="#cb113-592" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb113-593"><a href="#cb113-593" aria-hidden="true" tabindex="-1"></a>auc_val</span>
<span id="cb113-594"><a href="#cb113-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-595"><a href="#cb113-595" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb113-596"><a href="#cb113-596" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb113-597"><a href="#cb113-597" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb113-598"><a href="#cb113-598" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb113-599"><a href="#cb113-599" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"ROC Curves from Hold-out CV"</span>)</span>
<span id="cb113-600"><a href="#cb113-600" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(auc_val, <span class="dv">1</span> <span class="sc">-</span> auc_val, </span>
<span id="cb113-601"><a href="#cb113-601" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"steelblue"</span>, </span>
<span id="cb113-602"><a href="#cb113-602" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb113-603"><a href="#cb113-603" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb113-604"><a href="#cb113-604" aria-hidden="true" tabindex="-1"></a>knn.holdoutCV.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb113-605"><a href="#cb113-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-606"><a href="#cb113-606" aria-hidden="true" tabindex="-1"></a>knn.holdoutCV.plot <span class="ot">&lt;-</span> <span class="fu">knn.accu.kappa.plot</span>(knn_model) <span class="sc">+</span></span>
<span id="cb113-607"><a href="#cb113-607" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb113-608"><a href="#cb113-608" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">label =</span> <span class="fu">round</span>(Kappa, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb113-609"><a href="#cb113-609" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"KNN Model Performance (Hold-out CV)"</span>)</span>
<span id="cb113-610"><a href="#cb113-610" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-611"><a href="#cb113-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-612"><a href="#cb113-612" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Tuned</span></span>
<span id="cb113-613"><a href="#cb113-613" aria-hidden="true" tabindex="-1"></a><span class="in">```{r knn.holdoutCV_mod, fig.show='hide'}</span></span>
<span id="cb113-614"><a href="#cb113-614" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_holdoutCV_mod.Rdata"</span>)</span>
<span id="cb113-615"><a href="#cb113-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-616"><a href="#cb113-616" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_model, <span class="at">newdata =</span> test)</span>
<span id="cb113-617"><a href="#cb113-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-618"><a href="#cb113-618" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb113-619"><a href="#cb113-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-620"><a href="#cb113-620" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(knn.predictions)</span>
<span id="cb113-621"><a href="#cb113-621" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb113-622"><a href="#cb113-622" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb113-623"><a href="#cb113-623" aria-hidden="true" tabindex="-1"></a>auc_val</span>
<span id="cb113-624"><a href="#cb113-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-625"><a href="#cb113-625" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb113-626"><a href="#cb113-626" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb113-627"><a href="#cb113-627" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb113-628"><a href="#cb113-628" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb113-629"><a href="#cb113-629" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"ROC Curves from Tuned Hold-out CV"</span>)</span>
<span id="cb113-630"><a href="#cb113-630" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(auc_val, <span class="dv">1</span> <span class="sc">-</span> auc_val, </span>
<span id="cb113-631"><a href="#cb113-631" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"steelblue"</span>, </span>
<span id="cb113-632"><a href="#cb113-632" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb113-633"><a href="#cb113-633" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb113-634"><a href="#cb113-634" aria-hidden="true" tabindex="-1"></a>knn.holdoutCV_mod.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb113-635"><a href="#cb113-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-636"><a href="#cb113-636" aria-hidden="true" tabindex="-1"></a>knn.holdoutCV_mod.plot <span class="ot">&lt;-</span> <span class="fu">knn.accu.kappa.plot</span>(knn_model) <span class="sc">+</span> </span>
<span id="cb113-637"><a href="#cb113-637" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">3</span>)), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">angle=</span><span class="dv">90</span>) <span class="sc">+</span></span>
<span id="cb113-638"><a href="#cb113-638" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">label =</span> <span class="fu">round</span>(Kappa, <span class="dv">3</span>)), <span class="at">hjust=</span><span class="sc">-</span><span class="fl">0.3</span>, <span class="at">angle=</span><span class="dv">90</span>) <span class="sc">+</span></span>
<span id="cb113-639"><a href="#cb113-639" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"KNN Model Performance (Tuned Hold-out CV)"</span>)</span>
<span id="cb113-640"><a href="#cb113-640" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-641"><a href="#cb113-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-642"><a href="#cb113-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-643"><a href="#cb113-643" aria-hidden="true" tabindex="-1"></a><span class="fu">#### LOOCV</span></span>
<span id="cb113-644"><a href="#cb113-644" aria-hidden="true" tabindex="-1"></a><span class="in">```{r knn.LOOCV, fig.show='hide'}</span></span>
<span id="cb113-645"><a href="#cb113-645" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_looCV.Rdata"</span>)</span>
<span id="cb113-646"><a href="#cb113-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-647"><a href="#cb113-647" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_model, <span class="at">newdata =</span> test)</span>
<span id="cb113-648"><a href="#cb113-648" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb113-649"><a href="#cb113-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-650"><a href="#cb113-650" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(knn.predictions)</span>
<span id="cb113-651"><a href="#cb113-651" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb113-652"><a href="#cb113-652" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb113-653"><a href="#cb113-653" aria-hidden="true" tabindex="-1"></a>auc_val</span>
<span id="cb113-654"><a href="#cb113-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-655"><a href="#cb113-655" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb113-656"><a href="#cb113-656" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb113-657"><a href="#cb113-657" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb113-658"><a href="#cb113-658" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb113-659"><a href="#cb113-659" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">'ROC Curves from LOOCV'</span>)</span>
<span id="cb113-660"><a href="#cb113-660" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(auc_val, <span class="dv">1</span> <span class="sc">-</span> auc_val, </span>
<span id="cb113-661"><a href="#cb113-661" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"steelblue"</span>, </span>
<span id="cb113-662"><a href="#cb113-662" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb113-663"><a href="#cb113-663" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb113-664"><a href="#cb113-664" aria-hidden="true" tabindex="-1"></a>knn.looCV.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb113-665"><a href="#cb113-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-666"><a href="#cb113-666" aria-hidden="true" tabindex="-1"></a>knn.looCV.plot <span class="ot">&lt;-</span> <span class="fu">knn.accu.kappa.plot</span>(knn_model) <span class="sc">+</span> </span>
<span id="cb113-667"><a href="#cb113-667" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb113-668"><a href="#cb113-668" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">label =</span> <span class="fu">round</span>(Kappa, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb113-669"><a href="#cb113-669" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"KNN Model Performance (LOOCV)"</span>)</span>
<span id="cb113-670"><a href="#cb113-670" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-671"><a href="#cb113-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-672"><a href="#cb113-672" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Tuned</span></span>
<span id="cb113-673"><a href="#cb113-673" aria-hidden="true" tabindex="-1"></a><span class="in">```{r knn.LOOCV_mod, fig.show='hide'}</span></span>
<span id="cb113-674"><a href="#cb113-674" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_looCV_mod.Rdata"</span>)</span>
<span id="cb113-675"><a href="#cb113-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-676"><a href="#cb113-676" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_model, <span class="at">newdata =</span> test)</span>
<span id="cb113-677"><a href="#cb113-677" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb113-678"><a href="#cb113-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-679"><a href="#cb113-679" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(knn.predictions)</span>
<span id="cb113-680"><a href="#cb113-680" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb113-681"><a href="#cb113-681" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb113-682"><a href="#cb113-682" aria-hidden="true" tabindex="-1"></a>auc_val</span>
<span id="cb113-683"><a href="#cb113-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-684"><a href="#cb113-684" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb113-685"><a href="#cb113-685" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb113-686"><a href="#cb113-686" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb113-687"><a href="#cb113-687" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb113-688"><a href="#cb113-688" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"ROC Curves from Tuned LOOCV"</span>)</span>
<span id="cb113-689"><a href="#cb113-689" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(auc_val, <span class="dv">1</span> <span class="sc">-</span> auc_val, </span>
<span id="cb113-690"><a href="#cb113-690" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"steelblue"</span>, </span>
<span id="cb113-691"><a href="#cb113-691" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb113-692"><a href="#cb113-692" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb113-693"><a href="#cb113-693" aria-hidden="true" tabindex="-1"></a>knn.looCV_mod.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb113-694"><a href="#cb113-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-695"><a href="#cb113-695" aria-hidden="true" tabindex="-1"></a>knn.looCV_mod.plot <span class="ot">&lt;-</span> <span class="fu">knn.accu.kappa.plot</span>(knn_model) <span class="sc">+</span> </span>
<span id="cb113-696"><a href="#cb113-696" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Accuracy, <span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">3</span>)), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">angle=</span><span class="dv">90</span>) <span class="sc">+</span></span>
<span id="cb113-697"><a href="#cb113-697" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> Kappa, <span class="at">label =</span> <span class="fu">round</span>(Kappa, <span class="dv">3</span>)), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">angle=</span><span class="dv">90</span>) <span class="sc">+</span></span>
<span id="cb113-698"><a href="#cb113-698" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"KNN Model Performance (Tuned LOOCV)"</span>)</span>
<span id="cb113-699"><a href="#cb113-699" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-700"><a href="#cb113-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-701"><a href="#cb113-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-702"><a href="#cb113-702" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Repeated CV</span></span>
<span id="cb113-703"><a href="#cb113-703" aria-hidden="true" tabindex="-1"></a><span class="in">```{r knn.repeatedCV, fig.show='hide'}</span></span>
<span id="cb113-704"><a href="#cb113-704" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_repeatedCV.Rdata"</span>)</span>
<span id="cb113-705"><a href="#cb113-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-706"><a href="#cb113-706" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_model, <span class="at">newdata =</span> test)</span>
<span id="cb113-707"><a href="#cb113-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-708"><a href="#cb113-708" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb113-709"><a href="#cb113-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-710"><a href="#cb113-710" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(knn.predictions)</span>
<span id="cb113-711"><a href="#cb113-711" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb113-712"><a href="#cb113-712" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb113-713"><a href="#cb113-713" aria-hidden="true" tabindex="-1"></a>auc_val</span>
<span id="cb113-714"><a href="#cb113-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-715"><a href="#cb113-715" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb113-716"><a href="#cb113-716" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb113-717"><a href="#cb113-717" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb113-718"><a href="#cb113-718" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb113-719"><a href="#cb113-719" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"ROC Curves from Repeated CV"</span>)</span>
<span id="cb113-720"><a href="#cb113-720" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(auc_val, <span class="dv">1</span> <span class="sc">-</span> auc_val, </span>
<span id="cb113-721"><a href="#cb113-721" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"steelblue"</span>, </span>
<span id="cb113-722"><a href="#cb113-722" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb113-723"><a href="#cb113-723" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb113-724"><a href="#cb113-724" aria-hidden="true" tabindex="-1"></a>knn.repeatedCV.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb113-725"><a href="#cb113-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-726"><a href="#cb113-726" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> knn_model<span class="sc">$</span>results</span>
<span id="cb113-727"><a href="#cb113-727" aria-hidden="true" tabindex="-1"></a>knn.repeatedCV.plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>df, <span class="fu">aes</span>(<span class="at">x =</span> kmax, <span class="at">y =</span> Accuracy)) <span class="sc">+</span></span>
<span id="cb113-728"><a href="#cb113-728" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Accuracy"</span>)) <span class="sc">+</span></span>
<span id="cb113-729"><a href="#cb113-729" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Kappa"</span>)) <span class="sc">+</span></span>
<span id="cb113-730"><a href="#cb113-730" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> <span class="st">"Accuracy"</span>, <span class="at">color =</span> <span class="st">"Accuracy"</span>)) <span class="sc">+</span></span>
<span id="cb113-731"><a href="#cb113-731" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Kappa, <span class="at">linetype =</span> <span class="st">"Kappa"</span>, <span class="at">color =</span> <span class="st">"Kappa"</span>)) <span class="sc">+</span></span>
<span id="cb113-732"><a href="#cb113-732" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(Accuracy, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb113-733"><a href="#cb113-733" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> Kappa, <span class="at">label =</span> <span class="fu">round</span>(Kappa, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb113-734"><a href="#cb113-734" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#98c379"</span>, <span class="st">"#e06c75"</span>),</span>
<span id="cb113-735"><a href="#cb113-735" aria-hidden="true" tabindex="-1"></a>                     <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>)) )) <span class="sc">+</span></span>
<span id="cb113-736"><a href="#cb113-736" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"solid"</span>, <span class="st">"dotted"</span>),</span>
<span id="cb113-737"><a href="#cb113-737" aria-hidden="true" tabindex="-1"></a>                        <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="fu">c</span>(<span class="st">"#98c379"</span>, <span class="st">"#e06c75"</span>)))) <span class="sc">+</span></span>
<span id="cb113-738"><a href="#cb113-738" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"K value"</span>, </span>
<span id="cb113-739"><a href="#cb113-739" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Accuracy / Kappa"</span>,</span>
<span id="cb113-740"><a href="#cb113-740" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"KNN Model Performance (Repeated CV)"</span>) <span class="sc">+</span></span>
<span id="cb113-741"><a href="#cb113-741" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb113-742"><a href="#cb113-742" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb113-743"><a href="#cb113-743" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb113-744"><a href="#cb113-744" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Metric"</span>),</span>
<span id="cb113-745"><a href="#cb113-745" aria-hidden="true" tabindex="-1"></a>         <span class="at">linetype =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Metric"</span>))</span>
<span id="cb113-746"><a href="#cb113-746" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-747"><a href="#cb113-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-748"><a href="#cb113-748" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Tuned</span></span>
<span id="cb113-749"><a href="#cb113-749" aria-hidden="true" tabindex="-1"></a><span class="in">```{r knn.repeatedCV_mod, fig.show='hide'}</span></span>
<span id="cb113-750"><a href="#cb113-750" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">knn.model_repeatedCV_mod.Rdata"</span>)</span>
<span id="cb113-751"><a href="#cb113-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-752"><a href="#cb113-752" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_model, <span class="at">newdata =</span> test)</span>
<span id="cb113-753"><a href="#cb113-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-754"><a href="#cb113-754" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb113-755"><a href="#cb113-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-756"><a href="#cb113-756" aria-hidden="true" tabindex="-1"></a>knn.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(knn.predictions)</span>
<span id="cb113-757"><a href="#cb113-757" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(knn.predictions, test<span class="sc">$</span>good)</span>
<span id="cb113-758"><a href="#cb113-758" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb113-759"><a href="#cb113-759" aria-hidden="true" tabindex="-1"></a>auc_val</span>
<span id="cb113-760"><a href="#cb113-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-761"><a href="#cb113-761" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb113-762"><a href="#cb113-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-763"><a href="#cb113-763" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb113-764"><a href="#cb113-764" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb113-765"><a href="#cb113-765" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb113-766"><a href="#cb113-766" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"ROC Curves from Tuned Repeated CV"</span>)</span>
<span id="cb113-767"><a href="#cb113-767" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(auc_val, <span class="dv">1</span> <span class="sc">-</span> auc_val, </span>
<span id="cb113-768"><a href="#cb113-768" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"steelblue"</span>, </span>
<span id="cb113-769"><a href="#cb113-769" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb113-770"><a href="#cb113-770" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb113-771"><a href="#cb113-771" aria-hidden="true" tabindex="-1"></a>knn.repeatedCV_mod.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb113-772"><a href="#cb113-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-773"><a href="#cb113-773" aria-hidden="true" tabindex="-1"></a>knn.repeatedCV_mod.plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(knn_model) <span class="sc">+</span></span>
<span id="cb113-774"><a href="#cb113-774" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"K value"</span>, </span>
<span id="cb113-775"><a href="#cb113-775" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Accuracy"</span>, </span>
<span id="cb113-776"><a href="#cb113-776" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"KNN Model Performance (Tuned Repeated CV)"</span>) <span class="sc">+</span></span>
<span id="cb113-777"><a href="#cb113-777" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb113-778"><a href="#cb113-778" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) </span>
<span id="cb113-779"><a href="#cb113-779" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-780"><a href="#cb113-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-781"><a href="#cb113-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-782"><a href="#cb113-782" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Summary</span></span>
<span id="cb113-783"><a href="#cb113-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-784"><a href="#cb113-784" aria-hidden="true" tabindex="-1"></a><span class="in">```{r knn.Accuracy.Kappa.Plot, fig.width=15, fig.height=20}</span></span>
<span id="cb113-785"><a href="#cb113-785" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(knn.kfoldCV.plot,</span>
<span id="cb113-786"><a href="#cb113-786" aria-hidden="true" tabindex="-1"></a>          knn.kfoldCV_mod.plot,</span>
<span id="cb113-787"><a href="#cb113-787" aria-hidden="true" tabindex="-1"></a>          knn.holdoutCV.plot,</span>
<span id="cb113-788"><a href="#cb113-788" aria-hidden="true" tabindex="-1"></a>          knn.holdoutCV_mod.plot,</span>
<span id="cb113-789"><a href="#cb113-789" aria-hidden="true" tabindex="-1"></a>          knn.looCV.plot,</span>
<span id="cb113-790"><a href="#cb113-790" aria-hidden="true" tabindex="-1"></a>          knn.looCV_mod.plot,</span>
<span id="cb113-791"><a href="#cb113-791" aria-hidden="true" tabindex="-1"></a>          knn.repeatedCV.plot,</span>
<span id="cb113-792"><a href="#cb113-792" aria-hidden="true" tabindex="-1"></a>          knn.repeatedCV_mod.plot,</span>
<span id="cb113-793"><a href="#cb113-793" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">4</span>)</span>
<span id="cb113-794"><a href="#cb113-794" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-795"><a href="#cb113-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-796"><a href="#cb113-796" aria-hidden="true" tabindex="-1"></a><span class="in">```{r knn.ROC_curve, fig.width=10}</span></span>
<span id="cb113-797"><a href="#cb113-797" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(knn.kfoldCV.ROC.plot, knn.kfoldCV_mod.ROC.plot,</span>
<span id="cb113-798"><a href="#cb113-798" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">align =</span> <span class="st">"hv"</span>, <span class="at">scale =</span> <span class="fl">0.8</span>)</span>
<span id="cb113-799"><a href="#cb113-799" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(knn.holdoutCV.ROC.plot, knn.holdoutCV_mod.ROC.plot,</span>
<span id="cb113-800"><a href="#cb113-800" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">align =</span> <span class="st">"hv"</span>, <span class="at">scale =</span> <span class="fl">0.8</span>)</span>
<span id="cb113-801"><a href="#cb113-801" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(knn.looCV.ROC.plot, knn.looCV_mod.ROC.plot,</span>
<span id="cb113-802"><a href="#cb113-802" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">align =</span> <span class="st">"hv"</span>, <span class="at">scale =</span> <span class="fl">0.8</span>)</span>
<span id="cb113-803"><a href="#cb113-803" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(knn.repeatedCV.ROC.plot, knn.repeatedCV_mod.ROC.plot,</span>
<span id="cb113-804"><a href="#cb113-804" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">align =</span> <span class="st">"hv"</span>, <span class="at">scale =</span> <span class="fl">0.8</span>)</span>
<span id="cb113-805"><a href="#cb113-805" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-806"><a href="#cb113-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-807"><a href="#cb113-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-808"><a href="#cb113-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-809"><a href="#cb113-809" aria-hidden="true" tabindex="-1"></a>| Resampling Method    | Error Rate | Sensitivity | Specificity | AUC       |</span>
<span id="cb113-810"><a href="#cb113-810" aria-hidden="true" tabindex="-1"></a>| -------------------- | ---------- | ----------- | ----------- | --------- |</span>
<span id="cb113-811"><a href="#cb113-811" aria-hidden="true" tabindex="-1"></a>| K-Fold CV            | 0.2273     | 0.9199      | 0.1883      | 0.5541001 |</span>
<span id="cb113-812"><a href="#cb113-812" aria-hidden="true" tabindex="-1"></a>| K-Fold CV (Tuned)    | 0.1995     | 0.9768      | 0.1004      | 0.5386181 |</span>
<span id="cb113-813"><a href="#cb113-813" aria-hidden="true" tabindex="-1"></a>| Hold-out CV          | 0.2222     | 0.9336      | 0.1590      | 0.5463051 |</span>
<span id="cb113-814"><a href="#cb113-814" aria-hidden="true" tabindex="-1"></a>| Hold-out CV  (Tuned) | 0.2022     | 0.9926      | 0.0251      | 0.5088642 |</span>
<span id="cb113-815"><a href="#cb113-815" aria-hidden="true" tabindex="-1"></a>| LOOCV                | 0.1717     | 0.9642      | 0.2887      | 0.6264379 |</span>
<span id="cb113-816"><a href="#cb113-816" aria-hidden="true" tabindex="-1"></a>| LOOCV (Tuned)        | 0.1995     | 0.9768      | 0.1004      | 0.5386181 |</span>
<span id="cb113-817"><a href="#cb113-817" aria-hidden="true" tabindex="-1"></a>| Repeated CV          | 0.1776     | 0.9104      | 0.4728      | 0.6916177 |</span>
<span id="cb113-818"><a href="#cb113-818" aria-hidden="true" tabindex="-1"></a>| Repeated CV (Tuned)  | 0.1120     | 0.9547      | 0.6234      | 0.7890601 |</span>
<span id="cb113-819"><a href="#cb113-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-820"><a href="#cb113-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-821"><a href="#cb113-821" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=FALSE}</span></span>
<span id="cb113-822"><a href="#cb113-822" aria-hidden="true" tabindex="-1"></a><span class="fu">remove</span>(knn_model, df,</span>
<span id="cb113-823"><a href="#cb113-823" aria-hidden="true" tabindex="-1"></a>       knn.kfoldCV.plot,</span>
<span id="cb113-824"><a href="#cb113-824" aria-hidden="true" tabindex="-1"></a>       knn.kfoldCV_mod.plot,</span>
<span id="cb113-825"><a href="#cb113-825" aria-hidden="true" tabindex="-1"></a>       knn.holdoutCV.plot,</span>
<span id="cb113-826"><a href="#cb113-826" aria-hidden="true" tabindex="-1"></a>       knn.holdoutCV_mod.plot,</span>
<span id="cb113-827"><a href="#cb113-827" aria-hidden="true" tabindex="-1"></a>       knn.looCV.plot,</span>
<span id="cb113-828"><a href="#cb113-828" aria-hidden="true" tabindex="-1"></a>       knn.looCV_mod.plot,</span>
<span id="cb113-829"><a href="#cb113-829" aria-hidden="true" tabindex="-1"></a>       knn.repeatedCV.plot,</span>
<span id="cb113-830"><a href="#cb113-830" aria-hidden="true" tabindex="-1"></a>       knn.repeatedCV_mod.plot)</span>
<span id="cb113-831"><a href="#cb113-831" aria-hidden="true" tabindex="-1"></a><span class="fu">remove</span>(pred_obj, roc_obj)</span>
<span id="cb113-832"><a href="#cb113-832" aria-hidden="true" tabindex="-1"></a><span class="fu">remove</span>(auc_val, knn.predictions)</span>
<span id="cb113-833"><a href="#cb113-833" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-834"><a href="#cb113-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-835"><a href="#cb113-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-836"><a href="#cb113-836" aria-hidden="true" tabindex="-1"></a><span class="fu">### Logistic Regression</span></span>
<span id="cb113-837"><a href="#cb113-837" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Model Construction</span></span>
<span id="cb113-838"><a href="#cb113-838" aria-hidden="true" tabindex="-1"></a><span class="in">```{r logit.model_savings, eval=FALSE}</span></span>
<span id="cb113-839"><a href="#cb113-839" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------#</span></span>
<span id="cb113-840"><a href="#cb113-840" aria-hidden="true" tabindex="-1"></a><span class="co">#----Logistic Regression-----#</span></span>
<span id="cb113-841"><a href="#cb113-841" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------#</span></span>
<span id="cb113-842"><a href="#cb113-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-843"><a href="#cb113-843" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb113-844"><a href="#cb113-844" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the training control object for 10-fold cross-validation</span></span>
<span id="cb113-845"><a href="#cb113-845" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">10</span>)</span>
<span id="cb113-846"><a href="#cb113-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-847"><a href="#cb113-847" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the logistic regression model using 10-fold cross-validation</span></span>
<span id="cb113-848"><a href="#cb113-848" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb113-849"><a href="#cb113-849" aria-hidden="true" tabindex="-1"></a>logit_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb113-850"><a href="#cb113-850" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> train, </span>
<span id="cb113-851"><a href="#cb113-851" aria-hidden="true" tabindex="-1"></a>                     <span class="at">method =</span> <span class="st">"glm"</span>, </span>
<span id="cb113-852"><a href="#cb113-852" aria-hidden="true" tabindex="-1"></a>                     <span class="at">family =</span> <span class="st">"binomial"</span>,</span>
<span id="cb113-853"><a href="#cb113-853" aria-hidden="true" tabindex="-1"></a>                     <span class="at">trControl =</span> train_control)</span>
<span id="cb113-854"><a href="#cb113-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-855"><a href="#cb113-855" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(logit_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">logit.model_kfoldCV.Rdata"</span>)</span>
<span id="cb113-856"><a href="#cb113-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-857"><a href="#cb113-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-858"><a href="#cb113-858" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------#</span></span>
<span id="cb113-859"><a href="#cb113-859" aria-hidden="true" tabindex="-1"></a><span class="co">#----Logistic Regression (Mod)-----#</span></span>
<span id="cb113-860"><a href="#cb113-860" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------#</span></span>
<span id="cb113-861"><a href="#cb113-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-862"><a href="#cb113-862" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-863"><a href="#cb113-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-864"><a href="#cb113-864" aria-hidden="true" tabindex="-1"></a><span class="fu">#### K-fold CV</span></span>
<span id="cb113-865"><a href="#cb113-865" aria-hidden="true" tabindex="-1"></a><span class="in">```{r logit.kfoldCV, fig.show='hide', message=FALSE}</span></span>
<span id="cb113-866"><a href="#cb113-866" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">logit.model_kfoldCV.Rdata"</span>)</span>
<span id="cb113-867"><a href="#cb113-867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-868"><a href="#cb113-868" aria-hidden="true" tabindex="-1"></a>logit.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(logit_model, <span class="at">newdata =</span> test)</span>
<span id="cb113-869"><a href="#cb113-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-870"><a href="#cb113-870" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(logit.predictions, test<span class="sc">$</span>good)</span>
<span id="cb113-871"><a href="#cb113-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-872"><a href="#cb113-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-873"><a href="#cb113-873" aria-hidden="true" tabindex="-1"></a>logit.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(logit.predictions)</span>
<span id="cb113-874"><a href="#cb113-874" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(logit.predictions, test<span class="sc">$</span>good)</span>
<span id="cb113-875"><a href="#cb113-875" aria-hidden="true" tabindex="-1"></a>auc_val  <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb113-876"><a href="#cb113-876" aria-hidden="true" tabindex="-1"></a>auc_val</span>
<span id="cb113-877"><a href="#cb113-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-878"><a href="#cb113-878" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb113-879"><a href="#cb113-879" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb113-880"><a href="#cb113-880" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb113-881"><a href="#cb113-881" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb113-882"><a href="#cb113-882" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"ROC Curves from Repeated CV"</span>)</span>
<span id="cb113-883"><a href="#cb113-883" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(auc_val, <span class="dv">1</span> <span class="sc">-</span> auc_val, </span>
<span id="cb113-884"><a href="#cb113-884" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"steelblue"</span>, </span>
<span id="cb113-885"><a href="#cb113-885" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb113-886"><a href="#cb113-886" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb113-887"><a href="#cb113-887" aria-hidden="true" tabindex="-1"></a>logit.kfoldCV.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb113-888"><a href="#cb113-888" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-889"><a href="#cb113-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-890"><a href="#cb113-890" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Tuned</span></span>
<span id="cb113-891"><a href="#cb113-891" aria-hidden="true" tabindex="-1"></a><span class="in">```{r logit.kfoldCV_mod}</span></span>
<span id="cb113-892"><a href="#cb113-892" aria-hidden="true" tabindex="-1"></a>glm.model <span class="ot">&lt;-</span> <span class="fu">glm</span>(good <span class="sc">~</span> ., <span class="at">data=</span> train,<span class="at">family=</span><span class="st">"binomial"</span>)</span>
<span id="cb113-893"><a href="#cb113-893" aria-hidden="true" tabindex="-1"></a>glm.fit<span class="ot">=</span> <span class="fu">stepAIC</span>(glm.model, <span class="at">direction =</span> <span class="st">'backward'</span>)</span>
<span id="cb113-894"><a href="#cb113-894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-895"><a href="#cb113-895" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on test data and construct a confusion matrix</span></span>
<span id="cb113-896"><a href="#cb113-896" aria-hidden="true" tabindex="-1"></a>logit.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(glm.fit, <span class="at">newdata =</span> test,<span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb113-897"><a href="#cb113-897" aria-hidden="true" tabindex="-1"></a>logit.predictions <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(logit.predictions <span class="sc">&gt;</span> <span class="fl">0.7</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb113-898"><a href="#cb113-898" aria-hidden="true" tabindex="-1"></a>                            <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb113-899"><a href="#cb113-899" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(logit.predictions, test<span class="sc">$</span>good)</span>
<span id="cb113-900"><a href="#cb113-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-901"><a href="#cb113-901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-902"><a href="#cb113-902" aria-hidden="true" tabindex="-1"></a>logit.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(logit.predictions)</span>
<span id="cb113-903"><a href="#cb113-903" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(logit.predictions, test<span class="sc">$</span>good)</span>
<span id="cb113-904"><a href="#cb113-904" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb113-905"><a href="#cb113-905" aria-hidden="true" tabindex="-1"></a>auc_val</span>
<span id="cb113-906"><a href="#cb113-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-907"><a href="#cb113-907" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb113-908"><a href="#cb113-908" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb113-909"><a href="#cb113-909" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb113-910"><a href="#cb113-910" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb113-911"><a href="#cb113-911" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"ROC Curves from Repeated CV"</span>)</span>
<span id="cb113-912"><a href="#cb113-912" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(auc_val, <span class="dv">1</span> <span class="sc">-</span> auc_val, </span>
<span id="cb113-913"><a href="#cb113-913" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"steelblue"</span>, </span>
<span id="cb113-914"><a href="#cb113-914" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb113-915"><a href="#cb113-915" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb113-916"><a href="#cb113-916" aria-hidden="true" tabindex="-1"></a>logit.kfoldCV.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb113-917"><a href="#cb113-917" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-918"><a href="#cb113-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-919"><a href="#cb113-919" aria-hidden="true" tabindex="-1"></a>| Resampling Method           | Error Rate | Sensitivity | Specificity | AUC       |</span>
<span id="cb113-920"><a href="#cb113-920" aria-hidden="true" tabindex="-1"></a>| --------------------------- | ---------- | ----------- | ----------- | --------- |</span>
<span id="cb113-921"><a href="#cb113-921" aria-hidden="true" tabindex="-1"></a>| Logistic Regression         | 0.1944     | 0.9347      | 0.2929      | 0.6137776 |</span>
<span id="cb113-922"><a href="#cb113-922" aria-hidden="true" tabindex="-1"></a>| Logistic Regression (Tuned) | 0.1919     | 0.98946     | 0.08787     | 0.5386644 |</span>
<span id="cb113-923"><a href="#cb113-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-924"><a href="#cb113-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-925"><a href="#cb113-925" aria-hidden="true" tabindex="-1"></a><span class="fu">### Linear Discriminant Analysis</span></span>
<span id="cb113-926"><a href="#cb113-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-927"><a href="#cb113-927" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Model Construction</span></span>
<span id="cb113-928"><a href="#cb113-928" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lda.model_savings, eval=FALSE}</span></span>
<span id="cb113-929"><a href="#cb113-929" aria-hidden="true" tabindex="-1"></a><span class="co">#------------#</span></span>
<span id="cb113-930"><a href="#cb113-930" aria-hidden="true" tabindex="-1"></a><span class="co">#----LDA-----#</span></span>
<span id="cb113-931"><a href="#cb113-931" aria-hidden="true" tabindex="-1"></a><span class="co">#------------#</span></span>
<span id="cb113-932"><a href="#cb113-932" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb113-933"><a href="#cb113-933" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">10</span>)</span>
<span id="cb113-934"><a href="#cb113-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-935"><a href="#cb113-935" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb113-936"><a href="#cb113-936" aria-hidden="true" tabindex="-1"></a>lda_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb113-937"><a href="#cb113-937" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train, </span>
<span id="cb113-938"><a href="#cb113-938" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"lda"</span>, </span>
<span id="cb113-939"><a href="#cb113-939" aria-hidden="true" tabindex="-1"></a>                   <span class="at">trControl =</span> train_control)</span>
<span id="cb113-940"><a href="#cb113-940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-941"><a href="#cb113-941" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(lda_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">lda.model_kfoldCV.Rdata"</span>)</span>
<span id="cb113-942"><a href="#cb113-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-943"><a href="#cb113-943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-944"><a href="#cb113-944" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------#</span></span>
<span id="cb113-945"><a href="#cb113-945" aria-hidden="true" tabindex="-1"></a><span class="co">#----LDA (Mod)-----#</span></span>
<span id="cb113-946"><a href="#cb113-946" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------#</span></span>
<span id="cb113-947"><a href="#cb113-947" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-948"><a href="#cb113-948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-949"><a href="#cb113-949" aria-hidden="true" tabindex="-1"></a><span class="fu">#### K-fold CV</span></span>
<span id="cb113-950"><a href="#cb113-950" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lda.kfoldCV, fig.show='hide'}</span></span>
<span id="cb113-951"><a href="#cb113-951" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">lda.model_kfoldCV.Rdata"</span>)</span>
<span id="cb113-952"><a href="#cb113-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-953"><a href="#cb113-953" aria-hidden="true" tabindex="-1"></a>lda.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(lda_model, <span class="at">newdata =</span> test)</span>
<span id="cb113-954"><a href="#cb113-954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-955"><a href="#cb113-955" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(lda.predictions, test<span class="sc">$</span>good)</span>
<span id="cb113-956"><a href="#cb113-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-957"><a href="#cb113-957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-958"><a href="#cb113-958" aria-hidden="true" tabindex="-1"></a>lda.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(lda.predictions)</span>
<span id="cb113-959"><a href="#cb113-959" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(lda.predictions, test<span class="sc">$</span>good)</span>
<span id="cb113-960"><a href="#cb113-960" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb113-961"><a href="#cb113-961" aria-hidden="true" tabindex="-1"></a>auc_val</span>
<span id="cb113-962"><a href="#cb113-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-963"><a href="#cb113-963" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb113-964"><a href="#cb113-964" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb113-965"><a href="#cb113-965" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb113-966"><a href="#cb113-966" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb113-967"><a href="#cb113-967" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"ROC Curves from Repeated CV"</span>)</span>
<span id="cb113-968"><a href="#cb113-968" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(auc_val, <span class="dv">1</span> <span class="sc">-</span> auc_val, </span>
<span id="cb113-969"><a href="#cb113-969" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"steelblue"</span>, </span>
<span id="cb113-970"><a href="#cb113-970" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb113-971"><a href="#cb113-971" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb113-972"><a href="#cb113-972" aria-hidden="true" tabindex="-1"></a>lda.kfoldCV.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb113-973"><a href="#cb113-973" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-974"><a href="#cb113-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-975"><a href="#cb113-975" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Tuned</span></span>
<span id="cb113-976"><a href="#cb113-976" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, lda.kfoldCV_mod, fig.show='hide'}</span></span>
<span id="cb113-977"><a href="#cb113-977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-978"><a href="#cb113-978" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-979"><a href="#cb113-979" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-980"><a href="#cb113-980" aria-hidden="true" tabindex="-1"></a>| Resampling Method | Error Rate | Sensitivity | Specificity | AUC       |</span>
<span id="cb113-981"><a href="#cb113-981" aria-hidden="true" tabindex="-1"></a>| ----------------- | ---------- | ----------- | ----------- | --------- |</span>
<span id="cb113-982"><a href="#cb113-982" aria-hidden="true" tabindex="-1"></a>| LDA               | 0.1919     | 0.9283      | 0.3305      | 0.6294448 |</span>
<span id="cb113-983"><a href="#cb113-983" aria-hidden="true" tabindex="-1"></a>| LDA (Tuned)       | 0.xxxx     | 0.xxxx      | 0.xxxx      | 0.xxxxxxx |</span>
<span id="cb113-984"><a href="#cb113-984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-985"><a href="#cb113-985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-986"><a href="#cb113-986" aria-hidden="true" tabindex="-1"></a><span class="fu">### Quadratic discriminant analysis</span></span>
<span id="cb113-987"><a href="#cb113-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-988"><a href="#cb113-988" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Model Construction</span></span>
<span id="cb113-989"><a href="#cb113-989" aria-hidden="true" tabindex="-1"></a><span class="in">```{r qda.model_savings, eval=FALSE}</span></span>
<span id="cb113-990"><a href="#cb113-990" aria-hidden="true" tabindex="-1"></a><span class="co">#------------#</span></span>
<span id="cb113-991"><a href="#cb113-991" aria-hidden="true" tabindex="-1"></a><span class="co">#----QDA-----#</span></span>
<span id="cb113-992"><a href="#cb113-992" aria-hidden="true" tabindex="-1"></a><span class="co">#------------#</span></span>
<span id="cb113-993"><a href="#cb113-993" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb113-994"><a href="#cb113-994" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">10</span>)</span>
<span id="cb113-995"><a href="#cb113-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-996"><a href="#cb113-996" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb113-997"><a href="#cb113-997" aria-hidden="true" tabindex="-1"></a>qda_model <span class="ot">&lt;-</span> <span class="fu">train</span>(good <span class="sc">~</span> ., </span>
<span id="cb113-998"><a href="#cb113-998" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> train, </span>
<span id="cb113-999"><a href="#cb113-999" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"qda"</span>, </span>
<span id="cb113-1000"><a href="#cb113-1000" aria-hidden="true" tabindex="-1"></a>                   <span class="at">trControl =</span> train_control)</span>
<span id="cb113-1001"><a href="#cb113-1001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1002"><a href="#cb113-1002" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(qda_model, <span class="at">file =</span> <span class="st">"dataset</span><span class="sc">\\</span><span class="st">qda.model_kfoldCV.Rdata"</span>)</span>
<span id="cb113-1003"><a href="#cb113-1003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1004"><a href="#cb113-1004" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------#</span></span>
<span id="cb113-1005"><a href="#cb113-1005" aria-hidden="true" tabindex="-1"></a><span class="co">#----QDA (Mod)-----#</span></span>
<span id="cb113-1006"><a href="#cb113-1006" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------#</span></span>
<span id="cb113-1007"><a href="#cb113-1007" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-1008"><a href="#cb113-1008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1009"><a href="#cb113-1009" aria-hidden="true" tabindex="-1"></a><span class="fu">#### K-fold CV</span></span>
<span id="cb113-1010"><a href="#cb113-1010" aria-hidden="true" tabindex="-1"></a><span class="in">```{r qda.kfoldCV, fig.show='hide'}</span></span>
<span id="cb113-1011"><a href="#cb113-1011" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"dataset</span><span class="sc">\\</span><span class="st">qda.model_kfoldCV.Rdata"</span>)</span>
<span id="cb113-1012"><a href="#cb113-1012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1013"><a href="#cb113-1013" aria-hidden="true" tabindex="-1"></a>qda.predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(qda_model, <span class="at">newdata =</span> test)</span>
<span id="cb113-1014"><a href="#cb113-1014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1015"><a href="#cb113-1015" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(qda.predictions, test<span class="sc">$</span>good)</span>
<span id="cb113-1016"><a href="#cb113-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1017"><a href="#cb113-1017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1018"><a href="#cb113-1018" aria-hidden="true" tabindex="-1"></a>qda.predictions <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(qda.predictions)</span>
<span id="cb113-1019"><a href="#cb113-1019" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(qda.predictions, test<span class="sc">$</span>good)</span>
<span id="cb113-1020"><a href="#cb113-1020" aria-hidden="true" tabindex="-1"></a>auc_val <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb113-1021"><a href="#cb113-1021" aria-hidden="true" tabindex="-1"></a>auc_val</span>
<span id="cb113-1022"><a href="#cb113-1022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1023"><a href="#cb113-1023" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb113-1024"><a href="#cb113-1024" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj, <span class="at">colorize =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb113-1025"><a href="#cb113-1025" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb113-1026"><a href="#cb113-1026" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>,</span>
<span id="cb113-1027"><a href="#cb113-1027" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"ROC Curves from Repeated CV"</span>)</span>
<span id="cb113-1028"><a href="#cb113-1028" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(auc_val, <span class="dv">1</span> <span class="sc">-</span> auc_val, </span>
<span id="cb113-1029"><a href="#cb113-1029" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"steelblue"</span>, </span>
<span id="cb113-1030"><a href="#cb113-1030" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">21</span>)</span>
<span id="cb113-1031"><a href="#cb113-1031" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb113-1032"><a href="#cb113-1032" aria-hidden="true" tabindex="-1"></a>qda.kfoldCV.ROC.plot <span class="ot">&lt;-</span> <span class="fu">recordPlot</span>()</span>
<span id="cb113-1033"><a href="#cb113-1033" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-1034"><a href="#cb113-1034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1035"><a href="#cb113-1035" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Tuned</span></span>
<span id="cb113-1036"><a href="#cb113-1036" aria-hidden="true" tabindex="-1"></a><span class="in">```{r qda.kfoldCV_mod}</span></span>
<span id="cb113-1037"><a href="#cb113-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1038"><a href="#cb113-1038" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-1039"><a href="#cb113-1039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1040"><a href="#cb113-1040" aria-hidden="true" tabindex="-1"></a>| Resampling Method | Error Rate | Sensitivity | Specificity | AUC       |</span>
<span id="cb113-1041"><a href="#cb113-1041" aria-hidden="true" tabindex="-1"></a>| ----------------- | ---------- | ----------- | ----------- | --------- |</span>
<span id="cb113-1042"><a href="#cb113-1042" aria-hidden="true" tabindex="-1"></a>| QDA               | 0.2559     | 0.7418      | 0.7531      | 0.7474858 |</span>
<span id="cb113-1043"><a href="#cb113-1043" aria-hidden="true" tabindex="-1"></a>| QDA (Tuned)       | 0.xxxx     | 0.xxxx      | 0.xxxx      | 0.xxxxxxx |</span>
<span id="cb113-1044"><a href="#cb113-1044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1045"><a href="#cb113-1045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1046"><a href="#cb113-1046" aria-hidden="true" tabindex="-1"></a><span class="fu">### Summary</span></span>
<span id="cb113-1047"><a href="#cb113-1047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1048"><a href="#cb113-1048" aria-hidden="true" tabindex="-1"></a><span class="in">```{r log.lda.qda.ROC_curve, fig.width=10, fig.height=10}</span></span>
<span id="cb113-1049"><a href="#cb113-1049" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(knn.kfoldCV.ROC.plot,</span>
<span id="cb113-1050"><a href="#cb113-1050" aria-hidden="true" tabindex="-1"></a>                   logit.kfoldCV.ROC.plot,</span>
<span id="cb113-1051"><a href="#cb113-1051" aria-hidden="true" tabindex="-1"></a>                   lda.kfoldCV.ROC.plot,</span>
<span id="cb113-1052"><a href="#cb113-1052" aria-hidden="true" tabindex="-1"></a>                   qda.kfoldCV.ROC.plot, </span>
<span id="cb113-1053"><a href="#cb113-1053" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">align =</span> <span class="st">"hv"</span>, <span class="at">scale =</span> <span class="fl">0.8</span>)</span>
<span id="cb113-1054"><a href="#cb113-1054" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-1055"><a href="#cb113-1055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1056"><a href="#cb113-1056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1057"><a href="#cb113-1057" aria-hidden="true" tabindex="-1"></a>| Resampling Method           | Error Rate | Sensitivity | Specificity | AUC       |</span>
<span id="cb113-1058"><a href="#cb113-1058" aria-hidden="true" tabindex="-1"></a>| --------------------------- | ---------- | ----------- | ----------- | --------- |</span>
<span id="cb113-1059"><a href="#cb113-1059" aria-hidden="true" tabindex="-1"></a>| Logistic Regression         | 0.1944     | 0.9347      | 0.2929      | 0.6137776 |</span>
<span id="cb113-1060"><a href="#cb113-1060" aria-hidden="true" tabindex="-1"></a>| Logistic Regression (Tuned) | 0.1919     | 0.98946     | 0.08787     | 0.5386644 |</span>
<span id="cb113-1061"><a href="#cb113-1061" aria-hidden="true" tabindex="-1"></a>|                             |            |             |             |           |</span>
<span id="cb113-1062"><a href="#cb113-1062" aria-hidden="true" tabindex="-1"></a>| LDA                         | 0.1919     | 0.9283      | 0.3305      | 0.6294448 |</span>
<span id="cb113-1063"><a href="#cb113-1063" aria-hidden="true" tabindex="-1"></a>| LDA (Tuned)                 | 0.xxxx     | 0.xxxx      | 0.xxxx      | 0.xxxxxxx |</span>
<span id="cb113-1064"><a href="#cb113-1064" aria-hidden="true" tabindex="-1"></a>|                             |            |             |             |           |</span>
<span id="cb113-1065"><a href="#cb113-1065" aria-hidden="true" tabindex="-1"></a>| QDA                         | 0.2559     | 0.7418      | 0.7531      | 0.7474858 |</span>
<span id="cb113-1066"><a href="#cb113-1066" aria-hidden="true" tabindex="-1"></a>| QDA (Tuned)                 | 0.xxxx     | 0.xxxx      | 0.xxxx      | 0.xxxxxxx |</span>
<span id="cb113-1067"><a href="#cb113-1067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1068"><a href="#cb113-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1069"><a href="#cb113-1069" aria-hidden="true" tabindex="-1"></a><span class="fu">## Furthuer Modeling</span></span>
<span id="cb113-1070"><a href="#cb113-1070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1071"><a href="#cb113-1071" aria-hidden="true" tabindex="-1"></a><span class="fu">### Naive Bayes</span></span>
<span id="cb113-1072"><a href="#cb113-1072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1073"><a href="#cb113-1073" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Model Construction</span></span>
<span id="cb113-1076"><a href="#cb113-1076" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-1077"><a href="#cb113-1077" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-1078"><a href="#cb113-1078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1079"><a href="#cb113-1079" aria-hidden="true" tabindex="-1"></a><span class="fu">#### K-fold CV</span></span>
<span id="cb113-1082"><a href="#cb113-1082" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-1083"><a href="#cb113-1083" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-1084"><a href="#cb113-1084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1085"><a href="#cb113-1085" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Tuned</span></span>
<span id="cb113-1088"><a href="#cb113-1088" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-1089"><a href="#cb113-1089" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-1090"><a href="#cb113-1090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1091"><a href="#cb113-1091" aria-hidden="true" tabindex="-1"></a><span class="fu">### Decision Tree</span></span>
<span id="cb113-1092"><a href="#cb113-1092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1093"><a href="#cb113-1093" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Model Construction</span></span>
<span id="cb113-1096"><a href="#cb113-1096" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-1097"><a href="#cb113-1097" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb113-1098"><a href="#cb113-1098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1099"><a href="#cb113-1099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1100"><a href="#cb113-1100" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-1101"><a href="#cb113-1101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1102"><a href="#cb113-1102" aria-hidden="true" tabindex="-1"></a><span class="fu">#### K-fold CV</span></span>
<span id="cb113-1105"><a href="#cb113-1105" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-1106"><a href="#cb113-1106" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-1107"><a href="#cb113-1107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1108"><a href="#cb113-1108" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Tuned</span></span>
<span id="cb113-1111"><a href="#cb113-1111" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-1112"><a href="#cb113-1112" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-1113"><a href="#cb113-1113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1114"><a href="#cb113-1114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1115"><a href="#cb113-1115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1116"><a href="#cb113-1116" aria-hidden="true" tabindex="-1"></a><span class="fu">### Randome Forest</span></span>
<span id="cb113-1117"><a href="#cb113-1117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1118"><a href="#cb113-1118" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Model Construction</span></span>
<span id="cb113-1121"><a href="#cb113-1121" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-1122"><a href="#cb113-1122" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb113-1123"><a href="#cb113-1123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1124"><a href="#cb113-1124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1125"><a href="#cb113-1125" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-1126"><a href="#cb113-1126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1127"><a href="#cb113-1127" aria-hidden="true" tabindex="-1"></a><span class="fu">#### K-fold CV</span></span>
<span id="cb113-1130"><a href="#cb113-1130" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-1131"><a href="#cb113-1131" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-1132"><a href="#cb113-1132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1133"><a href="#cb113-1133" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Tuned</span></span>
<span id="cb113-1136"><a href="#cb113-1136" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-1137"><a href="#cb113-1137" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-1138"><a href="#cb113-1138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1139"><a href="#cb113-1139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1140"><a href="#cb113-1140" aria-hidden="true" tabindex="-1"></a><span class="fu">### Bagging</span></span>
<span id="cb113-1141"><a href="#cb113-1141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1142"><a href="#cb113-1142" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Model Construction</span></span>
<span id="cb113-1145"><a href="#cb113-1145" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-1146"><a href="#cb113-1146" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb113-1147"><a href="#cb113-1147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1148"><a href="#cb113-1148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1149"><a href="#cb113-1149" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-1150"><a href="#cb113-1150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1151"><a href="#cb113-1151" aria-hidden="true" tabindex="-1"></a><span class="fu">#### K-fold CV</span></span>
<span id="cb113-1154"><a href="#cb113-1154" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-1155"><a href="#cb113-1155" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-1156"><a href="#cb113-1156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1157"><a href="#cb113-1157" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Tuned</span></span>
<span id="cb113-1160"><a href="#cb113-1160" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-1161"><a href="#cb113-1161" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-1162"><a href="#cb113-1162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1163"><a href="#cb113-1163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1164"><a href="#cb113-1164" aria-hidden="true" tabindex="-1"></a><span class="fu">### Boosting</span></span>
<span id="cb113-1165"><a href="#cb113-1165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1166"><a href="#cb113-1166" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Model Construction</span></span>
<span id="cb113-1169"><a href="#cb113-1169" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-1170"><a href="#cb113-1170" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb113-1171"><a href="#cb113-1171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1172"><a href="#cb113-1172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1173"><a href="#cb113-1173" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-1174"><a href="#cb113-1174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1175"><a href="#cb113-1175" aria-hidden="true" tabindex="-1"></a><span class="fu">#### K-fold CV</span></span>
<span id="cb113-1178"><a href="#cb113-1178" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-1179"><a href="#cb113-1179" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-1180"><a href="#cb113-1180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1181"><a href="#cb113-1181" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Tuned</span></span>
<span id="cb113-1184"><a href="#cb113-1184" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-1185"><a href="#cb113-1185" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-1186"><a href="#cb113-1186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1187"><a href="#cb113-1187" aria-hidden="true" tabindex="-1"></a><span class="fu">### SVM</span></span>
<span id="cb113-1188"><a href="#cb113-1188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1189"><a href="#cb113-1189" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Model Construction</span></span>
<span id="cb113-1192"><a href="#cb113-1192" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-1193"><a href="#cb113-1193" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb113-1194"><a href="#cb113-1194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1195"><a href="#cb113-1195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1196"><a href="#cb113-1196" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-1197"><a href="#cb113-1197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1198"><a href="#cb113-1198" aria-hidden="true" tabindex="-1"></a><span class="fu">#### K-fold CV</span></span>
<span id="cb113-1201"><a href="#cb113-1201" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-1202"><a href="#cb113-1202" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-1203"><a href="#cb113-1203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1204"><a href="#cb113-1204" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Tuned</span></span>
<span id="cb113-1207"><a href="#cb113-1207" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb113-1208"><a href="#cb113-1208" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb113-1209"><a href="#cb113-1209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-1210"><a href="#cb113-1210" aria-hidden="true" tabindex="-1"></a><span class="fu">### Summary</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



<script src="Sang_files/libs/quarto-html/zenscroll-min.js"></script>
</body></html>